(self.webpackChunkdvbetter=self.webpackChunkdvbetter||[]).push([[5029],{9234:pt=>{"use strict";pt.exports=function(I){return function(){var T=arguments.length;if(T){for(var J=[],P=-1;++P<T;)J[P]=arguments[P];return I.call(this,J)}return I.call(this,[])}}},8686:(pt,R,I)=>{pt.exports=I(5454)},4054:(pt,R,I)=>{"use strict";var T=I(9471),J=I(5650),P=I(7790),k=I(4634),W=I(1929),U=I(2984),H=I(5886);pt.exports=function(N){return new Promise(function(E,K){var Z=N.data,nt=N.headers;T.isFormData(Z)&&delete nt["Content-Type"];var y=new XMLHttpRequest;N.auth&&(nt.Authorization="Basic "+btoa((N.auth.username||"")+":"+(N.auth.password||"")));var p=k(N.baseURL,N.url);if(y.open(N.method.toUpperCase(),P(p,N.params,N.paramsSerializer),!0),y.timeout=N.timeout,y.onreadystatechange=function(){if(y&&4===y.readyState&&(0!==y.status||y.responseURL&&0===y.responseURL.indexOf("file:"))){var ht="getAllResponseHeaders"in y?W(y.getAllResponseHeaders()):null;J(E,K,{data:N.responseType&&"text"!==N.responseType?y.response:y.responseText,status:y.status,statusText:y.statusText,headers:ht,config:N,request:y}),y=null}},y.onabort=function(){!y||(K(H("Request aborted",N,"ECONNABORTED",y)),y=null)},y.onerror=function(){K(H("Network Error",N,null,y)),y=null},y.ontimeout=function(){var ht="timeout of "+N.timeout+"ms exceeded";N.timeoutErrorMessage&&(ht=N.timeoutErrorMessage),K(H(ht,N,"ECONNABORTED",y)),y=null},T.isStandardBrowserEnv()){var m=I(300),b=(N.withCredentials||U(p))&&N.xsrfCookieName?m.read(N.xsrfCookieName):void 0;b&&(nt[N.xsrfHeaderName]=b)}if("setRequestHeader"in y&&T.forEach(nt,function(ht,St){void 0===Z&&"content-type"===St.toLowerCase()?delete nt[St]:y.setRequestHeader(St,ht)}),T.isUndefined(N.withCredentials)||(y.withCredentials=!!N.withCredentials),N.responseType)try{y.responseType=N.responseType}catch(x){if("json"!==N.responseType)throw x}"function"==typeof N.onDownloadProgress&&y.addEventListener("progress",N.onDownloadProgress),"function"==typeof N.onUploadProgress&&y.upload&&y.upload.addEventListener("progress",N.onUploadProgress),N.cancelToken&&N.cancelToken.promise.then(function(ht){!y||(y.abort(),K(ht),y=null)}),void 0===Z&&(Z=null),y.send(Z)})}},5454:(pt,R,I)=>{"use strict";var T=I(9471),J=I(1533),P=I(3227),k=I(4018);function U(B){var N=new P(B),F=J(P.prototype.request,N);return T.extend(F,P.prototype,N),T.extend(F,N),F}var H=U(I(2567));H.Axios=P,H.create=function(N){return U(k(H.defaults,N))},H.Cancel=I(8728),H.CancelToken=I(701),H.isCancel=I(2130),H.all=function(N){return Promise.all(N)},H.spread=I(8908),pt.exports=H,pt.exports.default=H},8728:pt=>{"use strict";function R(I){this.message=I}R.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},R.prototype.__CANCEL__=!0,pt.exports=R},701:(pt,R,I)=>{"use strict";var T=I(8728);function J(P){if("function"!=typeof P)throw new TypeError("executor must be a function.");var k;this.promise=new Promise(function(H){k=H});var W=this;P(function(H){W.reason||(W.reason=new T(H),k(W.reason))})}J.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},J.source=function(){var k;return{token:new J(function(H){k=H}),cancel:k}},pt.exports=J},2130:pt=>{"use strict";pt.exports=function(I){return!(!I||!I.__CANCEL__)}},3227:(pt,R,I)=>{"use strict";var T=I(9471),J=I(7790),P=I(3976),k=I(6764),W=I(4018);function U(H){this.defaults=H,this.interceptors={request:new P,response:new P}}U.prototype.request=function(B){"string"==typeof B?(B=arguments[1]||{}).url=arguments[0]:B=B||{},(B=W(this.defaults,B)).method=B.method?B.method.toLowerCase():this.defaults.method?this.defaults.method.toLowerCase():"get";var N=[k,void 0],F=Promise.resolve(B);for(this.interceptors.request.forEach(function(K){N.unshift(K.fulfilled,K.rejected)}),this.interceptors.response.forEach(function(K){N.push(K.fulfilled,K.rejected)});N.length;)F=F.then(N.shift(),N.shift());return F},U.prototype.getUri=function(B){return B=W(this.defaults,B),J(B.url,B.params,B.paramsSerializer).replace(/^\?/,"")},T.forEach(["delete","get","head","options"],function(B){U.prototype[B]=function(N,F){return this.request(T.merge(F||{},{method:B,url:N}))}}),T.forEach(["post","put","patch"],function(B){U.prototype[B]=function(N,F,E){return this.request(T.merge(E||{},{method:B,url:N,data:F}))}}),pt.exports=U},3976:(pt,R,I)=>{"use strict";var T=I(9471);function J(){this.handlers=[]}J.prototype.use=function(k,W){return this.handlers.push({fulfilled:k,rejected:W}),this.handlers.length-1},J.prototype.eject=function(k){this.handlers[k]&&(this.handlers[k]=null)},J.prototype.forEach=function(k){T.forEach(this.handlers,function(U){null!==U&&k(U)})},pt.exports=J},4634:(pt,R,I)=>{"use strict";var T=I(5164),J=I(1540);pt.exports=function(k,W){return k&&!T(W)?J(k,W):W}},5886:(pt,R,I)=>{"use strict";var T=I(9570);pt.exports=function(P,k,W,U,H){var B=new Error(P);return T(B,k,W,U,H)}},6764:(pt,R,I)=>{"use strict";var T=I(9471),J=I(4284),P=I(2130),k=I(2567);function W(U){U.cancelToken&&U.cancelToken.throwIfRequested()}pt.exports=function(H){return W(H),H.headers=H.headers||{},H.data=J(H.data,H.headers,H.transformRequest),H.headers=T.merge(H.headers.common||{},H.headers[H.method]||{},H.headers),T.forEach(["delete","get","head","post","put","patch","common"],function(F){delete H.headers[F]}),(H.adapter||k.adapter)(H).then(function(F){return W(H),F.data=J(F.data,F.headers,H.transformResponse),F},function(F){return P(F)||(W(H),F&&F.response&&(F.response.data=J(F.response.data,F.response.headers,H.transformResponse))),Promise.reject(F)})}},9570:pt=>{"use strict";pt.exports=function(I,T,J,P,k){return I.config=T,J&&(I.code=J),I.request=P,I.response=k,I.isAxiosError=!0,I.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},I}},4018:(pt,R,I)=>{"use strict";var T=I(9471);pt.exports=function(P,k){k=k||{};var W={},U=["url","method","params","data"],H=["headers","auth","proxy"],B=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];T.forEach(U,function(K){void 0!==k[K]&&(W[K]=k[K])}),T.forEach(H,function(K){T.isObject(k[K])?W[K]=T.deepMerge(P[K],k[K]):void 0!==k[K]?W[K]=k[K]:T.isObject(P[K])?W[K]=T.deepMerge(P[K]):void 0!==P[K]&&(W[K]=P[K])}),T.forEach(B,function(K){void 0!==k[K]?W[K]=k[K]:void 0!==P[K]&&(W[K]=P[K])});var N=U.concat(H).concat(B),F=Object.keys(k).filter(function(K){return-1===N.indexOf(K)});return T.forEach(F,function(K){void 0!==k[K]?W[K]=k[K]:void 0!==P[K]&&(W[K]=P[K])}),W}},5650:(pt,R,I)=>{"use strict";var T=I(5886);pt.exports=function(P,k,W){var U=W.config.validateStatus;!U||U(W.status)?P(W):k(T("Request failed with status code "+W.status,W.config,null,W.request,W))}},4284:(pt,R,I)=>{"use strict";var T=I(9471);pt.exports=function(P,k,W){return T.forEach(W,function(H){P=H(P,k)}),P}},2567:(pt,R,I)=>{"use strict";var T=I(9471),J=I(2196),P={"Content-Type":"application/x-www-form-urlencoded"};function k(H,B){!T.isUndefined(H)&&T.isUndefined(H["Content-Type"])&&(H["Content-Type"]=B)}var H,U={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(H=I(4054)),H),transformRequest:[function(B,N){return J(N,"Accept"),J(N,"Content-Type"),T.isFormData(B)||T.isArrayBuffer(B)||T.isBuffer(B)||T.isStream(B)||T.isFile(B)||T.isBlob(B)?B:T.isArrayBufferView(B)?B.buffer:T.isURLSearchParams(B)?(k(N,"application/x-www-form-urlencoded;charset=utf-8"),B.toString()):T.isObject(B)?(k(N,"application/json;charset=utf-8"),JSON.stringify(B)):B}],transformResponse:[function(B){if("string"==typeof B)try{B=JSON.parse(B)}catch(N){}return B}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(B){return B>=200&&B<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};T.forEach(["delete","get","head"],function(B){U.headers[B]={}}),T.forEach(["post","put","patch"],function(B){U.headers[B]=T.merge(P)}),pt.exports=U},1533:pt=>{"use strict";pt.exports=function(I,T){return function(){for(var P=new Array(arguments.length),k=0;k<P.length;k++)P[k]=arguments[k];return I.apply(T,P)}}},7790:(pt,R,I)=>{"use strict";var T=I(9471);function J(P){return encodeURIComponent(P).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}pt.exports=function(k,W,U){if(!W)return k;var H;if(U)H=U(W);else if(T.isURLSearchParams(W))H=W.toString();else{var B=[];T.forEach(W,function(E,K){null==E||(T.isArray(E)?K+="[]":E=[E],T.forEach(E,function(nt){T.isDate(nt)?nt=nt.toISOString():T.isObject(nt)&&(nt=JSON.stringify(nt)),B.push(J(K)+"="+J(nt))}))}),H=B.join("&")}if(H){var N=k.indexOf("#");-1!==N&&(k=k.slice(0,N)),k+=(-1===k.indexOf("?")?"?":"&")+H}return k}},1540:pt=>{"use strict";pt.exports=function(I,T){return T?I.replace(/\/+$/,"")+"/"+T.replace(/^\/+/,""):I}},300:(pt,R,I)=>{"use strict";var T=I(9471);pt.exports=T.isStandardBrowserEnv()?{write:function(k,W,U,H,B,N){var F=[];F.push(k+"="+encodeURIComponent(W)),T.isNumber(U)&&F.push("expires="+new Date(U).toGMTString()),T.isString(H)&&F.push("path="+H),T.isString(B)&&F.push("domain="+B),!0===N&&F.push("secure"),document.cookie=F.join("; ")},read:function(k){var W=document.cookie.match(new RegExp("(^|;\\s*)("+k+")=([^;]*)"));return W?decodeURIComponent(W[3]):null},remove:function(k){this.write(k,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},5164:pt=>{"use strict";pt.exports=function(I){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(I)}},2984:(pt,R,I)=>{"use strict";var T=I(9471);pt.exports=T.isStandardBrowserEnv()?function(){var W,P=/(msie|trident)/i.test(navigator.userAgent),k=document.createElement("a");function U(H){var B=H;return P&&(k.setAttribute("href",B),B=k.href),k.setAttribute("href",B),{href:k.href,protocol:k.protocol?k.protocol.replace(/:$/,""):"",host:k.host,search:k.search?k.search.replace(/^\?/,""):"",hash:k.hash?k.hash.replace(/^#/,""):"",hostname:k.hostname,port:k.port,pathname:"/"===k.pathname.charAt(0)?k.pathname:"/"+k.pathname}}return W=U(window.location.href),function(B){var N=T.isString(B)?U(B):B;return N.protocol===W.protocol&&N.host===W.host}}():function(){return!0}},2196:(pt,R,I)=>{"use strict";var T=I(9471);pt.exports=function(P,k){T.forEach(P,function(U,H){H!==k&&H.toUpperCase()===k.toUpperCase()&&(P[k]=U,delete P[H])})}},1929:(pt,R,I)=>{"use strict";var T=I(9471),J=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];pt.exports=function(k){var U,H,B,W={};return k&&T.forEach(k.split("\n"),function(F){if(B=F.indexOf(":"),U=T.trim(F.substr(0,B)).toLowerCase(),H=T.trim(F.substr(B+1)),U){if(W[U]&&J.indexOf(U)>=0)return;W[U]="set-cookie"===U?(W[U]?W[U]:[]).concat([H]):W[U]?W[U]+", "+H:H}}),W}},8908:pt=>{"use strict";pt.exports=function(I){return function(J){return I.apply(null,J)}}},9471:(pt,R,I)=>{"use strict";var T=I(1533),J=Object.prototype.toString;function P(G){return"[object Array]"===J.call(G)}function k(G){return void 0===G}function E(G){return null!==G&&"object"==typeof G}function y(G){return"[object Function]"===J.call(G)}function b(G,ct){if(null!=G)if("object"!=typeof G&&(G=[G]),P(G))for(var Ot=0,kt=G.length;Ot<kt;Ot++)ct.call(null,G[Ot],Ot,G);else for(var te in G)Object.prototype.hasOwnProperty.call(G,te)&&ct.call(null,G[te],te,G)}pt.exports={isArray:P,isArrayBuffer:function(G){return"[object ArrayBuffer]"===J.call(G)},isBuffer:function(G){return null!==G&&!k(G)&&null!==G.constructor&&!k(G.constructor)&&"function"==typeof G.constructor.isBuffer&&G.constructor.isBuffer(G)},isFormData:function(G){return"undefined"!=typeof FormData&&G instanceof FormData},isArrayBufferView:function(G){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(G):G&&G.buffer&&G.buffer instanceof ArrayBuffer},isString:function(G){return"string"==typeof G},isNumber:function(G){return"number"==typeof G},isObject:E,isUndefined:k,isDate:function(G){return"[object Date]"===J.call(G)},isFile:function(G){return"[object File]"===J.call(G)},isBlob:function(G){return"[object Blob]"===J.call(G)},isFunction:y,isStream:function(G){return E(G)&&y(G.pipe)},isURLSearchParams:function(G){return"undefined"!=typeof URLSearchParams&&G instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:b,merge:function x(){var G={};function ct(te,Ht){G[Ht]="object"==typeof G[Ht]&&"object"==typeof te?x(G[Ht],te):te}for(var Ot=0,kt=arguments.length;Ot<kt;Ot++)b(arguments[Ot],ct);return G},deepMerge:function ht(){var G={};function ct(te,Ht){G[Ht]="object"==typeof G[Ht]&&"object"==typeof te?ht(G[Ht],te):"object"==typeof te?ht({},te):te}for(var Ot=0,kt=arguments.length;Ot<kt;Ot++)b(arguments[Ot],ct);return G},extend:function(G,ct,Ot){return b(ct,function(te,Ht){G[Ht]=Ot&&"function"==typeof te?T(te,Ot):te}),G},trim:function(G){return G.replace(/^\s*/,"").replace(/\s*$/,"")}}},2281:function(pt,R,I){"use strict";var T=this&&this.__createBinding||(Object.create?function(B,N,F,E){void 0===E&&(E=F),Object.defineProperty(B,E,{enumerable:!0,get:function(){return N[F]}})}:function(B,N,F,E){void 0===E&&(E=F),B[E]=N[F]}),J=this&&this.__setModuleDefault||(Object.create?function(B,N){Object.defineProperty(B,"default",{enumerable:!0,value:N})}:function(B,N){B.default=N}),P=this&&this.__importStar||function(B){if(B&&B.__esModule)return B;var N={};if(null!=B)for(var F in B)"default"!==F&&Object.hasOwnProperty.call(B,F)&&T(N,B,F);return J(N,B),N},k=this&&this.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(R,"__esModule",{value:!0}),R.coords=void 0;const W=k(I(8686)),U=P(I(7174));R.coords=function(B,N=5e3){return W.default({url:"https://www.dvb.de/apps/map/coordinates",params:{id:B},responseType:"text",timeout:N}).then(E=>{if(E.data){const K=E.data.split("|");if(K.length>1)return U.WmOrGK4toWGS84(K[1],K[0])}})}},3425:function(pt,R,I){"use strict";var T=I(1325).default,J=this&&this.__createBinding||(Object.create?function(Z,nt,y,C){void 0===C&&(C=y),Object.defineProperty(Z,C,{enumerable:!0,get:function(){return nt[y]}})}:function(Z,nt,y,C){void 0===C&&(C=y),Z[C]=nt[y]}),P=this&&this.__setModuleDefault||(Object.create?function(Z,nt){Object.defineProperty(Z,"default",{enumerable:!0,value:nt})}:function(Z,nt){Z.default=nt}),k=this&&this.__importStar||function(Z){if(Z&&Z.__esModule)return Z;var nt={};if(null!=Z)for(var y in Z)"default"!==y&&Object.hasOwnProperty.call(Z,y)&&J(nt,Z,y);return P(nt,Z),nt},W=this&&this.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(R,"__esModule",{value:!0}),R.findAddress=R.findPOI=R.findStop=void 0;const U=W(I(8686)),H=k(I(7174));function B(Z,nt,y,C){return N.apply(this,arguments)}function N(){return(N=T(function*(Z,nt,y,C){if("string"!=typeof Z)throw H.constructError("ValidationError","query has to be a string");const w=Z.trim();return U.default({url:"https://webapi.vvo-online.de/tr/pointfinder",params:{format:"json",stopsOnly:nt,assignedStops:y,limit:0,query:w,dvb:!0},timeout:C}).then(m=>{H.checkStatus(m.data);const b=[];return m.data.Points&&m.data.Points.forEach(x=>{const ht=x.split("|"),St=H.WmOrGK4toWGS84(ht[5],ht[4]),G=ht[3].replace(/'/g,"");if(G&&St){const ct=""===ht[2]?"Dresden":ht[2],{id:Ot,type:kt}=H.parsePoiID(ht[0]);b.push({city:ct,coords:St,name:G,id:Ot,type:kt})}}),b}).catch(H.convertError)})).apply(this,arguments)}R.findStop=function(Z,nt=5e3){return B(Z,!0,!1,nt)},R.findPOI=function(Z,nt=5e3){return B(Z,!1,!1,nt)},R.findAddress=function(Z,nt,y=5e3){const C=H.WGS84toGK4(Z,nt);return B(`coord:${C[0]}:${C[1]}`,!1,!0,y).then(w=>0===w.length?void 0:Object.assign(Object.assign({},w[0]),{stops:w.slice(1)||[]}))}},5417:function(pt,R,I){"use strict";var T=this&&this.__createBinding||(Object.create?function(N,F,E,K){void 0===K&&(K=E),Object.defineProperty(N,K,{enumerable:!0,get:function(){return F[E]}})}:function(N,F,E,K){void 0===K&&(K=E),N[K]=F[E]}),J=this&&this.__exportStar||function(N,F){for(var E in N)"default"!==E&&!F.hasOwnProperty(E)&&T(F,N,E)};Object.defineProperty(R,"__esModule",{value:!0});var P=I(2281);Object.defineProperty(R,"coords",{enumerable:!0,get:function(){return P.coords}});var k=I(3425);Object.defineProperty(R,"findAddress",{enumerable:!0,get:function(){return k.findAddress}}),Object.defineProperty(R,"findPOI",{enumerable:!0,get:function(){return k.findPOI}}),Object.defineProperty(R,"findStop",{enumerable:!0,get:function(){return k.findStop}});var W=I(8025);Object.defineProperty(R,"lines",{enumerable:!0,get:function(){return W.lines}});var U=I(3047);Object.defineProperty(R,"monitor",{enumerable:!0,get:function(){return U.monitor}});var H=I(8407);Object.defineProperty(R,"pins",{enumerable:!0,get:function(){return H.pins}});var B=I(1649);Object.defineProperty(R,"route",{enumerable:!0,get:function(){return B.route}}),J(I(7785),R)},7785:(pt,R)=>{"use strict";var J;Object.defineProperty(R,"__esModule",{value:!0}),R.PIN_TYPE=R.POI_TYPE=void 0,(J=R.POI_TYPE||(R.POI_TYPE={})).Address="Address",J.Coords="Coords",J.POI="POI",J.Stop="Stop",function(J){J.stop="stop",J.platform="platform",J.poi="poi",J.rentabike="rentabike",J.ticketmachine="ticketmachine",J.carsharing="carsharing",J.parkandride="parkandride",J.unknown="unknown"}(R.PIN_TYPE||(R.PIN_TYPE={}))},8025:function(pt,R,I){"use strict";var T=this&&this.__createBinding||(Object.create?function(F,E,K,Z){void 0===Z&&(Z=K),Object.defineProperty(F,Z,{enumerable:!0,get:function(){return E[K]}})}:function(F,E,K,Z){void 0===Z&&(Z=K),F[Z]=E[K]}),J=this&&this.__setModuleDefault||(Object.create?function(F,E){Object.defineProperty(F,"default",{enumerable:!0,value:E})}:function(F,E){F.default=E}),P=this&&this.__importStar||function(F){if(F&&F.__esModule)return F;var E={};if(null!=F)for(var K in F)"default"!==K&&Object.hasOwnProperty.call(F,K)&&T(E,F,K);return J(E,F),E},k=this&&this.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(R,"__esModule",{value:!0}),R.lines=void 0;const W=k(I(8686)),U=P(I(7174));function H(F){return F.Name}R.lines=function(F,E=5e3){return W.default({url:"https://webapi.vvo-online.de/stt/lines",params:{format:"json",stopid:F},timeout:E}).then(Z=>{U.checkStatus(Z.data);let nt=[];return Z.data.Lines&&(nt=Z.data.Lines.map(y=>function(F){return{name:F.Name,mode:U.parseMode(F.Mot),diva:U.parseDiva(F.Diva),directions:F.Directions.map(H)}}(y))),nt}).catch(U.convertError)}},3047:function(pt,R,I){"use strict";var T=this&&this.__importDefault||function(W){return W&&W.__esModule?W:{default:W}};Object.defineProperty(R,"__esModule",{value:!0}),R.monitor=void 0;const J=T(I(8686)),P=I(7174);R.monitor=function(W,U=0,H=0,B=5e3){const N=new Date,E={url:"https://webapi.vvo-online.de/dm",params:{format:"json",stopid:W,time:new Date(N.getTime()+60*U*1e3).toISOString(),isarrival:!1,limit:H,shorttermchanges:!0,mentzonly:!1},timeout:B};return J.default(E).then(K=>{P.checkStatus(K.data);let Z=[];return K.data.Departures&&(Z=K.data.Departures.map(nt=>{const y=P.parseDate(nt.RealTime?nt.RealTime:nt.ScheduledTime),C=P.parseDate(nt.ScheduledTime);return{arrivalTime:y,scheduledTime:C,id:nt.Id,line:nt.LineName,direction:nt.Direction,platform:P.parsePlatform(nt.Platform),arrivalTimeRelative:P.dateDifference(N,y),scheduledTimeRelative:P.dateDifference(N,C),delayTime:P.dateDifference(C,y),state:nt.State?nt.State:"Unknown",mode:P.parseMode(nt.Mot),diva:P.parseDiva(nt.Diva)}})),Z}).catch(P.convertError)}},8407:function(pt,R,I){"use strict";var T=this&&this.__createBinding||(Object.create?function(N,F,E,K){void 0===K&&(K=E),Object.defineProperty(N,K,{enumerable:!0,get:function(){return F[E]}})}:function(N,F,E,K){void 0===K&&(K=E),N[K]=F[E]}),J=this&&this.__setModuleDefault||(Object.create?function(N,F){Object.defineProperty(N,"default",{enumerable:!0,value:F})}:function(N,F){N.default=F}),P=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var F={};if(null!=N)for(var E in N)"default"!==E&&Object.hasOwnProperty.call(N,E)&&T(F,N,E);return J(F,N),F},k=this&&this.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(R,"__esModule",{value:!0}),R.pins=void 0;const W=k(I(8686)),U=I(7785),H=P(I(7174));R.pins=function(N,F,E,K,Z=[U.PIN_TYPE.stop],nt=5e3){const y=H.WGS84toWm(N,F),C=H.WGS84toWm(E,K);let w="https://www.dvb.de/apps/map/pins?showLines=true";return Z.forEach(m=>w+=`&pintypes=${m}`),W.default({url:w,params:{swlng:y[0],swlat:y[1],nelng:C[0],nelat:C[1]},responseType:"text",timeout:nt}).then(m=>m.data||[]).then(m=>m.map(b=>H.parsePin(b)))}},1649:function(pt,R,I){"use strict";var T=this&&this.__createBinding||(Object.create?function(B,N,F,E){void 0===E&&(E=F),Object.defineProperty(B,E,{enumerable:!0,get:function(){return N[F]}})}:function(B,N,F,E){void 0===E&&(E=F),B[E]=N[F]}),J=this&&this.__setModuleDefault||(Object.create?function(B,N){Object.defineProperty(B,"default",{enumerable:!0,value:N})}:function(B,N){B.default=N}),P=this&&this.__importStar||function(B){if(B&&B.__esModule)return B;var N={};if(null!=B)for(var F in B)"default"!==F&&Object.hasOwnProperty.call(B,F)&&T(N,B,F);return J(N,B),N},k=this&&this.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(R,"__esModule",{value:!0}),R.route=void 0;const W=k(I(8686)),U=P(I(7174));R.route=function(B,N,F=new Date,E=!0,K=15e3){const Z={url:"https://webapi.vvo-online.de/tr/trips",params:{format:"json",origin:B,destination:N,isarrivaltime:E,shorttermchanges:!0,time:F.toISOString()},timeout:K};return W.default(Z).then(nt=>{U.checkStatus(nt.data);let y,C,w=[];if(nt.data.Routes&&(w=nt.data.Routes.map(U.extractTrip),w&&w.length>0)){const p=w[0];p.departure&&(y={id:p.departure.id,name:p.departure.name,city:p.departure.city,coords:p.departure.coords}),p.arrival&&(C={id:p.arrival.id,name:p.arrival.name,city:p.arrival.city,coords:p.arrival.coords})}return{origin:y,destination:C,trips:w}}).catch(U.convertError)}},7174:function(pt,R,I){"use strict";var T=this&&this.__importDefault||function(G){return G&&G.__esModule?G:{default:G}};Object.defineProperty(R,"__esModule",{value:!0}),R.dateDifference=R.extractTrip=R.parsePoiID=R.parseMode=R.parsePin=R.parseConnections=R.MODES=R.parsePlatform=R.parseDiva=R.parseDate=R.convertError=R.constructError=R.checkStatus=R.convertCoordinates=R.WmOrGK4toWGS84=R.WGS84toWm=R.WGS84toGK4=void 0;const J=T(I(8994)),P=I(7785);function U(G,ct){const Ot=parseInt(ct,10),kt=parseInt(G,10);if(!(0===Ot&&0===kt||isNaN(Ot)||isNaN(kt)))return J.default(kt<25e5?"WM":"GK4","WGS84",[kt,Ot])}function H(G){const ct=[];if(G){const Ot=G.split("|");let kt=1;const te=Ot.length-1;for(;kt<te;){const Ht=U(Ot[kt+1],Ot[kt]);Ht&&ct.push(Ht),kt+=2}}return ct}function N(G,ct=""){const Ot=new Error(ct);return G&&(Ot.name=G),Ot}function E(G){const ct=G.match(/\d+/);return ct?new Date(parseInt(ct[0],10)):new Date}function K(G){return G&&G.Number?{number:parseInt(G.Number,10),network:G.Network}:void 0}function Z(G){return G?{name:G.Name,type:G.Type}:void 0}function C(G){let ct=[];return G.split("#").forEach(Ot=>{if(!Ot)return[];const kt=Ot.split(":"),te=function(G){switch(G){case"1":return R.MODES.Tram;case"2":return R.MODES.CityBus;case"3":return R.MODES.IntercityBus;case"4":return R.MODES.Train;case"5":return R.MODES.SuburbanRailway;case"6":return R.MODES.HailedSharedTaxi;case"7":return R.MODES.Ferry;case"8":return R.MODES.Cableway;case"10":return R.MODES.PlusBus;default:return}}(kt[0]);ct=ct.concat(kt[1].split("~").map(Ht=>({line:Ht,mode:te})))}),ct}function p(G){if(G)switch(G.toLowerCase()){case"tram":return R.MODES.Tram;case"bus":case"citybus":return R.MODES.CityBus;case"intercitybus":return R.MODES.IntercityBus;case"suburbanrailway":return R.MODES.SuburbanRailway;case"train":case"rapidtransit":return R.MODES.Train;case"footpath":return R.MODES.Footpath;case"cableway":case"overheadrailway":return R.MODES.Cableway;case"ferry":return R.MODES.Ferry;case"hailedsharedtaxi":return R.MODES.HailedSharedTaxi;case"mobilitystairsup":return R.MODES.StairsUp;case"mobilitystairsdown":return R.MODES.StairsDown;case"mobilityescalatorup":return R.MODES.EscalatorUp;case"mobilityescalatordown":return R.MODES.EscalatorDown;case"mobilityelevatorup":return R.MODES.ElevatorUp;case"mobilityelevatordown":return R.MODES.ElevatorDown;case"stayforconnection":return R.MODES.StayForConnection;case"plusbus":return R.MODES.PlusBus;default:return{name:G,title:G.toLowerCase()}}}function b(G){return{id:G.DataId,name:G.Name.trim(),city:G.Place,type:G.Type,platform:Z(G.Platform),coords:U(G.Longitude,G.Latitude)||[0,0],arrival:E(G.ArrivalTime),departure:E(G.DepartureTime)}}J.default.defs("GK4","+proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000 +y_0=0 +ellps=bessel +datum=potsdam +units=m +no_defs"),J.default.defs("WM","+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 +b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),R.WGS84toGK4=function(G,ct){return J.default("WGS84","GK4",[G,ct]).map(Math.round)},R.WGS84toWm=function(G,ct){return J.default("WGS84","WM",[G,ct]).map(Math.round)},R.WmOrGK4toWGS84=U,R.convertCoordinates=H,R.checkStatus=function(G){if(!G||!G.Status)throw new Error("unexpected error");if("Ok"!==G.Status.Code){const ct=new Error(G.Status.Message);throw ct.name=G.Status.Code,ct}},R.constructError=N,R.convertError=function(G){throw G.response&&G.response.data&&G.response.data.Status?N(G.response.data.Status.Code,G.response.data.Status.Message):G},R.parseDate=E,R.parseDiva=K,R.parsePlatform=Z,R.MODES={Tram:{title:"Stra\xdfenbahn",name:"Tram",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-tram.svg"},CityBus:{title:"Bus",name:"CityBus",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-bus.svg"},IntercityBus:{title:"Regio-Bus",name:"IntercityBus",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-bus.svg"},SuburbanRailway:{title:"S-Bahn",name:"SuburbanRailway",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-metropolitan.svg"},Train:{title:"Zug",name:"Train",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-train.svg"},Cableway:{title:"Seil-/Schwebebahn",name:"Cableway",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-lift.svg"},Ferry:{title:"F\xe4hre",name:"Ferry",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-ferry.svg"},HailedSharedTaxi:{title:"Anrufsammeltaxi (AST)/ Rufbus",name:"HailedSharedTaxi",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-alita.svg"},Footpath:{title:"Fussweg",name:"Footpath",iconUrl:"https://m.dvb.de/img/walk.svg"},StairsUp:{title:"Treppe aufw\xe4rts",name:"StairsUp",iconUrl:"https://m.dvb.de/img/stairs-up.svg"},StairsDown:{title:"Treppe abw\xe4rts",name:"StairsDown",iconUrl:"https://m.dvb.de/img/stairs-down.svg"},EscalatorUp:{title:"Rolltreppe aufw\xe4rts",name:"EscalatorUp",iconUrl:"https://m.dvb.de/img/escalator-up.svg"},EscalatorDown:{title:"Rolltreppe abw\xe4rts",name:"EscalatorDown",iconUrl:"https://m.dvb.de/img/escalator-down.svg"},ElevatorUp:{title:"Fahrstuhl aufw\xe4rts",name:"ElevatorUp",iconUrl:"https://m.dvb.de/img/elevator-up.svg"},ElevatorDown:{title:"Fahrstuhl abw\xe4rts",name:"ElevatorDown",iconUrl:"https://m.dvb.de/img/elevator-down.svg"},StayForConnection:{title:"gesicherter Anschluss",name:"StayForConnection",iconUrl:"https://m.dvb.de/img/sit.svg"},PlusBus:{title:"PlusBus",name:"PlusBus",iconUrl:"https://m.dvb.de/img/mot_icons/plusBus.svg"}},R.parseConnections=C,R.parsePin=function(G){const ct=G.split("|"),Ot=U(ct[5],ct[4])||[],kt=function(G){switch(G){case"":return P.PIN_TYPE.stop;case"p":return P.PIN_TYPE.poi;case"pf":return P.PIN_TYPE.platform;case"pr":return P.PIN_TYPE.parkandride;case"r":return P.PIN_TYPE.rentabike;case"c":return P.PIN_TYPE.carsharing;case"t":return P.PIN_TYPE.ticketmachine}return P.PIN_TYPE.unknown}(ct[1]);return kt===P.PIN_TYPE.platform?{coords:Ot,id:ct[0],name:ct[3],platformNr:ct[6],type:kt}:kt===P.PIN_TYPE.poi||kt===P.PIN_TYPE.rentabike||kt===P.PIN_TYPE.ticketmachine||kt===P.PIN_TYPE.carsharing||kt===P.PIN_TYPE.unknown?{coords:Ot,id:ct[0],name:ct[3],type:kt}:kt===P.PIN_TYPE.parkandride?{coords:Ot,id:ct[0],name:ct[3],info:ct[6],type:kt}:{coords:Ot,id:ct[0],name:ct[3],connections:C(ct[7]),type:kt}},R.parseMode=p,R.parsePoiID=function(G){let ct=G.split(":");if(ct.length>=4)switch(ct=ct.slice(0,4),ct[0]){case"streetID":return{id:ct.join(":"),type:P.POI_TYPE.Address};case"coord":return{id:ct.join(":"),type:P.POI_TYPE.Coords};case"poiID":return{id:ct.join(":"),type:P.POI_TYPE.POI}}return{id:G,type:P.POI_TYPE.Stop}},R.extractTrip=function(G){const ct=G.PartialRoutes.map(Ot=>function(G,ct){const Ot=G.RegularStops?G.RegularStops.map(b):[];let kt,te;if(Ot&&Ot.length>1){const Ht=Ot[0],Ne=Ot[Ot.length-1];kt={id:Ht.id,name:Ht.name,city:Ht.city,platform:Ht.platform,time:Ht.departure,coords:Ht.coords,type:Ht.type},te={id:Ne.id,name:Ne.name,city:Ne.city,platform:Ne.platform,time:Ne.arrival,coords:Ne.coords,type:Ne.type}}return{stops:Ot,departure:kt,arrival:te,mode:p(G.Mot.Type),line:G.Mot.Name?G.Mot.Name:"",direction:G.Mot.Direction?G.Mot.Direction.trim():"",diva:K(G.Mot.Diva),duration:G.Duration||1,path:H(ct[G.MapDataIndex])}}(Ot,G.MapData));return{nodes:ct,departure:ct[0].departure,arrival:ct[ct.length-1].arrival,duration:G.Duration||1,interchanges:G.Interchanges}},R.dateDifference=function(G,ct){return Math.round((ct.getTime()-G.getTime())/1e3/60)}},3105:pt=>{"use strict";var T,R="object"==typeof Reflect?Reflect:null,I=R&&"function"==typeof R.apply?R.apply:function(b,x,ht){return Function.prototype.apply.call(b,x,ht)};T=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:function(b){return Object.getOwnPropertyNames(b)};var P=Number.isNaN||function(b){return b!=b};function k(){k.init.call(this)}pt.exports=k,pt.exports.once=function(m,b){return new Promise(function(x,ht){function St(ct){m.removeListener(b,G),ht(ct)}function G(){"function"==typeof m.removeListener&&m.removeListener("error",St),x([].slice.call(arguments))}p(m,b,G,{once:!0}),"error"!==b&&function(m,b,x){"function"==typeof m.on&&p(m,"error",b,{once:!0})}(m,St)})},k.EventEmitter=k,k.prototype._events=void 0,k.prototype._eventsCount=0,k.prototype._maxListeners=void 0;var W=10;function U(m){if("function"!=typeof m)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}function H(m){return void 0===m._maxListeners?k.defaultMaxListeners:m._maxListeners}function B(m,b,x,ht){var St,G,ct;if(U(x),void 0===(G=m._events)?(G=m._events=Object.create(null),m._eventsCount=0):(void 0!==G.newListener&&(m.emit("newListener",b,x.listener?x.listener:x),G=m._events),ct=G[b]),void 0===ct)ct=G[b]=x,++m._eventsCount;else if("function"==typeof ct?ct=G[b]=ht?[x,ct]:[ct,x]:ht?ct.unshift(x):ct.push(x),(St=H(m))>0&&ct.length>St&&!ct.warned){ct.warned=!0;var Ot=new Error("Possible EventEmitter memory leak detected. "+ct.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ot.name="MaxListenersExceededWarning",Ot.emitter=m,Ot.type=b,Ot.count=ct.length,function(m){console&&console.warn&&console.warn(m)}(Ot)}return m}function N(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function F(m,b,x){var ht={fired:!1,wrapFn:void 0,target:m,type:b,listener:x},St=N.bind(ht);return St.listener=x,ht.wrapFn=St,St}function E(m,b,x){var ht=m._events;if(void 0===ht)return[];var St=ht[b];return void 0===St?[]:"function"==typeof St?x?[St.listener||St]:[St]:x?function(m){for(var b=new Array(m.length),x=0;x<b.length;++x)b[x]=m[x].listener||m[x];return b}(St):Z(St,St.length)}function K(m){var b=this._events;if(void 0!==b){var x=b[m];if("function"==typeof x)return 1;if(void 0!==x)return x.length}return 0}function Z(m,b){for(var x=new Array(b),ht=0;ht<b;++ht)x[ht]=m[ht];return x}function p(m,b,x,ht){if("function"==typeof m.on)ht.once?m.once(b,x):m.on(b,x);else{if("function"!=typeof m.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof m);m.addEventListener(b,function St(G){ht.once&&m.removeEventListener(b,St),x(G)})}}Object.defineProperty(k,"defaultMaxListeners",{enumerable:!0,get:function(){return W},set:function(m){if("number"!=typeof m||m<0||P(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");W=m}}),k.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},k.prototype.setMaxListeners=function(b){if("number"!=typeof b||b<0||P(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this},k.prototype.getMaxListeners=function(){return H(this)},k.prototype.emit=function(b){for(var x=[],ht=1;ht<arguments.length;ht++)x.push(arguments[ht]);var St="error"===b,G=this._events;if(void 0!==G)St=St&&void 0===G.error;else if(!St)return!1;if(St){var ct;if(x.length>0&&(ct=x[0]),ct instanceof Error)throw ct;var Ot=new Error("Unhandled error."+(ct?" ("+ct.message+")":""));throw Ot.context=ct,Ot}var kt=G[b];if(void 0===kt)return!1;if("function"==typeof kt)I(kt,this,x);else{var te=kt.length,Ht=Z(kt,te);for(ht=0;ht<te;++ht)I(Ht[ht],this,x)}return!0},k.prototype.on=k.prototype.addListener=function(b,x){return B(this,b,x,!1)},k.prototype.prependListener=function(b,x){return B(this,b,x,!0)},k.prototype.once=function(b,x){return U(x),this.on(b,F(this,b,x)),this},k.prototype.prependOnceListener=function(b,x){return U(x),this.prependListener(b,F(this,b,x)),this},k.prototype.off=k.prototype.removeListener=function(b,x){var ht,St,G,ct,Ot;if(U(x),void 0===(St=this._events))return this;if(void 0===(ht=St[b]))return this;if(ht===x||ht.listener===x)0==--this._eventsCount?this._events=Object.create(null):(delete St[b],St.removeListener&&this.emit("removeListener",b,ht.listener||x));else if("function"!=typeof ht){for(G=-1,ct=ht.length-1;ct>=0;ct--)if(ht[ct]===x||ht[ct].listener===x){Ot=ht[ct].listener,G=ct;break}if(G<0)return this;0===G?ht.shift():function(m,b){for(;b+1<m.length;b++)m[b]=m[b+1];m.pop()}(ht,G),1===ht.length&&(St[b]=ht[0]),void 0!==St.removeListener&&this.emit("removeListener",b,Ot||x)}return this},k.prototype.removeAllListeners=function(b){var x,ht,St;if(void 0===(ht=this._events))return this;if(void 0===ht.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ht[b]&&(0==--this._eventsCount?this._events=Object.create(null):delete ht[b]),this;if(0===arguments.length){var ct,G=Object.keys(ht);for(St=0;St<G.length;++St)"removeListener"!==(ct=G[St])&&this.removeAllListeners(ct);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(x=ht[b]))this.removeListener(b,x);else if(void 0!==x)for(St=x.length-1;St>=0;St--)this.removeListener(b,x[St]);return this},k.prototype.listeners=function(b){return E(this,b,!0)},k.prototype.rawListeners=function(b){return E(this,b,!1)},k.listenerCount=function(m,b){return"function"==typeof m.listenerCount?m.listenerCount(b):K.call(m,b)},k.prototype.listenerCount=K,k.prototype.eventNames=function(){return this._eventsCount>0?T(this._events):[]}},4570:(pt,R,I)=>{"use strict";var J,P,T=[I(5525),I(7246),I(5302),I(1722),I(58),I(449)],k=-1,W=[],U=!1;function H(){!J||!P||(J=!1,P.length?W=P.concat(W):k=-1,W.length&&B())}function B(){if(!J){U=!1,J=!0;for(var nt=W.length,y=setTimeout(H);nt;){for(P=W,W=[];P&&++k<nt;)P[k].run();k=-1,nt=W.length}P=null,k=-1,J=!1,clearTimeout(y)}}for(var N,F=-1,E=T.length;++F<E;)if(T[F]&&T[F].test&&T[F].test()){N=T[F].install(B);break}function K(nt,y){this.fun=nt,this.array=y}K.prototype.run=function(){var nt=this.fun,y=this.array;switch(y.length){case 0:return nt();case 1:return nt(y[0]);case 2:return nt(y[0],y[1]);case 3:return nt(y[0],y[1],y[2]);default:return nt.apply(null,y)}},pt.exports=function(nt){var y=new Array(arguments.length-1);if(arguments.length>1)for(var C=1;C<arguments.length;C++)y[C-1]=arguments[C];W.push(new K(nt,y)),!U&&!J&&(U=!0,N())}},1722:(pt,R)=>{"use strict";R.test=function(){return!global.setImmediate&&void 0!==global.MessageChannel},R.install=function(I){var T=new global.MessageChannel;return T.port1.onmessage=I,function(){T.port2.postMessage(0)}}},5302:(pt,R)=>{"use strict";var I=global.MutationObserver||global.WebKitMutationObserver;R.test=function(){return I},R.install=function(T){var J=0,P=new I(T),k=global.document.createTextNode("");return P.observe(k,{characterData:!0}),function(){k.data=J=++J%2}}},7246:(pt,R)=>{"use strict";R.test=function(){return"function"==typeof global.queueMicrotask},R.install=function(I){return function(){global.queueMicrotask(I)}}},58:(pt,R)=>{"use strict";R.test=function(){return"document"in global&&"onreadystatechange"in global.document.createElement("script")},R.install=function(I){return function(){var T=global.document.createElement("script");return T.onreadystatechange=function(){I(),T.onreadystatechange=null,T.parentNode.removeChild(T),T=null},global.document.documentElement.appendChild(T),I}}},449:(pt,R)=>{"use strict";R.test=function(){return!0},R.install=function(I){return function(){setTimeout(I,0)}}},9879:pt=>{pt.exports="function"==typeof Object.create?function(I,T){T&&(I.super_=T,I.prototype=Object.create(T.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}))}:function(I,T){if(T){I.super_=T;var J=function(){};J.prototype=T.prototype,I.prototype=new J,I.prototype.constructor=I}}},8626:(pt,R)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;const I=[];for(let P=0;P<256;++P)I.push((P+256).toString(16).substr(1));R.default=function(P,k){const W=k||0;return(I[P[W+0]]+I[P[W+1]]+I[P[W+2]]+I[P[W+3]]+"-"+I[P[W+4]]+I[P[W+5]]+"-"+I[P[W+6]]+I[P[W+7]]+"-"+I[P[W+8]]+I[P[W+9]]+"-"+I[P[W+10]]+I[P[W+11]]+I[P[W+12]]+I[P[W+13]]+I[P[W+14]]+I[P[W+15]]).toLowerCase()}},7613:(pt,R,I)=>{"use strict";Object.defineProperty(R,"v1",{enumerable:!0,get:function(){return J.default}}),Object.defineProperty(R,"v3",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(R,"v4",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(R,"v5",{enumerable:!0,get:function(){return W.default}});var J=U(I(427)),P=U(I(7119)),k=U(I(9271)),W=U(I(1024));function U(H){return H&&H.__esModule?H:{default:H}}},8050:(pt,R)=>{"use strict";function J(Z){return 14+(Z+64>>>9<<4)+1}function W(Z,nt){const y=(65535&Z)+(65535&nt);return(Z>>16)+(nt>>16)+(y>>16)<<16|65535&y}function H(Z,nt,y,C,w,p){return W(function(Z,nt){return Z<<nt|Z>>>32-nt}(W(W(nt,Z),W(C,p)),w),y)}function B(Z,nt,y,C,w,p,m){return H(nt&y|~nt&C,Z,nt,w,p,m)}function N(Z,nt,y,C,w,p,m){return H(nt&C|y&~C,Z,nt,w,p,m)}function F(Z,nt,y,C,w,p,m){return H(nt^y^C,Z,nt,w,p,m)}function E(Z,nt,y,C,w,p,m){return H(y^(nt|~C),Z,nt,w,p,m)}Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0,R.default=function(Z){if("string"==typeof Z){const nt=unescape(encodeURIComponent(Z));Z=new Uint8Array(nt.length);for(let y=0;y<nt.length;++y)Z[y]=nt.charCodeAt(y)}return function(Z){const nt=[],y=32*Z.length,C="0123456789abcdef";for(let w=0;w<y;w+=8){const p=Z[w>>5]>>>w%32&255,m=parseInt(C.charAt(p>>>4&15)+C.charAt(15&p),16);nt.push(m)}return nt}(function(Z,nt){Z[nt>>5]|=128<<nt%32,Z[J(nt)-1]=nt;let y=1732584193,C=-271733879,w=-1732584194,p=271733878;for(let m=0;m<Z.length;m+=16){const b=y,x=C,ht=w,St=p;y=B(y,C,w,p,Z[m],7,-680876936),p=B(p,y,C,w,Z[m+1],12,-389564586),w=B(w,p,y,C,Z[m+2],17,606105819),C=B(C,w,p,y,Z[m+3],22,-1044525330),y=B(y,C,w,p,Z[m+4],7,-176418897),p=B(p,y,C,w,Z[m+5],12,1200080426),w=B(w,p,y,C,Z[m+6],17,-1473231341),C=B(C,w,p,y,Z[m+7],22,-45705983),y=B(y,C,w,p,Z[m+8],7,1770035416),p=B(p,y,C,w,Z[m+9],12,-1958414417),w=B(w,p,y,C,Z[m+10],17,-42063),C=B(C,w,p,y,Z[m+11],22,-1990404162),y=B(y,C,w,p,Z[m+12],7,1804603682),p=B(p,y,C,w,Z[m+13],12,-40341101),w=B(w,p,y,C,Z[m+14],17,-1502002290),C=B(C,w,p,y,Z[m+15],22,1236535329),y=N(y,C,w,p,Z[m+1],5,-165796510),p=N(p,y,C,w,Z[m+6],9,-1069501632),w=N(w,p,y,C,Z[m+11],14,643717713),C=N(C,w,p,y,Z[m],20,-373897302),y=N(y,C,w,p,Z[m+5],5,-701558691),p=N(p,y,C,w,Z[m+10],9,38016083),w=N(w,p,y,C,Z[m+15],14,-660478335),C=N(C,w,p,y,Z[m+4],20,-405537848),y=N(y,C,w,p,Z[m+9],5,568446438),p=N(p,y,C,w,Z[m+14],9,-1019803690),w=N(w,p,y,C,Z[m+3],14,-187363961),C=N(C,w,p,y,Z[m+8],20,1163531501),y=N(y,C,w,p,Z[m+13],5,-1444681467),p=N(p,y,C,w,Z[m+2],9,-51403784),w=N(w,p,y,C,Z[m+7],14,1735328473),C=N(C,w,p,y,Z[m+12],20,-1926607734),y=F(y,C,w,p,Z[m+5],4,-378558),p=F(p,y,C,w,Z[m+8],11,-2022574463),w=F(w,p,y,C,Z[m+11],16,1839030562),C=F(C,w,p,y,Z[m+14],23,-35309556),y=F(y,C,w,p,Z[m+1],4,-1530992060),p=F(p,y,C,w,Z[m+4],11,1272893353),w=F(w,p,y,C,Z[m+7],16,-155497632),C=F(C,w,p,y,Z[m+10],23,-1094730640),y=F(y,C,w,p,Z[m+13],4,681279174),p=F(p,y,C,w,Z[m],11,-358537222),w=F(w,p,y,C,Z[m+3],16,-722521979),C=F(C,w,p,y,Z[m+6],23,76029189),y=F(y,C,w,p,Z[m+9],4,-640364487),p=F(p,y,C,w,Z[m+12],11,-421815835),w=F(w,p,y,C,Z[m+15],16,530742520),C=F(C,w,p,y,Z[m+2],23,-995338651),y=E(y,C,w,p,Z[m],6,-198630844),p=E(p,y,C,w,Z[m+7],10,1126891415),w=E(w,p,y,C,Z[m+14],15,-1416354905),C=E(C,w,p,y,Z[m+5],21,-57434055),y=E(y,C,w,p,Z[m+12],6,1700485571),p=E(p,y,C,w,Z[m+3],10,-1894986606),w=E(w,p,y,C,Z[m+10],15,-1051523),C=E(C,w,p,y,Z[m+1],21,-2054922799),y=E(y,C,w,p,Z[m+8],6,1873313359),p=E(p,y,C,w,Z[m+15],10,-30611744),w=E(w,p,y,C,Z[m+6],15,-1560198380),C=E(C,w,p,y,Z[m+13],21,1309151649),y=E(y,C,w,p,Z[m+4],6,-145523070),p=E(p,y,C,w,Z[m+11],10,-1120210379),w=E(w,p,y,C,Z[m+2],15,718787259),C=E(C,w,p,y,Z[m+9],21,-343485551),y=W(y,b),C=W(C,x),w=W(w,ht),p=W(p,St)}return[y,C,w,p]}(function(Z){if(0===Z.length)return[];const nt=8*Z.length,y=new Uint32Array(J(nt));for(let C=0;C<nt;C+=8)y[C>>5]|=(255&Z[C/8])<<C%32;return y}(Z),8*Z.length))}},4175:(pt,R)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){if(!I)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(T)};const I="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),T=new Uint8Array(16)},4032:(pt,R)=>{"use strict";function I(k,W,U,H){switch(k){case 0:return W&U^~W&H;case 1:return W^U^H;case 2:return W&U^W&H^U&H;case 3:return W^U^H}}function T(k,W){return k<<W|k>>>32-W}Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0,R.default=function(k){const W=[1518500249,1859775393,2400959708,3395469782],U=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof k){const F=unescape(encodeURIComponent(k));k=[];for(let E=0;E<F.length;++E)k.push(F.charCodeAt(E))}k.push(128);const B=Math.ceil((k.length/4+2)/16),N=new Array(B);for(let F=0;F<B;++F){const E=new Uint32Array(16);for(let K=0;K<16;++K)E[K]=k[64*F+4*K]<<24|k[64*F+4*K+1]<<16|k[64*F+4*K+2]<<8|k[64*F+4*K+3];N[F]=E}N[B-1][14]=8*(k.length-1)/Math.pow(2,32),N[B-1][14]=Math.floor(N[B-1][14]),N[B-1][15]=8*(k.length-1)&4294967295;for(let F=0;F<B;++F){const E=new Uint32Array(80);for(let w=0;w<16;++w)E[w]=N[F][w];for(let w=16;w<80;++w)E[w]=T(E[w-3]^E[w-8]^E[w-14]^E[w-16],1);let K=U[0],Z=U[1],nt=U[2],y=U[3],C=U[4];for(let w=0;w<80;++w){const p=Math.floor(w/20),m=T(K,5)+I(p,Z,nt,y)+C+W[p]+E[w]>>>0;C=y,y=nt,nt=T(Z,30)>>>0,Z=K,K=m}U[0]=U[0]+K>>>0,U[1]=U[1]+Z>>>0,U[2]=U[2]+nt>>>0,U[3]=U[3]+y>>>0,U[4]=U[4]+C>>>0}return[U[0]>>24&255,U[0]>>16&255,U[0]>>8&255,255&U[0],U[1]>>24&255,U[1]>>16&255,U[1]>>8&255,255&U[1],U[2]>>24&255,U[2]>>16&255,U[2]>>8&255,255&U[2],U[3]>>24&255,U[3]>>16&255,U[3]>>8&255,255&U[3],U[4]>>24&255,U[4]>>16&255,U[4]>>8&255,255&U[4]]}},427:(pt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var T=P(I(4175)),J=P(I(8626));function P(F){return F&&F.__esModule?F:{default:F}}let k,W,U=0,H=0;R.default=function(F,E,K){let Z=E&&K||0;const nt=E||[];let y=(F=F||{}).node||k,C=void 0!==F.clockseq?F.clockseq:W;if(null==y||null==C){const ht=F.random||(F.rng||T.default)();null==y&&(y=k=[1|ht[0],ht[1],ht[2],ht[3],ht[4],ht[5]]),null==C&&(C=W=16383&(ht[6]<<8|ht[7]))}let w=void 0!==F.msecs?F.msecs:Date.now(),p=void 0!==F.nsecs?F.nsecs:H+1;const m=w-U+(p-H)/1e4;if(m<0&&void 0===F.clockseq&&(C=C+1&16383),(m<0||w>U)&&void 0===F.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");U=w,H=p,W=C,w+=122192928e5;const b=(1e4*(268435455&w)+p)%4294967296;nt[Z++]=b>>>24&255,nt[Z++]=b>>>16&255,nt[Z++]=b>>>8&255,nt[Z++]=255&b;const x=w/4294967296*1e4&268435455;nt[Z++]=x>>>8&255,nt[Z++]=255&x,nt[Z++]=x>>>24&15|16,nt[Z++]=x>>>16&255,nt[Z++]=C>>>8|128,nt[Z++]=255&C;for(let ht=0;ht<6;++ht)nt[Z+ht]=y[ht];return E||(0,J.default)(nt)}},7119:(pt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var T=P(I(1959)),J=P(I(8050));function P(U){return U&&U.__esModule?U:{default:U}}var W=(0,T.default)("v3",48,J.default);R.default=W},1959:(pt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(B,N,F){function E(K,Z,nt,y){const C=nt&&y||0;if("string"==typeof K&&(K=function(B){B=unescape(encodeURIComponent(B));const N=[];for(let F=0;F<B.length;++F)N.push(B.charCodeAt(F));return N}(K)),"string"==typeof Z&&(Z=function(B){const N=[];return B.replace(/[a-fA-F0-9]{2}/g,function(F){N.push(parseInt(F,16))}),N}(Z)),!Array.isArray(K))throw TypeError("value must be an array of bytes");if(!Array.isArray(Z)||16!==Z.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");const w=F(Z.concat(K));if(w[6]=15&w[6]|N,w[8]=63&w[8]|128,nt)for(let p=0;p<16;++p)nt[C+p]=w[p];return nt||(0,T.default)(w)}try{E.name=B}catch(K){}return E.DNS=W,E.URL=U,E},R.URL=R.DNS=void 0;var B,T=(B=I(8626))&&B.__esModule?B:{default:B};const W="6ba7b810-9dad-11d1-80b4-00c04fd430c8";R.DNS=W;const U="6ba7b811-9dad-11d1-80b4-00c04fd430c8";R.URL=U},9271:(pt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var T=P(I(4175)),J=P(I(8626));function P(U){return U&&U.__esModule?U:{default:U}}R.default=function(U,H,B){"string"==typeof U&&(H="binary"===U?new Uint8Array(16):null,U=null);const N=(U=U||{}).random||(U.rng||T.default)();if(N[6]=15&N[6]|64,N[8]=63&N[8]|128,H){const F=B||0;for(let E=0;E<16;++E)H[F+E]=N[E];return H}return(0,J.default)(N)}},1024:(pt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var T=P(I(1959)),J=P(I(4032));function P(U){return U&&U.__esModule?U:{default:U}}var W=(0,T.default)("v5",80,J.default);R.default=W},8994:(pt,R,I)=>{"use strict";I.r(R),I.d(R,{default:()=>ma});var H=6378137,N=.0066943799901413165,F=484813681109536e-20,E=Math.PI/2,y=1e-10,C=.017453292519943295,w=57.29577951308232,p=Math.PI/4,m=2*Math.PI,b=3.14159265359,x={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const ht={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var St=/[\s_\-\/\(\)]/g;function G(e,a){if(e[a])return e[a];for(var v,s=Object.keys(e),f=a.toLowerCase().replace(St,""),c=-1;++c<s.length;)if((v=s[c]).toLowerCase().replace(St,"")===f)return e[v]}function ct(e){var f,c,v,a={},s=e.split("+").map(function(l){return l.trim()}).filter(function(l){return l}).reduce(function(l,S){var D=S.split("=");return D.push(!0),l[D[0].toLowerCase()]=D[1],l},{}),g={proj:"projName",datum:"datumCode",rf:function(l){a.rf=parseFloat(l)},lat_0:function(l){a.lat0=l*C},lat_1:function(l){a.lat1=l*C},lat_2:function(l){a.lat2=l*C},lat_ts:function(l){a.lat_ts=l*C},lon_0:function(l){a.long0=l*C},lon_1:function(l){a.long1=l*C},lon_2:function(l){a.long2=l*C},alpha:function(l){a.alpha=parseFloat(l)*C},gamma:function(l){a.rectified_grid_angle=parseFloat(l)},lonc:function(l){a.longc=l*C},x_0:function(l){a.x0=parseFloat(l)},y_0:function(l){a.y0=parseFloat(l)},k_0:function(l){a.k0=parseFloat(l)},k:function(l){a.k0=parseFloat(l)},a:function(l){a.a=parseFloat(l)},b:function(l){a.b=parseFloat(l)},r_a:function(){a.R_A=!0},zone:function(l){a.zone=parseInt(l,10)},south:function(){a.utmSouth=!0},towgs84:function(l){a.datum_params=l.split(",").map(function(S){return parseFloat(S)})},to_meter:function(l){a.to_meter=parseFloat(l)},units:function(l){a.units=l;var S=G(ht,l);S&&(a.to_meter=S.to_meter)},from_greenwich:function(l){a.from_greenwich=l*C},pm:function(l){var S=G(x,l);a.from_greenwich=(S||parseFloat(l))*C},nadgrids:function(l){"@null"===l?a.datumCode="none":a.nadgrids=l},axis:function(l){var S="ewnsud";3===l.length&&-1!==S.indexOf(l.substr(0,1))&&-1!==S.indexOf(l.substr(1,1))&&-1!==S.indexOf(l.substr(2,1))&&(a.axis=l)},approx:function(){a.approx=!0}};for(f in s)c=s[f],f in g?"function"==typeof(v=g[f])?v(c):a[v]=c:a[f]=c;return"string"==typeof a.datumCode&&"WGS84"!==a.datumCode&&(a.datumCode=a.datumCode.toLowerCase()),a}var e,_a=/\s/,ke=/[A-Za-z]/,$r=/[A-Za-z84]/,yn=/[,\]]/,ya=/[\d\.E\-\+]/;function Ue(e){if("string"!=typeof e)throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function fi(e,a,s){Array.isArray(a)&&(s.unshift(a),a=null);var c=s.reduce(function(v,g){return Ye(g,v),v},a?{}:e);a&&(e[a]=c)}function Ye(e,a){if(Array.isArray(e)){var s=e.shift();if("PARAMETER"===s&&(s=e.shift()),1===e.length)return Array.isArray(e[0])?(a[s]={},void Ye(e[0],a[s])):void(a[s]=e[0]);if(e.length)if("TOWGS84"!==s){if("AXIS"===s)return s in a||(a[s]=[]),void a[s].push(e);var f;switch(Array.isArray(s)||(a[s]={}),s){case"UNIT":case"PRIMEM":case"VERT_DATUM":return a[s]={name:e[0].toLowerCase(),convert:e[1]},void(3===e.length&&Ye(e[2],a[s]));case"SPHEROID":case"ELLIPSOID":return a[s]={name:e[0],a:e[1],rf:e[2]},void(4===e.length&&Ye(e[3],a[s]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return e[0]=["name",e[0]],void fi(a,s,e);default:for(f=-1;++f<e.length;)if(!Array.isArray(e[f]))return Ye(e,a[s]);return fi(a,s,e)}}else a[s]=e;else a[s]=!0}else a[e]=!0}function Ae(e){return.017453292519943295*e}function Ee(e){var a=function(e){return new Ue(e).output()}(e),s=a.shift(),f=a.shift();a.unshift(["name",f]),a.unshift(["type",s]);var c={};return Ye(a,c),function(e){if("GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):e.projName="object"==typeof e.PROJECTION?Object.keys(e.PROJECTION)[0]:e.PROJECTION,e.AXIS){for(var a="",s=0,f=e.AXIS.length;s<f;++s){var c=[e.AXIS[s][0].toLowerCase(),e.AXIS[s][1].toLowerCase()];-1!==c[0].indexOf("north")||("y"===c[0]||"lat"===c[0])&&"north"===c[1]?a+="n":-1!==c[0].indexOf("south")||("y"===c[0]||"lat"===c[0])&&"south"===c[1]?a+="s":-1!==c[0].indexOf("east")||("x"===c[0]||"lon"===c[0])&&"east"===c[1]?a+="e":(-1!==c[0].indexOf("west")||("x"===c[0]||"lon"===c[0])&&"west"===c[1])&&(a+="w")}2===a.length&&(a+="u"),3===a.length&&(e.axis=a)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var v=e.GEOGCS;function g(D){return D*(e.to_meter||1)}"GEOGCS"===e.type&&(v=e),v&&(e.datumCode=v.DATUM?v.DATUM.name.toLowerCase():v.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===e.datumCode||"new_zealand_1949"===e.datumCode)&&(e.datumCode="nzgd49"),("wgs_1984"===e.datumCode||"world_geodetic_system_1984"===e.datumCode)&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),v.DATUM&&v.DATUM.SPHEROID&&(e.ellps=v.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=v.DATUM.SPHEROID.a,e.rf=parseFloat(v.DATUM.SPHEROID.rf,10)),v.DATUM&&v.DATUM.TOWGS84&&(e.datum_params=v.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ae],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ae],["x0","false_easting",g],["y0","false_northing",g],["long0","central_meridian",Ae],["lat0","latitude_of_origin",Ae],["lat0","standard_parallel_1",Ae],["lat1","standard_parallel_1",Ae],["lat2","standard_parallel_2",Ae],["azimuth","Azimuth"],["alpha","azimuth",Ae],["srsCode","name"]].forEach(function(D){return function(e,a){var s=a[0],f=a[1];!(s in e)&&f in e&&(e[s]=e[f],3===a.length&&(e[s]=a[2](e[s])))}(e,D)}),!e.long0&&e.longc&&("Albers_Conic_Equal_Area"===e.projName||"Lambert_Azimuthal_Equal_Area"===e.projName)&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&("Stereographic_South_Pole"===e.projName||"Polar Stereographic (variant B)"===e.projName)&&(e.lat0=Ae(e.lat1>0?90:-90),e.lat_ts=e.lat1)}(c),c}function Te(e){var a=this;if(2===arguments.length){var s=arguments[1];Te[e]="string"==typeof s?"+"===s.charAt(0)?ct(arguments[1]):Ee(arguments[1]):s}else if(1===arguments.length){if(Array.isArray(e))return e.map(function(f){Array.isArray(f)?Te.apply(a,f):Te(f)});if("string"==typeof e){if(e in Te)return Te[e]}else"EPSG"in e?Te["EPSG:"+e.EPSG]=e:"ESRI"in e?Te["ESRI:"+e.ESRI]=e:"IAU2000"in e?Te["IAU2000:"+e.IAU2000]=e:console.log(e);return}}Ue.prototype.readCharicter=function(){var e=this.text[this.place++];if(4!==this.state)for(;_a.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case 1:return this.neutral(e);case 2:return this.keyword(e);case 4:return this.quoted(e);case 5:return this.afterquote(e);case 3:return this.number(e);case-1:return}},Ue.prototype.afterquote=function(e){if('"'===e)return this.word+='"',void(this.state=4);if(yn.test(e))return this.word=this.word.trim(),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in afterquote yet, index '+this.place)},Ue.prototype.afterItem=function(e){return","===e?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===e?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Ue.prototype.number=function(e){if(!ya.test(e)){if(yn.test(e))return this.word=parseFloat(this.word),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in number yet, index '+this.place)}this.word+=e},Ue.prototype.quoted=function(e){'"'!==e?this.word+=e:this.state=5},Ue.prototype.keyword=function(e){if($r.test(e))this.word+=e;else{if("["===e){var a=[];return a.push(this.word),this.level++,null===this.root?this.root=a:this.currentObject.push(a),this.stack.push(this.currentObject),this.currentObject=a,void(this.state=1)}if(!yn.test(e))throw new Error("havn't handled \""+e+'" in keyword yet, index '+this.place);this.afterItem(e)}},Ue.prototype.neutral=function(e){if(ke.test(e))return this.word=e,void(this.state=2);if('"'===e)return this.word="",void(this.state=4);if(ya.test(e))return this.word=e,void(this.state=3);if(!yn.test(e))throw new Error("havn't handled \""+e+'" in neutral yet, index '+this.place);this.afterItem(e)},Ue.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)},(e=Te)("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"];const _e=Te;var Je=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],Sa=["3857","900913","3785","102113"];function Mn(e,a){var s,f;if(e=e||{},!a)return e;for(f in a)void 0!==(s=a[f])&&(e[f]=s);return e}function Be(e,a,s){var f=e*a;return s/Math.sqrt(1-f*f)}function Tr(e){return e<0?-1:1}function Mt(e){return Math.abs(e)<=b?e:e-Tr(e)*m}function Pe(e,a,s){var f=e*s;return f=Math.pow((1-f)/(1+f),.5*e),Math.tan(.5*(E-a))/f}function pr(e,a){for(var f,c,s=.5*e,v=E-2*Math.atan(a),g=0;g<=15;g++)if(f=e*Math.sin(v),v+=c=E-2*Math.atan(a*Math.pow((1-f)/(1+f),s))-v,Math.abs(c)<=1e-10)return v;return-9999}function wn(e){return e}var Pa=[{init:function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):Be(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function(e){var f,c,a=e.x,s=e.y;if(s*w>90&&s*w<-90&&a*w>180&&a*w<-180)return null;if(Math.abs(Math.abs(s)-E)<=y)return null;if(this.sphere)f=this.x0+this.a*this.k0*Mt(a-this.long0),c=this.y0+this.a*this.k0*Math.log(Math.tan(p+.5*s));else{var v=Math.sin(s),g=Pe(this.e,s,v);f=this.x0+this.a*this.k0*Mt(a-this.long0),c=this.y0-this.a*this.k0*Math.log(g)}return e.x=f,e.y=c,e},inverse:function(e){var f,c,a=e.x-this.x0,s=e.y-this.y0;if(this.sphere)c=E-2*Math.atan(Math.exp(-s/(this.a*this.k0)));else{var v=Math.exp(-s/(this.a*this.k0));if(-9999===(c=pr(this.e,v)))return null}return f=Mt(this.long0+a/(this.a*this.k0)),e.x=f,e.y=c,e},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:wn,inverse:wn,names:["longlat","identity"]}],Qe={},be=[];function di(e,a){var s=be.length;return e.names?(be[s]=e,e.names.forEach(function(f){Qe[f.toLowerCase()]=s}),this):(console.log(a),!0)}const Cn={start:function(){Pa.forEach(di)},add:di,get:function(e){if(!e)return!1;var a=e.toLowerCase();return void 0!==Qe[a]&&be[Qe[a]]?be[Qe[a]]:void 0}};var Rt={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},ie=Rt.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Rt.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var ee={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};var mi={};function pi(e){if(0===e.length)return null;var a="@"===e[0];return a&&(e=e.slice(1)),"null"===e?{name:"null",mandatory:!a,grid:null,isNull:!0}:{name:e,mandatory:!a,grid:mi[e]||null,isNull:!1}}function Ve(e){return e/3600*Math.PI/180}function Kr(e,a,s){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(a,s)))}function An(e){return e.map(function(a){return[Ve(a.longitudeShift),Ve(a.latitudeShift)]})}function Ro(e,a,s){return{name:Kr(e,a+8,a+16).trim(),parent:Kr(e,a+24,a+24+8).trim(),lowerLatitude:e.getFloat64(a+72,s),upperLatitude:e.getFloat64(a+88,s),lowerLongitude:e.getFloat64(a+104,s),upperLongitude:e.getFloat64(a+120,s),latitudeInterval:e.getFloat64(a+136,s),longitudeInterval:e.getFloat64(a+152,s),gridNodeCount:e.getInt32(a+168,s)}}function On(e,a,s,f){for(var c=a+176,g=[],l=0;l<s.gridNodeCount;l++){var S={latitudeShift:e.getFloat32(c+16*l,f),longitudeShift:e.getFloat32(c+16*l+4,f),latitudeAccuracy:e.getFloat32(c+16*l+8,f),longitudeAccuracy:e.getFloat32(c+16*l+12,f)};g.push(S)}return g}function Dr(e,a){if(!(this instanceof Dr))return new Dr(e);a=a||function(D){if(D)throw D};var s=function(e){if(!function(e){return"string"==typeof e}(e))return e;if(function(e){return e in _e}(e))return _e[e];if(function(e){return Je.some(function(a){return e.indexOf(a)>-1})}(e)){var a=Ee(e);if(function(e){var a=G(e,"authority");if(a){var s=G(a,"epsg");return s&&Sa.indexOf(s)>-1}}(a))return _e["EPSG:3857"];var s=function(e){var a=G(e,"extension");if(a)return G(a,"proj4")}(a);return s?ct(s):a}return function(e){return"+"===e[0]}(e)?ct(e):void 0}(e);if("object"==typeof s){var f=Dr.projections.get(s.projName);if(f){if(s.datumCode&&"none"!==s.datumCode){var c=G(ee,s.datumCode);c&&(s.datum_params=s.datum_params||(c.towgs84?c.towgs84.split(","):null),s.ellps=c.ellipse,s.datumName=c.datumName?c.datumName:s.datumCode)}s.k0=s.k0||1,s.axis=s.axis||"enu",s.ellps=s.ellps||"wgs84",s.lat1=s.lat1||s.lat0;var v=function(e,a,s,f,c){if(!e){var v=G(Rt,f);v||(v=ie),e=v.a,a=v.b,s=v.rf}return s&&!a&&(a=(1-1/s)*e),(0===s||Math.abs(e-a)<y)&&(c=!0,a=e),{a:e,b:a,rf:s,sphere:c}}(s.a,s.b,s.rf,s.ellps,s.sphere),g=function(e,a,s,f){var c=e*e,v=a*a,g=(c-v)/c,l=0;return f?(c=(e*=1-g*(.16666666666666666+g*(.04722222222222222+.022156084656084655*g)))*e,g=0):l=Math.sqrt(g),{es:g,e:l,ep2:(c-v)/v}}(v.a,v.b,0,s.R_A),l=function(e){return void 0===e?null:e.split(",").map(pi)}(s.nadgrids),S=s.datum||function(e,a,s,f,c,v,g){var l={};return l.datum_type=void 0===e||"none"===e?5:4,a&&(l.datum_params=a.map(parseFloat),(0!==l.datum_params[0]||0!==l.datum_params[1]||0!==l.datum_params[2])&&(l.datum_type=1),l.datum_params.length>3&&(0!==l.datum_params[3]||0!==l.datum_params[4]||0!==l.datum_params[5]||0!==l.datum_params[6])&&(l.datum_type=2,l.datum_params[3]*=F,l.datum_params[4]*=F,l.datum_params[5]*=F,l.datum_params[6]=l.datum_params[6]/1e6+1)),g&&(l.datum_type=3,l.grids=g),l.a=s,l.b=f,l.es=c,l.ep2=v,l}(s.datumCode,s.datum_params,v.a,v.b,g.es,g.ep2,l);Mn(this,s),Mn(this,f),this.a=v.a,this.b=v.b,this.rf=v.rf,this.sphere=v.sphere,this.es=g.es,this.e=g.e,this.ep2=g.ep2,this.datum=S,this.init(),a(null,this)}else a(e)}else a(e)}(Dr.projections=Cn).start();const Vr=Dr;function En(e,a,s){var g,l,D,f=e.x,c=e.y,v=e.z?e.z:0;if(c<-E&&c>-1.001*E)c=-E;else if(c>E&&c<1.001*E)c=E;else{if(c<-E)return{x:-1/0,y:-1/0,z:e.z};if(c>E)return{x:1/0,y:1/0,z:e.z}}return f>Math.PI&&(f-=2*Math.PI),l=Math.sin(c),D=Math.cos(c),{x:((g=s/Math.sqrt(1-a*(l*l)))+v)*D*Math.cos(f),y:(g+v)*D*Math.sin(f),z:(g*(1-a)+v)*l}}function Ra(e,a,s,f){var l,S,D,X,z,st,ft,dt,lt,mt,Pt,Ft,Qt,we,Ze,$t=e.x,Jt=e.y,Xt=e.z?e.z:0;if(l=Math.sqrt($t*$t+Jt*Jt),S=Math.sqrt($t*$t+Jt*Jt+Xt*Xt),l/s<1e-12){if(we=0,S/s<1e-12)return Ze=-f,{x:e.x,y:e.y,z:e.z}}else we=Math.atan2(Jt,$t);D=Xt/S,dt=(X=l/S)*(1-a)*(z=1/Math.sqrt(1-a*(2-a)*X*X)),lt=D*z,Qt=0;do{Qt++,st=a*(ft=s/Math.sqrt(1-a*lt*lt))/(ft+(Ze=l*dt+Xt*lt-ft*(1-a*lt*lt))),Ft=(Pt=D*(z=1/Math.sqrt(1-st*(2-st)*X*X)))*dt-(mt=X*(1-st)*z)*lt,dt=mt,lt=Pt}while(Ft*Ft>1e-24&&Qt<30);return{x:we,y:Math.atan(Pt/Math.abs(mt)),z:Ze}}function jt(e){return 1===e||2===e}function gi(e,a,s){if(null===e.grids||0===e.grids.length)return console.log("Grid shift grids not found"),-1;for(var f={x:-s.x,y:s.y},c={x:Number.NaN,y:Number.NaN},g=[],l=0;l<e.grids.length;l++){var S=e.grids[l];if(g.push(S.name),S.isNull){c=f;break}if(null!==S.grid){var D=S.grid.subgrids[0],X=(Math.abs(D.del[1])+Math.abs(D.del[0]))/1e4;if(!(D.ll[1]-X>f.y||D.ll[0]-X>f.x||D.ll[1]+(D.lim[1]-1)*D.del[1]+X<f.y||D.ll[0]+(D.lim[0]-1)*D.del[0]+X<f.x||(c=Tn(f,a,D),isNaN(c.x))))break}else if(S.mandatory)return console.log("Unable to find mandatory grid '"+S.name+"'"),-1}return isNaN(c.x)?(console.log("Failed to find a grid shift table for location '"+-f.x*w+" "+f.y*w+" tried: '"+g+"'"),-1):(s.x=-c.x,s.y=c.y,0)}function Tn(e,a,s){var f={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return f;var c={x:e.x,y:e.y};c.x-=s.ll[0],c.y-=s.ll[1],c.x=Mt(c.x-Math.PI)+Math.PI;var v=Ir(c,s);if(a){if(isNaN(v.x))return f;v.x=c.x-v.x,v.y=c.y-v.y;var S,D,g=9;do{if(D=Ir(v,s),isNaN(D.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}v.x+=(S={x:c.x-(D.x+v.x),y:c.y-(D.y+v.y)}).x,v.y+=S.y}while(g--&&Math.abs(S.x)>1e-12&&Math.abs(S.y)>1e-12);if(g<0)return console.log("Inverse grid shift iterator failed to converge."),f;f.x=Mt(v.x+s.ll[0]),f.y=v.y+s.ll[1]}else isNaN(v.x)||(f.x=e.x+v.x,f.y=e.y+v.y);return f}function Ir(e,a){var g,s={x:e.x/a.del[0],y:e.y/a.del[1]},f_x=Math.floor(s.x),f_y=Math.floor(s.y),c_x=s.x-1*f_x,c_y=s.y-1*f_y,v={x:Number.NaN,y:Number.NaN};if(f_x<0||f_x>=a.lim[0]||f_y<0||f_y>=a.lim[1])return v;var l_x=a.cvs[g=f_y*a.lim[0]+f_x][0],l_y=a.cvs[g][1];g++;var S_x=a.cvs[g][0],S_y=a.cvs[g][1],D_x=a.cvs[g+=a.lim[0]][0],D_y=a.cvs[g][1];g--;var X_y=a.cvs[g][1],z=c_x*c_y,st=c_x*(1-c_y),ft=(1-c_x)*(1-c_y),dt=(1-c_x)*c_y;return v.x=ft*l_x+st*S_x+dt*a.cvs[g][0]+z*D_x,v.y=ft*l_y+st*S_y+dt*X_y+z*D_y,v}function Pn(e,a,s){var g,l,S,f=s.x,c=s.y,v=s.z||0,D={};for(S=0;S<3;S++)if(!a||2!==S||void 0!==s.z)switch(0===S?(g=f,l=-1!=="ew".indexOf(e.axis[S])?"x":"y"):1===S?(g=c,l=-1!=="ns".indexOf(e.axis[S])?"y":"x"):(g=v,l="z"),e.axis[S]){case"e":D[l]=g;break;case"w":D[l]=-g;break;case"n":D[l]=g;break;case"s":D[l]=-g;break;case"u":void 0!==s[l]&&(D.z=g);break;case"d":void 0!==s[l]&&(D.z=-g);break;default:return null}return D}function qe(e){var a={x:e[0],y:e[1]};return e.length>2&&(a.z=e[2]),e.length>3&&(a.m=e[3]),a}function tn(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!=e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function Nr(e,a,s,f){var c;if(Array.isArray(s)&&(s=qe(s)),function(e){tn(e.x),tn(e.y)}(s),e.datum&&a.datum&&function(e,a){return(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==a.datumCode||(1===a.datum.datum_type||2===a.datum.datum_type)&&"WGS84"!==e.datumCode}(e,a)&&(s=Nr(e,c=new Vr("WGS84"),s,f),e=c),f&&"enu"!==e.axis&&(s=Pn(e,!1,s)),"longlat"===e.projName)s={x:s.x*C,y:s.y*C,z:s.z||0};else if(e.to_meter&&(s={x:s.x*e.to_meter,y:s.y*e.to_meter,z:s.z||0}),!(s=e.inverse(s)))return;if(e.from_greenwich&&(s.x+=e.from_greenwich),s=function(e,a,s){if(function(e,a){return!(e.datum_type!==a.datum_type||e.a!==a.a||Math.abs(e.es-a.es)>5e-11)&&(1===e.datum_type?e.datum_params[0]===a.datum_params[0]&&e.datum_params[1]===a.datum_params[1]&&e.datum_params[2]===a.datum_params[2]:2!==e.datum_type||e.datum_params[0]===a.datum_params[0]&&e.datum_params[1]===a.datum_params[1]&&e.datum_params[2]===a.datum_params[2]&&e.datum_params[3]===a.datum_params[3]&&e.datum_params[4]===a.datum_params[4]&&e.datum_params[5]===a.datum_params[5]&&e.datum_params[6]===a.datum_params[6])}(e,a)||5===e.datum_type||5===a.datum_type)return s;var f=e.a,c=e.es;if(3===e.datum_type){if(0!==gi(e,!1,s))return;f=H,c=N}var g=a.a,l=a.b,S=a.es;return 3===a.datum_type&&(g=H,l=6356752.314,S=N),c!==S||f!==g||jt(e.datum_type)||jt(a.datum_type)?(s=En(s,c,f),jt(e.datum_type)&&(s=function(e,a,s){if(1===a)return{x:e.x+s[0],y:e.y+s[1],z:e.z+s[2]};if(2===a){var g=s[3],l=s[4],S=s[5],D=s[6];return{x:D*(e.x-S*e.y+l*e.z)+s[0],y:D*(S*e.x+e.y-g*e.z)+s[1],z:D*(-l*e.x+g*e.y+e.z)+s[2]}}}(s,e.datum_type,e.datum_params)),jt(a.datum_type)&&(s=function(e,a,s){if(1===a)return{x:e.x-s[0],y:e.y-s[1],z:e.z-s[2]};if(2===a){var g=s[3],l=s[4],S=s[5],D=s[6],X=(e.x-s[0])/D,z=(e.y-s[1])/D,st=(e.z-s[2])/D;return{x:X+S*z-l*st,y:-S*X+z+g*st,z:l*X-g*z+st}}}(s,a.datum_type,a.datum_params)),s=Ra(s,S,g,l),3!==a.datum_type||0===gi(a,!0,s)?s:void 0):s}(e.datum,a.datum,s))return a.from_greenwich&&(s={x:s.x-a.from_greenwich,y:s.y,z:s.z||0}),"longlat"===a.projName?s={x:s.x*w,y:s.y*w,z:s.z||0}:(s=a.forward(s),a.to_meter&&(s={x:s.x/a.to_meter,y:s.y/a.to_meter,z:s.z||0})),f&&"enu"!==a.axis?Pn(a,!0,s):s}var Dn=Vr("WGS84");function In(e,a,s,f){var c,v,g;return Array.isArray(s)?(c=Nr(e,a,s,f)||{x:NaN,y:NaN},s.length>2?void 0!==e.name&&"geocent"===e.name||void 0!==a.name&&"geocent"===a.name?"number"==typeof c.z?[c.x,c.y,c.z].concat(s.splice(3)):[c.x,c.y,s[2]].concat(s.splice(3)):[c.x,c.y].concat(s.splice(2)):[c.x,c.y]):(v=Nr(e,a,s,f),2===(g=Object.keys(s)).length||g.forEach(function(l){if(void 0!==e.name&&"geocent"===e.name||void 0!==a.name&&"geocent"===a.name){if("x"===l||"y"===l||"z"===l)return}else if("x"===l||"y"===l)return;v[l]=s[l]}),v)}function yi(e){return e instanceof Vr?e:e.oProj?e.oProj:Vr(e)}const Se=function(e,a,s){e=yi(e);var c,f=!1;return void 0===a?(a=e,e=Dn,f=!0):(void 0!==a.x||Array.isArray(a))&&(s=a,a=e,e=Dn,f=!0),a=yi(a),s?In(e,a,s):(c={forward:function(v,g){return In(e,a,v,g)},inverse:function(v,g){return In(a,e,v,g)}},f&&(c.oProj=a),c)};const Ua={forward:Nn,inverse:function(e){var a=Rn(Ln(e.toUpperCase()));return a.lat&&a.lon?[a.lon,a.lat,a.lon,a.lat]:[a.left,a.bottom,a.right,a.top]},toPoint:rn};function Nn(e,a){return a=a||5,function(e,a){var s="00000"+e.easting,f="00000"+e.northing;return e.zoneNumber+e.zoneLetter+function(e,a,s){var f=nn(s);return function(e,a,s){var f=s-1,c="AJSAJS".charCodeAt(f),v="AFAFAF".charCodeAt(f),g=c+e-1,l=v+a,S=!1;return g>90&&(g=g-90+65-1,S=!0),(73===g||c<73&&g>73||(g>73||c<73)&&S)&&g++,(79===g||c<79&&g>79||(g>79||c<79)&&S)&&73==++g&&g++,g>90&&(g=g-90+65-1),l>86?(l=l-86+65-1,S=!0):S=!1,(73===l||v<73&&l>73||(l>73||v<73)&&S)&&l++,(79===l||v<79&&l>79||(l>79||v<79)&&S)&&73==++l&&l++,l>86&&(l=l-86+65-1),String.fromCharCode(g)+String.fromCharCode(l)}(Math.floor(e/1e5),Math.floor(a/1e5)%20,f)}(e.easting,e.northing,e.zoneNumber)+s.substr(s.length-5,a)+f.substr(f.length-5,a)}(function(e){var l,S,D,X,z,lt,mt,a=e.lat,s=e.lon,f=6378137,c=.00669438,v=.9996,ft=qn(a),dt=qn(s);mt=Math.floor((s+180)/6)+1,180===s&&(mt=60),a>=56&&a<64&&s>=3&&s<12&&(mt=32),a>=72&&a<84&&(s>=0&&s<9?mt=31:s>=9&&s<21?mt=33:s>=21&&s<33?mt=35:s>=33&&s<42&&(mt=37)),lt=qn(6*(mt-1)-180+3),l=c/(1-c),S=f/Math.sqrt(1-c*Math.sin(ft)*Math.sin(ft)),D=Math.tan(ft)*Math.tan(ft),X=l*Math.cos(ft)*Math.cos(ft);var Pt=v*S*((z=Math.cos(ft)*(dt-lt))+(1-D+X)*z*z*z/6+(5-18*D+D*D+72*X-58*l)*z*z*z*z*z/120)+5e5,Ft=v*(f*(.9983242984503243*ft-.002514607064228144*Math.sin(2*ft)+2639046602129982e-21*Math.sin(4*ft)-35*c*c*c/3072*Math.sin(6*ft))+S*Math.tan(ft)*(z*z/2+(5-D+9*X+4*X*X)*z*z*z*z/24+(61-58*D+D*D+600*X-330*l)*z*z*z*z*z*z/720));return a<0&&(Ft+=1e7),{northing:Math.round(Ft),easting:Math.round(Pt),zoneNumber:mt,zoneLetter:Fa(a)}}({lat:e[1],lon:e[0]}),a)}function rn(e){var a=Rn(Ln(e.toUpperCase()));return a.lat&&a.lon?[a.lon,a.lat]:[(a.left+a.right)/2,(a.top+a.bottom)/2]}function qn(e){return e*(Math.PI/180)}function Si(e){return e/Math.PI*180}function Rn(e){var a=e.northing,s=e.easting,f=e.zoneLetter,c=e.zoneNumber;if(c<0||c>60)return null;var S,X,z,st,ft,dt,mt,Pt,Ft,v=.9996,g=6378137,l=.00669438,D=(1-Math.sqrt(1-l))/(1+Math.sqrt(1-l)),Qt=s-5e5,$t=a;f<"N"&&($t-=1e7),mt=6*(c-1)-180+3,S=l/(1-l),Ft=(Pt=$t/v/6367449.145945056)+(3*D/2-27*D*D*D/32)*Math.sin(2*Pt)+(21*D*D/16-55*D*D*D*D/32)*Math.sin(4*Pt)+151*D*D*D/96*Math.sin(6*Pt),X=g/Math.sqrt(1-l*Math.sin(Ft)*Math.sin(Ft)),z=Math.tan(Ft)*Math.tan(Ft),st=S*Math.cos(Ft)*Math.cos(Ft),ft=g*(1-l)/Math.pow(1-l*Math.sin(Ft)*Math.sin(Ft),1.5),dt=Qt/(X*v);var Jt=Ft-X*Math.tan(Ft)/ft*(dt*dt/2-(5+3*z+10*st-4*st*st-9*S)*dt*dt*dt*dt/24+(61+90*z+298*st+45*z*z-252*S-3*st*st)*dt*dt*dt*dt*dt*dt/720);Jt=Si(Jt);var we,Xt=(dt-(1+2*z+st)*dt*dt*dt/6+(5-2*st+28*z-3*st*st+8*S+24*z*z)*dt*dt*dt*dt*dt/120)/Math.cos(Ft);if(Xt=mt+Si(Xt),e.accuracy){var he=Rn({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});we={top:he.lat,right:he.lon,bottom:Jt,left:Xt}}else we={lat:Jt,lon:Xt};return we}function Fa(e){var a="Z";return 84>=e&&e>=72?a="X":72>e&&e>=64?a="W":64>e&&e>=56?a="V":56>e&&e>=48?a="U":48>e&&e>=40?a="T":40>e&&e>=32?a="S":32>e&&e>=24?a="R":24>e&&e>=16?a="Q":16>e&&e>=8?a="P":8>e&&e>=0?a="N":0>e&&e>=-8?a="M":-8>e&&e>=-16?a="L":-16>e&&e>=-24?a="K":-24>e&&e>=-32?a="J":-32>e&&e>=-40?a="H":-40>e&&e>=-48?a="G":-48>e&&e>=-56?a="F":-56>e&&e>=-64?a="E":-64>e&&e>=-72?a="D":-72>e&&e>=-80&&(a="C"),a}function nn(e){var a=e%6;return 0===a&&(a=6),a}function Ln(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var c,a=e.length,s=null,f="",v=0;!/[A-Z]/.test(c=e.charAt(v));){if(v>=2)throw"MGRSPoint bad conversion from: "+e;f+=c,v++}var g=parseInt(f,10);if(0===v||v+3>a)throw"MGRSPoint bad conversion from: "+e;var l=e.charAt(v++);if(l<="A"||"B"===l||"Y"===l||l>="Z"||"I"===l||"O"===l)throw"MGRSPoint zone letter "+l+" not handled: "+e;s=e.substring(v,v+=2);for(var S=nn(g),D=function(e,a){for(var s="AJSAJS".charCodeAt(a-1),f=1e5,c=!1;s!==e.charCodeAt(0);){if(73==++s&&s++,79===s&&s++,s>90){if(c)throw"Bad character: "+e;s=65,c=!0}f+=1e5}return f}(s.charAt(0),S),X=function(e,a){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var s="AFAFAF".charCodeAt(a-1),f=0,c=!1;s!==e.charCodeAt(0);){if(73==++s&&s++,79===s&&s++,s>86){if(c)throw"Bad character: "+e;s=65,c=!0}f+=1e5}return f}(s.charAt(1),S);X<nr(l);)X+=2e6;var z=a-v;if(z%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var lt,mt,Pt,st=z/2,ft=0,dt=0;return st>0&&(lt=1e5/Math.pow(10,st),mt=e.substring(v,v+st),ft=parseFloat(mt)*lt,Pt=e.substring(v+st),dt=parseFloat(Pt)*lt),{easting:ft+D,northing:dt+X,zoneLetter:l,zoneNumber:g,accuracy:lt}}function nr(e){var a;switch(e){case"C":a=11e5;break;case"D":a=2e6;break;case"E":a=28e5;break;case"F":a=37e5;break;case"G":a=46e5;break;case"H":a=55e5;break;case"J":a=64e5;break;case"K":a=73e5;break;case"L":a=82e5;break;case"M":a=91e5;break;case"N":a=0;break;case"P":a=8e5;break;case"Q":a=17e5;break;case"R":a=26e5;break;case"S":a=35e5;break;case"T":a=44e5;break;case"U":a=53e5;break;case"V":a=62e5;break;case"W":a=7e6;break;case"X":a=79e5;break;default:a=-1}if(a>=0)return a;throw"Invalid zone letter: "+e}function yr(e,a,s){if(!(this instanceof yr))return new yr(e,a,s);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&void 0===a){var f=e.split(",");this.x=parseFloat(f[0],10),this.y=parseFloat(f[1],10),this.z=parseFloat(f[2],10)||0}else this.x=e,this.y=a,this.z=s||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}yr.fromMGRS=function(e){return new yr(rn(e))},yr.prototype.toMGRS=function(e){return Nn([this.x,this.y],e)};const kn=yr;var Ci=.01953125,Ai=.01068115234375;function Di(e){var a=[];a[0]=1-e*(.25+e*(.046875+e*(Ci+e*Ai))),a[1]=e*(.75-e*(.046875+e*(Ci+e*Ai)));var s=e*e;return a[2]=s*(.46875-e*(.013020833333333334+.007120768229166667*e)),a[3]=(s*=e)*(.3645833333333333-.005696614583333333*e),a[4]=s*e*.3076171875,a}function sn(e,a,s,f){return f[0]*e-(s*=a)*(f[1]+(a*=a)*(f[2]+a*(f[3]+a*f[4])))}function $e(e,a,s){for(var f=1/(1-a),c=e,v=20;v;--v){var g=Math.sin(c),l=1-a*g*g;if(c-=l=(sn(c,g,Math.cos(c),s)-e)*(l*Math.sqrt(l))*f,Math.abs(l)<y)return c}return c}const Lr={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Di(this.es),this.ml0=sn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(e){var c,v,g,s=e.y,f=Mt(e.x-this.long0),l=Math.sin(s),S=Math.cos(s);if(this.es){var X=S*f,z=Math.pow(X,2),st=this.ep2*Math.pow(S,2),ft=Math.pow(st,2),dt=Math.abs(S)>y?Math.tan(s):0,lt=Math.pow(dt,2),mt=Math.pow(lt,2);c=1-this.es*Math.pow(l,2),X/=Math.sqrt(c);var Pt=sn(s,l,S,this.en);v=this.a*(this.k0*X*(1+z/6*(1-lt+st+z/20*(5-18*lt+mt+14*st-58*lt*st+z/42*(61+179*mt-mt*lt-479*lt)))))+this.x0,g=this.a*(this.k0*(Pt-this.ml0+l*f*X/2*(1+z/12*(5-lt+9*st+4*ft+z/30*(61+mt-58*lt+270*st-330*lt*st+z/56*(1385+543*mt-mt*lt-3111*lt))))))+this.y0}else{var D=S*Math.sin(f);if(Math.abs(Math.abs(D)-1)<y)return 93;if(v=.5*this.a*this.k0*Math.log((1+D)/(1-D))+this.x0,g=S*Math.cos(f)/Math.sqrt(1-Math.pow(D,2)),(D=Math.abs(g))>=1){if(D-1>y)return 93;g=0}else g=Math.acos(g);s<0&&(g=-g),g=this.a*this.k0*(g-this.lat0)+this.y0}return e.x=v,e.y=g,e},inverse:function(e){var a,s,f,c,v=1/this.a*(e.x-this.x0),g=1/this.a*(e.y-this.y0);if(this.es)if(s=$e(a=this.ml0+g/this.k0,this.es,this.en),Math.abs(s)<E){var z=Math.sin(s),st=Math.cos(s),ft=Math.abs(st)>y?Math.tan(s):0,dt=this.ep2*Math.pow(st,2),lt=Math.pow(dt,2),mt=Math.pow(ft,2),Pt=Math.pow(mt,2);a=1-this.es*Math.pow(z,2);var Ft=v*Math.sqrt(a)/this.k0,Qt=Math.pow(Ft,2);f=s-(a*=ft)*Qt/(1-this.es)*.5*(1-Qt/12*(5+3*mt-9*dt*mt+dt-4*lt-Qt/30*(61+90*mt-252*dt*mt+45*Pt+46*dt-Qt/56*(1385+3633*mt+4095*Pt+1574*Pt*mt)))),c=Mt(this.long0+Ft*(1-Qt/6*(1+2*mt+dt-Qt/20*(5+28*mt+24*Pt+8*dt*mt+6*dt-Qt/42*(61+662*mt+1320*Pt+720*Pt*mt))))/st)}else f=E*Tr(g),c=0;else{var l=Math.exp(v/this.k0),S=.5*(l-1/l),X=Math.cos(this.lat0+g/this.k0);a=Math.sqrt((1-Math.pow(X,2))/(1+Math.pow(S,2))),f=Math.asin(a),g<0&&(f=-f),c=0===S&&0===X?0:Mt(Math.atan2(S,X)+this.long0)}return e.x=c,e.y=f,e},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function on(e){var a=Math.exp(e);return(a-1/a)/2}function un(e,a){e=Math.abs(e),a=Math.abs(a);var s=Math.max(e,a),f=Math.min(e,a)/(s||1);return s*Math.sqrt(1+Math.pow(f,2))}function Fn(e,a){for(var g,s=2*Math.cos(2*a),f=e.length-1,c=e[f],v=0;--f>=0;)g=s*c-v+e[f],v=c,c=g;return a+g*Math.sin(2*a)}function se(e,a,s){for(var dt,lt,f=Math.sin(a),c=Math.cos(a),v=on(s),g=function(e){var a=Math.exp(e);return(a+1/a)/2}(s),l=2*c*g,S=-2*f*v,D=e.length-1,X=e[D],z=0,st=0,ft=0;--D>=0;)dt=st,lt=z,X=l*(st=X)-dt-S*(z=ft)+e[D],ft=S*st-lt+l*z;return[(l=f*g)*X-(S=c*v)*ft,l*ft+S*X]}const cn={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Lr.init.apply(this),this.forward=Lr.forward,this.inverse=Lr.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),a=e/(2-e),s=a;this.cgb[0]=a*(2+a*(-2/3+a*(a*(116/45+a*(26/45+a*(-2854/675)))-2))),this.cbg[0]=a*(a*(2/3+a*(4/3+a*(-82/45+a*(32/45+a*(4642/4725)))))-2),this.cgb[1]=(s*=a)*(7/3+a*(a*(-227/45+a*(2704/315+a*(2323/945)))-1.6)),this.cbg[1]=s*(5/3+a*(-16/15+a*(-13/9+a*(904/315+a*(-1522/945))))),this.cgb[2]=(s*=a)*(56/15+a*(-136/35+a*(-1262/105+a*(73814/2835)))),this.cbg[2]=s*(-26/15+a*(34/21+a*(1.6+a*(-12686/2835)))),this.cgb[3]=(s*=a)*(4279/630+a*(-332/35+a*(-399572/14175))),this.cbg[3]=s*(1237/630+a*(a*(-24832/14175)-2.4)),this.cgb[4]=(s*=a)*(4174/315+a*(-144838/6237)),this.cbg[4]=s*(-734/315+a*(109598/31185)),this.cgb[5]=(s*=a)*(601676/22275),this.cbg[5]=s*(444337/155925),s=Math.pow(a,2),this.Qn=this.k0/(1+a)*(1+s*(1/4+s*(1/64+s/256))),this.utg[0]=a*(a*(2/3+a*(-37/96+a*(1/360+a*(81/512+a*(-96199/604800)))))-.5),this.gtu[0]=a*(.5+a*(-2/3+a*(5/16+a*(41/180+a*(-127/288+a*(7891/37800)))))),this.utg[1]=s*(-1/48+a*(-1/15+a*(437/1440+a*(-46/105+a*(1118711/3870720))))),this.gtu[1]=s*(13/48+a*(a*(557/1440+a*(281/630+a*(-1983433/1935360)))-.6)),this.utg[2]=(s*=a)*(-17/480+a*(37/840+a*(209/4480+a*(-5569/90720)))),this.gtu[2]=s*(61/240+a*(-103/140+a*(15061/26880+a*(167603/181440)))),this.utg[3]=(s*=a)*(-4397/161280+a*(11/504+a*(830251/7257600))),this.gtu[3]=s*(49561/161280+a*(-179/168+a*(6601661/7257600))),this.utg[4]=(s*=a)*(-4583/161280+a*(108847/3991680)),this.gtu[4]=s*(34729/80640+a*(-3418889/1995840)),this.utg[5]=(s*=a)*(-20648693/638668800),this.gtu[5]=.6650675310896665*s;var f=Fn(this.cbg,this.lat0);this.Zb=-this.Qn*(f+function(e,a){for(var g,s=2*Math.cos(a),f=e.length-1,c=e[f],v=0;--f>=0;)g=s*c-v+e[f],v=c,c=g;return Math.sin(a)*g}(this.gtu,2*f))},forward:function(e){var a=Mt(e.x-this.long0),s=e.y;s=Fn(this.cbg,s);var f=Math.sin(s),c=Math.cos(s),v=Math.sin(a),g=Math.cos(a);s=Math.atan2(f,g*c),a=Math.atan2(v*c,un(f,c*g)),a=function(e){var a=Math.abs(e);return a=function(e){var a=1+e,s=a-1;return 0===s?e:e*Math.log(a)/s}(a*(1+a/(un(1,a)+1))),e<0?-a:a}(Math.tan(a));var S,D,l=se(this.gtu,2*s,2*a);return s+=l[0],a+=l[1],Math.abs(a)<=2.623395162778?(S=this.a*(this.Qn*a)+this.x0,D=this.a*(this.Qn*s+this.Zb)+this.y0):(S=1/0,D=1/0),e.x=S,e.y=D,e},inverse:function(e){var f,c,a=1/this.a*(e.x-this.x0),s=1/this.a*(e.y-this.y0);if(s=(s-this.Zb)/this.Qn,a/=this.Qn,Math.abs(a)<=2.623395162778){var v=se(this.utg,2*s,2*a);s+=v[0],a+=v[1],a=Math.atan(on(a));var g=Math.sin(s),l=Math.cos(s),S=Math.sin(a),D=Math.cos(a);s=Math.atan2(g*D,un(S,D*l)),f=Mt((a=Math.atan2(S,D*l))+this.long0),c=Fn(this.cgb,s)}else f=1/0,c=1/0;return e.x=f,e.y=c,e},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]},rs={init:function(){var e=function(e,a){if(void 0===e){if((e=Math.floor(30*(Mt(a)+Math.PI)/Math.PI)+1)<0)return 0;if(e>60)return 60}return e}(this.zone,this.long0);if(void 0===e)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*C,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,cn.init.apply(this),this.forward=cn.forward,this.inverse=cn.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function fn(e,a){return Math.pow((1-e)/(1+e),a)}const jn={init:function(){var e=Math.sin(this.lat0),a=Math.cos(this.lat0);a*=a,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*a*a/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+p)/(Math.pow(Math.tan(.5*this.lat0+p),this.C)*fn(this.e*e,this.ratexp))},forward:function(e){var a=e.x,s=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*s+p),this.C)*fn(this.e*Math.sin(s),this.ratexp))-E,e.x=this.C*a,e},inverse:function(e){for(var s=e.x/this.C,f=e.y,c=Math.pow(Math.tan(.5*f+p)/this.K,1/this.C),v=20;v>0&&(f=2*Math.atan(c*fn(this.e*Math.sin(e.y),-.5*this.e))-E,!(Math.abs(f-e.y)<1e-14));--v)e.y=f;return v?(e.x=s,e.y=f,e):null},names:["gauss"]},us={init:function(){jn.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(e){var a,s,f,c;return e.x=Mt(e.x-this.long0),jn.forward.apply(this,[e]),a=Math.sin(e.y),s=Math.cos(e.y),f=Math.cos(e.x),e.x=(c=this.k0*this.R2/(1+this.sinc0*a+this.cosc0*s*f))*s*Math.sin(e.x),e.y=c*(this.cosc0*a-this.sinc0*s*f),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){var a,s,f,c,v;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,v=Math.sqrt(e.x*e.x+e.y*e.y)){var g=2*Math.atan2(v,this.R2);a=Math.sin(g),s=Math.cos(g),c=Math.asin(s*this.sinc0+e.y*a*this.cosc0/v),f=Math.atan2(e.x*a,v*this.cosc0*s-e.y*this.sinc0*a)}else c=this.phic0,f=0;return e.x=f,e.y=c,jn.inverse.apply(this,[e]),e.x=Mt(e.x+this.long0),e},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},Fi={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=y&&(this.k0=.5*(1+Tr(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=y&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=y&&(this.k0=.5*this.cons*Be(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Pe(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Be(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-E,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(e){var v,g,l,S,D,X,a=e.x,s=e.y,f=Math.sin(s),c=Math.cos(s),z=Mt(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=y&&Math.abs(s+this.lat0)<=y?(e.x=NaN,e.y=NaN,e):this.sphere?(v=2*this.k0/(1+this.sinlat0*f+this.coslat0*c*Math.cos(z)),e.x=this.a*v*c*Math.sin(z)+this.x0,e.y=this.a*v*(this.coslat0*f-this.sinlat0*c*Math.cos(z))+this.y0,e):(g=2*Math.atan(this.ssfn_(s,f,this.e))-E,S=Math.cos(g),l=Math.sin(g),Math.abs(this.coslat0)<=y?(D=Pe(this.e,s*this.con,this.con*f),e.x=this.x0+(X=2*this.a*this.k0*D/this.cons)*Math.sin(a-this.long0),e.y=this.y0-this.con*X*Math.cos(a-this.long0),e):(Math.abs(this.sinlat0)<y?(v=2*this.a*this.k0/(1+S*Math.cos(z)),e.y=v*l):(v=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*l+this.cosX0*S*Math.cos(z))),e.y=v*(this.cosX0*l-this.sinX0*S*Math.cos(z))+this.y0),e.x=v*S*Math.sin(z)+this.x0,e))},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var a,s,c,v,g=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var l=2*Math.atan(g/(2*this.a*this.k0));return a=this.long0,s=this.lat0,g<=y?(e.x=a,e.y=s,e):(s=Math.asin(Math.cos(l)*this.sinlat0+e.y*Math.sin(l)*this.coslat0/g),a=Math.abs(this.coslat0)<y?Mt(this.lat0>0?this.long0+Math.atan2(e.x,-1*e.y):this.long0+Math.atan2(e.x,e.y)):Mt(this.long0+Math.atan2(e.x*Math.sin(l),g*this.coslat0*Math.cos(l)-e.y*this.sinlat0*Math.sin(l))),e.x=a,e.y=s,e)}if(Math.abs(this.coslat0)<=y){if(g<=y)return s=this.lat0,e.x=a=this.long0,e.y=s,e;e.x*=this.con,e.y*=this.con,s=this.con*pr(this.e,g*this.cons/(2*this.a*this.k0)),a=this.con*Mt(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else c=2*Math.atan(g*this.cosX0/(2*this.a*this.k0*this.ms1)),a=this.long0,g<=y?v=this.X0:(v=Math.asin(Math.cos(c)*this.sinX0+e.y*Math.sin(c)*this.cosX0/g),a=Mt(this.long0+Math.atan2(e.x*Math.sin(c),g*this.cosX0*Math.cos(c)-e.y*this.sinX0*Math.sin(c)))),s=-1*pr(this.e,Math.tan(.5*(E+v)));return e.x=a,e.y=s,e},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(e,a,s){return a*=s,Math.tan(.5*(E+e))*Math.pow((1-a)/(1+a),.5*s)}},ls={init:function(){var e=this.lat0;this.lambda0=this.long0;var a=Math.sin(e),s=this.a,c=1/this.rf,v=2*c-Math.pow(c,2),g=this.e=Math.sqrt(v);this.R=this.k0*s*Math.sqrt(1-v)/(1-v*Math.pow(a,2)),this.alpha=Math.sqrt(1+v/(1-v)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(a/this.alpha);var l=Math.log(Math.tan(Math.PI/4+this.b0/2)),S=Math.log(Math.tan(Math.PI/4+e/2)),D=Math.log((1+g*a)/(1-g*a));this.K=l-this.alpha*S+this.alpha*g/2*D},forward:function(e){var a=Math.log(Math.tan(Math.PI/4-e.y/2)),s=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),c=2*(Math.atan(Math.exp(-this.alpha*(a+s)+this.K))-Math.PI/4),v=this.alpha*(e.x-this.lambda0),g=Math.atan(Math.sin(v)/(Math.sin(this.b0)*Math.tan(c)+Math.cos(this.b0)*Math.cos(v))),l=Math.asin(Math.cos(this.b0)*Math.sin(c)-Math.sin(this.b0)*Math.cos(c)*Math.cos(v));return e.y=this.R/2*Math.log((1+Math.sin(l))/(1-Math.sin(l)))+this.y0,e.x=this.R*g+this.x0,e},inverse:function(e){for(var f=(e.x-this.x0)/this.R,c=2*(Math.atan(Math.exp((e.y-this.y0)/this.R))-Math.PI/4),v=Math.asin(Math.cos(this.b0)*Math.sin(c)+Math.sin(this.b0)*Math.cos(c)*Math.cos(f)),g=Math.atan(Math.sin(f)/(Math.cos(this.b0)*Math.cos(f)-Math.sin(this.b0)*Math.tan(c))),l=this.lambda0+g/this.alpha,S=0,D=v,X=-1e3,z=0;Math.abs(D-X)>1e-7;){if(++z>20)return;S=1/this.alpha*(Math.log(Math.tan(Math.PI/4+v/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(D))/2)),X=D,D=2*Math.atan(Math.exp(S))-Math.PI/2}return e.x=l,e.y=D,e},names:["somerc"]};var Me=1e-7;const _s={init:function(){var e,a,s,f,c,v,g,l,S,D,z,X=0,st=0,ft=0,dt=0,lt=0,mt=0,Pt=0;this.no_off=function(e){var s="object"==typeof e.PROJECTION?Object.keys(e.PROJECTION)[0]:e.PROJECTION;return"no_uoff"in e||"no_off"in e||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(s)}(this),this.no_rot="no_rot"in this;var Qt=!1;"alpha"in this&&(Qt=!0);var $t=!1;if("rectified_grid_angle"in this&&($t=!0),Qt&&(Pt=this.alpha),$t&&(X=this.rectified_grid_angle*C),Qt||$t)st=this.longc;else if(ft=this.long1,lt=this.lat1,dt=this.long2,mt=this.lat2,Math.abs(lt-mt)<=Me||(e=Math.abs(lt))<=Me||Math.abs(e-E)<=Me||Math.abs(Math.abs(this.lat0)-E)<=Me||Math.abs(Math.abs(mt)-E)<=Me)throw new Error;var Jt=1-this.es;a=Math.sqrt(Jt),Math.abs(this.lat0)>y?(l=Math.sin(this.lat0),s=Math.cos(this.lat0),e=1-this.es*l*l,this.B=s*s,this.B=Math.sqrt(1+this.es*this.B*this.B/Jt),this.A=this.B*this.k0*a/e,(c=(f=this.B*a/(s*Math.sqrt(e)))*f-1)<=0?c=0:(c=Math.sqrt(c),this.lat0<0&&(c=-c)),this.E=c+=f,this.E*=Math.pow(Pe(this.e,this.lat0,l),this.B)):(this.B=1/a,this.A=this.k0,this.E=f=c=1),Qt||$t?(Qt?(z=Math.asin(Math.sin(Pt)/f),$t||(X=Pt)):(z=X,Pt=Math.asin(f*Math.sin(z))),this.lam0=st-Math.asin(.5*(c-1/c)*Math.tan(z))/this.B):(v=Math.pow(Pe(this.e,lt,Math.sin(lt)),this.B),g=Math.pow(Pe(this.e,mt,Math.sin(mt)),this.B),c=this.E/v,S=(g-v)/(g+v),D=((D=this.E*this.E)-g*v)/(D+g*v),(e=ft-dt)<-Math.pi?dt-=m:e>Math.pi&&(dt+=m),this.lam0=Mt(.5*(ft+dt)-Math.atan(D*Math.tan(.5*this.B*(ft-dt))/S)/this.B),z=Math.atan(2*Math.sin(this.B*Mt(ft-this.lam0))/(c-1/c)),X=Pt=Math.asin(f*Math.sin(z))),this.singam=Math.sin(z),this.cosgam=Math.cos(z),this.sinrot=Math.sin(X),this.cosrot=Math.cos(X),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(f*f-1)/Math.cos(Pt))),this.lat0<0&&(this.u_0=-this.u_0)),c=.5*z,this.v_pole_n=this.ArB*Math.log(Math.tan(p-c)),this.v_pole_s=this.ArB*Math.log(Math.tan(p+c))},forward:function(e){var s,f,c,v,g,l,S,D,a={};if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-E)>y){if(s=.5*((g=this.E/Math.pow(Pe(this.e,e.y,Math.sin(e.y)),this.B))-(l=1/g)),f=.5*(g+l),v=Math.sin(this.B*e.x),c=(s*this.singam-v*this.cosgam)/f,Math.abs(Math.abs(c)-1)<y)throw new Error;D=.5*this.ArB*Math.log((1-c)/(1+c)),l=Math.cos(this.B*e.x),S=Math.abs(l)<Me?this.A*e.x:this.ArB*Math.atan2(s*this.cosgam+v*this.singam,l)}else D=e.y>0?this.v_pole_n:this.v_pole_s,S=this.ArB*e.y;return this.no_rot?(a.x=S,a.y=D):(a.x=D*this.cosrot+(S-=this.u_0)*this.sinrot,a.y=S*this.cosrot-D*this.sinrot),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a},inverse:function(e){var a,s,f,c,v,g,l,S={};if(e.x=1/this.a*(e.x-this.x0),e.y=1/this.a*(e.y-this.y0),this.no_rot?(s=e.y,a=e.x):(s=e.x*this.cosrot-e.y*this.sinrot,a=e.y*this.cosrot+e.x*this.sinrot+this.u_0),c=.5*((f=Math.exp(-this.BrA*s))-1/f),v=.5*(f+1/f),l=((g=Math.sin(this.BrA*a))*this.cosgam+c*this.singam)/v,Math.abs(Math.abs(l)-1)<y)S.x=0,S.y=l<0?-E:E;else{if(S.y=this.E/Math.sqrt((1+l)/(1-l)),S.y=pr(this.e,Math.pow(S.y,1/this.B)),S.y===1/0)throw new Error;S.x=-this.rB*Math.atan2(c*this.cosgam-g*this.singam,Math.cos(this.BrA*a))}return S.x+=this.lam0,S},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},wr={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<y)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var a=Math.sin(this.lat1),s=Math.cos(this.lat1),f=Be(this.e,a,s),c=Pe(this.e,this.lat1,a),v=Math.sin(this.lat2),g=Math.cos(this.lat2),l=Be(this.e,v,g),S=Pe(this.e,this.lat2,v),D=Pe(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>y?Math.log(f/l)/Math.log(c/S):a,isNaN(this.ns)&&(this.ns=a),this.f0=f/(this.ns*Math.pow(c,this.ns)),this.rh=this.a*this.f0*Math.pow(D,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(e){var a=e.x,s=e.y;Math.abs(2*Math.abs(s)-Math.PI)<=y&&(s=Tr(s)*(E-2*y));var c,v,f=Math.abs(Math.abs(s)-E);if(f>y)c=Pe(this.e,s,Math.sin(s)),v=this.a*this.f0*Math.pow(c,this.ns);else{if((f=s*this.ns)<=0)return null;v=0}var g=this.ns*Mt(a-this.long0);return e.x=this.k0*(v*Math.sin(g))+this.x0,e.y=this.k0*(this.rh-v*Math.cos(g))+this.y0,e},inverse:function(e){var a,s,f,c,v,g=(e.x-this.x0)/this.k0,l=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(a=Math.sqrt(g*g+l*l),s=1):(a=-Math.sqrt(g*g+l*l),s=-1);var S=0;if(0!==a&&(S=Math.atan2(s*g,s*l)),0!==a||this.ns>0){if(s=1/this.ns,f=Math.pow(a/(this.a*this.f0),s),-9999===(c=pr(this.e,f)))return null}else c=-E;return v=Mt(S/this.ns+this.long0),e.x=v,e.y=c,e},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc"]},ar={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(e){var a,s,f,c,v,g,l,D=e.y,X=Mt(e.x-this.long0);return a=Math.pow((1+this.e*Math.sin(D))/(1-this.e*Math.sin(D)),this.alfa*this.e/2),s=2*(Math.atan(this.k*Math.pow(Math.tan(D/2+this.s45),this.alfa)/a)-this.s45),f=-X*this.alfa,c=Math.asin(Math.cos(this.ad)*Math.sin(s)+Math.sin(this.ad)*Math.cos(s)*Math.cos(f)),v=Math.asin(Math.cos(s)*Math.sin(f)/Math.cos(c)),g=this.n*v,l=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(c/2+this.s45),this.n),e.y=l*Math.cos(g)/1,e.x=l*Math.sin(g)/1,this.czech||(e.y*=-1,e.x*=-1),e},inverse:function(e){var a,s,f,c,g,l,S,D=e.x;e.x=e.y,e.y=D,this.czech||(e.y*=-1,e.x*=-1),g=Math.sqrt(e.x*e.x+e.y*e.y),c=Math.atan2(e.y,e.x)/Math.sin(this.s0),f=2*(Math.atan(Math.pow(this.ro0/g,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),a=Math.asin(Math.cos(this.ad)*Math.sin(f)-Math.sin(this.ad)*Math.cos(f)*Math.cos(c)),s=Math.asin(Math.cos(f)*Math.sin(c)/Math.cos(a)),e.x=this.long0-s/this.alfa,l=a,S=0;var X=0;do{e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(a/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.e/2))-this.s45),Math.abs(l-e.y)<1e-10&&(S=1),l=e.y,X+=1}while(0===S&&X<15);return X>=15?null:e},names:["Krovak","krovak"]};function xe(e,a,s,f,c){return e*c-a*Math.sin(2*c)+s*Math.sin(4*c)-f*Math.sin(6*c)}function br(e){return 1-.25*e*(1+e/16*(3+1.25*e))}function Fr(e){return.375*e*(1+.25*e*(1+.46875*e))}function jr(e){return.05859375*e*e*(1+.75*e)}function Gr(e){return e*e*e*(35/3072)}function Sr(e,a,s){var f=a*s;return e/Math.sqrt(1-f*f)}function sr(e){return Math.abs(e)<E?e:e-Tr(e)*Math.PI}function hn(e,a,s,f,c){var v,g;v=e/a;for(var l=0;l<15;l++)if(v+=g=(e-(a*v-s*Math.sin(2*v)+f*Math.sin(4*v)-c*Math.sin(6*v)))/(a-2*s*Math.cos(2*v)+4*f*Math.cos(4*v)-6*c*Math.cos(6*v)),Math.abs(g)<=1e-10)return v;return NaN}const Es={init:function(){this.sphere||(this.e0=br(this.es),this.e1=Fr(this.es),this.e2=jr(this.es),this.e3=Gr(this.es),this.ml0=this.a*xe(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(e){var a,s,f=e.x,c=e.y;if(f=Mt(f-this.long0),this.sphere)a=this.a*Math.asin(Math.cos(c)*Math.sin(f)),s=this.a*(Math.atan2(Math.tan(c),Math.cos(f))-this.lat0);else{var v=Math.sin(c),g=Math.cos(c),l=Sr(this.a,this.e,v),S=Math.tan(c)*Math.tan(c),D=f*Math.cos(c),X=D*D,z=this.es*g*g/(1-this.es);a=l*D*(1-X*S*(1/6-(8-S+8*z)*X/120)),s=this.a*xe(this.e0,this.e1,this.e2,this.e3,c)-this.ml0+l*v/g*X*(.5+(5-S+6*z)*X/24)}return e.x=a+this.x0,e.y=s+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var f,c,a=e.x/this.a,s=e.y/this.a;if(this.sphere){var v=s+this.lat0;f=Math.asin(Math.sin(v)*Math.cos(a)),c=Math.atan2(Math.tan(a),Math.cos(v))}else{var l=hn(this.ml0/this.a+s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(l)-E)<=y)return e.x=this.long0,e.y=E,s<0&&(e.y*=-1),e;var S=Sr(this.a,this.e,Math.sin(l)),D=S*S*S/this.a/this.a*(1-this.es),X=Math.pow(Math.tan(l),2),z=a*this.a/S,st=z*z;f=l-S*Math.tan(l)/D*z*z*(.5-(1+3*X)*z*z/24),c=z*(1-st*(X/3+(1+3*X)*X*st/15))/Math.cos(l)}return e.x=Mt(c+this.long0),e.y=sr(f),e},names:["Cassini","Cassini_Soldner","cass"]};function He(e,a){var s;return e>1e-7?(1-e*e)*(a/(1-(s=e*a)*s)-.5/e*Math.log((1-s)/(1+s))):2*a}const de={init:function(){var a,e=Math.abs(this.lat0);if(this.mode=Math.abs(e-E)<y?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<y?this.EQUIT:this.OBLIQ,this.es>0)switch(this.qp=He(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(e){var a,s=[];return s[0]=.3333333333333333*e,s[0]+=.17222222222222222*(a=e*e),s[1]=.06388888888888888*a,s[0]+=.10257936507936508*(a*=e),s[1]+=.0664021164021164*a,s[2]=.016415012942191543*a,s}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),a=Math.sin(this.lat0),this.sinb1=He(this.e,a)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*a*a)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(e){var a,s,f,c,v,g,l,S,D,X,z=e.x,st=e.y;if(z=Mt(z-this.long0),this.sphere){if(v=Math.sin(st),X=Math.cos(st),f=Math.cos(z),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((s=this.mode===this.EQUIT?1+X*f:1+this.sinph0*v+this.cosph0*X*f)<=y)return null;a=(s=Math.sqrt(2/s))*X*Math.sin(z),s*=this.mode===this.EQUIT?v:this.cosph0*v-this.sinph0*X*f}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(f=-f),Math.abs(st+this.lat0)<y)return null;s=p-.5*st,a=(s=2*(this.mode===this.S_POLE?Math.cos(s):Math.sin(s)))*Math.sin(z),s*=f}}else{switch(l=0,S=0,D=0,f=Math.cos(z),c=Math.sin(z),v=Math.sin(st),g=He(this.e,v),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(l=g/this.qp,S=Math.sqrt(1-l*l)),this.mode){case this.OBLIQ:D=1+this.sinb1*l+this.cosb1*S*f;break;case this.EQUIT:D=1+S*f;break;case this.N_POLE:D=E+st,g=this.qp-g;break;case this.S_POLE:D=st-E,g=this.qp+g}if(Math.abs(D)<y)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:D=Math.sqrt(2/D),s=this.mode===this.OBLIQ?this.ymf*D*(this.cosb1*l-this.sinb1*S*f):(D=Math.sqrt(2/(1+S*f)))*l*this.ymf,a=this.xmf*D*S*c;break;case this.N_POLE:case this.S_POLE:g>=0?(a=(D=Math.sqrt(g))*c,s=f*(this.mode===this.S_POLE?D:-D)):a=s=0}}return e.x=this.a*a+this.x0,e.y=this.a*s+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var f,c,v,g,l,S,D,a=e.x/this.a,s=e.y/this.a;if(this.sphere){var z,X=0,st=0;if((c=.5*(z=Math.sqrt(a*a+s*s)))>1)return null;switch(c=2*Math.asin(c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(st=Math.sin(c),X=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(z)<=y?0:Math.asin(s*st/z),a*=st,s=X*z;break;case this.OBLIQ:c=Math.abs(z)<=y?this.lat0:Math.asin(X*this.sinph0+s*st*this.cosph0/z),a*=st*this.cosph0,s=(X-Math.sin(c)*this.sinph0)*z;break;case this.N_POLE:s=-s,c=E-c;break;case this.S_POLE:c-=E}f=0!==s||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(a,s):0}else{if(D=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(a/=this.dd,s*=this.dd,(S=Math.sqrt(a*a+s*s))<y)return e.x=this.long0,e.y=this.lat0,e;g=2*Math.asin(.5*S/this.rq),v=Math.cos(g),a*=g=Math.sin(g),this.mode===this.OBLIQ?(l=this.qp*(D=v*this.sinb1+s*g*this.cosb1/S),s=S*this.cosb1*v-s*this.sinb1*g):(l=this.qp*(D=s*g/S),s=S*v)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(s=-s),!(l=a*a+s*s))return e.x=this.long0,e.y=this.lat0,e;D=1-l/this.qp,this.mode===this.S_POLE&&(D=-D)}f=Math.atan2(a,s),c=function(e,a){var s=e+e;return e+a[0]*Math.sin(s)+a[1]*Math.sin(s+s)+a[2]*Math.sin(s+s+s)}(Math.asin(D),this.apa)}return e.x=Mt(this.long0+f),e.y=c,e},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function ce(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}const Gs={init:function(){Math.abs(this.lat1+this.lat2)<y||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Be(this.e3,this.sin_po,this.cos_po),this.qs1=He(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Be(this.e3,this.sin_po,this.cos_po),this.qs2=He(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=He(this.e3,this.sin_po),this.ns0=Math.abs(this.lat1-this.lat2)>y?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(e){var a=e.x,s=e.y;this.sin_phi=Math.sin(s),this.cos_phi=Math.cos(s);var f=He(this.e3,this.sin_phi),c=this.a*Math.sqrt(this.c-this.ns0*f)/this.ns0,v=this.ns0*Mt(a-this.long0),g=c*Math.sin(v)+this.x0,l=this.rh-c*Math.cos(v)+this.y0;return e.x=g,e.y=l,e},inverse:function(e){var a,f,c,v,g;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(a=Math.sqrt(e.x*e.x+e.y*e.y),f=1):(a=-Math.sqrt(e.x*e.x+e.y*e.y),f=-1),c=0,0!==a&&(c=Math.atan2(f*e.x,f*e.y)),f=a*this.ns0/this.a,g=this.sphere?Math.asin((this.c-f*f)/(2*this.ns0)):this.phi1z(this.e3,(this.c-f*f)/this.ns0),v=Mt(c/this.ns0+this.long0),e.x=v,e.y=g,e},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(e,a){var s,c,v,g,l=ce(.5*a);if(e<y)return l;for(var S=e*e,D=1;D<=25;D++)if(l+=g=.5*(v=1-(c=e*(s=Math.sin(l)))*c)*v/Math.cos(l)*(a/(1-S)-s/v+.5/e*Math.log((1-c)/(1+c))),Math.abs(g)<=1e-7)return l;return null}},ln={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(e){var a,s,f,c,g,l,S,X=e.y;return f=Mt(e.x-this.long0),a=Math.sin(X),s=Math.cos(X),c=Math.cos(f),(g=this.sin_p14*a+this.cos_p14*s*c)>0||Math.abs(g)<=y?(l=this.x0+1*this.a*s*Math.sin(f)/g,S=this.y0+1*this.a*(this.cos_p14*a-this.sin_p14*s*c)/g):(l=this.x0+this.infinity_dist*s*Math.sin(f),S=this.y0+this.infinity_dist*(this.cos_p14*a-this.sin_p14*s*c)),e.x=l,e.y=S,e},inverse:function(e){var a,s,f,c,v,g;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(a=Math.sqrt(e.x*e.x+e.y*e.y))?(c=Math.atan2(a,this.rc),s=Math.sin(c),g=ce((f=Math.cos(c))*this.sin_p14+e.y*s*this.cos_p14/a),v=Math.atan2(e.x*s,a*this.cos_p14*f-e.y*this.sin_p14*s),v=Mt(this.long0+v)):(g=this.phic0,v=0),e.x=v,e.y=g,e},names:["gnom"]},Zr={init:function(){this.sphere||(this.k0=Be(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(e){var f,c,s=e.y,v=Mt(e.x-this.long0);if(this.sphere)f=this.x0+this.a*v*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(s)/Math.cos(this.lat_ts);else{var g=He(this.e,Math.sin(s));f=this.x0+this.a*this.k0*v,c=this.y0+this.a*g*.5/this.k0}return e.x=f,e.y=c,e},inverse:function(e){var a,s;return e.x-=this.x0,e.y-=this.y0,this.sphere?(a=Mt(this.long0+e.x/this.a/Math.cos(this.lat_ts)),s=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(s=function(e,a){var s=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(a)-s)<1e-6)return a<0?-1*E:E;for(var c,v,g,l,f=Math.asin(.5*a),S=0;S<30;S++)if(v=Math.sin(f),g=Math.cos(f),l=e*v,f+=c=Math.pow(1-l*l,2)/(2*g)*(a/(1-e*e)-v/(1-l*l)+.5/e*Math.log((1-l)/(1+l))),Math.abs(c)<=1e-10)return f;return NaN}(this.e,2*e.y*this.k0/this.a),a=Mt(this.long0+e.x/(this.a*this.k0))),e.x=a,e.y=s,e},names:["cea"]},Ys={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(e){var s=e.y,f=Mt(e.x-this.long0),c=sr(s-this.lat0);return e.x=this.x0+this.a*f*this.rc,e.y=this.y0+this.a*c,e},inverse:function(e){var s=e.y;return e.x=Mt(this.long0+(e.x-this.x0)/(this.a*this.rc)),e.y=sr(this.lat0+(s-this.y0)/this.a),e},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Hs={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=br(this.es),this.e1=Fr(this.es),this.e2=jr(this.es),this.e3=Gr(this.es),this.ml0=this.a*xe(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var f,c,v,s=e.y,g=Mt(e.x-this.long0);if(v=g*Math.sin(s),this.sphere)Math.abs(s)<=y?(f=this.a*g,c=-1*this.a*this.lat0):(f=this.a*Math.sin(v)/Math.tan(s),c=this.a*(sr(s-this.lat0)+(1-Math.cos(v))/Math.tan(s)));else if(Math.abs(s)<=y)f=this.a*g,c=-1*this.ml0;else{var l=Sr(this.a,this.e,Math.sin(s))/Math.tan(s);f=l*Math.sin(v),c=this.a*xe(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+l*(1-Math.cos(v))}return e.x=f+this.x0,e.y=c+this.y0,e},inverse:function(e){var a,s,f,c,v,g,l,S,D;if(f=e.x-this.x0,c=e.y-this.y0,this.sphere)if(Math.abs(c+this.a*this.lat0)<=y)a=Mt(f/this.a+this.long0),s=0;else{var X;for(l=f*f/this.a/this.a+(g=this.lat0+c/this.a)*g,S=g,v=20;v;--v)if(S+=D=-1*(g*(S*(X=Math.tan(S))+1)-S-.5*(S*S+l)*X)/((S-g)/X-1),Math.abs(D)<=y){s=S;break}a=Mt(this.long0+Math.asin(f*Math.tan(S)/this.a)/Math.sin(s))}else if(Math.abs(c+this.ml0)<=y)s=0,a=Mt(this.long0+f/this.a);else{var z,st,ft,dt,lt;for(l=f*f/this.a/this.a+(g=(this.ml0+c)/this.a)*g,S=g,v=20;v;--v)if(lt=this.e*Math.sin(S),z=Math.sqrt(1-lt*lt)*Math.tan(S),st=this.a*xe(this.e0,this.e1,this.e2,this.e3,S),ft=this.e0-2*this.e1*Math.cos(2*S)+4*this.e2*Math.cos(4*S)-6*this.e3*Math.cos(6*S),S-=D=(g*(z*(dt=st/this.a)+1)-dt-.5*z*(dt*dt+l))/(this.es*Math.sin(2*S)*(dt*dt+l-2*g*dt)/(4*z)+(g-dt)*(z*ft-2/Math.sin(2*S))-ft),Math.abs(D)<=y){s=S;break}z=Math.sqrt(1-this.es*Math.pow(Math.sin(s),2))*Math.tan(s),a=Mt(this.long0+Math.asin(f*z/this.a)/Math.sin(s))}return e.x=a,e.y=s,e},names:["Polyconic","poly"]},Xn={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(e){var a,g=(e.y-this.lat0)/F*1e-5,l=e.x-this.long0,S=1,D=0;for(a=1;a<=10;a++)D+=this.A[a]*(S*=g);var lt,X=D,z=l,st=1,ft=0,mt=0,Pt=0;for(a=1;a<=6;a++)lt=ft*X+st*z,mt=mt+this.B_re[a]*(st=st*X-ft*z)-this.B_im[a]*(ft=lt),Pt=Pt+this.B_im[a]*st+this.B_re[a]*ft;return e.x=Pt*this.a+this.x0,e.y=mt*this.a+this.y0,e},inverse:function(e){var a,z,g=(e.y-this.y0)/this.a,l=(e.x-this.x0)/this.a,S=1,D=0,st=0,ft=0;for(a=1;a<=6;a++)z=D*g+S*l,st=st+this.C_re[a]*(S=S*g-D*l)-this.C_im[a]*(D=z),ft=ft+this.C_im[a]*S+this.C_re[a]*D;for(var dt=0;dt<this.iterations;dt++){var Ft,lt=st,mt=ft,Qt=g,$t=l;for(a=2;a<=6;a++)Ft=mt*st+lt*ft,Qt+=(a-1)*(this.B_re[a]*(lt=lt*st-mt*ft)-this.B_im[a]*(mt=Ft)),$t+=(a-1)*(this.B_im[a]*lt+this.B_re[a]*mt);lt=1,mt=0;var Jt=this.B_re[1],Xt=this.B_im[1];for(a=2;a<=6;a++)Ft=mt*st+lt*ft,Jt+=a*(this.B_re[a]*(lt=lt*st-mt*ft)-this.B_im[a]*(mt=Ft)),Xt+=a*(this.B_im[a]*lt+this.B_re[a]*mt);var we=Jt*Jt+Xt*Xt;st=(Qt*Jt+$t*Xt)/we,ft=($t*Jt-Qt*Xt)/we}var he=st,Ze=ft,dr=1,vr=0;for(a=1;a<=9;a++)vr+=this.D[a]*(dr*=he);var Xe=this.lat0+vr*F*1e5;return e.x=this.long0+Ze,e.y=Xe,e},names:["New_Zealand_Map_Grid","nzmg"]},no={init:function(){},forward:function(e){var s=e.y,f=Mt(e.x-this.long0),c=this.x0+this.a*f,v=this.y0+this.a*Math.log(Math.tan(Math.PI/4+s/2.5))*1.25;return e.x=c,e.y=v,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var a=Mt(this.long0+e.x/this.a),s=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=a,e.y=s,e},names:["Miller_Cylindrical","mill"]},cr={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Di(this.es)},forward:function(e){var a,s,f=e.x,c=e.y;if(f=Mt(f-this.long0),this.sphere){if(this.m)for(var v=this.n*Math.sin(c),g=20;g;--g){var l=(this.m*c+Math.sin(c)-v)/(this.m+Math.cos(c));if(c-=l,Math.abs(l)<y)break}else c=1!==this.n?Math.asin(this.n*Math.sin(c)):c;a=this.a*this.C_x*f*(this.m+Math.cos(c)),s=this.a*this.C_y*c}else{var S=Math.sin(c),D=Math.cos(c);s=this.a*sn(c,S,D,this.en),a=this.a*f*D/Math.sqrt(1-this.es*S*S)}return e.x=a,e.y=s,e},inverse:function(e){var a,f,c;return e.x-=this.x0,f=e.x/this.a,e.y-=this.y0,a=e.y/this.a,this.sphere?(a/=this.C_y,f/=this.C_x*(this.m+Math.cos(a)),this.m?a=ce((this.m*a+Math.sin(a))/this.n):1!==this.n&&(a=ce(Math.sin(a)/this.n)),f=Mt(f+this.long0),a=sr(a)):(a=$e(e.y/this.a,this.es,this.en),(c=Math.abs(a))<E?(c=Math.sin(a),f=Mt(this.long0+e.x*Math.sqrt(1-this.es*c*c)/(this.a*Math.cos(a)))):c-y<E&&(f=this.long0)),e.x=f,e.y=a,e},names:["Sinusoidal","sinu"]},vn={init:function(){},forward:function(e){for(var s=e.y,f=Mt(e.x-this.long0),c=s,v=Math.PI*Math.sin(s);;){var g=-(c+Math.sin(c)-v)/(1+Math.cos(c));if(c+=g,Math.abs(g)<y)break}c/=2,Math.PI/2-Math.abs(s)<y&&(f=0);var l=.900316316158*this.a*f*Math.cos(c)+this.x0,S=1.4142135623731*this.a*Math.sin(c)+this.y0;return e.x=l,e.y=S,e},inverse:function(e){var a,s;e.x-=this.x0,e.y-=this.y0,s=e.y/(1.4142135623731*this.a),Math.abs(s)>.999999999999&&(s=.999999999999),a=Math.asin(s);var f=Mt(this.long0+e.x/(.900316316158*this.a*Math.cos(a)));f<-Math.PI&&(f=-Math.PI),f>Math.PI&&(f=Math.PI),s=(2*a+Math.sin(2*a))/Math.PI,Math.abs(s)>1&&(s=1);var c=Math.asin(s);return e.x=f,e.y=c,e},names:["Mollweide","moll"]},fr={init:function(){Math.abs(this.lat1+this.lat2)<y||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=br(this.es),this.e1=Fr(this.es),this.e2=jr(this.es),this.e3=Gr(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Be(this.e,this.sinphi,this.cosphi),this.ml1=xe(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<y?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Be(this.e,this.sinphi,this.cosphi),this.ml2=xe(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=xe(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(e){var f,a=e.x,s=e.y;if(this.sphere)f=this.a*(this.g-s);else{var c=xe(this.e0,this.e1,this.e2,this.e3,s);f=this.a*(this.g-c)}var v=this.ns*Mt(a-this.long0),g=this.x0+f*Math.sin(v),l=this.y0+this.rh-f*Math.cos(v);return e.x=g,e.y=l,e},inverse:function(e){var a,s,f,c;e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns>=0?(s=Math.sqrt(e.x*e.x+e.y*e.y),a=1):(s=-Math.sqrt(e.x*e.x+e.y*e.y),a=-1);var v=0;return 0!==s&&(v=Math.atan2(a*e.x,a*e.y)),this.sphere?(c=Mt(this.long0+v/this.ns),f=sr(this.g-s/this.a),e.x=c,e.y=f,e):(f=hn(this.g-s/this.a,this.e0,this.e1,this.e2,this.e3),c=Mt(this.long0+v/this.ns),e.x=c,e.y=f,e)},names:["Equidistant_Conic","eqdc"]},ho={init:function(){this.R=this.a},forward:function(e){var c,v,s=e.y,f=Mt(e.x-this.long0);Math.abs(s)<=y&&(c=this.x0+this.R*f,v=this.y0);var g=ce(2*Math.abs(s/Math.PI));(Math.abs(f)<=y||Math.abs(Math.abs(s)-E)<=y)&&(c=this.x0,v=s>=0?this.y0+Math.PI*this.R*Math.tan(.5*g):this.y0+Math.PI*this.R*-Math.tan(.5*g));var l=.5*Math.abs(Math.PI/f-f/Math.PI),S=l*l,D=Math.sin(g),X=Math.cos(g),z=X/(D+X-1),ft=z*(2/D-1),dt=ft*ft,lt=Math.PI*this.R*(l*(z-dt)+Math.sqrt(S*(z-dt)*(z-dt)-(dt+S)*(z*z-dt)))/(dt+S);f<0&&(lt=-lt),c=this.x0+lt;var mt=S+z;return lt=Math.PI*this.R*(ft*mt-l*Math.sqrt((dt+S)*(S+1)-mt*mt))/(dt+S),v=s>=0?this.y0+lt:this.y0-lt,e.x=c,e.y=v,e},inverse:function(e){var a,s,f,c,v,g,l,S,D,X,z,st;return e.x-=this.x0,e.y-=this.y0,z=Math.PI*this.R,v=(f=e.x/z)*f+(c=e.y/z)*c,z=3*(c*c/(S=-2*(g=-Math.abs(c)*(1+v))+1+2*c*c+v*v)+(2*(l=g-2*c*c+f*f)*l*l/S/S/S-9*g*l/S/S)/27)/(D=(g-l*l/3/S)/S)/(X=2*Math.sqrt(-D/3)),Math.abs(z)>1&&(z=z>=0?1:-1),st=Math.acos(z)/3,s=e.y>=0?(-X*Math.cos(st+Math.PI/3)-l/3/S)*Math.PI:-(-X*Math.cos(st+Math.PI/3)-l/3/S)*Math.PI,a=Math.abs(f)<y?this.long0:Mt(this.long0+Math.PI*(v-1+Math.sqrt(1+2*(f*f-c*c)+v*v))/2/f),e.x=a,e.y=s,e},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},ii={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(e){var g,l,S,D,X,z,st,ft,dt,lt,mt,Pt,Ft,Qt,$t,Jt,Xt,we,he,Ze,dr,vr,a=e.x,s=e.y,f=Math.sin(e.y),c=Math.cos(e.y),v=Mt(a-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=y?(e.x=this.x0+this.a*(E-s)*Math.sin(v),e.y=this.y0-this.a*(E-s)*Math.cos(v),e):Math.abs(this.sin_p12+1)<=y?(e.x=this.x0+this.a*(E+s)*Math.sin(v),e.y=this.y0+this.a*(E+s)*Math.cos(v),e):(we=this.sin_p12*f+this.cos_p12*c*Math.cos(v),Xt=(Jt=Math.acos(we))?Jt/Math.sin(Jt):1,e.x=this.x0+this.a*Xt*c*Math.sin(v),e.y=this.y0+this.a*Xt*(this.cos_p12*f-this.sin_p12*c*Math.cos(v)),e):(g=br(this.es),l=Fr(this.es),S=jr(this.es),D=Gr(this.es),Math.abs(this.sin_p12-1)<=y?(X=this.a*xe(g,l,S,D,E),z=this.a*xe(g,l,S,D,s),e.x=this.x0+(X-z)*Math.sin(v),e.y=this.y0-(X-z)*Math.cos(v),e):Math.abs(this.sin_p12+1)<=y?(X=this.a*xe(g,l,S,D,E),z=this.a*xe(g,l,S,D,s),e.x=this.x0+(X+z)*Math.sin(v),e.y=this.y0+(X+z)*Math.cos(v),e):(st=f/c,ft=Sr(this.a,this.e,this.sin_p12),dt=Sr(this.a,this.e,f),lt=Math.atan((1-this.es)*st+this.es*ft*this.sin_p12/(dt*c)),he=0===(mt=Math.atan2(Math.sin(v),this.cos_p12*Math.tan(lt)-this.sin_p12*Math.cos(v)))?Math.asin(this.cos_p12*Math.sin(lt)-this.sin_p12*Math.cos(lt)):Math.abs(Math.abs(mt)-Math.PI)<=y?-Math.asin(this.cos_p12*Math.sin(lt)-this.sin_p12*Math.cos(lt)):Math.asin(Math.sin(v)*Math.cos(lt)/Math.sin(mt)),Pt=this.e*this.sin_p12/Math.sqrt(1-this.es),Ft=this.e*this.cos_p12*Math.cos(mt)/Math.sqrt(1-this.es),e.x=this.x0+(Jt=ft*he*(1-(Ze=he*he)*($t=Ft*Ft)*(1-$t)/6+(dr=Ze*he)/8*(Qt=Pt*Ft)*(1-2*$t)+(vr=dr*he)/120*($t*(4-7*$t)-3*Pt*Pt*(1-7*$t))-vr*he/48*Qt))*Math.sin(mt),e.y=this.y0+Jt*Math.cos(mt),e))},inverse:function(e){var a,s,f,c,v,g,l,S,D,X,z,st,dt,lt,mt,Pt,Ft,Qt,$t,Jt,Xt,we,he;return e.x-=this.x0,e.y-=this.y0,this.sphere?(a=Math.sqrt(e.x*e.x+e.y*e.y))>2*E*this.a?void 0:(s=a/this.a,f=Math.sin(s),c=Math.cos(s),v=this.long0,Math.abs(a)<=y?g=this.lat0:(g=ce(c*this.sin_p12+e.y*f*this.cos_p12/a),l=Math.abs(this.lat0)-E,v=Math.abs(l)<=y?Mt(this.lat0>=0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y)):Mt(this.long0+Math.atan2(e.x*f,a*this.cos_p12*c-e.y*this.sin_p12*f))),e.x=v,e.y=g,e):(S=br(this.es),D=Fr(this.es),X=jr(this.es),z=Gr(this.es),Math.abs(this.sin_p12-1)<=y?(g=hn(((st=this.a*xe(S,D,X,z,E))-(a=Math.sqrt(e.x*e.x+e.y*e.y)))/this.a,S,D,X,z),v=Mt(this.long0+Math.atan2(e.x,-1*e.y)),e.x=v,e.y=g,e):Math.abs(this.sin_p12+1)<=y?(st=this.a*xe(S,D,X,z,E),g=hn(((a=Math.sqrt(e.x*e.x+e.y*e.y))-st)/this.a,S,D,X,z),v=Mt(this.long0+Math.atan2(e.x,e.y)),e.x=v,e.y=g,e):(a=Math.sqrt(e.x*e.x+e.y*e.y),mt=Math.atan2(e.x,e.y),dt=Sr(this.a,this.e,this.sin_p12),Pt=Math.cos(mt),$t=3*this.es*(1-(Qt=-(Ft=this.e*this.cos_p12*Pt)*Ft/(1-this.es)))*this.sin_p12*this.cos_p12*Pt/(1-this.es),we=1-Qt*(Xt=(Jt=a/dt)-Qt*(1+Qt)*Math.pow(Jt,3)/6-$t*(1+3*Qt)*Math.pow(Jt,4)/24)*Xt/2-Jt*Xt*Xt*Xt/6,lt=Math.asin(this.sin_p12*Math.cos(Xt)+this.cos_p12*Math.sin(Xt)*Pt),v=Mt(this.long0+Math.asin(Math.sin(mt)*Math.sin(Xt)/Math.cos(lt))),he=Math.sin(lt),g=Math.atan2((he-this.es*we*this.sin_p12)*Math.tan(lt),he*(1-this.es)),e.x=v,e.y=g,e))},names:["Azimuthal_Equidistant","aeqd"]},Wr={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(e){var a,s,f,c,g,l,S,X=e.y;return f=Mt(e.x-this.long0),a=Math.sin(X),s=Math.cos(X),c=Math.cos(f),((g=this.sin_p14*a+this.cos_p14*s*c)>0||Math.abs(g)<=y)&&(l=1*this.a*s*Math.sin(f),S=this.y0+1*this.a*(this.cos_p14*a-this.sin_p14*s*c)),e.x=l,e.y=S,e},inverse:function(e){var a,s,f,c,v,g,l;return e.x-=this.x0,e.y-=this.y0,s=ce((a=Math.sqrt(e.x*e.x+e.y*e.y))/this.a),f=Math.sin(s),c=Math.cos(s),g=this.long0,Math.abs(a)<=y?(l=this.lat0,e.x=g,e.y=l,e):(l=ce(c*this.sin_p14+e.y*f*this.cos_p14/a),v=Math.abs(this.lat0)-E,Math.abs(v)<=y?(g=Mt(this.lat0>=0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y)),e.x=g,e.y=l,e):(g=Mt(this.long0+Math.atan2(e.x*f,a*this.cos_p14*c-e.y*this.sin_p14*f)),e.x=g,e.y=l,e))},names:["ortho"]};function Qr(e,a,s,f){var c;return e<y?(f.value=1,c=0):(c=Math.atan2(a,s),Math.abs(c)<=p?f.value=1:c>p&&c<=E+p?(f.value=2,c-=E):c>E+p||c<=-(E+p)?(f.value=3,c=c>=0?c-b:c+b):(f.value=4,c+=E)),c}function Ke(e,a){var s=e+a;return s<-b?s+=m:s>+b&&(s-=m),s}const ia={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.face=this.lat0>=E-p/2?5:this.lat0<=-(E-p/2)?6:Math.abs(this.long0)<=p?1:Math.abs(this.long0)<=E+p?this.long0>0?2:4:3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(e){var s,f,c,v,g,l,a={x:0,y:0},S={value:0};if(e.x-=this.long0,s=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(e.y)):e.y,f=e.x,5===this.face)v=E-s,f>=p&&f<=E+p?(S.value=1,c=f-E):f>E+p||f<=-(E+p)?(S.value=2,c=f>0?f-b:f+b):f>-(E+p)&&f<=-p?(S.value=3,c=f+E):(S.value=4,c=f);else if(6===this.face)v=E+s,f>=p&&f<=E+p?(S.value=1,c=-f+E):f<p&&f>=-p?(S.value=2,c=-f):f<-p&&f>=-(E+p)?(S.value=3,c=-f-E):(S.value=4,c=f>0?-f+b:-f-b);else{var D,X,z,st,ft,dt;2===this.face?f=Ke(f,+E):3===this.face?f=Ke(f,+b):4===this.face&&(f=Ke(f,-E)),st=Math.sin(s),ft=Math.cos(s),dt=Math.sin(f),D=ft*Math.cos(f),X=ft*dt,z=st,1===this.face?c=Qr(v=Math.acos(D),z,X,S):2===this.face?c=Qr(v=Math.acos(X),z,-D,S):3===this.face?c=Qr(v=Math.acos(-D),z,-X,S):4===this.face?c=Qr(v=Math.acos(-X),z,D,S):(v=c=0,S.value=1)}return l=Math.atan(12/b*(c+Math.acos(Math.sin(c)*Math.cos(p))-E)),g=Math.sqrt((1-Math.cos(v))/(Math.cos(l)*Math.cos(l))/(1-Math.cos(Math.atan(1/Math.cos(c))))),2===S.value?l+=E:3===S.value?l+=b:4===S.value&&(l+=1.5*b),a.x=g*Math.cos(l),a.y=g*Math.sin(l),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,e.x=a.x,e.y=a.y,e},inverse:function(e){var s,f,c,v,g,l,S,D,X,lt,mt,Pt,a={lam:0,phi:0},z={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,f=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),s=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?z.value=1:e.y>=0&&e.y>=Math.abs(e.x)?(z.value=2,s-=E):e.x<0&&-e.x>=Math.abs(e.y)?(z.value=3,s=s<0?s+b:s-b):(z.value=4,s+=E),X=b/12*Math.tan(s),g=Math.sin(X)/(Math.cos(X)-1/Math.sqrt(2)),l=Math.atan(g),(S=1-(c=Math.cos(s))*c*(v=Math.tan(f))*v*(1-Math.cos(Math.atan(1/Math.cos(l)))))<-1?S=-1:S>1&&(S=1),5===this.face)D=Math.acos(S),a.phi=E-D,a.lam=1===z.value?l+E:2===z.value?l<0?l+b:l-b:3===z.value?l-E:l;else if(6===this.face)D=Math.acos(S),a.phi=D-E,a.lam=1===z.value?-l+E:2===z.value?-l:3===z.value?-l-E:l<0?-l-b:-l+b;else{var st,ft,dt;X=(st=S)*st,ft=(X+=(dt=X>=1?0:Math.sqrt(1-X)*Math.sin(l))*dt)>=1?0:Math.sqrt(1-X),2===z.value?(X=ft,ft=-dt,dt=X):3===z.value?(ft=-ft,dt=-dt):4===z.value&&(X=ft,ft=dt,dt=-X),2===this.face?(X=st,st=-ft,ft=X):3===this.face?(st=-st,ft=-ft):4===this.face&&(X=st,st=ft,ft=-X),a.phi=Math.acos(-dt)-E,a.lam=Math.atan2(ft,st),2===this.face?a.lam=Ke(a.lam,-E):3===this.face?a.lam=Ke(a.lam,-b):4===this.face&&(a.lam=Ke(a.lam,+E))}return 0!==this.es&&(lt=a.phi<0?1:0,mt=Math.tan(a.phi),Pt=this.b/Math.sqrt(mt*mt+this.one_minus_f_squared),a.phi=Math.atan(Math.sqrt(this.a*this.a-Pt*Pt)/(this.one_minus_f*Pt)),lt&&(a.phi=-a.phi)),a.lam+=this.long0,e.x=a.lam,e.y=a.phi,e},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var ai=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],hr=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],zr=function(e,a){return e[0]+a*(e[1]+a*(e[2]+a*e[3]))};const bo={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(e){var a=Mt(e.x-this.long0),s=Math.abs(e.y),f=Math.floor(11.459155902616464*s);f<0?f=0:f>=18&&(f=17);var c={x:zr(ai[f],s=w*(s-.08726646259971647*f))*a,y:zr(hr[f],s)};return e.y<0&&(c.y=-c.y),c.x=c.x*this.a*.8487+this.x0,c.y=c.y*this.a*1.3523+this.y0,c},inverse:function(e){var a={x:(e.x-this.x0)/(.8487*this.a),y:Math.abs(e.y-this.y0)/(1.3523*this.a)};if(a.y>=1)a.x/=ai[18][0],a.y=e.y<0?-E:E;else{var s=Math.floor(18*a.y);for(s<0?s=0:s>=18&&(s=17);;)if(hr[s][0]>a.y)--s;else{if(!(hr[s+1][0]<=a.y))break;++s}var f=hr[s],c=5*(a.y-f[0])/(hr[s+1][0]-f[0]);c=function(e,a,s,f){for(var c=a;f;--f){var v=e(c);if(c-=v,Math.abs(v)<1e-10)break}return c}(function(v){return(zr(f,v)-a.y)/function(e,a){return e[1]+a*(2*e[2]+3*a*e[3])}(f,v)},c,0,100),a.x/=zr(ai[s],c),a.y=(5*s+c)*C,e.y<0&&(a.y=-a.y)}return a.x=Mt(a.x+this.long0),a},names:["Robinson","robin"]},Co={init:function(){this.name="geocent"},forward:function(e){return En(e,this.es,this.a)},inverse:function(e){return Ra(e,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var lr={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const si={init:function(){if(Object.keys(lr).forEach(function(s){if(void 0===this[s])this[s]=lr[s].def;else{if(lr[s].num&&isNaN(this[s]))throw new Error("Invalid parameter value, must be numeric "+s+" = "+this[s]);lr[s].num&&(this[s]=parseFloat(this[s]))}lr[s].degrees&&(this[s]=this[s]*C)}.bind(this)),Math.abs(Math.abs(this.lat0)-E)<y?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<y?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,a=this.azi;this.cg=Math.cos(a),this.sg=Math.sin(a),this.cw=Math.cos(e),this.sw=Math.sin(e)},forward:function(e){e.x-=this.long0;var c,v,g,l,a=Math.sin(e.y),s=Math.cos(e.y),f=Math.cos(e.x);switch(this.mode){case 3:v=this.sinph0*a+this.cosph0*s*f;break;case 2:v=s*f;break;case 1:v=-a;break;case 0:v=a}switch(c=(v=this.pn1/(this.p-v))*s*Math.sin(e.x),this.mode){case 3:v*=this.cosph0*a-this.sinph0*s*f;break;case 2:v*=a;break;case 0:v*=-s*f;break;case 1:v*=s*f}return c=(c*this.cg-v*this.sg)*this.cw*(l=1/((g=v*this.cg+c*this.sg)*this.sw*this.h1+this.cw)),v=g*l,e.x=c*this.a,e.y=v*this.a,e},inverse:function(e){e.x/=this.a,e.y/=this.a;var s,f,c,a={x:e.x,y:e.y};e.x=(s=this.pn1*e.x*(c=1/(this.pn1-e.y*this.sw)))*this.cg+(f=this.pn1*e.y*this.cw*c)*this.sg,e.y=f*this.cg-s*this.sg;var v=un(e.x,e.y);if(Math.abs(v)<y)a.x=0,a.y=e.y;else{var g,l;switch(l=1-v*v*this.pfact,l=(this.p-Math.sqrt(l))/(this.pn1/v+v/this.pn1),g=Math.sqrt(1-l*l),this.mode){case 3:a.y=Math.asin(g*this.sinph0+e.y*l*this.cosph0/v),e.y=(g-this.sinph0*Math.sin(a.y))*v,e.x*=l*this.cosph0;break;case 2:a.y=Math.asin(e.y*l/v),e.y=g*v,e.x*=l;break;case 0:a.y=Math.asin(g),e.y=-e.y;break;case 1:a.y=-Math.asin(g)}a.x=Math.atan2(e.x,e.y)}return e.x=a.x+this.long0,e.y=a.y,e},names:["Tilted_Perspective","tpers"]};Se.defaultDatum="WGS84",Se.Proj=Vr,Se.WGS84=new Se.Proj("WGS84"),Se.Point=kn,Se.toPoint=qe,Se.defs=_e,Se.nadgrid=function(e,a){var s=new DataView(a),f=function(e){var a=e.getInt32(8,!1);return 11!==a&&(11!==(a=e.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(s),c=function(e,a){return{nFields:e.getInt32(8,a),nSubgridFields:e.getInt32(24,a),nSubgrids:e.getInt32(40,a),shiftType:Kr(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,a),fromSemiMinorAxis:e.getFloat64(136,a),toSemiMajorAxis:e.getFloat64(152,a),toSemiMinorAxis:e.getFloat64(168,a)}}(s,f);c.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var v=function(e,a,s){for(var c=[],v=0;v<a.nSubgrids;v++){var g=Ro(e,176,s),l=On(e,176,g,s),S=Math.round(1+(g.upperLongitude-g.lowerLongitude)/g.longitudeInterval),D=Math.round(1+(g.upperLatitude-g.lowerLatitude)/g.latitudeInterval);c.push({ll:[Ve(g.lowerLongitude),Ve(g.lowerLatitude)],del:[Ve(g.longitudeInterval),Ve(g.latitudeInterval)],lim:[S,D],count:g.gridNodeCount,cvs:An(l)})}return c}(s,c,f),g={header:c,subgrids:v};return mi[e]=g,g},Se.transform=Nr,Se.mgrs=Ua,Se.version="__VERSION__",function(e){e.Proj.projections.add(Lr),e.Proj.projections.add(cn),e.Proj.projections.add(rs),e.Proj.projections.add(us),e.Proj.projections.add(Fi),e.Proj.projections.add(ls),e.Proj.projections.add(_s),e.Proj.projections.add(wr),e.Proj.projections.add(ar),e.Proj.projections.add(Es),e.Proj.projections.add(de),e.Proj.projections.add(Gs),e.Proj.projections.add(ln),e.Proj.projections.add(Zr),e.Proj.projections.add(Ys),e.Proj.projections.add(Hs),e.Proj.projections.add(Xn),e.Proj.projections.add(no),e.Proj.projections.add(cr),e.Proj.projections.add(vn),e.Proj.projections.add(fr),e.Proj.projections.add(ho),e.Proj.projections.add(ii),e.Proj.projections.add(Wr),e.Proj.projections.add(ia),e.Proj.projections.add(bo),e.Proj.projections.add(Co),e.Proj.projections.add(si)}(Se);const ma=Se},6985:pt=>{pt.exports=function(R){"use strict";var T=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function P(C,w){var p=C[0],m=C[1],b=C[2],x=C[3];m=((m+=((b=((b+=((x=((x+=((p=((p+=(m&b|~m&x)+w[0]-680876936|0)<<7|p>>>25)+m|0)&m|~p&b)+w[1]-389564586|0)<<12|x>>>20)+p|0)&p|~x&m)+w[2]+606105819|0)<<17|b>>>15)+x|0)&x|~b&p)+w[3]-1044525330|0)<<22|m>>>10)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m&b|~m&x)+w[4]-176418897|0)<<7|p>>>25)+m|0)&m|~p&b)+w[5]+1200080426|0)<<12|x>>>20)+p|0)&p|~x&m)+w[6]-1473231341|0)<<17|b>>>15)+x|0)&x|~b&p)+w[7]-45705983|0)<<22|m>>>10)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m&b|~m&x)+w[8]+1770035416|0)<<7|p>>>25)+m|0)&m|~p&b)+w[9]-1958414417|0)<<12|x>>>20)+p|0)&p|~x&m)+w[10]-42063|0)<<17|b>>>15)+x|0)&x|~b&p)+w[11]-1990404162|0)<<22|m>>>10)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m&b|~m&x)+w[12]+1804603682|0)<<7|p>>>25)+m|0)&m|~p&b)+w[13]-40341101|0)<<12|x>>>20)+p|0)&p|~x&m)+w[14]-1502002290|0)<<17|b>>>15)+x|0)&x|~b&p)+w[15]+1236535329|0)<<22|m>>>10)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m&x|b&~x)+w[1]-165796510|0)<<5|p>>>27)+m|0)&b|m&~b)+w[6]-1069501632|0)<<9|x>>>23)+p|0)&m|p&~m)+w[11]+643717713|0)<<14|b>>>18)+x|0)&p|x&~p)+w[0]-373897302|0)<<20|m>>>12)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m&x|b&~x)+w[5]-701558691|0)<<5|p>>>27)+m|0)&b|m&~b)+w[10]+38016083|0)<<9|x>>>23)+p|0)&m|p&~m)+w[15]-660478335|0)<<14|b>>>18)+x|0)&p|x&~p)+w[4]-405537848|0)<<20|m>>>12)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m&x|b&~x)+w[9]+568446438|0)<<5|p>>>27)+m|0)&b|m&~b)+w[14]-1019803690|0)<<9|x>>>23)+p|0)&m|p&~m)+w[3]-187363961|0)<<14|b>>>18)+x|0)&p|x&~p)+w[8]+1163531501|0)<<20|m>>>12)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m&x|b&~x)+w[13]-1444681467|0)<<5|p>>>27)+m|0)&b|m&~b)+w[2]-51403784|0)<<9|x>>>23)+p|0)&m|p&~m)+w[7]+1735328473|0)<<14|b>>>18)+x|0)&p|x&~p)+w[12]-1926607734|0)<<20|m>>>12)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m^b^x)+w[5]-378558|0)<<4|p>>>28)+m|0)^m^b)+w[8]-2022574463|0)<<11|x>>>21)+p|0)^p^m)+w[11]+1839030562|0)<<16|b>>>16)+x|0)^x^p)+w[14]-35309556|0)<<23|m>>>9)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m^b^x)+w[1]-1530992060|0)<<4|p>>>28)+m|0)^m^b)+w[4]+1272893353|0)<<11|x>>>21)+p|0)^p^m)+w[7]-155497632|0)<<16|b>>>16)+x|0)^x^p)+w[10]-1094730640|0)<<23|m>>>9)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m^b^x)+w[13]+681279174|0)<<4|p>>>28)+m|0)^m^b)+w[0]-358537222|0)<<11|x>>>21)+p|0)^p^m)+w[3]-722521979|0)<<16|b>>>16)+x|0)^x^p)+w[6]+76029189|0)<<23|m>>>9)+b|0,m=((m+=((b=((b+=((x=((x+=((p=((p+=(m^b^x)+w[9]-640364487|0)<<4|p>>>28)+m|0)^m^b)+w[12]-421815835|0)<<11|x>>>21)+p|0)^p^m)+w[15]+530742520|0)<<16|b>>>16)+x|0)^x^p)+w[2]-995338651|0)<<23|m>>>9)+b|0,m=((m+=((x=((x+=(m^((p=((p+=(b^(m|~x))+w[0]-198630844|0)<<6|p>>>26)+m|0)|~b))+w[7]+1126891415|0)<<10|x>>>22)+p|0)^((b=((b+=(p^(x|~m))+w[14]-1416354905|0)<<15|b>>>17)+x|0)|~p))+w[5]-57434055|0)<<21|m>>>11)+b|0,m=((m+=((x=((x+=(m^((p=((p+=(b^(m|~x))+w[12]+1700485571|0)<<6|p>>>26)+m|0)|~b))+w[3]-1894986606|0)<<10|x>>>22)+p|0)^((b=((b+=(p^(x|~m))+w[10]-1051523|0)<<15|b>>>17)+x|0)|~p))+w[1]-2054922799|0)<<21|m>>>11)+b|0,m=((m+=((x=((x+=(m^((p=((p+=(b^(m|~x))+w[8]+1873313359|0)<<6|p>>>26)+m|0)|~b))+w[15]-30611744|0)<<10|x>>>22)+p|0)^((b=((b+=(p^(x|~m))+w[6]-1560198380|0)<<15|b>>>17)+x|0)|~p))+w[13]+1309151649|0)<<21|m>>>11)+b|0,m=((m+=((x=((x+=(m^((p=((p+=(b^(m|~x))+w[4]-145523070|0)<<6|p>>>26)+m|0)|~b))+w[11]-1120210379|0)<<10|x>>>22)+p|0)^((b=((b+=(p^(x|~m))+w[2]+718787259|0)<<15|b>>>17)+x|0)|~p))+w[9]-343485551|0)<<21|m>>>11)+b|0,C[0]=p+C[0]|0,C[1]=m+C[1]|0,C[2]=b+C[2]|0,C[3]=x+C[3]|0}function k(C){var p,w=[];for(p=0;p<64;p+=4)w[p>>2]=C.charCodeAt(p)+(C.charCodeAt(p+1)<<8)+(C.charCodeAt(p+2)<<16)+(C.charCodeAt(p+3)<<24);return w}function W(C){var p,w=[];for(p=0;p<64;p+=4)w[p>>2]=C[p]+(C[p+1]<<8)+(C[p+2]<<16)+(C[p+3]<<24);return w}function U(C){var m,b,x,ht,St,G,w=C.length,p=[1732584193,-271733879,-1732584194,271733878];for(m=64;m<=w;m+=64)P(p,k(C.substring(m-64,m)));for(b=(C=C.substring(m-64)).length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;m<b;m+=1)x[m>>2]|=C.charCodeAt(m)<<(m%4<<3);if(x[m>>2]|=128<<(m%4<<3),m>55)for(P(p,x),m=0;m<16;m+=1)x[m]=0;return ht=(ht=8*w).toString(16).match(/(.*?)(.{0,8})$/),St=parseInt(ht[2],16),G=parseInt(ht[1],16)||0,x[14]=St,x[15]=G,P(p,x),p}function B(C){var p,w="";for(p=0;p<4;p+=1)w+=T[C>>8*p+4&15]+T[C>>8*p&15];return w}function N(C){var w;for(w=0;w<C.length;w+=1)C[w]=B(C[w]);return C.join("")}function F(C){return/[\u0080-\uFFFF]/.test(C)&&(C=unescape(encodeURIComponent(C))),C}function nt(C){var m,w=[],p=C.length;for(m=0;m<p-1;m+=2)w.push(parseInt(C.substr(m,2),16));return String.fromCharCode.apply(String,w)}function y(){this.reset()}return N(U("hello")),"undefined"!=typeof ArrayBuffer&&!ArrayBuffer.prototype.slice&&function(){function C(w,p){return(w=0|w||0)<0?Math.max(w+p,0):Math.min(w,p)}ArrayBuffer.prototype.slice=function(w,p){var ht,St,G,ct,m=this.byteLength,b=C(w,m),x=m;return undefined!==p&&(x=C(p,m)),b>x?new ArrayBuffer(0):(ht=x-b,St=new ArrayBuffer(ht),G=new Uint8Array(St),ct=new Uint8Array(this,b,ht),G.set(ct),St)}}(),y.prototype.append=function(C){return this.appendBinary(F(C)),this},y.prototype.appendBinary=function(C){this._buff+=C,this._length+=C.length;var p,w=this._buff.length;for(p=64;p<=w;p+=64)P(this._hash,k(this._buff.substring(p-64,p)));return this._buff=this._buff.substring(p-64),this},y.prototype.end=function(C){var m,x,w=this._buff,p=w.length,b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(m=0;m<p;m+=1)b[m>>2]|=w.charCodeAt(m)<<(m%4<<3);return this._finish(b,p),x=N(this._hash),C&&(x=nt(x)),this.reset(),x},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},y.prototype.setState=function(C){return this._buff=C.buff,this._length=C.length,this._hash=C.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(C,w){var m,b,x,p=w;if(C[p>>2]|=128<<(p%4<<3),p>55)for(P(this._hash,C),p=0;p<16;p+=1)C[p]=0;m=(m=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),b=parseInt(m[2],16),x=parseInt(m[1],16)||0,C[14]=b,C[15]=x,P(this._hash,C)},y.hash=function(C,w){return y.hashBinary(F(C),w)},y.hashBinary=function(C,w){var m=N(U(C));return w?nt(m):m},(y.ArrayBuffer=function(){this.reset()}).prototype.append=function(C){var m,w=function(C,w,p){var m=new Uint8Array(C.byteLength+w.byteLength);return m.set(new Uint8Array(C)),m.set(new Uint8Array(w),C.byteLength),p?m:m.buffer}(this._buff.buffer,C,!0),p=w.length;for(this._length+=C.byteLength,m=64;m<=p;m+=64)P(this._hash,W(w.subarray(m-64,m)));return this._buff=m-64<p?new Uint8Array(w.buffer.slice(m-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(C){var b,x,w=this._buff,p=w.length,m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;b<p;b+=1)m[b>>2]|=w[b]<<(b%4<<3);return this._finish(m,p),x=N(this._hash),C&&(x=nt(x)),this.reset(),x},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var C=y.prototype.getState.call(this);return C.buff=function(C){return String.fromCharCode.apply(null,new Uint8Array(C))}(C.buff),C},y.ArrayBuffer.prototype.setState=function(C){return C.buff=function(C,w){var x,p=C.length,m=new ArrayBuffer(p),b=new Uint8Array(m);for(x=0;x<p;x+=1)b[x]=C.charCodeAt(x);return w?b:m}(C.buff,!0),y.prototype.setState.call(this,C)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(C,w){var m=N(function(C){var m,b,x,ht,St,G,w=C.length,p=[1732584193,-271733879,-1732584194,271733878];for(m=64;m<=w;m+=64)P(p,W(C.subarray(m-64,m)));for(b=(C=m-64<w?C.subarray(m-64):new Uint8Array(0)).length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;m<b;m+=1)x[m>>2]|=C[m]<<(m%4<<3);if(x[m>>2]|=128<<(m%4<<3),m>55)for(P(p,x),m=0;m<16;m+=1)x[m]=0;return ht=(ht=8*w).toString(16).match(/(.*?)(.{0,8})$/),St=parseInt(ht[2],16),G=parseInt(ht[1],16)||0,x[14]=St,x[15]=G,P(p,x),p}(new Uint8Array(C)));return w?nt(m):m},y}()},5186:(pt,R)=>{"use strict";function I(T,J,P){var k=P[P.length-1];T===k.element&&(P.pop(),k=P[P.length-1]);var W=k.element,U=k.index;Array.isArray(W)?W.push(T):U===J.length-2?W[J.pop()]=T:J.push(T)}R.stringify=function(J){var P=[];P.push({obj:J});for(var W,U,B,N,E,K,Z,nt,y,k="";W=P.pop();)if(U=W.obj,k+=W.prefix||"",B=W.val||"")k+=B;else if("object"!=typeof U)k+=void 0===U?null:JSON.stringify(U);else if(null===U)k+="null";else if(Array.isArray(U)){for(P.push({val:"]"}),N=U.length-1;N>=0;N--)P.push({obj:U[N],prefix:0===N?"":","});P.push({val:"["})}else{for(K in E=[],U)U.hasOwnProperty(K)&&E.push(K);for(P.push({val:"}"}),N=E.length-1;N>=0;N--)nt=U[Z=E[N]],y=N>0?",":"",y+=JSON.stringify(Z)+":",P.push({obj:nt,prefix:y});P.push({val:"{"})}return k},R.parse=function(T){for(var W,U,H,B,N,F,E,K,Z,J=[],P=[],k=0;;)if("}"!==(W=T[k++])&&"]"!==W&&void 0!==W)switch(W){case" ":case"\t":case"\n":case":":case",":break;case"n":k+=3,I(null,J,P);break;case"t":k+=3,I(!0,J,P);break;case"f":k+=4,I(!1,J,P);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(U="",k--;;){if(H=T[k++],!/[\d\.\-e\+]/.test(H)){k--;break}U+=H}I(parseFloat(U),J,P);break;case'"':for(B="",N=void 0,F=0;'"'!==(E=T[k++])||"\\"===N&&F%2==1;)B+=E,"\\"===(N=E)?F++:F=0;I(JSON.parse('"'+B+'"'),J,P);break;case"[":J.push((K={element:[],index:J.length}).element),P.push(K);break;case"{":J.push((Z={element:{},index:J.length}).element),P.push(Z);break;default:throw new Error("unexpectedly reached end of input: "+W)}else{if(1===J.length)return J.pop();I(J.pop(),J,P)}}},5029:(pt,R,I)=>{"use strict";I.r(R),I.d(R,{DeparturesPageModule:()=>Gc});var T=I(7823),J=I(8583),P=I(3679),k=I(1348);function K(t,n,r,i){return new(r||(r=Promise))(function(u,d){function M($){try{L(i.next($))}catch(_){d(_)}}function A($){try{L(i.throw($))}catch(_){d(_)}}function L($){$.done?u($.value):function(u){return u instanceof r?u:new r(function(d){d(u)})}($.value).then(M,A)}L((i=i.apply(t,n||[])).next())})}var h=I(8720),Or=I(9765),_a=I(4570),ke=I.n(_a);const Ue=I(7613).v4;var mr,Oe,fi=I(6985),Ye=I.n(fi),hi=I(5186),Ma=I(9234),Ae=I.n(Ma),wa=I(9879),Ee=I.n(wa),Te=I(3105),_e=I.n(Te);function Hr(t){return"$"+t}function ba(t){return t.substring(1)}function Je(){this._store={}}function Er(t){if(this._store=new Je,t&&Array.isArray(t))for(var n=0,r=t.length;n<r;n++)this.add(t[n])}Je.prototype.get=function(t){var n=Hr(t);return this._store[n]},Je.prototype.set=function(t,n){var r=Hr(t);return this._store[r]=n,!0},Je.prototype.has=function(t){return Hr(t)in this._store},Je.prototype.delete=function(t){var n=Hr(t),r=n in this._store;return delete this._store[n],r},Je.prototype.forEach=function(t){for(var n=Object.keys(this._store),r=0,i=n.length;r<i;r++){var o=n[r];t(this._store[o],o=ba(o))}},Object.defineProperty(Je.prototype,"size",{get:function(){return Object.keys(this._store).length}}),Er.prototype.add=function(t){return this._store.set(t,!0)},Er.prototype.has=function(t){return this._store.has(t)},Er.prototype.forEach=function(t){this._store.forEach(function(n,r){t(r)})},Object.defineProperty(Er.prototype,"size",{get:function(){return this._store.size}}),function(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var t=Object.getOwnPropertyDescriptor(Map,Symbol.species);return t&&"get"in t&&Map[Symbol.species]===Map}()?(mr=Set,Oe=Map):(mr=Er,Oe=Je);var bn,Mn=Function.prototype.toString,Be=Mn.call(Object);function Mt(t){var n,r,i;if(!t||"object"!=typeof t)return t;if(Array.isArray(t)){for(n=[],r=0,i=t.length;r<i;r++)n[r]=Mt(t[r]);return n}if(t instanceof Date)return t.toISOString();if(function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}(t))return function(t){if(t instanceof ArrayBuffer)return function(t){if("function"==typeof t.slice)return t.slice(0);var n=new ArrayBuffer(t.byteLength),r=new Uint8Array(n),i=new Uint8Array(t);return r.set(i),n}(t);var n=t.size,r=t.type;return"function"==typeof t.slice?t.slice(0,n,r):t.webkitSlice(0,n,r)}(t);if(!function(t){var n=Object.getPrototypeOf(t);if(null===n)return!0;var r=n.constructor;return"function"==typeof r&&r instanceof r&&Mn.call(r)==Be}(t))return t;for(r in n={},t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Mt(t[r]);void 0!==o&&(n[r]=o)}return n}function Pe(t){var n=!1;return Ae()(function(r){if(n)throw new Error("once called more than once");n=!0,t.apply(this,r)})}function pr(t){return Ae()(function(n){n=Mt(n);var r=this,i="function"==typeof n[n.length-1]&&n.pop(),o=new Promise(function(u,d){var M;try{var A=Pe(function(L,$){L?d(L):u($)});n.push(A),(M=t.apply(r,n))&&"function"==typeof M.then&&u(M)}catch(L){d(L)}});return i&&o.then(function(u){i(null,u)},i),o})}function le(t,n){return pr(Ae()(function(r){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var i=this;return function(t,n,r){if(t.constructor.listeners("debug").length){for(var i=["api",t.name,n],o=0;o<r.length-1;o++)i.push(r[o]);t.constructor.emit("debug",i);var u=r[r.length-1];r[r.length-1]=function(d,M){var A=["api",t.name,n];A=A.concat(d?["error",d]:["success",M]),t.constructor.emit("debug",A),u(d,M)}}}(i,t,r),this.taskqueue.isReady?n.apply(this,r):new Promise(function(o,u){i.taskqueue.addTask(function(d){d?u(d):o(i[t].apply(i,r))})})}))}function Pr(t,n){for(var r={},i=0,o=n.length;i<o;i++){var u=n[i];u in t&&(r[u]=t[u])}return r}function li(t){return t}function Ta(t){return[{ok:t}]}function wn(t,n,r){var i=n.docs,o=new Oe;i.forEach(function(j){o.has(j.id)?o.get(j.id).push(j):o.set(j.id,[j])});var u=o.size,d=0,M=new Array(u);var _=[];o.forEach(function(j,V){_.push(V)});var q=0;!function Q(){if(!(q>=_.length)){var j=Math.min(q+6,_.length),V=_.slice(q,j);(function(j,V){j.forEach(function(et,rt){var Y=V+rt,ut=o.get(et),vt=Pr(ut[0],["atts_since","attachments"]);vt.open_revs=ut.map(function(yt){return yt.rev}),vt.open_revs=vt.open_revs.filter(li);var xt=li;0===vt.open_revs.length&&(delete vt.open_revs,xt=Ta),["revs","attachments","binary","ajax","latest"].forEach(function(yt){yt in n&&(vt[yt]=n[yt])}),t.get(et,vt,function(yt,At){var It;It=yt?[{error:yt}]:xt(At),function(j,V,et){M[j]={id:V,docs:et},function(){var j;++d===u&&(j=[],M.forEach(function(V){V.docs.forEach(function(et){j.push({id:V.id,docs:[et]})})}),r(null,{results:j}))}()}(Y,et,It),Q()})})})(V,q),q+=V.length}}()}try{localStorage.setItem("_pouch_check_localstorage",1),bn=!!localStorage.getItem("_pouch_check_localstorage")}catch(t){bn=!1}function Sn(){return bn}function Qe(){var t;_e().call(this),this._listeners={},t=this,Sn()&&addEventListener("storage",function(n){t.emit(n.key)})}function be(t){if("undefined"!=typeof console&&"function"==typeof console[t]){var n=Array.prototype.slice.call(arguments,1);console[t].apply(console,n)}}function Da(t){var n=0;return t||(n=2e3),function(t,n){var r=6e5;return t=parseInt(t,10)||0,(n=parseInt(n,10))!=n||n<=t?n=(t||1)<<1:n+=1,n>r&&(t=r>>1,n=r),~~((n-t)*Math.random()+t)}(t,n)}function xn(t,n){be("info","The above "+t+" is totally normal. "+n)}Ee()(Qe,_e()),Qe.prototype.addListener=function(t,n,r,i){if(!this._listeners[n]){var o=this,u=!1;this._listeners[n]=d,this.on(t,d)}function d(){if(o._listeners[n])if(u)u="waiting";else{u=!0;var M=Pr(i,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);r.changes(M).on("change",function(L){L.seq>i.since&&!i.cancelled&&(i.since=L.seq,i.onChange(L))}).on("complete",function(){"waiting"===u&&ke()(d),u=!1}).on("error",function(){u=!1})}}},Qe.prototype.removeListener=function(t,n){n in this._listeners&&(_e().prototype.removeListener.call(this,t,this._listeners[n]),delete this._listeners[n])},Qe.prototype.notifyLocalWindows=function(t){Sn()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},Qe.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var Rt="function"==typeof Object.assign?Object.assign:function(t){for(var n=Object(t),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n};function ie(t,n,r){Error.call(this,r),this.status=t,this.name=n,this.message=r,this.error=!0}Ee()(ie,Error),ie.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})},new ie(401,"unauthorized","Name or password is incorrect.");var Ia=new ie(400,"bad_request","Missing JSON list of 'docs'"),ee=new ie(404,"not_found","missing"),gr=new ie(409,"conflict","Document update conflict"),vi=new ie(400,"bad_request","_id field must contain a string"),mi=new ie(412,"missing_id","_id is required for puts"),Na=new ie(400,"bad_request","Only reserved document ids may start with underscore."),pi=(new ie(412,"precondition_failed","Database not open"),new ie(500,"unknown_error","Database encountered an unknown error")),Ve=new ie(500,"badarg","Some query argument is invalid"),qa=(new ie(400,"invalid_request","Request was invalid"),new ie(400,"query_parse_error","Some query parameter is invalid")),Kr=new ie(500,"doc_validation","Bad special document member"),Xr=new ie(400,"bad_request","Something wrong with the request"),An=new ie(400,"bad_request","Document must be a JSON object"),On=(new ie(404,"not_found","Database not found"),new ie(500,"indexed_db_went_bad","unknown")),En=(new ie(500,"web_sql_went_bad","unknown"),new ie(500,"levelDB_went_went_bad","unknown"),new ie(403,"forbidden","Forbidden by design doc validate_doc_update function"),new ie(400,"bad_request","Invalid rev format")),La=(new ie(412,"file_exists","The database could not be created, the file already exists."),new ie(412,"missing_stub","A pre-existing attachment stub wasn't found"));function jt(t,n){function r(i){for(var o=Object.getOwnPropertyNames(t),u=0,d=o.length;u<d;u++)"function"!=typeof t[o[u]]&&(this[o[u]]=t[o[u]]);void 0!==i&&(this.reason=i)}return r.prototype=ie.prototype,new r(n)}function _r(t){if("object"!=typeof t){var n=t;(t=pi).data=n}return"error"in t&&"conflict"===t.error&&(t.name="conflict",t.status=409),"name"in t||(t.name=t.error||"unknown"),"status"in t||(t.status=500),"message"in t||(t.message=t.message||t.reason),t}function Tn(t){var n={},r=t.filter&&"function"==typeof t.filter;return n.query=t.query_params,function(o){o.doc||(o.doc={});var u=r&&function(t,n,r){try{return!t(n,r)}catch(o){var i="Filter function threw: "+o.toString();return jt(Xr,i)}}(t.filter,o.doc,n);if("object"==typeof u)return u;if(u)return!1;if(t.include_docs){if(!t.attachments)for(var d in o.doc._attachments)o.doc._attachments.hasOwnProperty(d)&&(o.doc._attachments[d].stub=!0)}else delete o.doc;return!0}}function Ir(t){for(var n=[],r=0,i=t.length;r<i;r++)n=n.concat(t[r]);return n}function Pn(t){var n;if(t?"string"!=typeof t?n=jt(vi):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(n=jt(Na)):n=jt(mi),n)throw n}function qe(t){return"boolean"==typeof t._remote?t._remote:"function"==typeof t.type&&(be("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===t.type())}function tn(t){if(!t)return null;var n=t.split("/");return 2===n.length?n:1===n.length?[t,t]:null}function _i(t){var n=tn(t);return n?n.join("/"):null}new ie(413,"invalid_url","Provided URL is invalid");var Nr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Dn="queryKey",In=/(?:^|&)([^&=]*)=?([^&]*)/g,yi=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function Mi(t){for(var n=yi.exec(t),r={},i=14;i--;){var o=Nr[i],u=n[i]||"",d=-1!==["user","password"].indexOf(o);r[o]=d?decodeURIComponent(u):u}return r[Dn]={},r[Nr[12]].replace(In,function(M,A,L){A&&(r[Dn][A]=L)}),r}function Se(t,n){var r=[],i=[];for(var o in n)n.hasOwnProperty(o)&&(r.push(o),i.push(n[o]));return r.push(t),Function.apply(null,r).apply(null,i)}function qr(t,n,r){return new Promise(function(i,o){t.get(n,function(u,d){if(u){if(404!==u.status)return o(u);d={}}var M=d._rev,A=r(d);if(!A)return i({updated:!1,rev:M});A._id=n,A._rev=M,i(function(t,n,r){return t.put(n).then(function(i){return{updated:!0,rev:i.rev}},function(i){if(409!==i.status)throw i;return qr(t,n._id,r)})}(t,A,r))})})}var en=function(t){return atob(t)},Fe=function(t){return btoa(t)};function ye(t,n){t=t||[],n=n||{};try{return new Blob(t,n)}catch(u){if("TypeError"!==u.name)throw u;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),o=0;o<t.length;o+=1)i.append(t[o]);return i.getBlob(n.type)}}function De(t){for(var n=t.length,r=new ArrayBuffer(n),i=new Uint8Array(r),o=0;o<n;o++)i[o]=t.charCodeAt(o);return r}function tr(t,n){return ye([De(t)],{type:n})}function er(t,n){return tr(en(t),n)}function Nn(t,n){var r=new FileReader,i="function"==typeof r.readAsBinaryString;r.onloadend=function(o){var u=o.target.result||"";if(i)return n(u);n(function(t){for(var n="",r=new Uint8Array(t),i=r.byteLength,o=0;o<i;o++)n+=String.fromCharCode(r[o]);return n}(u))},i?r.readAsBinaryString(t):r.readAsArrayBuffer(t)}function bi(t,n){Nn(t,function(r){n(r)})}function rn(t,n){bi(t,function(r){n(Fe(r))})}var Si=self.setImmediate||self.setTimeout;function ja(t,n,r,i,o){(r>0||i<n.size)&&(n=function(t,n,r){return t.webkitSlice?t.webkitSlice(n,r):t.slice(n,r)}(n,r,i)),function(t,n){var r=new FileReader;r.onloadend=function(i){var o=i.target.result||new ArrayBuffer(0);n(o)},r.readAsArrayBuffer(t)}(n,function(u){t.append(u),o()})}function Ga(t,n,r,i,o){(r>0||i<n.length)&&(n=n.substring(r,i)),t.appendBinary(n),o()}function nn(t,n){var r="string"==typeof t,i=r?t.length:t.size,o=Math.min(32768,i),u=Math.ceil(i/o),d=0,M=r?new(Ye()):new(Ye().ArrayBuffer),A=r?Ga:ja;function L(){Si(_)}function $(){var Q=function(t){return Fe(t)}(M.end(!0));n(Q),M.destroy()}function _(){var q=d*o;d++,A(M,t,q,q+o,d<u?L:$)}_()}function xi(t){return Ye().hash(t)}function Ln(t,n){var r=Mt(t);return n?(delete r._rev_tree,xi(JSON.stringify(r))):Ue().replace(/-/g,"").toLowerCase()}var an=Ue;function rr(t){for(var n,r,i,u,o=t.rev_tree.slice();u=o.pop();){var d=u.ids,M=d[2],A=u.pos;if(M.length)for(var L=0,$=M.length;L<$;L++)o.push({pos:A+1,ids:M[L]});else{var _=!!d[1].deleted,q=d[0];(!n||(i!==_?i:r!==A?r<A:n<q))&&(n=q,r=A,i=_)}}return r+"-"+n}function nr(t,n){for(var i,r=t.slice();i=r.pop();)for(var o=i.pos,u=i.ids,d=u[2],M=n(0===d.length,o,u[0],i.ctx,u[1]),A=0,L=d.length;A<L;A++)r.push({pos:o+1,ids:d[A],ctx:M})}function yr(t,n){return t.pos-n.pos}function kn(t){var n=[];nr(t,function(o,u,d,M,A){o&&n.push({rev:u+"-"+d,pos:u,opts:A})}),n.sort(yr).reverse();for(var r=0,i=n.length;r<i;r++)delete n[r].pos;return n}function Un(t){for(var n=rr(t),r=kn(t.rev_tree),i=[],o=0,u=r.length;o<u;o++){var d=r[o];d.rev!==n&&!d.opts.deleted&&i.push(d.rev)}return i}function Bn(t){for(var i,n=[],r=t.slice();i=r.pop();){var o=i.pos,u=i.ids,d=u[0],M=u[1],A=u[2],L=0===A.length,$=i.history?i.history.slice():[];$.push({id:d,opts:M}),L&&n.push({pos:o+1-$.length,ids:$});for(var _=0,q=A.length;_<q;_++)r.push({pos:o+1,ids:A[_],history:$})}return n.reverse()}function Ci(t,n){return t.pos-n.pos}function Wa(t,n,r){var i=function(t,n,r){for(var u,i=0,o=t.length;i<o;)r(t[u=i+o>>>1],n)<0?i=u+1:o=u;return i}(t,n,r);t.splice(i,0,n)}function Oi(t,n){for(var r,i,o=n,u=t.length;o<u;o++){var d=t[o],M=[d.id,d.opts,[]];i?(i[2].push(M),i=M):r=i=M}return r}function Qa(t,n){return t[0]<n[0]?-1:1}function Ei(t,n){for(var r=[{tree1:t,tree2:n}],i=!1;r.length>0;){var o=r.pop(),u=o.tree1,d=o.tree2;(u[1].status||d[1].status)&&(u[1].status="available"===u[1].status||"available"===d[1].status?"available":"missing");for(var M=0;M<d[2].length;M++)if(u[2][0]){for(var A=!1,L=0;L<u[2].length;L++)u[2][L][0]===d[2][M][0]&&(r.push({tree1:u[2][L],tree2:d[2][M]}),A=!0);A||(i="new_branch",Wa(u[2],d[2][M],Qa))}else i="new_leaf",u[2][0]=d[2][M]}return{conflicts:i,tree:t}}function Ti(t,n,r){var d,i=[],o=!1,u=!1;if(!t.length)return{tree:[n],conflicts:"new_leaf"};for(var M=0,A=t.length;M<A;M++){var L=t[M];if(L.pos===n.pos&&L.ids[0]===n.ids[0])d=Ei(L.ids,n.ids),i.push({pos:L.pos,ids:d.tree}),o=o||d.conflicts,u=!0;else if(!0!==r){var $=L.pos<n.pos?L:n,_=L.pos<n.pos?n:L,Q=[],O=[];for(O.push({ids:$.ids,diff:_.pos-$.pos,parent:null,parentIdx:null});O.length>0;){var j=O.pop();if(0!==j.diff)for(var V=j.ids[2],et=0,rt=V.length;et<rt;et++)O.push({ids:V[et],diff:j.diff-1,parent:j.ids,parentIdx:et});else j.ids[0]===_.ids[0]&&Q.push(j)}var Y=Q[0];Y?(d=Ei(Y.ids,_.ids),Y.parent[2][Y.parentIdx]=d.tree,i.push({pos:$.pos,ids:$.ids}),o=o||d.conflicts,u=!0):i.push(L)}else i.push(L)}return u||i.push(n),i.sort(Ci),{tree:i,conflicts:o||"internal_node"}}function Pi(t,n,r){var i=Ti(t,n),o=function(t,n){for(var i,o,r=Bn(t),u=0,d=r.length;u<d;u++){var L,M=r[u],A=M.ids;if(A.length>n){i||(i={});var $=A.length-n;L={pos:M.pos+$,ids:Oi(A,$)};for(var _=0;_<$;_++)i[M.pos+_+"-"+A[_].id]=!0}else L={pos:M.pos,ids:Oi(A,0)};o=o?Ti(o,L,!0).tree:[L]}return i&&nr(o,function(Q,O,j){delete i[O+"-"+j]}),{tree:o,revs:i?Object.keys(i):[]}}(i.tree,r);return{tree:o.tree,stemmedRevs:o.revs,conflicts:i.conflicts}}function sn(t){return t.ids}function ze(t,n){n||(n=rr(t));for(var o,r=n.substring(n.indexOf("-")+1),i=t.rev_tree.map(sn);o=i.pop();){if(o[0]===r)return!!o[1].deleted;i=i.concat(o[2])}}function $e(t){return/^_local/.test(t)}function Rr(t,n,r){_e().call(this);var i=this;this.db=t;var o=(n=n?Mt(n):{}).complete=Pe(function(M,A){M?function(t,n){return"listenerCount"in t?t.listenerCount(n):_e().listenerCount(t,n)}(i,"error")>0&&i.emit("error",M):i.emit("complete",A),i.removeAllListeners(),t.removeListener("destroyed",u)});function u(){i.cancel()}r&&(i.on("complete",function(M){r(null,M)}),i.on("error",r)),t.once("destroyed",u),n.onChange=function(M,A,L){i.isCancelled||function(t,n,r,i){try{t.emit("change",n,r,i)}catch(o){be("error",'Error in .on("change", function):',o)}}(i,M,A,L)};var d=new Promise(function(M,A){n.complete=function(L,$){L?A(L):M($)}});i.once("cancel",function(){t.removeListener("destroyed",u),n.complete(null,{status:"cancelled"})}),this.then=d.then.bind(d),this.catch=d.catch.bind(d),this.then(function(M){o(null,M)},o),t.taskqueue.isReady?i.validateChanges(n):t.taskqueue.addTask(function(M){M?n.complete(M):i.isCancelled?i.emit("cancel"):i.validateChanges(n)})}function $a(t,n,r){var i=[{rev:t._rev}];"all_docs"===r.style&&(i=kn(n.rev_tree).map(function(u){return{rev:u.rev}}));var o={id:n.id,changes:i,doc:t};return ze(n,t._rev)&&(o.deleted=!0),r.conflicts&&(o.doc._conflicts=Un(n),o.doc._conflicts.length||delete o.doc._conflicts),o}function Lr(t,n){return t<n?-1:t>n?1:0}function on(t,n){return function(r,i){r||i[0]&&i[0].error?((r=r||i[0]).docId=n,t(r)):t(null,i.length?i[0]:i)}}function Ha(t,n){var r=Lr(t._id,n._id);return 0!==r?r:Lr(t._revisions?t._revisions.start:0,n._revisions?n._revisions.start:0)}function Ii(t){var n=t._compactionQueue[0],r=n.opts,i=n.callback;t.get("_local/compaction").catch(function(){return!1}).then(function(o){o&&o.last_seq&&(r.last_seq=o.last_seq),t._compact(r,function(u,d){u?i(u):i(null,d),ke()(function(){t._compactionQueue.shift(),t._compactionQueue.length&&Ii(t)})})})}function se(){for(var t in _e().call(this),se.prototype)"function"==typeof this[t]&&(this[t]=this[t].bind(this))}function kr(){this.isReady=!1,this.failed=!1,this.queue=[]}function Gt(t,n){if(!(this instanceof Gt))return new Gt(t,n);var r=this;if(n=n||{},t&&"object"==typeof t&&(t=(n=t).name,delete n.name),void 0===n.deterministic_revs&&(n.deterministic_revs=!0),this.__opts=n=Mt(n),r.auto_compaction=n.auto_compaction,r.prefix=Gt.prefix,"string"!=typeof t)throw new Error("Missing/invalid DB name");var o=function(t,n){var r=t.match(/([a-z-]*):\/\/(.*)/);if(r)return{name:/https?/.test(r[1])?r[1]+"://"+r[2]:r[2],adapter:r[1]};var i=Gt.adapters,o=Gt.preferredAdapters,u=Gt.prefix,d=n.adapter;if(!d)for(var M=0;M<o.length&&"idb"===(d=o[M])&&"websql"in i&&Sn()&&localStorage["_pouch__websqldb_"+u+t];++M)be("log",'PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var A=i[d];return{name:A&&"use_prefix"in A&&!A.use_prefix?t:u+t,adapter:d}}((n.prefix||"")+t,n);if(n.name=o.name,n.adapter=n.adapter||o.adapter,r.name=t,r._adapter=n.adapter,Gt.emit("debug",["adapter","Picked adapter: ",n.adapter]),!Gt.adapters[n.adapter]||!Gt.adapters[n.adapter].valid())throw new Error("Invalid Adapter: "+n.adapter);se.call(r),r.taskqueue=new kr,r.adapter=n.adapter,Gt.adapters[n.adapter].call(r,n,function(u){if(u)return r.taskqueue.fail(u);(function(t){function n(i){t.removeListener("closed",r),i||t.constructor.emit("destroyed",t.name)}function r(){t.removeListener("destroyed",n),t.constructor.emit("unref",t)}t.once("destroyed",n),t.once("closed",r),t.constructor.emit("ref",t)})(r),r.emit("created",r),Gt.emit("created",r.name),r.taskqueue.ready(r)})}Ee()(Rr,_e()),Rr.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Rr.prototype.validateChanges=function(t){var n=t.complete,r=this;Gt._changesFilterPlugin?Gt._changesFilterPlugin.validate(t,function(i){if(i)return n(i);r.doChanges(t)}):r.doChanges(t)},Rr.prototype.doChanges=function(t){var n=this,r=t.complete;if("live"in(t=Mt(t))&&!("continuous"in t)&&(t.continuous=t.live),t.processChange=$a,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"!==t.since){if(Gt._changesFilterPlugin){if(Gt._changesFilterPlugin.normalize(t),Gt._changesFilterPlugin.shouldFilter(this,t))return Gt._changesFilterPlugin.filter(this,t)}else["doc_ids","filter","selector","view"].forEach(function(u){u in t&&be("warn",'The "'+u+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=r;var i=this.db._changes(t);if(i&&"function"==typeof i.cancel){var o=n.cancel;n.cancel=Ae()(function(u){i.cancel(),o.apply(this,u)})}}else this.db.info().then(function(u){n.isCancelled?r(null,{status:"cancelled"}):(t.since=u.update_seq,n.doChanges(t))},r)},Ee()(se,_e()),se.prototype.post=le("post",function(t,n,r){if("function"==typeof n&&(r=n,n={}),"object"!=typeof t||Array.isArray(t))return r(jt(An));this.bulkDocs({docs:[t]},n,on(r,t._id))}),se.prototype.put=le("put",function(t,n,r){if("function"==typeof n&&(r=n,n={}),"object"!=typeof t||Array.isArray(t))return r(jt(An));if(Pn(t._id),$e(t._id)&&"function"==typeof this._putLocal)return t._deleted?this._removeLocal(t,r):this._putLocal(t,r);var d,M,L,$,i=this;function u(d){"function"==typeof i._put&&!1!==n.new_edits?i._put(t,n,d):i.bulkDocs({docs:[t]},n,on(d,t._id))}n.force&&t._rev?(M=(d=t._rev.split("-"))[1],L=parseInt(d[0],10)+1,$=Ln(),t._revisions={start:L,ids:[$,M]},t._rev=L+"-"+$,n.new_edits=!1,u(function(d){r(d,d?null:{ok:!0,id:t._id,rev:t._rev})})):u(r)}),se.prototype.putAttachment=le("putAttachment",function(t,n,r,i,o){var u=this;function d(M){var A="_rev"in M?parseInt(M._rev,10):0;return M._attachments=M._attachments||{},M._attachments[n]={content_type:o,data:i,revpos:++A},u.put(M)}return"function"==typeof o&&(o=i,i=r,r=null),void 0===o&&(o=i,i=r,r=null),o||be("warn","Attachment",n,"on document",t,"is missing content_type"),u.get(t).then(function(M){if(M._rev!==r)throw jt(gr);return d(M)},function(M){if(M.reason===ee.message)return d({_id:t});throw M})}),se.prototype.removeAttachment=le("removeAttachment",function(t,n,r,i){var o=this;o.get(t,function(u,d){if(u)i(u);else{if(d._rev===r)return d._attachments?(delete d._attachments[n],0===Object.keys(d._attachments).length&&delete d._attachments,void o.put(d,i)):i();i(jt(gr))}})}),se.prototype.remove=le("remove",function(t,n,r,i){var o;"string"==typeof n?(o={_id:t,_rev:n},"function"==typeof r&&(i=r,r={})):(o=t,"function"==typeof n?(i=n,r={}):(i=r,r=n)),(r=r||{}).was_delete=!0;var u={_id:o._id,_rev:o._rev||r.rev,_deleted:!0};if($e(u._id)&&"function"==typeof this._removeLocal)return this._removeLocal(o,i);this.bulkDocs({docs:[u]},r,on(i,u._id))}),se.prototype.revsDiff=le("revsDiff",function(t,n,r){"function"==typeof n&&(r=n,n={});var i=Object.keys(t);if(!i.length)return r(null,{});var o=0,u=new Oe;function d(A,L){u.has(A)||u.set(A,{missing:[]}),u.get(A).missing.push(L)}i.map(function(A){this._getRevisionTree(A,function(L,$){if(L&&404===L.status&&"missing"===L.message)u.set(A,{missing:t[A]});else{if(L)return r(L);!function(A,L){var $=t[A].slice(0);nr(L,function(_,q,Q,O,j){var V=q+"-"+Q,et=$.indexOf(V);-1!==et&&($.splice(et,1),"available"!==j.status&&d(A,V))}),$.forEach(function(_){d(A,_)})}(A,$)}if(++o===i.length){var _={};return u.forEach(function(q,Q){_[Q]=q}),r(null,_)}})},this)}),se.prototype.bulkGet=le("bulkGet",function(t,n){wn(this,t,n)}),se.prototype.compactDocument=le("compactDocument",function(t,n,r){var i=this;this._getRevisionTree(t,function(o,u){if(o)return r(o);var d=function(t){var n={},r=[];return nr(t,function(i,o,u,d){var M=o+"-"+u;return i&&(n[M]=0),void 0!==d&&r.push({from:d,to:M}),M}),r.reverse(),r.forEach(function(i){n[i.from]=void 0===n[i.from]?1+n[i.to]:Math.min(n[i.from],1+n[i.to])}),n}(u),M=[],A=[];Object.keys(d).forEach(function(L){d[L]>n&&M.push(L)}),nr(u,function(L,$,_,q,Q){var O=$+"-"+_;"available"===Q.status&&-1!==M.indexOf(O)&&A.push(O)}),i._doCompaction(t,A,r)})}),se.prototype.compact=le("compact",function(t,n){"function"==typeof t&&(n=t,t={});var r=this;t=t||{},r._compactionQueue=r._compactionQueue||[],r._compactionQueue.push({opts:t,callback:n}),1===r._compactionQueue.length&&Ii(r)}),se.prototype._compact=function(t,n){var r=this,o=[];r.changes({return_docs:!1,last_seq:t.last_seq||0}).on("change",function(M){o.push(r.compactDocument(M.id,0))}).on("complete",function(M){var A=M.last_seq;Promise.all(o).then(function(){return qr(r,"_local/compaction",function($){return(!$.last_seq||$.last_seq<A)&&($.last_seq=A,$)})}).then(function(){n(null,{ok:!0})}).catch(n)}).on("error",n)},se.prototype.get=le("get",function(t,n,r){if("function"==typeof n&&(r=n,n={}),"string"!=typeof t)return r(jt(vi));if($e(t)&&"function"==typeof this._getLocal)return this._getLocal(t,r);var i=[],o=this;function u(){var A=[],L=i.length;if(!L)return r(null,A);i.forEach(function($){o.get(t,{rev:$,revs:n.revs,latest:n.latest,attachments:n.attachments,binary:n.binary},function(_,q){if(_)A.push({missing:$});else{for(var Q,O=0,j=A.length;O<j;O++)if(A[O].ok&&A[O].ok._rev===q._rev){Q=!0;break}Q||A.push({ok:q})}--L||r(null,A)})})}if(!n.open_revs)return this._get(t,n,function(A,L){if(A)return A.docId=t,r(A);var $=L.doc,_=L.metadata,q=L.ctx;if(n.conflicts){var Q=Un(_);Q.length&&($._conflicts=Q)}if(ze(_,$._rev)&&($._deleted=!0),n.revs||n.revs_info){for(var O=$._rev.split("-"),j=parseInt(O[0],10),V=O[1],et=Bn(_.rev_tree),rt=null,Y=0;Y<et.length;Y++){var ut=et[Y],vt=ut.ids.map(function(Zt){return Zt.id}).indexOf(V);(vt===j-1||!rt&&-1!==vt)&&(rt=ut)}if(!rt)return(A=new Error("invalid rev tree")).docId=t,r(A);var yt=rt.ids.map(function(Zt){return Zt.id}).indexOf($._rev.split("-")[1])+1;if(rt.ids.splice(yt,rt.ids.length-yt),rt.ids.reverse(),n.revs&&($._revisions={start:rt.pos+rt.ids.length-1,ids:rt.ids.map(function(Zt){return Zt.id})}),n.revs_info){var It=rt.pos+rt.ids.length;$._revs_info=rt.ids.map(function(Zt){return{rev:--It+"-"+Zt.id,status:Zt.opts.status}})}}if(n.attachments&&$._attachments){var Ct=$._attachments,Ut=Object.keys(Ct).length;if(0===Ut)return r(null,$);Object.keys(Ct).forEach(function(Zt){this._getAttachment($._id,Zt,Ct[Zt],{rev:$._rev,binary:n.binary,ctx:q},function(Bt,qt){var Yt=$._attachments[Zt];Yt.data=qt,delete Yt.stub,delete Yt.length,--Ut||r(null,$)})},o)}else{if($._attachments)for(var Wt in $._attachments)$._attachments.hasOwnProperty(Wt)&&($._attachments[Wt].stub=!0);r(null,$)}});if("all"===n.open_revs)this._getRevisionTree(t,function(A,L){if(A)return r(A);i=kn(L).map(function($){return $.rev}),u()});else{if(!Array.isArray(n.open_revs))return r(jt(pi,"function_clause"));i=n.open_revs;for(var d=0;d<i.length;d++){var M=i[d];if("string"!=typeof M||!/^\d+-/.test(M))return r(jt(En))}u()}}),se.prototype.getAttachment=le("getAttachment",function(t,n,r,i){var o=this;r instanceof Function&&(i=r,r={}),this._get(t,r,function(u,d){return u?i(u):d.doc._attachments&&d.doc._attachments[n]?(r.ctx=d.ctx,r.binary=!0,void o._getAttachment(t,n,d.doc._attachments[n],r,i)):i(jt(ee))})}),se.prototype.allDocs=le("allDocs",function(t,n){if("function"==typeof t&&(n=t,t={}),t.skip=void 0!==t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys"in t){if(!Array.isArray(t.keys))return n(new TypeError("options.keys must be an array"));var r=["startkey","endkey","key"].filter(function(i){return i in t})[0];if(r)return void n(jt(qa,"Query parameter `"+r+"` is not compatible with multi-get"));if(!qe(this)&&(function(t){var n="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;t.keys=n,t.skip=0,delete t.limit,t.descending&&(n.reverse(),t.descending=!1)}(t),0===t.keys.length))return this._allDocs({limit:0},n)}return this._allDocs(t,n)}),se.prototype.changes=function(t,n){return"function"==typeof t&&(n=t,t={}),(t=t||{}).return_docs="return_docs"in t?t.return_docs:!t.live,new Rr(this,t,n)},se.prototype.close=le("close",function(t){return this._closed=!0,this.emit("closed"),this._close(t)}),se.prototype.info=le("info",function(t){var n=this;this._info(function(r,i){if(r)return t(r);i.db_name=i.db_name||n.name,i.auto_compaction=!(!n.auto_compaction||qe(n)),i.adapter=n.adapter,t(null,i)})}),se.prototype.id=le("id",function(t){return this._id(t)}),se.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},se.prototype.bulkDocs=le("bulkDocs",function(t,n,r){if("function"==typeof n&&(r=n,n={}),n=n||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs))return r(jt(Ia));for(var i=0;i<t.docs.length;++i)if("object"!=typeof t.docs[i]||Array.isArray(t.docs[i]))return r(jt(An));var o;if(t.docs.forEach(function(M){M._attachments&&Object.keys(M._attachments).forEach(function(A){o=o||function(t){return"_"===t.charAt(0)&&t+" is not a valid attachment name, attachment names cannot start with '_'"}(A),M._attachments[A].content_type||be("warn","Attachment",A,"on document",M._id,"is missing content_type")})}),o)return r(jt(Xr,o));"new_edits"in n||(n.new_edits=!("new_edits"in t)||t.new_edits);var u=this;!n.new_edits&&!qe(u)&&t.docs.sort(Ha),function(t){for(var n=0;n<t.length;n++){var r=t[n];if(r._deleted)delete r._attachments;else if(r._attachments)for(var i=Object.keys(r._attachments),o=0;o<i.length;o++){var u=i[o];r._attachments[u]=Pr(r._attachments[u],["data","digest","content_type","length","revpos","stub"])}}}(t.docs);var d=t.docs.map(function(M){return M._id});return this._bulkDocs(t,n,function(M,A){if(M)return r(M);if(n.new_edits||(A=A.filter(function(_){return _.error})),!qe(u))for(var L=0,$=A.length;L<$;L++)A[L].id=A[L].id||d[L];r(null,A)})}),se.prototype.registerDependentDatabase=le("registerDependentDatabase",function(t,n){var r=new this.constructor(t,this.__opts);qr(this,"_local/_pouch_dependentDbs",function(o){return o.dependentDbs=o.dependentDbs||{},!o.dependentDbs[t]&&(o.dependentDbs[t]=!0,o)}).then(function(){n(null,{db:r})}).catch(n)}),se.prototype.destroy=le("destroy",function(t,n){"function"==typeof t&&(n=t,t={});var r=this,i=!("use_prefix"in r)||r.use_prefix;function o(){r._destroy(t,function(u,d){if(u)return n(u);r._destroyed=!0,r.emit("destroyed"),n(null,d||{ok:!0})})}if(qe(r))return o();r.get("_local/_pouch_dependentDbs",function(u,d){if(u)return 404!==u.status?n(u):o();var A=r.constructor,L=Object.keys(d.dependentDbs).map(function($){var _=i?$.replace(new RegExp("^"+A.prefix),""):$;return new A(_,r.__opts).destroy()});Promise.all(L).then(o,n)})}),kr.prototype.execute=function(){var t;if(this.failed)for(;t=this.queue.shift();)t(this.failed);else for(;t=this.queue.shift();)t()},kr.prototype.fail=function(t){this.failed=t,this.execute()},kr.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},kr.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},Ee()(Gt,se);var cn="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},Ni=fetch,Mr=Headers;Gt.adapters={},Gt.preferredAdapters=[],Gt.prefix="_pouch_";var qi=new(_e());function fn(t,n){for(var r=t,i=0,o=n.length;i<o&&(r=r[n[i]]);i++);return r}function Ri(t){for(var n=[],r="",i=0,o=t.length;i<o;i++){var u=t[i];"."===u?i>0&&"\\"===t[i-1]?r=r.substring(0,r.length-1)+".":(n.push(r),r=""):r+=u}return n.push(r),n}(function(t){Object.keys(_e().prototype).forEach(function(r){"function"==typeof _e().prototype[r]&&(t[r]=qi[r].bind(qi))});var n=t._destructionListeners=new Oe;t.on("ref",function(i){n.has(i.name)||n.set(i.name,[]),n.get(i.name).push(i)}),t.on("unref",function(i){if(n.has(i.name)){var o=n.get(i.name),u=o.indexOf(i);u<0||(o.splice(u,1),o.length>1?n.set(i.name,o):n.delete(i.name))}}),t.on("destroyed",function(i){if(n.has(i)){var o=n.get(i);n.delete(i),o.forEach(function(u){u.emit("destroyed",!0)})}})})(Gt),Gt.adapter=function(t,n,r){n.valid()&&(Gt.adapters[t]=n,r&&Gt.preferredAdapters.push(t))},Gt.plugin=function(t){if("function"==typeof t)t(Gt);else{if("object"!=typeof t||0===Object.keys(t).length)throw new Error('Invalid plugin: got "'+t+'", expected an object or a function');Object.keys(t).forEach(function(n){Gt.prototype[n]=t[n]})}return this.__defaults&&(Gt.__defaults=Rt({},this.__defaults)),Gt},Gt.defaults=function(t){function n(r,i){if(!(this instanceof n))return new n(r,i);i=i||{},r&&"object"==typeof r&&(r=(i=r).name,delete i.name),i=Rt({},n.__defaults,i),Gt.call(this,r,i)}return Ee()(n,Gt),n.preferredAdapters=Gt.preferredAdapters.slice(),Object.keys(Gt).forEach(function(r){r in n||(n[r]=Gt[r])}),n.__defaults=Rt({},this.__defaults,t),n},Gt.fetch=function(t,n){return Ni(t,n)};var is=["$or","$nor","$not"];function Li(t){return is.indexOf(t)>-1}function ki(t){return Object.keys(t)[0]}function Ur(t){var n={};return t.forEach(function(r){Object.keys(r).forEach(function(i){var o=r[i];if("object"!=typeof o&&(o={$eq:o}),Li(i))n[i]=o instanceof Array?o.map(function(d){return Ur([d])}):Ur([o]);else{var u=n[i]=n[i]||{};Object.keys(o).forEach(function(d){var M=o[d];return"$gt"===d||"$gte"===d?function(t,n,r){void 0===r.$eq&&(void 0!==r.$gte?"$gte"===t?n>r.$gte&&(r.$gte=n):n>=r.$gte&&(delete r.$gte,r.$gt=n):void 0!==r.$gt?"$gte"===t?n>r.$gt&&(delete r.$gt,r.$gte=n):n>r.$gt&&(r.$gt=n):r[t]=n)}(d,M,u):"$lt"===d||"$lte"===d?function(t,n,r){void 0===r.$eq&&(void 0!==r.$lte?"$lte"===t?n<r.$lte&&(r.$lte=n):n<=r.$lte&&(delete r.$lte,r.$lt=n):void 0!==r.$lt?"$lte"===t?n<r.$lt&&(delete r.$lt,r.$lte=n):n<r.$lt&&(r.$lt=n):r[t]=n)}(d,M,u):"$ne"===d?function(t,n){"$ne"in n?n.$ne.push(t):n.$ne=[t]}(M,u):"$eq"===d?function(t,n){delete n.$gt,delete n.$gte,delete n.$lt,delete n.$lte,delete n.$ne,n.$eq=t}(M,u):void(u[d]=M)})}})}),n}function Ui(t){for(var n in t){if(Array.isArray(t))for(var r in t)t[r].$and&&(t[r]=Ur(t[r].$and));var i=t[n];"object"==typeof i&&Ui(i)}return t}function Bi(t,n){for(var r in t){"$and"===r&&(n=!0);var i=t[r];"object"==typeof i&&(n=Bi(i,n))}return n}function cs(t){var n=Mt(t),r=!1;Bi(n,!1)&&("$and"in(n=Ui(n))&&(n=Ur(n.$and)),r=!0),["$or","$nor"].forEach(function(M){M in n&&n[M].forEach(function(A){for(var L=Object.keys(A),$=0;$<L.length;$++){var _=L[$],q=A[_];("object"!=typeof q||null===q)&&(A[_]={$eq:q})}})}),"$not"in n&&(n.$not=Ur([n.$not]));for(var i=Object.keys(n),o=0;o<i.length;o++){var u=i[o],d=n[u];"object"!=typeof d||null===d?d={$eq:d}:"$ne"in d&&!r&&(d.$ne=[d.$ne]),n[u]=d}return n}function ge(t,n){if(t===n)return 0;t=ir(t),n=ir(n);var r=Wn(t),i=Wn(n);if(r-i!=0)return r-i;switch(typeof t){case"number":return t-n;case"boolean":return t<n?-1:1;case"string":return function(t,n){return t===n?0:t>n?1:-1}(t,n)}return Array.isArray(t)?function(t,n){for(var r=Math.min(t.length,n.length),i=0;i<r;i++){var o=ge(t[i],n[i]);if(0!==o)return o}return t.length===n.length?0:t.length>n.length?1:-1}(t,n):function(t,n){for(var r=Object.keys(t),i=Object.keys(n),o=Math.min(r.length,i.length),u=0;u<o;u++){var d=ge(r[u],i[u]);if(0!==d||0!==(d=ge(t[r[u]],n[i[u]])))return d}return r.length===i.length?0:r.length>i.length?1:-1}(t,n)}function ir(t){switch(typeof t){case"undefined":return null;case"number":return t===1/0||t===-1/0||isNaN(t)?null:t;case"object":var n=t;if(Array.isArray(t)){var r=t.length;t=new Array(r);for(var i=0;i<r;i++)t[i]=ir(n[i])}else{if(t instanceof Date)return t.toJSON();if(null!==t)for(var o in t={},n)if(n.hasOwnProperty(o)){var u=n[o];void 0!==u&&(t[o]=ir(u))}}}return t}function Me(t){return Wn(t=ir(t))+""+function(t){if(null!==t)switch(typeof t){case"boolean":return t?1:0;case"number":return function(t){if(0===t)return"1";var n=t.toExponential().split(/e\+?/),r=parseInt(n[1],10),i=t<0,o=i?"0":"2";o+=""+function(t,n,r){return function(t,n,r){for(var i="",o=3-t.length;i.length<o;)i+="0";return i}(t)+t}(((i?-r:r)- -324).toString());var M=Math.abs(parseFloat(n[0]));i&&(M=10-M);var A=M.toFixed(20);return o+""+A.replace(/\.?0+$/,"")}(t);case"string":return t.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01");case"object":var n=Array.isArray(t),r=n?t:Object.keys(t),i=-1,o=r.length,u="";if(n)for(;++i<o;)u+=Me(r[i]);else for(;++i<o;){var d=r[i];u+=Me(d)+Me(t[d])}return u}return""}(t)+"\0"}function ds(t,n){var i,r=n;if("1"===t[n])i=0,n++;else{var u="0"===t[n];n++;var d="",M=t.substring(n,n+3),A=parseInt(M,10)+-324;for(u&&(A=-A),n+=3;;){var L=t[n];if("\0"===L)break;d+=L,n++}i=1===(d=d.split(".")).length?parseInt(d,10):parseFloat(d[0]+"."+d[1]),u&&(i-=10),0!==A&&(i=parseFloat(i+"e"+A))}return{num:i,length:n-r}}function vs(t,n){var r=t.pop();if(n.length){var i=n[n.length-1];r===i.element&&(n.pop(),i=n[n.length-1]);var o=i.element,u=i.index;Array.isArray(o)?o.push(r):u===t.length-2?o[t.pop()]=r:t.push(r)}}function Wn(t){var r=["boolean","number","string","object"].indexOf(typeof t);return~r?null===t?1:Array.isArray(t)?5:r<3?r+2:r+3:Array.isArray(t)?5:void 0}function wr(t,n,r){return r.every(function(i){var o=n[i],u=Ri(i),d=fn(t,u);return Li(i)?function(t,n,r){return"$or"===t?n.some(function(i){return wr(r,i,Object.keys(i))}):"$not"===t?!wr(r,n,Object.keys(n)):!n.find(function(i){return wr(r,i,Object.keys(i))})}(i,o,t):Qn(o,t,u,d)})}function Qn(t,n,r,i){return!t||("object"==typeof t?Object.keys(t).every(function(o){return function(t,n,r,i,o){if(!sr[t])throw new Error('unknown operator "'+t+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return sr[t](n,r,i,o)}(o,n,t[o],r,i)}):t===i)}function Br(t){return null!=t}function ar(t){return void 0!==t}function br(t,n){return n.some(function(r){return t instanceof Array?t.indexOf(r)>-1:t===r})}var sr={$elemMatch:function(t,n,r,i){return!(!Array.isArray(i)||0===i.length)&&i.some("object"==typeof i[0]?function(o){return wr(o,n,Object.keys(n))}:function(o){return Qn(n,t,r,o)})},$allMatch:function(t,n,r,i){return!(!Array.isArray(i)||0===i.length)&&i.every("object"==typeof i[0]?function(o){return wr(o,n,Object.keys(n))}:function(o){return Qn(n,t,r,o)})},$eq:function(t,n,r,i){return ar(i)&&0===ge(i,n)},$gte:function(t,n,r,i){return ar(i)&&ge(i,n)>=0},$gt:function(t,n,r,i){return ar(i)&&ge(i,n)>0},$lte:function(t,n,r,i){return ar(i)&&ge(i,n)<=0},$lt:function(t,n,r,i){return ar(i)&&ge(i,n)<0},$exists:function(t,n,r,i){return n?ar(i):!ar(i)},$mod:function(t,n,r,i){return Br(i)&&function(t,n){var r=n[0],i=n[1];if(0===r)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(r,10)!==r)throw new Error("Divisor is not an integer");if(parseInt(i,10)!==i)throw new Error("Modulus is not an integer");return parseInt(t,10)===t&&t%r===i}(i,n)},$ne:function(t,n,r,i){return n.every(function(o){return 0!==ge(i,o)})},$in:function(t,n,r,i){return Br(i)&&br(i,n)},$nin:function(t,n,r,i){return Br(i)&&!br(i,n)},$size:function(t,n,r,i){return Br(i)&&function(t,n){return t.length===n}(i,n)},$all:function(t,n,r,i){return Array.isArray(i)&&function(t,n){return n.every(function(r){return t.indexOf(r)>-1})}(i,n)},$regex:function(t,n,r,i){return Br(i)&&function(t,n){return new RegExp(n).test(t)}(i,n)},$type:function(t,n,r,i){return function(t,n){switch(n){case"null":return null===t;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t;case"string":return"string"==typeof t;case"array":return t instanceof Array;case"object":return"[object Object]"==={}.toString.call(t)}throw new Error(n+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}(i,n)}};function As(t,n){if(t.selector&&t.filter&&"_selector"!==t.filter)return n(new Error('selector invalid for filter "'+("string"==typeof t.filter?t.filter:"function")+'"'));n()}function Os(t){t.view&&!t.filter&&(t.filter="_view"),t.selector&&!t.filter&&(t.filter="_selector"),t.filter&&"string"==typeof t.filter&&("_view"===t.filter?t.view=_i(t.view):t.filter=_i(t.filter))}function Es(t,n){return n.filter&&"string"==typeof n.filter&&!n.doc_ids&&!qe(t.db)}function He(t,n){var r=n.complete;if("_view"===n.filter){if(!n.view||"string"!=typeof n.view){var i=jt(Xr,"`view` filter parameter not found or invalid.");return r(i)}var o=tn(n.view);t.db.get("_design/"+o[0],function(d,M){if(t.isCancelled)return r(null,{status:"cancelled"});if(d)return r(_r(d));var A=M&&M.views&&M.views[o[1]]&&M.views[o[1]].map;if(!A)return r(jt(ee,M.views?"missing json key: "+o[1]:"missing json key: views"));n.filter=function(t){return Se(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+t+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{})}(A),t.doChanges(n)})}else if(n.selector)n.filter=function(d){return function(t,n){if("object"!=typeof n)throw new Error("Selector error: expected a JSON object");var i=function(t,n,r){if(t=t.filter(function(d){return wr(d.doc,n.selector,r)}),n.sort){var i=function(t){function n(r){return t.map(function(i){var u=Ri(ki(i));return fn(r,u)})}return function(r,i){var d=ge(n(r.doc),n(i.doc));return 0!==d?d:function(t,n){return t<n?-1:t>n?1:0}(r.doc._id,i.doc._id)}}(n.sort);t=t.sort(i),"string"!=typeof n.sort[0]&&"desc"===function(t){return t[ki(t)]}(n.sort[0])&&(t=t.reverse())}if("limit"in n||"skip"in n){var o=n.skip||0;t=t.slice(o,("limit"in n?n.limit:t.length)+o)}return t}([{doc:t}],{selector:n=cs(n)},Object.keys(n));return i&&1===i.length}(d,n.selector)},t.doChanges(n);else{var u=tn(n.filter);t.db.get("_design/"+u[0],function(d,M){if(t.isCancelled)return r(null,{status:"cancelled"});if(d)return r(_r(d));var A=M&&M.filters&&M.filters[u[1]];if(!A)return r(jt(ee,M&&M.filters?"missing json key: "+u[1]:"missing json key: filters"));n.filter=function(t){return Se('"use strict";\nreturn '+t+";",{})}(A),t.doChanges(n)})}}function ji(t){return t.reduce(function(n,r){return n[r]=!0,n},{})}Gt.plugin(function(t){t._changesFilterPlugin={validate:As,normalize:Os,shouldFilter:Es,filter:He}}),Gt.version="7.2.2";var Ps=ji(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Ds=ji(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function Gi(t){if(!/^\d+-/.test(t))return jt(En);var n=t.indexOf("-"),r=t.substring(0,n),i=t.substring(n+1);return{prefix:parseInt(r,10),id:i}}function Zi(t,n,r){r||(r={deterministic_revs:!0});var i,o,u,d={status:"available"};if(t._deleted&&(d.deleted=!0),n)if(t._id||(t._id=an()),o=Ln(t,r.deterministic_revs),t._rev){if((u=Gi(t._rev)).error)return u;t._rev_tree=[{pos:u.prefix,ids:[u.id,{status:"missing"},[[o,d,[]]]]}],i=u.prefix+1}else t._rev_tree=[{pos:1,ids:[o,d,[]]}],i=1;else if(t._revisions&&(t._rev_tree=function(t,n){for(var r=t.start-t.ids.length+1,i=t.ids,o=[i[0],n,[]],u=1,d=i.length;u<d;u++)o=[i[u],{status:"missing"},[o]];return[{pos:r,ids:o}]}(t._revisions,d),i=t._revisions.start,o=t._revisions.ids[0]),!t._rev_tree){if((u=Gi(t._rev)).error)return u;t._rev_tree=[{pos:i=u.prefix,ids:[o=u.id,d,[]]}]}Pn(t._id),t._rev=i+"-"+o;var M={metadata:{},data:{}};for(var A in t)if(Object.prototype.hasOwnProperty.call(t,A)){var L="_"===A[0];if(L&&!Ps[A]){var $=jt(Kr,A);throw $.message=Kr.message+": "+A,$}L&&!Ds[A]?M.metadata[A.slice(1)]=t[A]:M.data[A]=t[A]}return M}function Ls(t,n,r){if(t.stub)return r();"string"==typeof t.data?function(t,n,r){var i=function(t){try{return en(t)}catch(r){return{error:jt(Ve,"Attachment is not a valid base64 string")}}}(t.data);if(i.error)return r(i.error);t.length=i.length,t.data="blob"===n?tr(i,t.content_type):"base64"===n?Fe(i):i,nn(i,function(o){t.digest="md5-"+o,r()})}(t,n,r):function(t,n,r){nn(t.data,function(i){t.digest="md5-"+i,t.length=t.data.size||t.data.length||0,"binary"===n?bi(t.data,function(o){t.data=o,r()}):"base64"===n?rn(t.data,function(o){t.data=o,r()}):r()})}(t,n,r)}function Fs(t,n,r,i,o,u,d,M,A){t=t||1e3;var $=M.new_edits,_=new Oe,q=0,Q=n.length;function O(){++q===Q&&A&&A()}n.forEach(function(j,V){if(j._id&&$e(j._id))r[j._deleted?"_removeLocal":"_putLocal"](j,{ctx:o},function(Y,ut){u[V]=Y||ut,O()});else{var rt=j.metadata.id;_.has(rt)?(Q--,_.get(rt).push([j,V])):_.set(rt,[[j,V]])}}),_.forEach(function(j,V){var et=0;function rt(){++et<j.length?Y():O()}function Y(){var ut=j[et],vt=ut[0],xt=ut[1];if(i.has(V))!function(t,n,r,i,o,u,d,M){if(function(t,n){for(var d,r=t.slice(),i=n.split("-"),o=parseInt(i[0],10),u=i[1];d=r.pop();){if(d.pos===o&&d.ids[0]===u)return!0;for(var M=d.ids[2],A=0,L=M.length;A<L;A++)r.push({pos:d.pos+1,ids:M[A]})}return!1}(n.rev_tree,r.metadata.rev)&&!M)return i[o]=r,u();var A=n.winningRev||rr(n),L="deleted"in n?n.deleted:ze(n,A),$="deleted"in r.metadata?r.metadata.deleted:ze(r.metadata),_=/^1-/.test(r.metadata.rev);if(L&&!$&&M&&_){var q=r.data;q._rev=A,q._id=r.metadata.id,r=Zi(q,M)}var Q=Pi(n.rev_tree,r.metadata.rev_tree[0],t);if(M&&(L&&$&&"new_leaf"!==Q.conflicts||!L&&"new_leaf"!==Q.conflicts||L&&!$&&"new_branch"===Q.conflicts)){var j=jt(gr);return i[o]=j,u()}var V=r.metadata.rev;r.metadata.rev_tree=Q.tree,r.stemmedRevs=Q.stemmedRevs||[],n.rev_map&&(r.metadata.rev_map=n.rev_map);var et=rr(r.metadata),rt=ze(r.metadata,et),Y=L===rt?0:L<rt?-1:1;d(r,et,rt,V===et?rt:ze(r.metadata,V),!0,Y,o,u)}(t,i.get(V),vt,u,xt,rt,d,$);else{var yt=Pi([],vt.metadata.rev_tree[0],t);vt.metadata.rev_tree=yt.tree,vt.stemmedRevs=yt.stemmedRevs||[],function(j,V,et){var rt=rr(j.metadata),Y=ze(j.metadata,rt);if("was_delete"in M&&Y)return u[V]=jt(ee,"deleted"),et();if($&&function(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}(j)){var vt=jt(gr);return u[V]=vt,et()}d(j,rt,Y,Y,!1,Y?0:1,V,et)}(vt,xt,rt)}}Y()})}var de="document-store",ce="by-sequence",Ie="attach-store",or="attach-seq-store",Ce="meta-store",je="local-store",zn="detect-blob-support";function Zs(t){try{return JSON.stringify(t)}catch(n){return hi.stringify(t)}}function Ge(t){return function(n){var r="unknown_error";n.target&&n.target.error&&(r=n.target.error.name||n.target.error.message),t(jt(On,r))}}function Yn(t,n,r){return{data:Zs(t),winningRev:n,deletedOrLocal:r?"1":"0",seq:t.seq,id:t.id}}function ur(t){if(!t)return null;var n=function(t){try{return JSON.parse(t)}catch(n){return hi.parse(t)}}(t.data);return n.winningRev=t.winningRev,n.deleted="1"===t.deletedOrLocal,n.seq=t.seq,n}function ln(t){if(!t)return t;var n=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,n-1),t._rev=t._doc_id_rev.substring(n+1),delete t._doc_id_rev,t}function Wi(t,n,r,i){r?i(t?"string"!=typeof t?t:er(t,n):ye([""],{type:n})):t?"string"!=typeof t?Nn(t,function(o){i(Fe(o))}):i(t):i("")}function Qi(t,n,r,i){var o=Object.keys(t._attachments||{});if(!o.length)return i&&i();var u=0;function d(){++u===o.length&&i&&i()}o.forEach(function(A){n.attachments&&n.include_docs?function(A,L){var $=A._attachments[L],_=$.digest;r.objectStore(Ie).get(_).onsuccess=function(Q){$.body=Q.target.result.body,d()}}(t,A):(t._attachments[A].stub=!0,d())})}function Jn(t,n){return Promise.all(t.map(function(r){if(r.doc&&r.doc._attachments){var i=Object.keys(r.doc._attachments);return Promise.all(i.map(function(o){var u=r.doc._attachments[o];if("body"in u){var d=u.body,M=u.content_type;return new Promise(function(A){Wi(d,M,n,function(L){r.doc._attachments[o]=Rt(Pr(u,["digest","content_type"]),{data:L}),A()})})}}))}}))}function zi(t,n,r){var i=[],o=r.objectStore(ce),u=r.objectStore(Ie),d=r.objectStore(or),M=t.length;function A(){--M||!i.length||i.forEach(function($){d.index("digestSeq").count(IDBKeyRange.bound($+"::",$+"::\uffff",!1,!1)).onsuccess=function(q){q.target.result||u.delete($)}})}t.forEach(function($){o.index("_doc_id_rev").getKey(n+"::"+$).onsuccess=function(Q){var O=Q.target.result;if("number"!=typeof O)return A();o.delete(O),d.index("seq").openCursor(IDBKeyRange.only(O)).onsuccess=function(V){var et=V.target.result;if(et){var rt=et.value.digestSeq.split("::")[0];i.push(rt),d.delete(et.primaryKey),et.continue()}else A()}}})}function Re(t,n,r){try{return{txn:t.transaction(n,r)}}catch(i){return{error:i}}}var Zr=new Qe;function Ws(t,n,r,i,o,u){for(var M,A,L,$,_,q,Q,O,d=n.docs,j=0,V=d.length;j<V;j++){var et=d[j];et._id&&$e(et._id)||(et=d[j]=Zi(et,r.new_edits,t)).error&&!Q&&(Q=et)}if(Q)return u(Q);var rt=!1,Y=0,ut=new Array(d.length),vt=new Oe,xt=!1;function It(){rt=!0,Ut()}function Ut(){!O||!rt||(O.docCount+=Y,q.put(O))}function Zt(){xt||(Zr.notify(i._meta.name),u(null,ut))}function Yt(gt,at,_t,Et,Tt,Lt,Dt,wt){gt.metadata.winningRev=at,gt.metadata.deleted=_t;var Nt=gt.data;if(Nt._id=gt.metadata.id,Nt._rev=gt.metadata.rev,Et&&(Nt._deleted=!0),Nt._attachments&&Object.keys(Nt._attachments).length)return function(gt,at,_t,Et,Tt,Lt){var wt=0,Nt=Object.keys(gt.data._attachments);function zt(){wt===Nt.length&&tt(gt,at,_t,Et,Tt,Lt)}function ue(){wt++,zt()}Nt.forEach(function(re){var Vt=gt.data._attachments[re];if(Vt.stub)wt++,zt();else{var ne=Vt.data;delete Vt.data,Vt.revpos=parseInt(at,10),function(gt,at,_t){$.count(gt).onsuccess=function(Tt){if(Tt.target.result)return _t();$.put({digest:gt,body:at}).onsuccess=_t}}(Vt.digest,ne,ue)}})}(gt,at,_t,Tt,Dt,wt);Y+=Lt,Ut(),tt(gt,at,_t,Tt,Dt,wt)}function tt(gt,at,_t,Et,Tt,Lt){var Dt=gt.data,wt=gt.metadata;function Nt(Vt){var ne=gt.stemmedRevs||[];Et&&i.auto_compaction&&(ne=ne.concat(function(t){var n=[];return nr(t.rev_tree,function(r,i,o,u,d){"available"===d.status&&!r&&(n.push(i+"-"+o),d.status="missing")}),n}(gt.metadata))),ne&&ne.length&&zi(ne,gt.metadata.id,M),wt.seq=Vt.target.result;var ve=Yn(wt,at,_t);A.put(ve).onsuccess=ue}function ue(){ut[Tt]={ok:!0,id:wt.id,rev:wt.rev},vt.set(gt.metadata.id,gt.metadata),function(gt,at,_t){var Et=0,Tt=Object.keys(gt.data._attachments||{});if(!Tt.length)return _t();function Lt(){++Et===Tt.length&&_t()}function Dt(Nt){var ue=_.put({seq:at,digestSeq:gt.data._attachments[Nt].digest+"::"+at});ue.onsuccess=Lt,ue.onerror=function(re){re.preventDefault(),re.stopPropagation(),Lt()}}for(var wt=0;wt<Tt.length;wt++)Dt(Tt[wt])}(gt,wt.seq,Lt)}Dt._doc_id_rev=wt.id+"::"+wt.rev,delete Dt._id,delete Dt._rev;var re=L.put(Dt);re.onsuccess=Nt,re.onerror=function(Vt){Vt.preventDefault(),Vt.stopPropagation(),L.index("_doc_id_rev").getKey(Dt._doc_id_rev).onsuccess=function(We){L.put(Dt,We.target.result).onsuccess=Nt}}}!function(t,n,r){if(!t.length)return r();var o,i=0;function u(){i++,t.length===i&&(o?r(o):r())}t.forEach(function(d){var M=d.data&&d.data._attachments?Object.keys(d.data._attachments):[],A=0;if(!M.length)return u();function L(_){o=_,++A===M.length&&u()}for(var $ in d.data._attachments)d.data._attachments.hasOwnProperty($)&&Ls(d.data._attachments[$],n,L)})}(d,i._meta.blobSupport?"blob":"base64",function(gt){if(gt)return u(gt);!function(){var at=Re(o,[de,ce,Ie,je,or,Ce],"readwrite");if(at.error)return u(at.error);(M=at.txn).onabort=Ge(u),M.ontimeout=Ge(u),M.oncomplete=Zt,A=M.objectStore(de),L=M.objectStore(ce),$=M.objectStore(Ie),_=M.objectStore(or),(q=M.objectStore(Ce)).get(Ce).onsuccess=function(_t){O=_t.target.result,Ut()},function(gt){var at=[];if(d.forEach(function(Lt){Lt.data&&Lt.data._attachments&&Object.keys(Lt.data._attachments).forEach(function(Dt){var wt=Lt.data._attachments[Dt];wt.stub&&at.push(wt.digest)})}),!at.length)return gt();var Et,_t=0;at.forEach(function(Lt){!function(gt,at){$.get(gt).onsuccess=function(Et){if(Et.target.result)at();else{var Tt=jt(La,"unknown stub attachment with digest "+gt);Tt.status=412,at(Tt)}}}(Lt,function(Dt){Dt&&!Et&&(Et=Dt),++_t===at.length&&gt(Et)})})}(function(_t){if(_t)return xt=!0,u(_t);!function(){if(d.length)for(var gt=0,Et=0,Tt=d.length;Et<Tt;Et++){var Lt=d[Et];Lt._id&&$e(Lt._id)?at():A.get(Lt.metadata.id).onsuccess=_t}function at(){++gt===d.length&&Fs(t.revs_limit,d,i,vt,M,ut,Yt,r,It)}function _t(wt){var Nt=ur(wt.target.result);Nt&&vt.set(Nt.id,Nt),at()}}()})}()})}function Yi(t,n,r,i,o){var d,M,A;function L(Q){M=Q.target.result,d&&o(d,M,A)}function $(Q){d=Q.target.result,M&&o(d,M,A)}function q(Q){var O=Q.target.result;if(!O)return o();o([O.key],[O.value],O)}-1===i&&(i=1e3),"function"==typeof t.getAll&&"function"==typeof t.getAllKeys&&i>1&&!r?(A={continue:function(){if(!d.length)return o();var O,Q=d[d.length-1];if(n&&n.upper)try{O=IDBKeyRange.bound(Q,n.upper,!0,n.upperOpen)}catch(j){if("DataError"===j.name&&0===j.code)return o()}else O=IDBKeyRange.lowerBound(Q,!0);d=null,M=null,t.getAll(n=O,i).onsuccess=L,t.getAllKeys(n,i).onsuccess=$}},t.getAll(n,i).onsuccess=L,t.getAllKeys(n,i).onsuccess=$):r?t.openCursor(n,"prev").onsuccess=q:t.openCursor(n).onsuccess=q}var $n=!1,Hn=[];function Ks(){$n||!Hn.length||($n=!0,Hn.shift()())}var Kn,xr=new Oe,Xn=new Oe;function $i(t,n){var r=this;!function(t,n,r){Hn.push(function(){t(function(u,d){(function(t,n,r,i){try{t(n,r)}catch(o){i.emit("error",o)}})(n,u,d,r),$n=!1,ke()(function(){Ks()})})}),Ks()}(function(i){!function(t,n,r){var i=n.name,o=null;function d(O,j){var V=O.objectStore(de);V.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),V.openCursor().onsuccess=function(et){var rt=et.target.result;if(rt){var Y=rt.value,ut=ze(Y);Y.deletedOrLocal=ut?"1":"0",V.put(Y),rt.continue()}else j()}}function A(O,j){var V=O.objectStore(je),et=O.objectStore(de),rt=O.objectStore(ce);et.openCursor().onsuccess=function(ut){var vt=ut.target.result;if(vt){var xt=vt.value,yt=xt.id,At=$e(yt),It=rr(xt);if(At){var Ct=yt+"::"+It,Ut=yt+"::",Wt=yt+"::~",Zt=rt.index("_doc_id_rev"),Bt=IDBKeyRange.bound(Ut,Wt,!1,!1),qt=Zt.openCursor(Bt);qt.onsuccess=function(Yt){if(qt=Yt.target.result){var tt=qt.value;tt._doc_id_rev===Ct&&V.put(tt),rt.delete(qt.primaryKey),qt.continue()}else et.delete(vt.primaryKey),vt.continue()}}else vt.continue()}else j&&j()}}function $(O,j){var V=O.objectStore(ce),et=O.objectStore(Ie),rt=O.objectStore(or);et.count().onsuccess=function(ut){if(!ut.target.result)return j();V.openCursor().onsuccess=function(xt){var yt=xt.target.result;if(!yt)return j();for(var At=yt.value,It=yt.primaryKey,Ct=Object.keys(At._attachments||{}),Ut={},Wt=0;Wt<Ct.length;Wt++)Ut[At._attachments[Ct[Wt]].digest]=!0;var Bt=Object.keys(Ut);for(Wt=0;Wt<Bt.length;Wt++)rt.put({seq:It,digestSeq:Bt[Wt]+"::"+It});yt.continue()}}}function _(O){var V=O.objectStore(ce),et=O.objectStore(de);et.openCursor().onsuccess=function(Y){var At,It,Ct,Ut,ut=Y.target.result;if(ut){var vt=function(Y){return Y.data?ur(Y):(Y.deleted="1"===Y.deletedOrLocal,Y)}(ut.value);if(vt.winningRev=vt.winningRev||rr(vt),vt.seq)return yt();At=vt.id+"::",It=vt.id+"::\uffff",Ct=V.index("_doc_id_rev").openCursor(IDBKeyRange.bound(At,It)),Ut=0,Ct.onsuccess=function(Wt){var Zt=Wt.target.result;if(!Zt)return vt.seq=Ut,yt();var Bt=Zt.primaryKey;Bt>Ut&&(Ut=Bt),Zt.continue()}}function yt(){var At=Yn(vt,vt.winningRev,vt.deleted);et.put(At).onsuccess=function(){ut.continue()}}}}t._meta=null,t._remote=!1,t.type=function(){return"idb"},t._id=pr(function(O){O(null,t._meta.instanceId)}),t._bulkDocs=function(j,V,et){Ws(n,j,V,t,o,et)},t._get=function(j,V,et){var rt,Y,ut,vt=V.ctx;if(!vt){var xt=Re(o,[de,ce,Ie],"readonly");if(xt.error)return et(xt.error);vt=xt.txn}function yt(){et(ut,{doc:rt,metadata:Y,ctx:vt})}vt.objectStore(de).get(j).onsuccess=function(At){if(!(Y=ur(At.target.result)))return ut=jt(ee,"missing"),yt();var It;if(V.rev)It=V.latest?function(t,n){for(var i,r=n.rev_tree.slice();i=r.pop();){var o=i.pos,u=i.ids,d=u[0],M=u[1],A=u[2],L=0===A.length,$=i.history?i.history.slice():[];if($.push({id:d,pos:o,opts:M}),L)for(var _=0,q=$.length;_<q;_++){var Q=$[_];if(Q.pos+"-"+Q.id===t)return o+"-"+d}for(var j=0,V=A.length;j<V;j++)r.push({pos:o+1,ids:A[j],history:$})}throw new Error("Unable to resolve latest revision for id "+n.id+", rev "+t)}(V.rev,Y):V.rev;else if(It=Y.winningRev,ze(Y))return ut=jt(ee,"deleted"),yt();var Ut=vt.objectStore(ce),Wt=Y.id+"::"+It;Ut.index("_doc_id_rev").get(Wt).onsuccess=function(Zt){if((rt=Zt.target.result)&&(rt=ln(rt)),!rt)return ut=jt(ee,"missing"),yt();yt()}}},t._getAttachment=function(O,j,V,et,rt){var Y;if(et.ctx)Y=et.ctx;else{var ut=Re(o,[de,ce,Ie],"readonly");if(ut.error)return rt(ut.error);Y=ut.txn}var vt=V.digest,xt=V.content_type;Y.objectStore(Ie).get(vt).onsuccess=function(yt){Wi(yt.target.result.body,xt,et.binary,function(It){rt(null,It)})}},t._info=function(j){var V,et,rt=Re(o,[Ce,ce],"readonly");if(rt.error)return j(rt.error);var Y=rt.txn;Y.objectStore(Ce).get(Ce).onsuccess=function(ut){et=ut.target.result.docCount},Y.objectStore(ce).openCursor(null,"prev").onsuccess=function(ut){var vt=ut.target.result;V=vt?vt.key:0},Y.oncomplete=function(){j(null,{doc_count:et,update_seq:V,idb_attachment_format:t._meta.blobSupport?"binary":"base64"})}},t._allDocs=function(j,V){!function(t,n,r){var $,_,d="keys"in t&&t.keys,M=t.skip||0,A="number"==typeof t.limit?t.limit:-1;if(!d&&(_=($=function(t,n,r,i,o){try{if(t&&n)return o?IDBKeyRange.bound(n,t,!r,!1):IDBKeyRange.bound(t,n,!1,!r);if(t)return o?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(t);if(n)return o?IDBKeyRange.lowerBound(n,!r):IDBKeyRange.upperBound(n,!r);if(i)return IDBKeyRange.only(i)}catch(u){return{error:u}}return null}("startkey"in t&&t.startkey,"endkey"in t&&t.endkey,!1!==t.inclusive_end,"key"in t&&t.key,t.descending))&&$.error)&&("DataError"!==_.name||0!==_.code))return r(jt(On,_.name));var q=[de,ce,Ce];t.attachments&&q.push(Ie);var Q=Re(n,q,"readonly");if(Q.error)return r(Q.error);var O=Q.txn;O.oncomplete=function(){t.attachments?Jn(Y,t.binary).then(Wt):Wt()},O.onabort=Ge(r);var ut,vt,qt,j=O.objectStore(de),V=O.objectStore(ce),et=O.objectStore(Ce),rt=V.index("_doc_id_rev"),Y=[];function At(Bt,qt){var Yt={id:qt.id,key:qt.id,value:{rev:Bt}};qt.deleted?d&&(Y.push(Yt),Yt.value.deleted=!0,Yt.doc=null):M--<=0&&(Y.push(Yt),t.include_docs&&function(Bt,qt,Yt){rt.get(Bt.id+"::"+Yt).onsuccess=function(ot){if(qt.doc=ln(ot.target.result)||{},t.conflicts){var bt=Un(Bt);bt.length&&(qt.doc._conflicts=bt)}Qi(qt.doc,t,O)}}(qt,Yt,Bt))}function It(Bt){for(var qt=0,Yt=Bt.length;qt<Yt&&Y.length!==A;qt++){var tt=Bt[qt];if(tt.error&&d)Y.push(tt);else{var it=ur(tt);At(it.winningRev,it)}}}function Ct(Bt,qt,Yt){!Yt||(It(qt),Y.length<A&&Yt.continue())}function Wt(){var Bt={total_rows:ut,offset:t.skip,rows:Y};t.update_seq&&void 0!==vt&&(Bt.update_seq=vt),r(null,Bt)}if(et.get(Ce).onsuccess=function(Bt){ut=Bt.target.result.docCount},t.update_seq&&(qt=function(Bt){Bt.target.result&&Bt.target.result.length>0&&(vt=Bt.target.result[0])},V.openCursor(null,"prev").onsuccess=function(tt){var it=tt.target.result,ot=void 0;return it&&it.key&&(ot=it.key),qt({target:{result:[ot]}})}),!_&&0!==A){if(d)return function(t,n,r){var i=new Array(t.length),o=0;t.forEach(function(u,d){n.get(u).onsuccess=function(M){i[d]=M.target.result?M.target.result:{key:u,error:"not_found"},++o===t.length&&r(t,i,{})}})}(t.keys,j,Ct);if(-1===A)return function(t,n,r){if("function"!=typeof t.getAll){var i=[];t.openCursor(n).onsuccess=function(u){var d=u.target.result;d?(i.push(d.value),d.continue()):r({target:{result:i}})}}else t.getAll(n).onsuccess=r}(j,$,function(Bt){var qt=Bt.target.result;t.descending&&(qt=qt.reverse()),It(qt)});Yi(j,$,t.descending,A+M,Ct)}}(j,o,V)},t._changes=function(j){return function(t,n,r,i){if((t=Mt(t)).continuous){var o=r+":"+an();return Zr.addListener(r,o,n,t),Zr.notify(r),{cancel:function(){Zr.removeListener(r,o)}}}var u=t.doc_ids&&new mr(t.doc_ids);t.since=t.since||0;var d=t.since,M="limit"in t?t.limit:-1;0===M&&(M=1);var q,Q,O,j,A=[],L=0,$=Tn(t),_=new Oe;function et(At,It,Ct,Ut){return Ct.seq!==It?Ut():Ct.winningRev===At._rev?Ut(Ct,At):void(j.get(At._id+"::"+Ct.winningRev).onsuccess=function(Bt){Ut(Ct,ln(Bt.target.result))})}function Y(){t.complete(null,{results:A,last_seq:d})}var vt=[de,ce];t.attachments&&vt.push(Ie);var xt=Re(i,vt,"readonly");if(xt.error)return t.complete(xt.error);(q=xt.txn).onabort=Ge(t.complete),q.oncomplete=function(){!t.continuous&&t.attachments?Jn(A).then(Y):Y()},Q=q.objectStore(ce),O=q.objectStore(de),j=Q.index("_doc_id_rev"),Yi(Q,t.since&&!t.descending?IDBKeyRange.lowerBound(t.since,!0):null,t.descending,M,function(At,It,Ct){if(Ct&&At.length){var Ut=new Array(At.length),Wt=new Array(At.length),qt=0;It.forEach(function(Yt,tt){!function(At,It,Ct){if(u&&!u.has(At._id))return Ct();var Ut=_.get(At._id);if(Ut)return et(At,It,Ut,Ct);O.get(At._id).onsuccess=function(Wt){Ut=ur(Wt.target.result),_.set(At._id,Ut),et(At,It,Ut,Ct)}}(ln(Yt),At[tt],function(bt,gt){Wt[tt]=bt,Ut[tt]=gt,++qt===At.length&&function(){for(var Yt=[],tt=0,it=Ut.length;tt<it&&L!==M;tt++){var ot=Ut[tt];ot&&Yt.push(Zt(Wt[tt],ot))}Promise.all(Yt).then(function(gt){for(var at=0,_t=gt.length;at<_t;at++)gt[at]&&t.onChange(gt[at])}).catch(t.complete),L!==M&&Ct.continue()}()})})}function Zt(Yt,tt){var it=t.processChange(tt,Yt,t);d=it.seq=Yt.seq;var ot=$(it);return"object"==typeof ot?Promise.reject(ot):ot?(L++,t.return_docs&&A.push(it),t.attachments&&t.include_docs?new Promise(function(bt){Qi(tt,t,q,function(){Jn([it],t.binary).then(function(){bt(it)})})}):Promise.resolve(it)):Promise.resolve()}})}(j,t,i,o)},t._close=function(O){o.close(),xr.delete(i),O()},t._getRevisionTree=function(O,j){var V=Re(o,[de],"readonly");if(V.error)return j(V.error);V.txn.objectStore(de).get(O).onsuccess=function(Y){var ut=ur(Y.target.result);ut?j(null,ut.rev_tree):j(jt(ee))}},t._doCompaction=function(O,j,V){var rt=Re(o,[de,ce,Ie,or],"readwrite");if(rt.error)return V(rt.error);var Y=rt.txn;Y.objectStore(de).get(O).onsuccess=function(vt){var xt=ur(vt.target.result);nr(xt.rev_tree,function(It,Ct,Ut,Wt,Zt){-1!==j.indexOf(Ct+"-"+Ut)&&(Zt.status="missing")}),zi(j,O,Y);var yt=xt.winningRev,At=xt.deleted;Y.objectStore(de).put(Yn(xt,yt,At))},Y.onabort=Ge(V),Y.oncomplete=function(){V()}},t._getLocal=function(O,j){var V=Re(o,[je],"readonly");if(V.error)return j(V.error);var rt=V.txn.objectStore(je).get(O);rt.onerror=Ge(j),rt.onsuccess=function(Y){var ut=Y.target.result;ut?(delete ut._doc_id_rev,j(null,ut)):j(jt(ee))}},t._putLocal=function(O,j,V){"function"==typeof j&&(V=j,j={}),delete O._revisions;var et=O._rev,rt=O._id;O._rev=et?"0-"+(parseInt(et.split("-")[1],10)+1):"0-1";var ut,Y=j.ctx;if(!Y){var vt=Re(o,[je],"readwrite");if(vt.error)return V(vt.error);(Y=vt.txn).onerror=Ge(V),Y.oncomplete=function(){ut&&V(null,ut)}}var yt,xt=Y.objectStore(je);et?(yt=xt.get(rt)).onsuccess=function(At){var It=At.target.result;It&&It._rev===et?xt.put(O).onsuccess=function(){ut={ok:!0,id:O._id,rev:O._rev},j.ctx&&V(null,ut)}:V(jt(gr))}:((yt=xt.add(O)).onerror=function(At){V(jt(gr)),At.preventDefault(),At.stopPropagation()},yt.onsuccess=function(){ut={ok:!0,id:O._id,rev:O._rev},j.ctx&&V(null,ut)})},t._removeLocal=function(O,j,V){"function"==typeof j&&(V=j,j={});var et=j.ctx;if(!et){var rt=Re(o,[je],"readwrite");if(rt.error)return V(rt.error);(et=rt.txn).oncomplete=function(){Y&&V(null,Y)}}var Y,ut=O._id,vt=et.objectStore(je),xt=vt.get(ut);xt.onerror=Ge(V),xt.onsuccess=function(yt){var At=yt.target.result;At&&At._rev===O._rev?(vt.delete(ut),Y={ok:!0,id:ut,rev:"0-0"},j.ctx&&V(null,Y)):V(jt(ee))}},t._destroy=function(O,j){Zr.removeAllListeners(i);var V=Xn.get(i);V&&V.result&&(V.result.close(),xr.delete(i));var et=indexedDB.deleteDatabase(i);et.onsuccess=function(){Xn.delete(i),Sn()&&i in localStorage&&delete localStorage[i],j(null,{ok:!0})},et.onerror=Ge(j)};var q=xr.get(i);if(q)return o=q.idb,t._meta=q.global,ke()(function(){r(null,t)});var Q=indexedDB.open(i,5);Xn.set(i,Q),Q.onupgradeneeded=function(O){var j=O.target.result;if(O.oldVersion<1)return function(O){var j=O.createObjectStore(de,{keyPath:"id"});O.createObjectStore(ce,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),O.createObjectStore(Ie,{keyPath:"digest"}),O.createObjectStore(Ce,{keyPath:"id",autoIncrement:!1}),O.createObjectStore(zn),j.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),O.createObjectStore(je,{keyPath:"_id"});var V=O.createObjectStore(or,{autoIncrement:!0});V.createIndex("seq","seq"),V.createIndex("digestSeq","digestSeq",{unique:!0})}(j);var V=O.currentTarget.transaction;O.oldVersion<3&&function(O){O.createObjectStore(je,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}(j),O.oldVersion<4&&function(O){var j=O.createObjectStore(or,{autoIncrement:!0});j.createIndex("seq","seq"),j.createIndex("digestSeq","digestSeq",{unique:!0})}(j);var et=[d,A,$,_],rt=O.oldVersion;!function Y(){var ut=et[rt-1];rt++,ut&&ut(V,Y)}()},Q.onsuccess=function(O){(o=O.target.result).onversionchange=function(){o.close(),xr.delete(i)},o.onabort=function(yt){be("error","Database has a global failure",yt.target.error),o.close(),xr.delete(i)};var et,rt,Y,ut,j=o.transaction([Ce,zn,de],"readwrite"),V=!1;function vt(){void 0===Y||!V||(t._meta={name:i,instanceId:ut,blobSupport:Y},xr.set(i,{idb:o,global:t._meta}),r(null,t))}function xt(){if(void 0!==rt&&void 0!==et){var yt=i+"_id";yt in et?ut=et[yt]:et[yt]=ut=an(),et.docCount=rt,j.objectStore(Ce).put(et)}}j.objectStore(Ce).get(Ce).onsuccess=function(yt){et=yt.target.result||{id:Ce},xt()},function(t,n){t.objectStore(de).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(i){rt=i.target.result,xt()}}(j),Kn||(Kn=function(t){return new Promise(function(n){var r=ye([""]),i=t.objectStore(zn).put(r,"key");i.onsuccess=function(){var o=navigator.userAgent.match(/Chrome\/(\d+)/),u=navigator.userAgent.match(/Edge\//);n(u||!o||parseInt(o[1],10)>=43)},i.onerror=t.onabort=function(o){o.preventDefault(),o.stopPropagation(),n(!1)}}).catch(function(){return!1})}(j)),Kn.then(function(yt){Y=yt,vt()}),j.oncomplete=function(){V=!0,vt()},j.onabort=Ge(r)},Q.onerror=function(O){var j=O.target.error&&O.target.error.message;j?-1!==j.indexOf("stored database is a higher version")&&(j=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):j="Failed to open indexedDB, are you in private browsing mode?",be("error",j),r(jt(On,j))}}(r,t,i)},n,r.constructor)}$i.valid=function(){try{return"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}};var Vn={};function ti(t){var n=t.doc||t.ok,r=n&&n._attachments;!r||Object.keys(r).forEach(function(i){var o=r[i];o.data=er(o.data,o.content_type)})}function cr(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function Hi(t){return t._attachments&&Object.keys(t._attachments)?Promise.all(Object.keys(t._attachments).map(function(n){var r=t._attachments[n];if(r.data&&"string"!=typeof r.data)return new Promise(function(i){rn(r.data,i)}).then(function(i){r.data=i})})):Promise.resolve()}function me(t,n){return vn(t,t.db+"/"+n)}function vn(t,n){return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+(t.path?"/":"")+n}function mn(t){return"?"+Object.keys(t).map(function(n){return n+"="+encodeURIComponent(t[n])}).join("&")}function ei(t,n){var r=this,i=function(t,n){if(function(t){if(!t.prefix)return!1;var n=Mi(t.prefix).protocol;return"http"===n||"https"===n}(n)){var r=n.name.substr(n.prefix.length);t=n.prefix.replace(/\/?$/,"/")+encodeURIComponent(r)}var o=Mi(t);(o.user||o.password)&&(o.auth={username:o.user,password:o.password});var u=o.path.replace(/(^\/|\/$)/g,"").split("/");return o.db=u.pop(),-1===o.db.indexOf("%")&&(o.db=encodeURIComponent(o.db)),o.path=u.join("/"),o}(t.name,t),o=me(i,"");t=Mt(t);var A,u=function(_,q){if((q=q||{}).headers=q.headers||new Mr,q.credentials="include",t.auth||i.auth){var Q=t.auth||i.auth,j=Fe(unescape(encodeURIComponent(Q.username+":"+Q.password)));q.headers.set("Authorization","Basic "+j)}var V=t.headers||{};return Object.keys(V).forEach(function(rt){q.headers.append(rt,V[rt])}),function(t){var n="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",r=-1!==n.indexOf("msie"),i=-1!==n.indexOf("trident"),o=-1!==n.indexOf("edge");return(r||i||o)&&(!("method"in t)||"GET"===t.method)}(q)&&(_+=(-1===_.indexOf("?")?"?":"&")+"_nonce="+Date.now()),(t.fetch||Ni)(_,q)};function d(_,q){return le(_,Ae()(function(Q){L().then(function(){return q.apply(this,Q)}).catch(function(O){Q.pop()(O)})})).bind(r)}function M(_,q,Q){var O={};return(q=q||{}).headers=q.headers||new Mr,q.headers.get("Content-Type")||q.headers.set("Content-Type","application/json"),q.headers.get("Accept")||q.headers.set("Accept","application/json"),u(_,q).then(function(j){return O.ok=j.ok,O.status=j.status,j.json()}).then(function(j){if(O.data=j,!O.ok){O.data.status=O.status;var V=_r(O.data);if(Q)return Q(V);throw V}if(Array.isArray(O.data)&&(O.data=O.data.map(function(et){return et.error||et.missing?_r(et):et})),!Q)return O;Q(null,O.data)})}function L(){return t.skip_setup?Promise.resolve():A||((A=M(o).catch(function(_){return _&&_.status&&404===_.status?(xn(404,"PouchDB is just detecting if the remote exists."),M(o,{method:"PUT"})):Promise.reject(_)}).catch(function(_){return!(!_||!_.status||412!==_.status)||Promise.reject(_)})).catch(function(){A=null}),A)}function $(_){return _.split("/").map(encodeURIComponent).join("/")}ke()(function(){n(null,r)}),r._remote=!0,r.type=function(){return"http"},r.id=d("id",function(_){u(vn(i,"")).then(function(q){return q.json()}).catch(function(){return{}}).then(function(q){var Q=q&&q.uuid?q.uuid+i.db:me(i,"");_(null,Q)})}),r.compact=d("compact",function(_,q){"function"==typeof _&&(q=_,_={}),_=Mt(_),M(me(i,"_compact"),{method:"POST"}).then(function(){!function Q(){r.info(function(O,j){j&&!j.compact_running?q(null,{ok:!0}):setTimeout(Q,_.interval||200)})}()})}),r.bulkGet=le("bulkGet",function(_,q){var Q=this;function O(rt){var Y={};_.revs&&(Y.revs=!0),_.attachments&&(Y.attachments=!0),_.latest&&(Y.latest=!0),M(me(i,"_bulk_get"+mn(Y)),{method:"POST",body:JSON.stringify({docs:_.docs})}).then(function(ut){_.attachments&&_.binary&&ut.data.results.forEach(function(vt){vt.docs.forEach(ti)}),rt(null,ut.data)}).catch(rt)}function j(){var Y=Math.ceil(_.docs.length/50),ut=0,vt=new Array(Y);function xt(It){return function(Ct,Ut){vt[It]=Ut.results,++ut===Y&&q(null,{results:Ir(vt)})}}for(var yt=0;yt<Y;yt++){var At=Pr(_,["revs","attachments","binary","latest"]);At.docs=_.docs.slice(50*yt,Math.min(_.docs.length,50*(yt+1))),wn(Q,At,xt(yt))}}var V=vn(i,""),et=Vn[V];"boolean"!=typeof et?O(function(rt,Y){rt?(Vn[V]=!1,xn(rt.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),j()):(Vn[V]=!0,q(null,Y))}):et?O(q):j()}),r._info=function(_){L().then(function(){return u(me(i,""))}).then(function(q){return q.json()}).then(function(q){q.host=me(i,""),_(null,q)}).catch(_)},r.fetch=function(_,q){return L().then(function(){var Q="/"===_.substring(0,1)?vn(i,_.substring(1)):me(i,_);return u(Q,q)})},r.get=d("get",function(_,q,Q){"function"==typeof q&&(Q=q,q={});var O={};function j(rt){var Y=rt._attachments,ut=Y&&Object.keys(Y);if(Y&&ut.length)return function(t,n){return new Promise(function(r,i){var A,o=0,u=0,d=0,M=t.length;function $(){++d===M?A?i(A):r():Q()}function _(){o--,$()}function q(O){o--,A=A||O,$()}function Q(){for(;o<5&&u<M;)o++,t[u++]().then(_,q)}Q()})}(ut.map(function(yt){return function(){return function(yt){var At=Y[yt],It=cr(rt._id)+"/"+$(yt)+"?rev="+rt._rev;return u(me(i,It)).then(function(Ct){return"buffer"in Ct?Ct.buffer():Ct.blob()}).then(function(Ct){if(q.binary){var Ut=Object.getOwnPropertyDescriptor(Ct.__proto__,"type");return(!Ut||Ut.set)&&(Ct.type=At.content_type),Ct}return new Promise(function(Wt){rn(Ct,Wt)})}).then(function(Ct){delete At.stub,delete At.length,At.data=Ct})}(yt)}}))}(q=Mt(q)).revs&&(O.revs=!0),q.revs_info&&(O.revs_info=!0),q.latest&&(O.latest=!0),q.open_revs&&("all"!==q.open_revs&&(q.open_revs=JSON.stringify(q.open_revs)),O.open_revs=q.open_revs),q.rev&&(O.rev=q.rev),q.conflicts&&(O.conflicts=q.conflicts),q.update_seq&&(O.update_seq=q.update_seq),_=cr(_),M(me(i,_+mn(O))).then(function(rt){return Promise.resolve().then(function(){if(q.attachments)return function(rt){return Array.isArray(rt)?Promise.all(rt.map(function(Y){if(Y.ok)return j(Y.ok)})):j(rt)}(rt.data)}).then(function(){Q(null,rt.data)})}).catch(function(rt){rt.docId=_,Q(rt)})}),r.remove=d("remove",function(_,q,Q,O){var j;"string"==typeof q?(j={_id:_,_rev:q},"function"==typeof Q&&(O=Q,Q={})):(j=_,"function"==typeof q?(O=q,Q={}):(O=Q,Q=q));var V=j._rev||Q.rev;M(me(i,cr(j._id))+"?rev="+V,{method:"DELETE"},O).catch(O)}),r.getAttachment=d("getAttachment",function(_,q,Q,O){"function"==typeof Q&&(O=Q,Q={});var et,j=Q.rev?"?rev="+Q.rev:"",V=me(i,cr(_))+"/"+$(q)+j;u(V,{method:"GET"}).then(function(rt){if(et=rt.headers.get("content-type"),rt.ok)return"undefined"==typeof process||process.browser||"function"!=typeof rt.buffer?rt.blob():rt.buffer();throw rt}).then(function(rt){"undefined"!=typeof process&&!process.browser&&(rt.type=et),O(null,rt)}).catch(function(rt){O(rt)})}),r.removeAttachment=d("removeAttachment",function(_,q,Q,O){M(me(i,cr(_)+"/"+$(q))+"?rev="+Q,{method:"DELETE"},O).catch(O)}),r.putAttachment=d("putAttachment",function(_,q,Q,O,j,V){"function"==typeof j&&(V=j,j=O,O=Q,Q=null);var et=cr(_)+"/"+$(q),rt=me(i,et);if(Q&&(rt+="?rev="+Q),"string"==typeof O){var Y;try{Y=en(O)}catch(ut){return V(jt(Ve,"Attachment is not a valid base64 string"))}O=Y?tr(Y,j):""}M(rt,{headers:new Mr({"Content-Type":j}),method:"PUT",body:O},V).catch(V)}),r._bulkDocs=function(_,q,Q){_.new_edits=q.new_edits,L().then(function(){return Promise.all(_.docs.map(Hi))}).then(function(){return M(me(i,"_bulk_docs"),{method:"POST",body:JSON.stringify(_)},Q)}).catch(Q)},r._put=function(_,q,Q){L().then(function(){return Hi(_)}).then(function(){return M(me(i,cr(_._id)),{method:"PUT",body:JSON.stringify(_)})}).then(function(O){Q(null,O.data)}).catch(function(O){O.docId=_&&_._id,Q(O)})},r.allDocs=d("allDocs",function(_,q){"function"==typeof _&&(q=_,_={});var O,Q={},j="GET";(_=Mt(_)).conflicts&&(Q.conflicts=!0),_.update_seq&&(Q.update_seq=!0),_.descending&&(Q.descending=!0),_.include_docs&&(Q.include_docs=!0),_.attachments&&(Q.attachments=!0),_.key&&(Q.key=JSON.stringify(_.key)),_.start_key&&(_.startkey=_.start_key),_.startkey&&(Q.startkey=JSON.stringify(_.startkey)),_.end_key&&(_.endkey=_.end_key),_.endkey&&(Q.endkey=JSON.stringify(_.endkey)),void 0!==_.inclusive_end&&(Q.inclusive_end=!!_.inclusive_end),void 0!==_.limit&&(Q.limit=_.limit),void 0!==_.skip&&(Q.skip=_.skip);var V=mn(Q);void 0!==_.keys&&(j="POST",O={keys:_.keys}),M(me(i,"_all_docs"+V),{method:j,body:JSON.stringify(O)}).then(function(et){_.include_docs&&_.attachments&&_.binary&&et.data.rows.forEach(ti),q(null,et.data)}).catch(q)}),r._changes=function(_){var q="batch_size"in _?_.batch_size:25;(_=Mt(_)).continuous&&!("heartbeat"in _)&&(_.heartbeat=1e4);var Q="timeout"in _?_.timeout:3e4;"timeout"in _&&_.timeout&&Q-_.timeout<5e3&&(Q=_.timeout+5e3),"heartbeat"in _&&_.heartbeat&&Q-_.heartbeat<5e3&&(Q=_.heartbeat+5e3);var O={};"timeout"in _&&_.timeout&&(O.timeout=_.timeout);var j=void 0!==_.limit&&_.limit,V=j;if(_.style&&(O.style=_.style),(_.include_docs||_.filter&&"function"==typeof _.filter)&&(O.include_docs=!0),_.attachments&&(O.attachments=!0),_.continuous&&(O.feed="longpoll"),_.seq_interval&&(O.seq_interval=_.seq_interval),_.conflicts&&(O.conflicts=!0),_.descending&&(O.descending=!0),_.update_seq&&(O.update_seq=!0),"heartbeat"in _&&_.heartbeat&&(O.heartbeat=_.heartbeat),_.filter&&"string"==typeof _.filter&&(O.filter=_.filter),_.view&&"string"==typeof _.view&&(O.filter="_view",O.view=_.view),_.query_params&&"object"==typeof _.query_params)for(var et in _.query_params)_.query_params.hasOwnProperty(et)&&(O[et]=_.query_params[et]);var Y,rt="GET";_.doc_ids?(O.filter="_doc_ids",rt="POST",Y={doc_ids:_.doc_ids}):_.selector&&(O.filter="_selector",rt="POST",Y={selector:_.selector});var vt,ut=new cn,xt=function(It,Ct){if(!_.aborted){O.since=It,"object"==typeof O.since&&(O.since=JSON.stringify(O.since)),_.descending?j&&(O.limit=V):O.limit=!j||V>q?q:V;var Ut=me(i,"_changes"+mn(O)),Wt={signal:ut.signal,method:rt,body:JSON.stringify(Y)};vt=It,!_.aborted&&L().then(function(){return M(Ut,Wt,Ct)}).catch(Ct)}},yt={results:[]},At=function(It,Ct){if(!_.aborted){var Ut=0;if(Ct&&Ct.results){Ut=Ct.results.length,yt.last_seq=Ct.last_seq;var Wt=null,Zt=null;"number"==typeof Ct.pending&&(Wt=Ct.pending),("string"==typeof yt.last_seq||"number"==typeof yt.last_seq)&&(Zt=yt.last_seq),Ct.results=Ct.results.filter(function(Yt){V--;var tt=Tn(_)(Yt);return tt&&(_.include_docs&&_.attachments&&_.binary&&ti(Yt),_.return_docs&&yt.results.push(Yt),_.onChange(Yt,Wt,Zt)),tt})}else if(It)return _.aborted=!0,void _.complete(It);Ct&&Ct.last_seq&&(vt=Ct.last_seq),(!_.continuous||j&&V<=0)&&(j&&V<=0||Ct&&Ut<q||_.descending)?_.complete(null,yt):ke()(function(){xt(vt,At)})}};return xt(_.since||0,At),{cancel:function(){_.aborted=!0,ut.abort()}}},r.revsDiff=d("revsDiff",function(_,q,Q){"function"==typeof q&&(Q=q,q={}),M(me(i,"_revs_diff"),{method:"POST",body:JSON.stringify(_)},Q).catch(Q)}),r._close=function(_){_()},r._destroy=function(_,q){M(me(i,""),{method:"DELETE"}).then(function(Q){q(null,Q)}).catch(function(Q){404===Q.status?q(null,{ok:!0}):q(Q)})}}function fr(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,fr)}catch(n){}}function pn(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,pn)}catch(n){}}function gn(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,gn)}catch(n){}}function Ki(t,n){return n&&t.then(function(r){ke()(function(){n(null,r)})},function(r){ke()(function(){n(r)})}),t}function ri(t,n){return function(){var r=arguments,i=this;return t.add(function(){return n.apply(i,r)})}}function Xi(t){var n=new mr(t),r=new Array(n.size),i=-1;return n.forEach(function(o){r[++i]=o}),r}function ni(t){var n=new Array(t.size),r=-1;return t.forEach(function(i,o){n[++r]=o}),n}function Vi(t){return new gn("builtin "+t+" function requires map values to be numbers or number arrays")}function ii(t){for(var n=0,r=0,i=t.length;r<i;r++){var o=t[r];if("number"!=typeof o){if(!Array.isArray(o))throw Vi("_sum");n="number"==typeof n?[n]:n;for(var u=0,d=o.length;u<d;u++){var M=o[u];if("number"!=typeof M)throw Vi("_sum");void 0===n[u]?n.push(M):n[u]+=M}}else"number"==typeof n?n+=o:n[0]+=o}return n}ei.valid=function(){return!0},Ee()(fr,Error),Ee()(pn,Error),Ee()(gn,Error);var lo=be.bind(null,"log"),vo=Array.isArray,mo=JSON.parse;function ta(t,n){return Se("return ("+t.replace(/;\s*$/,"")+");",{emit:n,sum:ii,log:lo,isArray:vo,toJSON:mo})}function Wr(){this.promise=new Promise(function(t){t()})}function fe(t){if(!t)return"undefined";switch(typeof t){case"function":case"string":return t.toString();default:return JSON.stringify(t)}}function ea(t,n,r,i,o,u){var M,d=function(t,n){return fe(t)+fe(n)+"undefined"}(r,i);if(!o&&(M=t._cachedViews=t._cachedViews||{})[d])return M[d];var A=t.info().then(function(L){var $=L.db_name+"-mrview-"+(o?"temp":xi(d));return qr(t,"_local/"+u,function(q){q.views=q.views||{};var Q=n;-1===Q.indexOf("/")&&(Q=n+"/"+n);var O=q.views[Q]=q.views[Q]||{};if(!O[$])return O[$]=!0,q}).then(function(){return t.registerDependentDatabase($).then(function(q){var Q=q.db;Q.auto_compaction=!0;var O={name:$,db:Q,sourceDB:t,adapter:t.adapter,mapFun:r,reduceFun:i};return O.db.get("_local/lastSeq").catch(function(j){if(404!==j.status)throw j}).then(function(j){return O.seq=j?j.seq:0,M&&O.db.once("destroyed",function(){delete M[d]}),O})})})});return M&&(M[d]=A),A}Wr.prototype.add=function(t){return this.promise=this.promise.catch(function(){}).then(function(){return t()}),this.promise},Wr.prototype.finish=function(){return this.promise};var ra={},na=new Wr;function Ke(t){return-1===t.indexOf("/")?[t,t]:t.split("/")}function ia(t,n){try{t.emit("error",n)}catch(r){be("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),be("error",n)}}var hr__sum=function(t,n){return ii(n)},hr__count=function(t,n){return n.length},hr__stats=function(t,n){return{sum:ii(n),min:Math.min.apply(null,n),max:Math.max.apply(null,n),count:n.length,sumsqr:function(i){for(var o=0,u=0,d=i.length;u<d;u++){var M=i[u];o+=M*M}return o}(n)}},zr=function(t,n,r,i){function o(tt,it,ot){try{it(ot)}catch(bt){ia(tt,bt)}}function u(tt,it,ot,bt,gt){try{return{output:it(ot,bt,gt)}}catch(at){return ia(tt,at),{error:at}}}function d(tt,it){var ot=ge(tt.key,it.key);return 0!==ot?ot:ge(tt.value,it.value)}function M(tt,it,ot){return ot=ot||0,"number"==typeof it?tt.slice(ot,it+ot):ot>0?tt.slice(ot):tt}function A(tt){var it=tt.value;return it&&"object"==typeof it&&it._id||tt.id}function $(tt){return function(it){return tt.include_docs&&tt.attachments&&tt.binary&&function(tt){tt.rows.forEach(function(it){var ot=it.doc&&it.doc._attachments;!ot||Object.keys(ot).forEach(function(bt){var gt=ot[bt];ot[bt].data=er(gt.data,gt.content_type)})})}(it),it}}function _(tt,it,ot,bt){var gt=it[tt];void 0!==gt&&(bt&&(gt=encodeURIComponent(JSON.stringify(gt))),ot.push(tt+"="+gt))}function q(tt){if(void 0!==tt){var it=Number(tt);return isNaN(it)||it!==parseInt(tt,10)?tt:it}}function j(tt,it){var ot=tt.descending?"endkey":"startkey",bt=tt.descending?"startkey":"endkey";if(void 0!==tt[ot]&&void 0!==tt[bt]&&ge(tt[ot],tt[bt])>0)throw new fr("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(it.reduce&&!1!==tt.reduce){if(tt.include_docs)throw new fr("{include_docs:true} is invalid for reduce");if(tt.keys&&tt.keys.length>1&&!tt.group&&!tt.group_level)throw new fr("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(gt){var at=function(tt){if(tt){if("number"!=typeof tt)return new fr('Invalid value for integer: "'+tt+'"');if(tt<0)return new fr('Invalid value for positive integer: "'+tt+'"')}}(tt[gt]);if(at)throw at})}function Y(tt){return function(it){if(404===it.status)return tt;throw it}}function xt(tt){var it="string"==typeof tt?tt:tt.name,ot=ra[it];return ot||(ot=ra[it]=new Wr),ot}function yt(tt){return ri(xt(tt),function(){return function(tt){var it,ot;var gt=function(t,n){if("function"==typeof t&&2===t.length){var r=t;return function(i){return r(i,n)}}return ta(t.toString(),n)}(tt.mapFun,function(Nt,zt){var ue={id:ot._id,key:ir(Nt)};null!=zt&&(ue.value=ir(zt)),it.push(ue)}),at=tt.seq||0;function _t(Nt,zt){return function(){return function(tt,it,ot){var bt="_local/lastSeq";return tt.db.get(bt).catch(Y({_id:bt,seq:0})).then(function(gt){var at=ni(it);return Promise.all(at.map(function(_t){return function(tt,it,ot){var bt="_local/doc_"+tt,gt={_id:bt,keys:[]},at=ot.get(tt),_t=at[0];return(function(t){return 1===t.length&&/^1-/.test(t[0].rev)}(at[1])?Promise.resolve(gt):it.db.get(bt).catch(Y(gt))).then(function(wt){return function(wt){return wt.keys.length?it.db.allDocs({keys:wt.keys,include_docs:!0}):Promise.resolve({rows:[]})}(wt).then(function(Nt){return function(wt,Nt){for(var zt=[],ue=new mr,re=0,Vt=Nt.rows.length;re<Vt;re++){var ve=Nt.rows[re].doc;if(ve&&(zt.push(ve),ue.add(ve._id),ve._deleted=!_t.has(ve._id),!ve._deleted)){var We=_t.get(ve._id);"value"in We&&(ve.value=We.value)}}var Le=ni(_t);return Le.forEach(function(ui){if(!ue.has(ui)){var ci={_id:ui},Ho=_t.get(ui);"value"in Ho&&(ci.value=Ho.value),zt.push(ci)}}),wt.keys=Xi(Le.concat(wt.keys)),zt.push(wt),zt}(wt,Nt)})})}(_t,tt,it)})).then(function(_t){var Et=Ir(_t);return gt.seq=ot,Et.push(gt),tt.db.bulkDocs({docs:Et})})})}(tt,Nt,zt)}}var Et=new Wr;function Tt(){return tt.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:at,limit:50}).then(Lt)}function Lt(Nt){var zt=Nt.results;if(zt.length){var ue=function(Nt){for(var zt=new Oe,ue=0,re=Nt.length;ue<re;ue++){var Vt=Nt[ue];if("_"!==Vt.doc._id[0]){it=[],(ot=Vt.doc)._deleted||o(tt.sourceDB,gt,ot),it.sort(d);var ne=wt(it);zt.set(Vt.doc._id,[ne,Vt.changes])}at=Vt.seq}return zt}(zt);if(Et.add(_t(ue,at)),!(zt.length<50))return Tt()}}function wt(Nt){for(var ue,zt=new Oe,re=0,Vt=Nt.length;re<Vt;re++){var ne=Nt[re],ve=[ne.key,ne.id];re>0&&0===ge(ne.key,ue)&&ve.push(re),zt.set(Me(ve),ne),ue=ne.key}return zt}return Tt().then(function(){return Et.finish()}).then(function(){tt.seq=at})}(tt)})()}function Ct(tt,it){return ri(xt(tt),function(){return function(tt,it){var ot,bt=tt.reduceFun&&!1!==it.reduce,gt=it.skip||0;function at(re){return re.include_docs=!0,tt.db.allDocs(re).then(function(Vt){return ot=Vt.total_rows,Vt.rows.map(function(ne){if("value"in ne.doc&&"object"==typeof ne.doc.value&&null!==ne.doc.value){var ve=Object.keys(ne.doc.value).sort(),We=["id","key","value"];if(!(ve<We||ve>We))return ne.doc.value}var Le=function(t){for(var n=[],r=[],i=0;;){var o=t[i++];if("\0"!==o)switch(o){case"1":n.push(null);break;case"2":n.push("1"===t[i]),i++;break;case"3":var u=ds(t,i);n.push(u.num),i+=u.length;break;case"4":for(var d="";;){var M=t[i];if("\0"===M)break;d+=M,i++}d=d.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02"),n.push(d);break;case"5":var A={element:[],index:n.length};n.push(A.element),r.push(A);break;case"6":var L={element:{},index:n.length};n.push(L.element),r.push(L);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+o)}else{if(1===n.length)return n.pop();vs(n,r)}}}(ne.doc._id);return{key:Le[0],id:Le[1],value:"value"in ne.doc?ne.doc.value:null}})})}function _t(re){var Vt;if(Vt=bt?function(tt,it,ot){0===ot.group_level&&delete ot.group_level;var bt=ot.group||ot.group_level,gt=function(t){var n=t.toString();return function(t){if(/^_sum/.test(t))return hr__sum;if(/^_count/.test(t))return hr__count;if(/^_stats/.test(t))return hr__stats;if(/^_/.test(t))throw new Error(t+" is not a supported reduce function.")}(n)||ta(n)}(tt.reduceFun),at=[],_t=isNaN(ot.group_level)?Number.POSITIVE_INFINITY:ot.group_level;it.forEach(function(wt){var Nt=at[at.length-1],zt=bt?wt.key:null;if(bt&&Array.isArray(zt)&&(zt=zt.slice(0,_t)),Nt&&0===ge(Nt.groupKey,zt))return Nt.keys.push([wt.key,wt.id]),void Nt.values.push(wt.value);at.push({keys:[[wt.key,wt.id]],values:[wt.value],groupKey:zt})}),it=[];for(var Et=0,Tt=at.length;Et<Tt;Et++){var Lt=at[Et],Dt=u(tt.sourceDB,gt,Lt.keys,Lt.values,!1);if(Dt.error&&Dt.error instanceof gn)throw Dt.error;it.push({value:Dt.error?null:Dt.output,key:Lt.groupKey})}return{rows:M(it,ot.limit,ot.skip)}}(tt,re,it):{total_rows:ot,offset:gt,rows:re},it.update_seq&&(Vt.update_seq=tt.seq),it.include_docs){var ne=Xi(re.map(A));return tt.sourceDB.allDocs({keys:ne,include_docs:!0,conflicts:it.conflicts,attachments:it.attachments,binary:it.binary}).then(function(ve){var We=new Oe;return ve.rows.forEach(function(Le){We.set(Le.id,Le.doc)}),re.forEach(function(Le){var ui=A(Le),ci=We.get(ui);ci&&(Le.doc=ci)}),Vt})}return Vt}if(void 0!==it.keys&&!it.keys.length&&(it.limit=0,delete it.keys),void 0!==it.keys){var Tt=it.keys.map(function(re){var Vt={startkey:Me([re]),endkey:Me([re,{}])};return it.update_seq&&(Vt.update_seq=!0),at(Vt)});return Promise.all(Tt).then(Ir).then(_t)}var Dt,wt,Lt={descending:it.descending};if(it.update_seq&&(Lt.update_seq=!0),"start_key"in it&&(Dt=it.start_key),"startkey"in it&&(Dt=it.startkey),"end_key"in it&&(wt=it.end_key),"endkey"in it&&(wt=it.endkey),void 0!==Dt&&(Lt.startkey=Me(it.descending?[Dt,{}]:[Dt])),void 0!==wt){var Nt=!1!==it.inclusive_end;it.descending&&(Nt=!Nt),Lt.endkey=Me(Nt?[wt,{}]:[wt])}if(void 0!==it.key){var zt=Me([it.key]),ue=Me([it.key,{}]);Lt.descending?(Lt.endkey=zt,Lt.startkey=ue):(Lt.startkey=zt,Lt.endkey=ue)}return bt||("number"==typeof it.limit&&(Lt.limit=it.limit),Lt.skip=gt),at(Lt).then(_t)}(tt,it)})()}function Bt(tt,it,ot){if("function"==typeof tt._query)return function(tt,it,ot){return new Promise(function(bt,gt){tt._query(it,ot,function(at,_t){if(at)return gt(at);bt(_t)})})}(tt,it,ot);if(qe(tt))return function(tt,it,ot){var gt,_t,Et,bt=[],at="GET";if(_("reduce",ot,bt),_("include_docs",ot,bt),_("attachments",ot,bt),_("limit",ot,bt),_("descending",ot,bt),_("group",ot,bt),_("group_level",ot,bt),_("skip",ot,bt),_("stale",ot,bt),_("conflicts",ot,bt),_("startkey",ot,bt,!0),_("start_key",ot,bt,!0),_("endkey",ot,bt,!0),_("end_key",ot,bt,!0),_("inclusive_end",ot,bt),_("key",ot,bt,!0),_("update_seq",ot,bt),bt=""===(bt=bt.join("&"))?"":"?"+bt,void 0!==ot.keys){var Lt="keys="+encodeURIComponent(JSON.stringify(ot.keys));Lt.length+bt.length+1<=2e3?bt+=("?"===bt[0]?"&":"?")+Lt:(at="POST","string"==typeof it?gt={keys:ot.keys}:it.keys=ot.keys)}if("string"==typeof it){var Dt=Ke(it);return tt.fetch("_design/"+Dt[0]+"/_view/"+Dt[1]+bt,{headers:new Mr({"Content-Type":"application/json"}),method:at,body:JSON.stringify(gt)}).then(function(wt){return _t=wt.ok,Et=wt.status,wt.json()}).then(function(wt){if(!_t)throw wt.status=Et,_r(wt);return wt.rows.forEach(function(Nt){if(Nt.value&&Nt.value.error&&"builtin_reduce_error"===Nt.value.error)throw new Error(Nt.reason)}),wt}).then($(ot))}return gt=gt||{},Object.keys(it).forEach(function(wt){gt[wt]=Array.isArray(it[wt])?it[wt]:it[wt].toString()}),tt.fetch("_temp_view"+bt,{headers:new Mr({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(gt)}).then(function(wt){return _t=wt.ok,Et=wt.status,wt.json()}).then(function(wt){if(!_t)throw wt.status=Et,_r(wt);return wt}).then($(ot))}(tt,it,ot);if("string"!=typeof it)return j(ot,it),na.add(function(){return ea(tt,"temp_view/temp_view",it.map,it.reduce,!0,t).then(function(Tt){return function(t,n){return t.then(function(r){return n().then(function(){return r})},function(r){return n().then(function(){throw r})})}(yt(Tt).then(function(){return Ct(Tt,ot)}),function(){return Tt.db.destroy()})})}),na.finish();var bt=it,gt=Ke(bt),_t=gt[1];return tt.get("_design/"+gt[0]).then(function(Et){var Tt=Et.views&&Et.views[_t];if(!Tt)throw new pn("ddoc "+Et._id+" has no view named "+_t);return function(t,n){var r=t.views&&t.views[n];if("string"!=typeof r.map)throw new pn("ddoc "+t._id+" has no string view named "+n+", instead found object of type: "+typeof r.map)}(Et,_t),j(ot,Tt),ea(tt,bt,Tt.map,Tt.reduce,!1,t).then(function(Dt){return"ok"===ot.stale||"update_after"===ot.stale?("update_after"===ot.stale&&ke()(function(){yt(Dt)}),Ct(Dt,ot)):yt(Dt).then(function(){return Ct(Dt,ot)})})})}return{query:function(tt,it,ot){var bt=this;"function"==typeof it&&(ot=it,it={}),it=it?function(tt){return tt.group_level=q(tt.group_level),tt.limit=q(tt.limit),tt.skip=q(tt.skip),tt}(it):{},"function"==typeof tt&&(tt={map:tt});var gt=Promise.resolve().then(function(){return Bt(bt,tt,it)});return Ki(gt,ot),gt},viewCleanup:function(t){return Ae()(function(n){var r=n.pop(),i=t.apply(this,n);return"function"==typeof r&&Ki(i,r),i})}(function(){var tt=this;return"function"==typeof tt._viewCleanup?function(tt){return new Promise(function(it,ot){tt._viewCleanup(function(bt,gt){if(bt)return ot(bt);it(gt)})})}(tt):qe(tt)?function(tt){return tt.fetch("_view_cleanup",{headers:new Mr({"Content-Type":"application/json"}),method:"POST"}).then(function(it){return it.json()})}(tt):function(tt){return tt.get("_local/"+t).then(function(it){var ot=new Oe;Object.keys(it.views).forEach(function(gt){var at=Ke(gt),_t="_design/"+at[0],Et=at[1],Tt=ot.get(_t);Tt||(Tt=new mr,ot.set(_t,Tt)),Tt.add(Et)});var bt={keys:ni(ot),include_docs:!0};return tt.allDocs(bt).then(function(gt){var at={};gt.rows.forEach(function(Tt){var Lt=Tt.key.substring(8);ot.get(Tt.key).forEach(function(Dt){var wt=Lt+"/"+Dt;it.views[wt]||(wt=Dt);var Nt=Object.keys(it.views[wt]),zt=Tt.doc&&Tt.doc.views&&Tt.doc.views[Dt];Nt.forEach(function(ue){at[ue]=at[ue]||zt})})});var Et=Object.keys(at).filter(function(Tt){return!at[Tt]}).map(function(Tt){return ri(xt(Tt),function(){return new tt.constructor(Tt,tt.__opts).destroy()})()});return Promise.all(Et).then(function(){return{ok:!0}})})},Y({ok:!0}))}(tt)})}}("mrviews"),Mo={query:function(t,n,r){return zr.query.call(this,t,n,r)},viewCleanup:function(t){return zr.viewCleanup.call(this,t)}};function ua(t){return/^1-/.test(t)}function ca(t,n){var r=Object.keys(n._attachments);return Promise.all(r.map(function(i){return t.getAttachment(n._id,i,{rev:n._rev})}))}function xo(t,n,r,i){r=Mt(r);var o=[],u=!0;return Promise.resolve().then(function(){var q=Object.keys(r).filter(function(Q){var O=r[Q].missing;return 1===O.length&&ua(O[0])});if(q.length>0)return function(q){return t.allDocs({keys:q,include_docs:!0,conflicts:!0}).then(function(Q){if(i.cancelled)throw new Error("cancelled");Q.rows.forEach(function(O){O.deleted||!O.doc||!ua(O.value.rev)||function(q){return q._attachments&&Object.keys(q._attachments).length>0}(O.doc)||function(q){return q._conflicts&&q._conflicts.length>0}(O.doc)||(O.doc._conflicts&&delete O.doc._conflicts,o.push(O.doc),delete r[O.id])})})}(q)}).then(function(){var q=function(t){var n=[];return Object.keys(t).forEach(function(r){t[r].missing.forEach(function(o){n.push({id:r,rev:o})})}),{docs:n,revs:!0,latest:!0}}(r);if(q.docs.length)return t.bulkGet(q).then(function(Q){if(i.cancelled)throw new Error("cancelled");return Promise.all(Q.results.map(function(O){return Promise.all(O.docs.map(function(j){var V=j.ok;return j.error&&(u=!1),V&&V._attachments?function(t,n,r){var i=qe(n)&&!qe(t),o=Object.keys(r._attachments);return i?t.get(r._id).then(function(u){return Promise.all(o.map(function(d){return function(t,n,r){return!t._attachments||!t._attachments[r]||t._attachments[r].digest!==n._attachments[r].digest}(u,r,d)?n.getAttachment(r._id,d):t.getAttachment(u._id,d)}))}).catch(function(u){if(404!==u.status)throw u;return ca(n,r)}):ca(n,r)}(n,t,V).then(function(et){var rt=Object.keys(V._attachments);return et.forEach(function(Y,ut){var vt=V._attachments[rt[ut]];delete vt.stub,delete vt.length,vt.data=Y}),V}):V}))})).then(function(O){o=o.concat(Ir(O).filter(Boolean))})})}).then(function(){return{ok:u,docs:o}})}var ha="pouchdb";function lr(t,n,r,i,o){return t.get(n).catch(function(u){if(404===u.status)return("http"===t.adapter||"https"===t.adapter)&&xn(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:i,_id:n,history:[],replicator:ha,version:1};throw u}).then(function(u){if(!o.cancelled&&u.last_seq!==r)return u.history=(u.history||[]).filter(function(d){return d.session_id!==i}),u.history.unshift({last_seq:r,session_id:i}),u.history=u.history.slice(0,5),u.version=1,u.replicator=ha,u.session_id=i,u.last_seq=r,t.put(u).catch(function(d){if(409===d.status)return lr(t,n,r,i,o);throw d})})}function Yr(t,n,r,i,o){this.src=t,this.target=n,this.id=r,this.returnValue=i,this.opts=o||{}}Yr.prototype.writeCheckpoint=function(t,n){var r=this;return this.updateTarget(t,n).then(function(){return r.updateSource(t,n)})},Yr.prototype.updateTarget=function(t,n){return this.opts.writeTargetCheckpoint?lr(this.target,this.id,t,n,this.returnValue):Promise.resolve(!0)},Yr.prototype.updateSource=function(t,n){if(this.opts.writeSourceCheckpoint){var r=this;return lr(this.src,this.id,t,n,this.returnValue).catch(function(i){if(va(i))return r.opts.writeSourceCheckpoint=!1,!0;throw i})}return Promise.resolve(!0)};var la={undefined:function(t,n){return 0===ge(t.last_seq,n.last_seq)?n.last_seq:0},1:function(t,n){return function(t,n){return t.session_id===n.session_id?{last_seq:t.last_seq,history:t.history}:da(t.history,n.history)}(n,t).last_seq}};function da(t,n){var r=t[0],i=t.slice(1),o=n[0],u=n.slice(1);return r&&0!==n.length?si(r.session_id,n)?{last_seq:r.last_seq,history:t}:si(o.session_id,i)?{last_seq:o.last_seq,history:u}:da(i,u):{last_seq:0,history:[]}}function si(t,n){var r=n[0],i=n.slice(1);return!(!t||0===n.length)&&(t===r.session_id||si(t,i))}function va(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function f(t,n,r,i,o){var d,Y,u=[],M={seq:0,changes:[],docs:[]},A=!1,L=!1,$=!1,_=0,q=r.continuous||r.live||!1,Q=r.batch_size||100,O=r.batches_limit||10,j=!1,V=r.doc_ids,et=r.selector,ut=[],vt=an();o=o||{ok:!0,start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var xt={};function yt(){return Y?Promise.resolve():function(t,n,r){var i=r.doc_ids?r.doc_ids.sort(ge):"",o=r.filter?r.filter.toString():"",u="",d="",M="";return r.selector&&(M=JSON.stringify(r.selector)),r.filter&&r.query_params&&(u=JSON.stringify(function(t){return Object.keys(t).sort(ge).reduce(function(n,r){return n[r]=t[r],n},{})}(r.query_params))),r.filter&&"_view"===r.filter&&(d=r.view.toString()),Promise.all([t.id(),n.id()]).then(function(A){var L=A[0]+A[1]+o+d+u+i+M;return new Promise(function($){nn(L,$)})}).then(function(A){return"_local/"+A.replace(/\//g,".").replace(/\+/g,"_")})}(t,n,r).then(function(at){Y=new Yr(t,n,at,i,!1===r.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===r.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===r.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0})})}function At(){if(ut=[],0!==d.docs.length){var at=d.docs;return n.bulkDocs({docs:at,new_edits:!1},{timeout:r.timeout}).then(function(Et){if(i.cancelled)throw qt(),new Error("cancelled");var Tt=Object.create(null);Et.forEach(function(Dt){Dt.error&&(Tt[Dt.id]=Dt)});var Lt=Object.keys(Tt).length;o.doc_write_failures+=Lt,o.docs_written+=at.length-Lt,at.forEach(function(Dt){var wt=Tt[Dt._id];if(wt){o.errors.push(wt);var Nt=(wt.name||"").toLowerCase();if("unauthorized"!==Nt&&"forbidden"!==Nt)throw wt;i.emit("denied",Mt(wt))}else ut.push(Dt)})},function(Et){throw o.doc_write_failures+=at.length,Et})}}function It(){if(d.error)throw new Error("There was a problem getting docs.");o.last_seq=_=d.seq;var at=Mt(o);return ut.length&&(at.docs=ut,"number"==typeof d.pending&&(at.pending=d.pending,delete d.pending),i.emit("change",at)),A=!0,Y.writeCheckpoint(d.seq,vt).then(function(){if(A=!1,i.cancelled)throw qt(),new Error("cancelled");d=void 0,ot()}).catch(function(_t){throw gt(_t),_t})}function Ut(){return xo(t,n,d.diffs,i).then(function(at){d.error=!at.ok,at.docs.forEach(function(_t){delete d.diffs[_t._id],o.docs_read++,d.docs.push(_t)})})}function Wt(){if(!i.cancelled&&!d){if(0===u.length)return void Zt(!0);d=u.shift(),(at={},d.changes.forEach(function(_t){"_user/"!==_t.id&&(at[_t.id]=_t.changes.map(function(Et){return Et.rev}))}),n.revsDiff(at).then(function(_t){if(i.cancelled)throw qt(),new Error("cancelled");d.diffs=_t})).then(Ut).then(At).then(It).then(Wt).catch(function(at){Bt("batch processing terminated with error",at)})}var at}function Zt(at){0!==M.changes.length?(at||L||M.changes.length>=Q)&&(u.push(M),M={seq:0,changes:[],docs:[]},("pending"===i.state||"stopped"===i.state)&&(i.state="active",i.emit("active")),Wt()):0===u.length&&!d&&((q&&xt.live||L)&&(i.state="pending",i.emit("paused")),L&&qt())}function Bt(at,_t){$||(_t.message||(_t.message=at),o.ok=!1,o.status="aborting",u=[],M={seq:0,changes:[],docs:[]},qt(_t))}function qt(at){if(!($||i.cancelled&&(o.status="cancelled",A)))if(o.status=o.status||"complete",o.end_time=(new Date).toISOString(),o.last_seq=_,$=!0,at){(at=jt(at)).result=o;var _t=(at.name||"").toLowerCase();"unauthorized"===_t||"forbidden"===_t?(i.emit("error",at),i.removeAllListeners()):function(t,n,r,i){if(!1===t.retry)return n.emit("error",r),void n.removeAllListeners();if("function"!=typeof t.back_off_function&&(t.back_off_function=Da),n.emit("requestError",r),"active"===n.state||"pending"===n.state){n.emit("paused",r),n.state="stopped";var o=function(){t.current_back_off=0};n.once("paused",function(){n.removeListener("active",o)}),n.once("active",o)}t.current_back_off=t.current_back_off||0,t.current_back_off=t.back_off_function(t.current_back_off),setTimeout(i,t.current_back_off)}(r,i,at,function(){f(t,n,r,i)})}else i.emit("complete",o),i.removeAllListeners()}function Yt(at,_t,Et){if(i.cancelled)return qt();"number"==typeof _t&&(M.pending=_t),!Tn(r)(at)||(M.seq=at.seq||Et,M.changes.push(at),ke()(function(){Zt(0===u.length&&xt.live)}))}function tt(at){if(j=!1,i.cancelled)return qt();if(at.results.length>0)xt.since=at.results[at.results.length-1].seq,ot(),Zt(!0);else{var _t=function(){q?(xt.live=!0,ot()):L=!0,Zt(!0)};d||0!==at.results.length?_t():(A=!0,Y.writeCheckpoint(at.last_seq,vt).then(function(){A=!1,o.last_seq=_=at.last_seq,_t()}).catch(gt))}}function it(at){if(j=!1,i.cancelled)return qt();Bt("changes rejected",at)}function ot(){if(!j&&!L&&u.length<O){j=!0,i._changes&&(i.removeListener("cancel",i._abortChanges),i._changes.cancel()),i.once("cancel",at);var Et=t.changes(xt).on("change",Yt);Et.then(_t,_t),Et.then(tt).catch(it),r.retry&&(i._changes=Et,i._abortChanges=at)}function at(){Et.cancel()}function _t(){i.removeListener("cancel",at)}}function bt(){yt().then(function(){if(!i.cancelled)return Y.getCheckpoint().then(function(at){xt={since:_=at,limit:Q,batch_size:Q,style:"all_docs",doc_ids:V,selector:et,return_docs:!0},r.filter&&("string"!=typeof r.filter?xt.include_docs=!0:xt.filter=r.filter),"heartbeat"in r&&(xt.heartbeat=r.heartbeat),"timeout"in r&&(xt.timeout=r.timeout),r.query_params&&(xt.query_params=r.query_params),r.view&&(xt.view=r.view),ot()});qt()}).catch(function(at){Bt("getCheckpoint rejected with ",at)})}function gt(at){A=!1,Bt("writeCheckpoint completed with error",at)}i.ready(t,n),i.cancelled?qt():(i._addedListeners||(i.once("cancel",qt),"function"==typeof r.complete&&(i.once("error",r.complete),i.once("complete",function(at){r.complete(null,at)})),i._addedListeners=!0),void 0===r.since?bt():yt().then(function(){return A=!0,Y.writeCheckpoint(r.since,vt)}).then(function(){A=!1,i.cancelled?qt():(_=r.since,bt())}).catch(gt))}function c(){_e().call(this),this.cancelled=!1,this.state="pending";var t=this,n=new Promise(function(r,i){t.once("complete",r),t.once("error",i)});t.then=function(r,i){return n.then(r,i)},t.catch=function(r){return n.catch(r)},t.catch(function(){})}function v(t,n){return"string"==typeof t?new(0,n.PouchConstructor)(t,n):t}function g(t,n,r,i){if("function"==typeof r&&(i=r,r={}),void 0===r&&(r={}),r.doc_ids&&!Array.isArray(r.doc_ids))throw jt(Xr,"`doc_ids` filter parameter is not a list.");r.complete=i,(r=Mt(r)).continuous=r.continuous||r.live,r.retry="retry"in r&&r.retry,r.PouchConstructor=r.PouchConstructor||this;var o=new c(r);return f(v(t,r),v(n,r),r,o),o}function l(t,n,r,i){return"function"==typeof r&&(i=r,r={}),void 0===r&&(r={}),(r=Mt(r)).PouchConstructor=r.PouchConstructor||this,new S(t=v(t,r),n=v(n,r),r,i)}function S(t,n,r,i){var o=this;this.canceled=!1;var u=r.push?Rt({},r,r.push):r,d=r.pull?Rt({},r,r.pull):r;function M(Y){o.emit("change",{direction:"pull",change:Y})}function A(Y){o.emit("change",{direction:"push",change:Y})}function L(Y){o.emit("denied",{direction:"push",doc:Y})}function $(Y){o.emit("denied",{direction:"pull",doc:Y})}function _(){o.pushPaused=!0,o.pullPaused&&o.emit("paused")}function q(){o.pullPaused=!0,o.pushPaused&&o.emit("paused")}function Q(){o.pushPaused=!1,o.pullPaused&&o.emit("active",{direction:"push"})}function O(){o.pullPaused=!1,o.pushPaused&&o.emit("active",{direction:"pull"})}this.push=g(t,n,u),this.pull=g(n,t,d),this.pushPaused=!0,this.pullPaused=!0;var j={};function V(Y){return function(ut,vt){("change"===ut&&(vt===M||vt===A)||"denied"===ut&&(vt===$||vt===L)||"paused"===ut&&(vt===q||vt===_)||"active"===ut&&(vt===O||vt===Q))&&(ut in j||(j[ut]={}),j[ut][Y]=!0,2===Object.keys(j[ut]).length&&o.removeAllListeners(ut))}}function et(Y,ut,vt){-1==Y.listeners(ut).indexOf(vt)&&Y.on(ut,vt)}r.live&&(this.push.on("complete",o.pull.cancel.bind(o.pull)),this.pull.on("complete",o.push.cancel.bind(o.push))),this.on("newListener",function(Y){"change"===Y?(et(o.pull,"change",M),et(o.push,"change",A)):"denied"===Y?(et(o.pull,"denied",$),et(o.push,"denied",L)):"active"===Y?(et(o.pull,"active",O),et(o.push,"active",Q)):"paused"===Y&&(et(o.pull,"paused",q),et(o.push,"paused",_))}),this.on("removeListener",function(Y){"change"===Y?(o.pull.removeListener("change",M),o.push.removeListener("change",A)):"denied"===Y?(o.pull.removeListener("denied",$),o.push.removeListener("denied",L)):"active"===Y?(o.pull.removeListener("active",O),o.push.removeListener("active",Q)):"paused"===Y&&(o.pull.removeListener("paused",q),o.push.removeListener("paused",_))}),this.pull.on("removeListener",V("pull")),this.push.on("removeListener",V("push"));var rt=Promise.all([this.push,this.pull]).then(function(Y){var ut={push:Y[0],pull:Y[1]};return o.emit("complete",ut),i&&i(null,ut),o.removeAllListeners(),ut},function(Y){if(o.cancel(),i?i(Y):o.emit("error",Y),o.removeAllListeners(),i)throw Y});this.then=function(Y,ut){return rt.then(Y,ut)},this.catch=function(Y){return rt.catch(Y)}}Yr.prototype.getCheckpoint=function(){var t=this;return t.opts&&t.opts.writeSourceCheckpoint&&!t.opts.writeTargetCheckpoint?t.src.get(t.id).then(function(n){return n.last_seq||0}).catch(function(n){if(404!==n.status)throw n;return 0}):t.target.get(t.id).then(function(n){return t.opts&&t.opts.writeTargetCheckpoint&&!t.opts.writeSourceCheckpoint?n.last_seq||0:t.src.get(t.id).then(function(r){return n.version!==r.version?0:(i=n.version?n.version.toString():"undefined")in la?la[i](n,r):0;var i},function(r){if(404===r.status&&n.last_seq)return t.src.put({_id:t.id,last_seq:0}).then(function(){return 0},function(i){return va(i)?(t.opts.writeSourceCheckpoint=!1,n.last_seq):0});throw r})}).catch(function(n){if(404!==n.status)throw n;return 0})},Ee()(c,_e()),c.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},c.prototype.ready=function(t,n){var r=this;function i(){r.cancel()}r._readyCalled||(r._readyCalled=!0,t.once("destroyed",i),n.once("destroyed",i),r.once("complete",function(){t.removeListener("destroyed",i),n.removeListener("destroyed",i)}))},Ee()(S,_e()),S.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},Gt.plugin(function(t){t.adapter("idb",$i,!0)}).plugin(function(t){t.adapter("http",ei,!1),t.adapter("https",ei,!1)}).plugin(Mo).plugin(function(t){t.replicate=g,t.sync=l,Object.defineProperty(t.prototype,"replicate",{get:function(){var n=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(r,i,o){return n.constructor.replicate(r,n,i,o)},to:function(r,i,o){return n.constructor.replicate(n,r,i,o)}}),this.replicateMethods}}),t.prototype.sync=function(n,r,i){return this.constructor.sync(this,n,r,i)}});const X=Gt;let z=(()=>{class t{constructor(){this.db=new X("stations")}getStations(){return K(this,void 0,void 0,function*(){return(yield this.db.allDocs({include_docs:!0})).rows.map(i=>i.doc)})}getStation(r){return K(this,void 0,void 0,function*(){try{return yield this.db.get(r)}catch(i){return null}})}addUpdateStation(r){return K(this,void 0,void 0,function*(){return yield this.db.put(r),yield this.db.get(r._id)})}deleteStation(r){return K(this,void 0,void 0,function*(){return yield this.db.remove(r),r._rev="",r})}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=h.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),st=(()=>{class t{constructor(r){this.stationStorageService=r,this.stationCreated=new Or.xQ,this.stationUpdated=new Or.xQ,this.stationDeleted=new Or.xQ}getStationCreated(){return this.stationCreated.asObservable()}getStationUpdated(){return this.stationUpdated.asObservable()}getStationDeleted(){return this.stationDeleted.asObservable()}getStations(){return K(this,void 0,void 0,function*(){return this.stations||(this.stations=yield this.stationStorageService.getStations()),this.stations})}getStation(r){return K(this,void 0,void 0,function*(){return yield this.stationStorageService.getStation(r)})}createStation(r){return K(this,void 0,void 0,function*(){const i=yield this.stationStorageService.addUpdateStation(r);this.stationCreated.next(i)})}updateStation(r){return K(this,void 0,void 0,function*(){const i=yield this.stationStorageService.addUpdateStation(r);this.stationUpdated.next(i)})}deleteStation(r){return K(this,void 0,void 0,function*(){const i=yield this.stationStorageService.deleteStation(r);this.stationDeleted.next(i)})}}return t.\u0275fac=function(r){return new(r||t)(h.LFG(z))},t.\u0275prov=h.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var ft=I(5529),dt=I(7453);function lt(t,n){if(n.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+n.length+" present")}function mt(t){lt(1,arguments);var n=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===n?new Date(t.getTime()):"number"==typeof t||"[object Number]"===n?new Date(t):(("string"==typeof t||"[object String]"===n)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function Pt(t){lt(1,arguments);var n=mt(t);return!isNaN(n)}var Ft={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function $t(t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width?String(n.width):t.defaultWidth,i=t.formats[r]||t.formats[t.defaultWidth];return i}}var t,he={date:$t({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:$t({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:$t({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},dr={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Xe(t){return function(n,r){var u,i=r||{};if("formatting"===(i.context?String(i.context):"standalone")&&t.formattingValues){var d=t.defaultFormattingWidth||t.defaultWidth,M=i.width?String(i.width):d;u=t.formattingValues[M]||t.formattingValues[d]}else{var A=t.defaultWidth,L=i.width?String(i.width):t.defaultWidth;u=t.values[L]||t.values[A]}return u[t.argumentCallback?t.argumentCallback(n):n]}}function oi(t){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.width,o=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],u=n.match(o);if(!u)return null;var L,d=u[0],M=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],A=Array.isArray(M)?ou(M,function(_){return _.test(d)}):su(M,function(_){return _.test(d)});L=t.valueCallback?t.valueCallback(A):A,L=r.valueCallback?r.valueCallback(L):L;var $=n.slice(d.length);return{value:L,rest:$}}}function su(t,n){for(var r in t)if(t.hasOwnProperty(r)&&n(t[r]))return r}function ou(t,n){for(var r=0;r<t.length;r++)if(n(t[r]))return r}const bu={code:"en-US",formatDistance:function(t,n,r){var i;return r=r||{},i="string"==typeof Ft[t]?Ft[t]:1===n?Ft[t].one:Ft[t].other.replace("{{count}}",n),r.addSuffix?r.comparison>0?"in "+i:i+" ago":i},formatLong:he,formatRelative:function(t,n,r,i){return dr[t]},localize:{ordinalNumber:function(t,n){var r=Number(t),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:Xe({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Xe({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(t){return Number(t)-1}}),month:Xe({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Xe({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Xe({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(t={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(t){return parseInt(t,10)}},function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.match(t.matchPattern);if(!i)return null;var o=i[0],u=n.match(t.parsePattern);if(!u)return null;var d=t.valueCallback?t.valueCallback(u[0]):u[0];d=r.valueCallback?r.valueCallback(d):d;var M=n.slice(o.length);return{value:d,rest:M}}),era:oi({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:oi({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:oi({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:oi({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:oi({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function pe(t){if(null===t||!0===t||!1===t)return NaN;var n=Number(t);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}function Su(t,n){lt(2,arguments);var r=mt(t).getTime(),i=pe(n);return new Date(r+i)}function xu(t,n){lt(2,arguments);var r=pe(n);return Su(t,-r)}function ae(t,n){for(var r=t<0?"-":"",i=Math.abs(t).toString();i.length<n;)i="0"+i;return r+i}const Ar_y=function(t,n){var r=t.getUTCFullYear(),i=r>0?r:1-r;return ae("yy"===n?i%100:i,n.length)},Ar_M=function(t,n){var r=t.getUTCMonth();return"M"===n?String(r+1):ae(r+1,2)},Ar_d=function(t,n){return ae(t.getUTCDate(),n.length)},Ar_h=function(t,n){return ae(t.getUTCHours()%12||12,n.length)},Ar_H=function(t,n){return ae(t.getUTCHours(),n.length)},Ar_m=function(t,n){return ae(t.getUTCMinutes(),n.length)},Ar_s=function(t,n){return ae(t.getUTCSeconds(),n.length)},Ar_S=function(t,n){var r=n.length,i=t.getUTCMilliseconds();return ae(Math.floor(i*Math.pow(10,r-3)),n.length)};function pa(t){lt(1,arguments);var n=1,r=mt(t),i=r.getUTCDay(),o=(i<n?7:0)+i-n;return r.setUTCDate(r.getUTCDate()-o),r.setUTCHours(0,0,0,0),r}function Uo(t){lt(1,arguments);var n=mt(t),r=n.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(r+1,0,4),i.setUTCHours(0,0,0,0);var o=pa(i),u=new Date(0);u.setUTCFullYear(r,0,4),u.setUTCHours(0,0,0,0);var d=pa(u);return n.getTime()>=o.getTime()?r+1:n.getTime()>=d.getTime()?r:r-1}function Eu(t){lt(1,arguments);var n=Uo(t),r=new Date(0);r.setUTCFullYear(n,0,4),r.setUTCHours(0,0,0,0);var i=pa(r);return i}var Tu=6048e5;function ga(t,n){lt(1,arguments);var r=n||{},i=r.locale,o=i&&i.options&&i.options.weekStartsOn,u=null==o?0:pe(o),d=null==r.weekStartsOn?u:pe(r.weekStartsOn);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var M=mt(t),A=M.getUTCDay(),L=(A<d?7:0)+A-d;return M.setUTCDate(M.getUTCDate()-L),M.setUTCHours(0,0,0,0),M}function Bo(t,n){lt(1,arguments);var r=mt(t,n),i=r.getUTCFullYear(),o=n||{},u=o.locale,d=u&&u.options&&u.options.firstWeekContainsDate,M=null==d?1:pe(d),A=null==o.firstWeekContainsDate?M:pe(o.firstWeekContainsDate);if(!(A>=1&&A<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var L=new Date(0);L.setUTCFullYear(i+1,0,A),L.setUTCHours(0,0,0,0);var $=ga(L,n),_=new Date(0);_.setUTCFullYear(i,0,A),_.setUTCHours(0,0,0,0);var q=ga(_,n);return r.getTime()>=$.getTime()?i+1:r.getTime()>=q.getTime()?i:i-1}function Du(t,n){lt(1,arguments);var r=n||{},i=r.locale,o=i&&i.options&&i.options.firstWeekContainsDate,u=null==o?1:pe(o),d=null==r.firstWeekContainsDate?u:pe(r.firstWeekContainsDate),M=Bo(t,n),A=new Date(0);A.setUTCFullYear(M,0,d),A.setUTCHours(0,0,0,0);var L=ga(A,n);return L}var Iu=6048e5;function Fo(t,n){var r=t>0?"-":"+",i=Math.abs(t),o=Math.floor(i/60),u=i%60;if(0===u)return r+String(o);var d=n||"";return r+String(o)+d+ae(u,2)}function jo(t,n){return t%60==0?(t>0?"-":"+")+ae(Math.abs(t)/60,2):Jr(t,n)}function Jr(t,n){var r=n||"",i=t>0?"-":"+",o=Math.abs(t);return i+ae(Math.floor(o/60),2)+r+ae(o%60,2)}const Ru={G:function(t,n,r){var i=t.getUTCFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(t,n,r){if("yo"===n){var i=t.getUTCFullYear();return r.ordinalNumber(i>0?i:1-i,{unit:"year"})}return Ar_y(t,n)},Y:function(t,n,r,i){var o=Bo(t,i),u=o>0?o:1-o;return"YY"===n?ae(u%100,2):"Yo"===n?r.ordinalNumber(u,{unit:"year"}):ae(u,n.length)},R:function(t,n){return ae(Uo(t),n.length)},u:function(t,n){return ae(t.getUTCFullYear(),n.length)},Q:function(t,n,r){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(n){case"Q":return String(i);case"QQ":return ae(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,n,r){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(n){case"q":return String(i);case"qq":return ae(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,n,r){var i=t.getUTCMonth();switch(n){case"M":case"MM":return Ar_M(t,n);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(t,n,r){var i=t.getUTCMonth();switch(n){case"L":return String(i+1);case"LL":return ae(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(t,n,r,i){var o=function(t,n){lt(1,arguments);var r=mt(t),i=ga(r,n).getTime()-Du(r,n).getTime();return Math.round(i/Iu)+1}(t,i);return"wo"===n?r.ordinalNumber(o,{unit:"week"}):ae(o,n.length)},I:function(t,n,r){var i=function(t){lt(1,arguments);var n=mt(t),r=pa(n).getTime()-Eu(n).getTime();return Math.round(r/Tu)+1}(t);return"Io"===n?r.ordinalNumber(i,{unit:"week"}):ae(i,n.length)},d:function(t,n,r){return"do"===n?r.ordinalNumber(t.getUTCDate(),{unit:"date"}):Ar_d(t,n)},D:function(t,n,r){var i=function(t){lt(1,arguments);var n=mt(t),r=n.getTime();n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0);var i=n.getTime();return Math.floor((r-i)/864e5)+1}(t);return"Do"===n?r.ordinalNumber(i,{unit:"dayOfYear"}):ae(i,n.length)},E:function(t,n,r){var i=t.getUTCDay();switch(n){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(t,n,r,i){var o=t.getUTCDay(),u=(o-i.weekStartsOn+8)%7||7;switch(n){case"e":return String(u);case"ee":return ae(u,2);case"eo":return r.ordinalNumber(u,{unit:"day"});case"eee":return r.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(o,{width:"short",context:"formatting"});case"eeee":default:return r.day(o,{width:"wide",context:"formatting"})}},c:function(t,n,r,i){var o=t.getUTCDay(),u=(o-i.weekStartsOn+8)%7||7;switch(n){case"c":return String(u);case"cc":return ae(u,n.length);case"co":return r.ordinalNumber(u,{unit:"day"});case"ccc":return r.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(o,{width:"narrow",context:"standalone"});case"cccccc":return r.day(o,{width:"short",context:"standalone"});case"cccc":default:return r.day(o,{width:"wide",context:"standalone"})}},i:function(t,n,r){var i=t.getUTCDay(),o=0===i?7:i;switch(n){case"i":return String(o);case"ii":return ae(o,n.length);case"io":return r.ordinalNumber(o,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(t,n,r){var o=t.getUTCHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,n,r){var o,i=t.getUTCHours();switch(o=12===i?"noon":0===i?"midnight":i/12>=1?"pm":"am",n){case"b":case"bb":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,n,r){var o,i=t.getUTCHours();switch(o=i>=17?"evening":i>=12?"afternoon":i>=4?"morning":"night",n){case"B":case"BB":case"BBB":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,n,r){if("ho"===n){var i=t.getUTCHours()%12;return 0===i&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return Ar_h(t,n)},H:function(t,n,r){return"Ho"===n?r.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Ar_H(t,n)},K:function(t,n,r){var i=t.getUTCHours()%12;return"Ko"===n?r.ordinalNumber(i,{unit:"hour"}):ae(i,n.length)},k:function(t,n,r){var i=t.getUTCHours();return 0===i&&(i=24),"ko"===n?r.ordinalNumber(i,{unit:"hour"}):ae(i,n.length)},m:function(t,n,r){return"mo"===n?r.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Ar_m(t,n)},s:function(t,n,r){return"so"===n?r.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Ar_s(t,n)},S:function(t,n){return Ar_S(t,n)},X:function(t,n,r,i){var u=(i._originalDate||t).getTimezoneOffset();if(0===u)return"Z";switch(n){case"X":return jo(u);case"XXXX":case"XX":return Jr(u);case"XXXXX":case"XXX":default:return Jr(u,":")}},x:function(t,n,r,i){var u=(i._originalDate||t).getTimezoneOffset();switch(n){case"x":return jo(u);case"xxxx":case"xx":return Jr(u);case"xxxxx":case"xxx":default:return Jr(u,":")}},O:function(t,n,r,i){var u=(i._originalDate||t).getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Fo(u,":");case"OOOO":default:return"GMT"+Jr(u,":")}},z:function(t,n,r,i){var u=(i._originalDate||t).getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Fo(u,":");case"zzzz":default:return"GMT"+Jr(u,":")}},t:function(t,n,r,i){return ae(Math.floor((i._originalDate||t).getTime()/1e3),n.length)},T:function(t,n,r,i){return ae((i._originalDate||t).getTime(),n.length)}};function Go(t,n){switch(t){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}}function Zo(t,n){switch(t){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}}const Uu={p:Zo,P:function(t,n){var u,r=t.match(/(P+)(p+)?/),i=r[1],o=r[2];if(!o)return Go(t,n);switch(i){case"P":u=n.dateTime({width:"short"});break;case"PP":u=n.dateTime({width:"medium"});break;case"PPP":u=n.dateTime({width:"long"});break;case"PPPP":default:u=n.dateTime({width:"full"})}return u.replace("{{date}}",Go(i,n)).replace("{{time}}",Zo(o,n))}};function Bu(t){var n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),t.getTime()-n.getTime()}var Fu=["D","DD"],ju=["YY","YYYY"];function Gu(t){return-1!==Fu.indexOf(t)}function Zu(t){return-1!==ju.indexOf(t)}function Wo(t,n,r){if("YYYY"===t)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(n,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if("YY"===t)throw new RangeError("Use `yy` instead of `YY` (in `".concat(n,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if("D"===t)throw new RangeError("Use `d` instead of `D` (in `".concat(n,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"));if("DD"===t)throw new RangeError("Use `dd` instead of `DD` (in `".concat(n,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"))}var Wu=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Qu=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zu=/^'([^]*?)'?$/,Yu=/''/g,Ju=/[a-zA-Z]/;function Eo(t,n,r){lt(2,arguments);var i=String(n),o=r||{},u=o.locale||bu,d=u.options&&u.options.firstWeekContainsDate,M=null==d?1:pe(d),A=null==o.firstWeekContainsDate?M:pe(o.firstWeekContainsDate);if(!(A>=1&&A<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var L=u.options&&u.options.weekStartsOn,$=null==L?0:pe(L),_=null==o.weekStartsOn?$:pe(o.weekStartsOn);if(!(_>=0&&_<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!u.localize)throw new RangeError("locale must contain localize property");if(!u.formatLong)throw new RangeError("locale must contain formatLong property");var q=mt(t);if(!Pt(q))throw new RangeError("Invalid time value");var Q=Bu(q),O=xu(q,Q),j={firstWeekContainsDate:A,weekStartsOn:_,locale:u,_originalDate:q},V=i.match(Qu).map(function(et){var rt=et[0];return"p"===rt||"P"===rt?(0,Uu[rt])(et,u.formatLong,j):et}).join("").match(Wu).map(function(et){if("''"===et)return"'";var rt=et[0];if("'"===rt)return $u(et);var Y=Ru[rt];if(Y)return!o.useAdditionalWeekYearTokens&&Zu(et)&&Wo(et,n,t),!o.useAdditionalDayOfYearTokens&&Gu(et)&&Wo(et,n,t),Y(O,et,u.localize,j);if(rt.match(Ju))throw new RangeError("Format string contains an unescaped latin alphabet character `"+rt+"`");return et}).join("");return V}function $u(t){return t.match(zu)[1].replace(Yu,"'")}function Hu(t,n){lt(2,arguments);var r=mt(t),i=pe(n);return isNaN(i)?new Date(NaN):(i&&r.setDate(r.getDate()+i),r)}function Ku(t,n){lt(2,arguments);var r=mt(t),i=pe(n);if(isNaN(i))return new Date(NaN);if(!i)return r;var o=r.getDate(),u=new Date(r.getTime());u.setMonth(r.getMonth()+i+1,0);var d=u.getDate();return o>=d?u:(r.setFullYear(u.getFullYear(),u.getMonth(),o),r)}function Qo(t,n){lt(2,arguments);var r=mt(t),i=mt(n);return r.getTime()-i.getTime()}let To=(()=>{class t{constructor(){}getSecondsElapsed(r){return function(t,n){lt(2,arguments);var r=Qo(t,n)/1e3;return r>0?Math.floor(r):Math.ceil(r)}(new Date,r)}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=h.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var zo=I(5417);class rc{constructor(){this.departureCount=5}}class nc{}let Po=(()=>{class t{constructor(){}getStations(r){return K(this,void 0,void 0,function*(){try{return(yield zo.findStop(r)).map(o=>{const u=new rc;return u._id=o.id,u.name=o.name,u.city=o.city,u})}catch(i){return[]}})}getDepartures(r,i=0){return K(this,void 0,void 0,function*(){try{return(yield zo.monitor(r._id,i,r.departureCount)).map(u=>{const d=new nc;return d.line=u.line,d.destination=u.direction,d.arrival=u.arrivalTime,d.relativeArrival=u.arrivalTimeRelative,d.relativeDelay=u.delayTime,d.hasLiveData="Unknown"!==u.state,d.isCancelled="Cancelled"===u.state,d.platformType=u.platform.type,d.platformName=u.platform.name,d.modeIconUrl=u.mode.iconUrl,d})}catch(o){return[]}})}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=h.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ic(t,n){1&t&&(h.TgZ(0,"ion-text",4),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&t&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"shared.inputs.restraints.station"),""))}function ac(t,n){if(1&t){const r=h.EpF();h.TgZ(0,"ion-item",5),h.NdJ("click",function(){const u=h.CHM(r).$implicit;return h.oxw().onSelect(u)}),h.TgZ(1,"ion-label"),h.TgZ(2,"h2"),h._uU(3),h.qZA(),h.TgZ(4,"ion-card-subtitle"),h._uU(5),h.qZA(),h.qZA(),h.qZA()}if(2&t){const r=n.$implicit;h.xp6(3),h.Oqu(r.name),h.xp6(2),h.Oqu(r.city)}}let sc=(()=>{class t{constructor(r){this.apiService=r,this.stationSelected=new h.vpe}ngOnInit(){this.stationName=new P.NI(this.combinedStationName(),[P.kI.required])}combinedStationName(){return this.selectedStation?this.selectedStation.name+", "+this.selectedStation.city:""}onInput(r){return K(this,void 0,void 0,function*(){const i=r.target.value;this.selectedStation&&i!==this.combinedStationName()&&(this.selectedStation=null,this.stationSelected.emit(null)),this.matchingStations=i?(yield this.apiService.getStations(i)).slice(0,4):[]})}onSelect(r){this.selectedStation=r,this.stationName.setValue(this.combinedStationName()),this.matchingStations=[],this.stationSelected.emit(r)}}return t.\u0275fac=function(r){return new(r||t)(h.Y36(Po))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-station-picker"]],outputs:{stationSelected:"stationSelected"},decls:8,vars:6,consts:[["position","floating"],["type","text",3,"formControl","ionInput"],["color","danger",4,"ngIf"],["button","",3,"click",4,"ngFor","ngForOf"],["color","danger"],["button","",3,"click"]],template:function(r,i){1&r&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",0),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-input",1),h.NdJ("ionInput",function(u){return i.onInput(u)}),h.qZA(),h.qZA(),h.YNc(5,ic,3,3,"ion-text",2),h.TgZ(6,"ion-list"),h.YNc(7,ac,6,2,"ion-item",3),h.qZA()),2&r&&(h.xp6(2),h.Oqu(h.lcZ(3,4,"shared.inputs.station")),h.xp6(2),h.Q6J("formControl",i.stationName),h.xp6(1),h.Q6J("ngIf",!i.selectedStation&&(i.stationName.dirty||i.stationName.touched)),h.xp6(2),h.Q6J("ngForOf",i.matchingStations))},directives:[T.Ie,T.Q$,T.pK,T.j9,P.JJ,P.oH,J.O5,T.q_,J.sg,T.yW,T.tO],pipes:[ft.X$],styles:[""]}),t})();const oc=function(t){return{clickable:t}};let Yo=(()=>{class t{constructor(r){this.helperService=r,this.elapsed=new h.vpe,this.value=0}ngOnInit(){this.updateInterval=setInterval(()=>{this.compute()},500)}compute(){this.update&&(this.value=this.helperService.getSecondsElapsed(this.start),this.value>0&&this.value%this.interval==0&&this.elapsed.emit())}}return t.\u0275fac=function(r){return new(r||t)(h.Y36(To))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-timer"]],inputs:{start:"start",interval:"interval",update:"update",clickable:"clickable"},outputs:{elapsed:"elapsed"},decls:5,vars:6,consts:[["lines","none",3,"ngClass"],["name","timer-outline",3,"color"],[3,"color"]],template:function(r,i){1&r&&(h.TgZ(0,"ion-item",0),h._UZ(1,"ion-icon",1),h._uU(2," \xa0 "),h.TgZ(3,"ion-text",2),h._uU(4),h.qZA(),h.qZA()),2&r&&(h.Q6J("ngClass",h.VKq(4,oc,i.clickable)),h.xp6(1),h.Q6J("color",i.clickable?"":"medium"),h.xp6(2),h.Q6J("color",i.clickable?"":"medium"),h.xp6(1),h.hij("",i.value>99?">99":i.value,"s"))},directives:[T.Ie,J.mk,T.gu,T.yW],styles:[""]}),t})(),uc=(()=>{class t{constructor(r){this.translateService=r}getDepartureTime(r){if(0===r.relativeArrival)return this.translateService.instant("departures.arrival-times.now");if(r.relativeArrival<0)return this.translateService.instant("departures.arrival-times.min-ago",{count:Math.abs(r.relativeArrival)});if(r.relativeArrival>30){const i=r.arrival.getHours(),o=r.arrival.getMinutes();return o<10?i+":0"+o:i+":"+o}return this.translateService.instant("departures.arrival-times.min",{count:r.relativeArrival})}getDelay(r){return r.isCancelled?this.translateService.instant("departures.delays.cancelled"):0===r.relativeDelay?this.translateService.instant("departures.delays.on-time"):r.relativeDelay<0?this.translateService.instant("departures.delays.early",{count:Math.abs(r.relativeDelay)}):this.translateService.instant("departures.delays.late",{count:r.relativeDelay})}}return t.\u0275fac=function(r){return new(r||t)(h.LFG(ft.sK))},t.\u0275prov=h.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),cc=(()=>{class t{getDelayColor(r,i,o){switch(!0){case r<0:return"color-departed";case o:return"color-cancelled";case i<-2:return"color-early";case i<0:return"color-slightly-early";case 0===i:return"color-on-time";case i<3:return"color-slightly-late";case i<5:return"color-late";default:return"color-very-late"}}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=h.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function fc(t,n){if(1&t&&(h.TgZ(0,"h3"),h._uU(1),h.qZA()),2&t){const r=h.oxw();h.Tol(r.delayColor),h.xp6(1),h.hij(" ",r.delay," ")}}const hc=function(t){return{"filter-grayscale":t}},lc=function(t,n){return{"color-departed":t,strikethrough:n}},dc=function(t){return{"color-departed":t}};let vc=(()=>{class t{constructor(r,i){this.stringService=r,this.colorService=i}ngOnInit(){}get departureTime(){return this.stringService.getDepartureTime(this.departure)}get delay(){return this.stringService.getDelay(this.departure)}get delayColor(){return this.colorService.getDelayColor(this.departure.relativeArrival,this.departure.relativeDelay,this.departure.isCancelled)}}return t.\u0275fac=function(r){return new(r||t)(h.Y36(uc),h.Y36(cc))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-departures-item"]],inputs:{departure:"departure"},decls:14,vars:21,consts:[["slot","start"],["onerror","this.onerror=null; this.src='assets/unknown-mode.svg'","alt","",3,"src","ngClass"],[3,"ngClass"],["slot","end",1,"ion-text-end",3,"ngClass"],[3,"class",4,"ngIf"]],template:function(r,i){1&r&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-avatar",0),h._UZ(2,"img",1),h.qZA(),h.TgZ(3,"ion-label",2),h.TgZ(4,"h2"),h._uU(5),h.qZA(),h.TgZ(6,"h3"),h._uU(7),h.ALo(8,"translate"),h.ALo(9,"lowercase"),h.qZA(),h.qZA(),h.TgZ(10,"ion-note",3),h.TgZ(11,"h3"),h._uU(12),h.qZA(),h.YNc(13,fc,2,4,"h3",4),h.qZA(),h.qZA()),2&r&&(h.xp6(2),h.s9C("src","https://m.dvb.de/img/mot_icons/plusBus.svg"===i.departure.modeIconUrl?"assets/plusbus.svg":i.departure.modeIconUrl,h.LSH),h.Q6J("ngClass",h.VKq(14,hc,i.departure.relativeArrival<0)),h.xp6(1),h.Q6J("ngClass",h.WLB(16,lc,i.departure.relativeArrival<0,i.departure.isCancelled)),h.xp6(2),h.AsE("",i.departure.line," ",i.departure.destination,""),h.xp6(2),h.AsE("",h.lcZ(8,10,h.lcZ(9,12,"shared.station-types."+i.departure.platformType))," ",i.departure.platformName,""),h.xp6(3),h.Q6J("ngClass",h.VKq(19,dc,i.departure.relativeArrival<0)),h.xp6(2),h.Oqu(i.departureTime),h.xp6(1),h.Q6J("ngIf",i.departure.hasLiveData))},directives:[T.Ie,T.BJ,J.mk,T.Q$,T.uN,J.O5],pipes:[ft.X$,J.i8],styles:["ion-avatar[_ngcontent-%COMP%]{--border-radius: 0px;margin-left:unset;margin-inline-start:-16px}ion-note[_ngcontent-%COMP%]{color:var(--ion-text-color);padding:12px 0 10px;margin-right:-5px;margin-left:8px}.filter-grayscale[_ngcontent-%COMP%]{filter:grayscale(100%)}.strikethrough[_ngcontent-%COMP%]{text-decoration:line-through}"]}),t})();function mc(t,n){1&t&&h._UZ(0,"app-departures-item",2),2&t&&h.Q6J("departure",n.$implicit)}function pc(t,n){if(1&t&&(h.TgZ(0,"ion-list"),h.YNc(1,mc,1,1,"app-departures-item",1),h.qZA()),2&t){const r=h.oxw();h.xp6(1),h.Q6J("ngForOf",r.departures)}}let Jo=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-departures-list"]],inputs:{departures:"departures"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"departure",4,"ngFor","ngForOf"],[3,"departure"]],template:function(r,i){1&r&&h.YNc(0,pc,2,1,"ion-list",0),2&r&&h.Q6J("ngIf",i.departures)},directives:[J.O5,T.q_,J.sg,vc],styles:[""]}),t})();function gc(t,n){1&t&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-avatar",1),h._UZ(2,"ion-skeleton-text",2),h.qZA(),h.TgZ(3,"ion-label"),h.TgZ(4,"h2"),h._UZ(5,"ion-skeleton-text",2),h.qZA(),h.TgZ(6,"h3"),h._UZ(7,"ion-skeleton-text",2),h.qZA(),h.qZA(),h.qZA())}let $o=(()=>{class t{constructor(){}ngOnInit(){}get skeletons(){return Array(this.departureCount)}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-departures-item-skeleton"]],inputs:{departureCount:"departureCount"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["slot","start"],["animated",""]],template:function(r,i){1&r&&(h.TgZ(0,"ion-list"),h.YNc(1,gc,8,0,"ion-item",0),h.qZA()),2&r&&(h.xp6(1),h.Q6J("ngForOf",i.skeletons))},directives:[T.q_,J.sg,T.Ie,T.BJ,T.CK,T.Q$],styles:["ion-avatar[_ngcontent-%COMP%]{--border-radius: 0px;margin-left:unset;margin-inline-start:-16px}"]}),t})();function _c(t,n){if(1&t){const r=h.EpF();h.TgZ(0,"ion-card"),h.TgZ(1,"ion-item",1),h.TgZ(2,"ion-label"),h.TgZ(3,"ion-card-title",2),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(6,"ion-card-content"),h.TgZ(7,"app-station-picker",3),h.NdJ("stationSelected",function(o){return h.CHM(r),h.oxw().onStationSelected(o)}),h.qZA(),h.TgZ(8,"ion-item"),h.TgZ(9,"ion-label",4),h._uU(10),h.ALo(11,"translate"),h.qZA(),h._UZ(12,"ion-datetime",5),h.ALo(13,"translate"),h.ALo(14,"translate"),h.qZA(),h._UZ(15,"ion-row",6),h.TgZ(16,"ion-button",7),h.NdJ("click",function(){return h.CHM(r),h.oxw().searchDepartures()}),h._UZ(17,"ion-icon",8),h._uU(18),h.ALo(19,"translate"),h.qZA(),h.qZA(),h.qZA()}if(2&t){const r=h.oxw();h.xp6(4),h.Oqu(h.lcZ(5,9,"departures.quick-search-title")),h.xp6(6),h.Oqu(h.lcZ(11,11,"shared.times.departure-time")),h.xp6(2),h.s9C("min",r.currentDate),h.s9C("max",r.maxDate),h.s9C("cancelText",h.lcZ(13,13,"shared.inputs.cancel")),h.s9C("doneText",h.lcZ(14,15,"shared.inputs.done")),h.Q6J("formControl",r.departureTime),h.xp6(4),h.Q6J("disabled",!r.selectedStation),h.xp6(2),h.hij(" ",h.lcZ(19,17,"shared.inputs.search")," ")}}function yc(t,n){if(1&t){const r=h.EpF();h.TgZ(0,"ion-button",17),h.NdJ("click",function(){return h.CHM(r),h.oxw(2).addStationToFavorites()}),h._UZ(1,"ion-icon",18),h.qZA()}}function Mc(t,n){if(1&t){const r=h.EpF();h.TgZ(0,"ion-button",17),h.NdJ("click",function(){return h.CHM(r),h.oxw(2).removeStationFromFavorites()}),h._UZ(1,"ion-icon",19),h.qZA()}}function wc(t,n){if(1&t&&h._UZ(0,"app-departures-list",20),2&t){const r=h.oxw(2);h.Q6J("departures",r.departures)}}function bc(t,n){1&t&&(h.TgZ(0,"h2",21),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&t&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"departures.none-found")))}function Sc(t,n){if(1&t&&h._UZ(0,"app-departures-item-skeleton",22),2&t){const r=h.oxw(2);h.Q6J("departureCount",r.selectedStation.departureCount)}}const xc=function(t){return{time:t}};function Cc(t,n){if(1&t){const r=h.EpF();h.TgZ(0,"ion-card"),h.TgZ(1,"ion-item",1),h.TgZ(2,"ion-label"),h.TgZ(3,"ion-card-subtitle",2),h._uU(4),h.qZA(),h.TgZ(5,"ion-card-title",2),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"app-timer",9),h.NdJ("click",function(){h.CHM(r);const o=h.oxw();return o.secondsElapsed>35&&o.updateDepartures()})("elapsed",function(){return h.CHM(r),h.oxw().updateDepartures()}),h.qZA(),h.YNc(8,yc,2,0,"ion-button",10),h.YNc(9,Mc,2,0,"ion-button",10),h.TgZ(10,"ion-button",11),h.NdJ("click",function(){return h.CHM(r),h.oxw().leaveStationSelectedMode()}),h._UZ(11,"ion-icon",12),h.qZA(),h.qZA(),h.TgZ(12,"ion-card-content"),h.TgZ(13,"ion-text",13),h._uU(14),h.ALo(15,"translate"),h.qZA(),h.YNc(16,wc,1,1,"app-departures-list",14),h.YNc(17,bc,3,3,"h2",15),h.YNc(18,Sc,1,1,"app-departures-item-skeleton",16),h.qZA(),h.qZA()}if(2&t){const r=h.oxw();h.xp6(4),h.Oqu(r.selectedStation.city),h.xp6(2),h.Oqu(r.selectedStation.name),h.xp6(1),h.Q6J("start",r.lastUpdate)("interval",30)("update",r.inStationSelectedMode)("clickable",r.secondsElapsed>35),h.xp6(1),h.Q6J("ngIf",!r.isStationInFavorites),h.xp6(1),h.Q6J("ngIf",r.isStationInFavorites),h.xp6(5),h.hij(" ",h.xi3(15,12,"shared.times.departing-at",h.VKq(15,xc,r.formattedDepartureTime))," "),h.xp6(2),h.Q6J("ngIf",r.departures.length>0),h.xp6(1),h.Q6J("ngIf",0===r.departures.length&&!r.isUpdating),h.xp6(1),h.Q6J("ngIf",0===r.departures.length&&r.isUpdating)}}let Ac=(()=>{class t{constructor(r,i,o){this.helperService=r,this.apiService=i,this.stationService=o,this.departures=[],this.inStationSelectedMode=!1,this.isUpdating=!0,this.isStationInFavorites=!1}ngOnInit(){this.lastUpdate=new Date,this.updateCurrentDate(),this.updateCurrentDateInterval=setInterval(()=>{this.updateCurrentDate()},3e4),this.departureTime=new P.NI(this.currentDate,P.kI.required)}get formattedDepartureTime(){return Eo(new Date(this.departureTime.value),"dd.MM.yyyy, HH:mm")}get secondsElapsed(){return this.lastUpdate?this.helperService.getSecondsElapsed(this.lastUpdate):0}updateCurrentDate(){const r=new Date;this.currentDate=Eo(r,"yyyy-MM-dd'T'HH:mm"),this.maxDate=Eo(function(t,n){if(lt(2,arguments),!n||"object"!=typeof n)return new Date(NaN);var r=n.years?pe(n.years):0,i=n.months?pe(n.months):0,o=n.weeks?pe(n.weeks):0,u=n.days?pe(n.days):0,d=n.hours?pe(n.hours):0,M=n.minutes?pe(n.minutes):0,A=n.seconds?pe(n.seconds):0,L=mt(t),$=i||r?Ku(L,i+12*r):L,_=u||o?Hu($,u+7*o):$,O=1e3*(A+60*(M+60*d));return new Date(_.getTime()+O)}(r,{months:1}),"yyyy-MM-dd'T'HH:mm"),this.departureTime&&!this.departureTime.dirty&&!this.departureTime.touched&&this.departureTime.setValue(this.currentDate)}updateDepartures(){return K(this,void 0,void 0,function*(){this.isUpdating=!0;let r=function(t,n){lt(2,arguments);var r=Qo(t,n)/6e4;return r>0?Math.floor(r):Math.ceil(r)}(new Date(this.departureTime.value),new Date);r<0&&(r=0,this.updateCurrentDate(),this.departureTime.setValue(this.currentDate));const i=yield this.apiService.getDepartures(this.selectedStation,r);0===i.length&&this.departures.length>0?this.isUpdating=!1:(this.departures=i,this.isUpdating=!1,this.lastUpdate=new Date)})}searchDepartures(){return K(this,void 0,void 0,function*(){const r=yield this.stationService.getStation(this.selectedStation._id);r&&(this.selectedStation=r,this.isStationInFavorites=!0),this.inStationSelectedMode=!0,this.updateDepartures()})}addStationToFavorites(){return K(this,void 0,void 0,function*(){yield this.stationService.createStation(this.selectedStation),this.leaveStationSelectedMode()})}removeStationFromFavorites(){return K(this,void 0,void 0,function*(){yield this.stationService.deleteStation(this.selectedStation),this.leaveStationSelectedMode()})}leaveStationSelectedMode(){this.inStationSelectedMode=!1,this.isStationInFavorites=!1,this.selectedStation=null,this.departures=[]}onStationSelected(r){this.selectedStation=r}}return t.\u0275fac=function(r){return new(r||t)(h.Y36(To),h.Y36(Po),h.Y36(st))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-departures-card-quick-search"]],decls:2,vars:2,consts:[[4,"ngIf"],["lines","none"],[1,"ion-text-nowrap"],[3,"stationSelected"],["position","floating"],["displayFormat","DD.MM.YYYY, HH:mm",3,"formControl","min","max","cancelText","doneText"],[2,"height","1em"],[3,"disabled","click"],["slot","start","name","search-outline"],[1,"timer-item",3,"start","interval","update","clickable","click","elapsed"],["class","card-button-item","fill","clear","size","small",3,"click",4,"ngIf"],["fill","clear","size","small",3,"click"],["slot","icon-only","name","close-outline","color","dark"],["color","dark"],[3,"departures",4,"ngIf"],["class","no-departures",4,"ngIf"],[3,"departureCount",4,"ngIf"],["fill","clear","size","small",1,"card-button-item",3,"click"],["slot","icon-only","name","star-outline","color","dark"],["slot","icon-only","name","star","color","primary"],[3,"departures"],[1,"no-departures"],[3,"departureCount"]],template:function(r,i){1&r&&(h.YNc(0,_c,20,19,"ion-card",0),h.YNc(1,Cc,19,17,"ion-card",0)),2&r&&(h.Q6J("ngIf",!i.inStationSelectedMode),h.xp6(1),h.Q6J("ngIf",i.inStationSelectedMode))},directives:[J.O5,T.PM,T.Ie,T.Q$,T.gZ,T.FN,sc,T.x4,T.QI,P.JJ,P.oH,T.Nd,T.YG,T.gu,T.tO,Yo,T.yW,Jo,$o],pipes:[ft.X$],styles:["ion-card-title.ion-text-nowrap[_ngcontent-%COMP%], ion-card-subtitle.ion-text-nowrap[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}ion-card-content[_ngcontent-%COMP%]{padding-top:0}.card-button-item[_ngcontent-%COMP%]{margin-left:0!important}.timer-item[_ngcontent-%COMP%]{margin-left:0}.no-departures[_ngcontent-%COMP%]{margin-top:10px}"]}),t})();const Oc=function(){return{lower:"1",upper:"10"}};function Ec(t,n){1&t&&(h.TgZ(0,"ion-text",8),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&t&&(h.xp6(1),h.hij(" ",h.xi3(2,1,"shared.inputs.restraints.range",h.DdM(4,Oc)),""))}let Tc=(()=>{class t{constructor(r){this.stationService=r,this.submitted=new h.vpe}ngOnInit(){this.departureCount=new P.NI(this.station.departureCount,[P.kI.required,P.kI.min(1),P.kI.max(10)])}submit(){return K(this,void 0,void 0,function*(){this.station.departureCount=this.departureCount.value,yield this.stationService.updateStation(this.station),this.submitted.emit()})}removeStationFromFavorites(){return K(this,void 0,void 0,function*(){yield this.stationService.deleteStation(this.station)})}}return t.\u0275fac=function(r){return new(r||t)(h.Y36(st))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-departures-station-editor"]],inputs:{station:"station"},outputs:{submitted:"submitted"},decls:15,vars:12,consts:[["position","floating"],["type","number","min","1","max","10",3,"formControl"],["color","danger",4,"ngIf"],[2,"height","1em"],[3,"disabled","click"],["slot","start","name","save-outline"],["fill","clear","color","danger",1,"ion-float-right",3,"click"],["slot","start","name","trash-outline"],["color","danger"]],template:function(r,i){1&r&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",0),h._uU(2),h.ALo(3,"translate"),h.qZA(),h._UZ(4,"ion-input",1),h.qZA(),h.YNc(5,Ec,3,5,"ion-text",2),h._UZ(6,"ion-row",3),h.TgZ(7,"ion-button",4),h.NdJ("click",function(){return i.submit()}),h._UZ(8,"ion-icon",5),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.TgZ(11,"ion-button",6),h.NdJ("click",function(){return i.removeStationFromFavorites()}),h._UZ(12,"ion-icon",7),h._uU(13),h.ALo(14,"translate"),h.qZA()),2&r&&(h.xp6(2),h.Oqu(h.lcZ(3,6,"departures.departure-count")),h.xp6(2),h.Q6J("formControl",i.departureCount),h.xp6(1),h.Q6J("ngIf",i.departureCount.invalid&&(i.departureCount.dirty||i.departureCount.touched)),h.xp6(2),h.Q6J("disabled",i.departureCount.invalid),h.xp6(2),h.hij(" ",h.lcZ(10,8,"shared.inputs.save"),"\n"),h.xp6(4),h.hij(" ",h.lcZ(14,10,"shared.inputs.delete"),"\n"))},directives:[T.Ie,T.Q$,T.pK,T.as,P.JJ,P.oH,J.O5,T.Nd,T.YG,T.gu,T.yW],pipes:[ft.X$],styles:[""]}),t})();function Pc(t,n){if(1&t){const r=h.EpF();h.TgZ(0,"app-timer",5),h.NdJ("click",function(){h.CHM(r);const o=h.oxw();return o.secondsElapsed>35&&o.updateDepartures()})("elapsed",function(){return h.CHM(r),h.oxw().updateDepartures()}),h.qZA()}if(2&t){const r=h.oxw();h.Q6J("start",r.lastUpdate)("interval",30)("update",!r.inEditMode)("clickable",r.secondsElapsed>35)}}function Dc(t,n){if(1&t){const r=h.EpF();h.TgZ(0,"ion-button",6),h.NdJ("click",function(){return h.CHM(r),h.oxw().enterEditMode()}),h._UZ(1,"ion-icon",7),h.qZA()}}function Ic(t,n){if(1&t&&h._UZ(0,"app-departures-list",10),2&t){const r=h.oxw(2);h.Q6J("departures",r.departures)}}function Nc(t,n){if(1&t&&h._UZ(0,"app-departures-item-skeleton",11),2&t){const r=h.oxw(2);h.Q6J("departureCount",r.station.departureCount)}}function qc(t,n){1&t&&(h.TgZ(0,"h2"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&t&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"departures.none-found")))}function Rc(t,n){if(1&t&&(h.TgZ(0,"ion-card-content"),h.YNc(1,Ic,1,1,"app-departures-list",8),h.YNc(2,Nc,1,1,"app-departures-item-skeleton",9),h.YNc(3,qc,3,3,"h2",4),h.qZA()),2&t){const r=h.oxw();h.xp6(1),h.Q6J("ngIf",r.departures&&r.departures.length>0),h.xp6(1),h.Q6J("ngIf",!r.departures||0===r.departures.length&&r.isUpdating),h.xp6(1),h.Q6J("ngIf",r.departures&&0===r.departures.length&&!r.isUpdating)}}function Lc(t,n){if(1&t){const r=h.EpF();h.TgZ(0,"ion-card-content"),h.TgZ(1,"app-departures-station-editor",12),h.NdJ("submitted",function(){return h.CHM(r),h.oxw().onEditorSubmitted()}),h.qZA(),h.qZA()}if(2&t){const r=h.oxw();h.xp6(1),h.Q6J("station",r.station)}}let kc=(()=>{class t{constructor(r,i,o){this.helperService=r,this.apiService=i,this.stationService=o,this.departures=[],this.inEditMode=!1,this.isUpdating=!0}ngOnInit(){return K(this,void 0,void 0,function*(){this.stationService.getStationUpdated().subscribe(r=>this.onStationUpdated(r)),this.lastUpdate=new Date,yield this.updateDepartures()})}get secondsElapsed(){return this.lastUpdate?this.helperService.getSecondsElapsed(this.lastUpdate):0}updateDepartures(){return K(this,void 0,void 0,function*(){this.isUpdating=!0;const r=yield this.apiService.getDepartures(this.station);0===r.length&&this.departures.length>0?this.isUpdating=!1:(this.departures=r,this.isUpdating=!1,this.lastUpdate=new Date)})}enterEditMode(){this.inEditMode=!0}onStationUpdated(r){return K(this,void 0,void 0,function*(){r._id===this.station._id&&(this.station=r)})}onEditorSubmitted(){return K(this,void 0,void 0,function*(){this.departures=[],this.inEditMode=!1,yield this.updateDepartures()})}}return t.\u0275fac=function(r){return new(r||t)(h.Y36(To),h.Y36(Po),h.Y36(st))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-departures-card-favorite"]],inputs:{station:"station"},decls:11,vars:6,consts:[["lines","none"],[1,"ion-text-nowrap"],["class","timer-item",3,"start","interval","update","clickable","click","elapsed",4,"ngIf"],["class","settings-item","slot","end","fill","clear","size","small",3,"click",4,"ngIf"],[4,"ngIf"],[1,"timer-item",3,"start","interval","update","clickable","click","elapsed"],["slot","end","fill","clear","size","small",1,"settings-item",3,"click"],["slot","icon-only","name","settings-outline","color","dark"],[3,"departures",4,"ngIf"],[3,"departureCount",4,"ngIf"],[3,"departures"],[3,"departureCount"],[3,"station","submitted"]],template:function(r,i){1&r&&(h.TgZ(0,"ion-card"),h.TgZ(1,"ion-item",0),h.TgZ(2,"ion-label"),h.TgZ(3,"ion-card-subtitle",1),h._uU(4),h.qZA(),h.TgZ(5,"ion-card-title",1),h._uU(6),h.qZA(),h.qZA(),h.YNc(7,Pc,1,4,"app-timer",2),h.YNc(8,Dc,2,0,"ion-button",3),h.qZA(),h.YNc(9,Rc,4,3,"ion-card-content",4),h.YNc(10,Lc,2,1,"ion-card-content",4),h.qZA()),2&r&&(h.xp6(4),h.Oqu(i.station.city),h.xp6(2),h.Oqu(i.station.name),h.xp6(1),h.Q6J("ngIf",!i.inEditMode),h.xp6(1),h.Q6J("ngIf",!i.inEditMode),h.xp6(1),h.Q6J("ngIf",!i.inEditMode),h.xp6(1),h.Q6J("ngIf",i.inEditMode))},directives:[T.PM,T.Ie,T.Q$,T.tO,T.gZ,J.O5,Yo,T.YG,T.gu,T.FN,Jo,$o,Tc],pipes:[ft.X$],styles:["ion-card-title.ion-text-nowrap[_ngcontent-%COMP%], ion-card-subtitle.ion-text-nowrap[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}ion-card-content[_ngcontent-%COMP%]{padding-top:0}.settings-item[_ngcontent-%COMP%]{margin-left:0!important}.timer-item[_ngcontent-%COMP%]{margin-left:0}"]}),t})();function Uc(t,n){if(1&t&&(h.TgZ(0,"ion-col",4),h._UZ(1,"app-departures-card-favorite",6),h.qZA()),2&t){const r=n.$implicit;h.xp6(1),h.Q6J("station",r)}}const Bc=[{path:"",component:(()=>{class t{constructor(r,i,o){this.stationService=r,this.toastController=i,this.translateService=o,this.stations=[]}ngOnInit(){return K(this,void 0,void 0,function*(){this.stationService.getStationCreated().subscribe(r=>this.onStationCreated(r)),this.stationService.getStationDeleted().subscribe(r=>this.onStationDeleted(r)),this.stations=yield this.stationService.getStations(),this.stations.sort((r,i)=>this.compare(r,i))})}getCombinedStationName(r){return r.name+", "+r.city}compare(r,i){return r.city===i.city?r.name.localeCompare(i.name):r.city.localeCompare(i.city)}onStationCreated(r){return K(this,void 0,void 0,function*(){this.stations.push(r),this.stations.sort((o,u)=>this.compare(o,u)),(yield this.toastController.create({message:this.translateService.instant("shared.favorite.added",{name:this.getCombinedStationName(r)}),duration:3e3})).present()})}onStationDeleted(r){return K(this,void 0,void 0,function*(){const i=this.stations.findIndex(u=>u._id===r._id);this.stations.splice(i,1),(yield this.toastController.create({message:this.translateService.instant("shared.favorite.removed",{name:this.getCombinedStationName(r)}),duration:3e3})).present()})}}return t.\u0275fac=function(r){return new(r||t)(h.Y36(st),h.Y36(T.yF),h.Y36(ft.sK))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-departures"]],decls:15,vars:9,consts:[[3,"translucent"],[1,"ion-float-start"],[1,"ion-float-end"],[3,"fullscreen"],["size-xs","12","size-sm","12","size-md","6","size-lg","6","size-xl","4"],["size-xs","12","size-sm","12","size-md","6","size-lg","6","size-xl","4",4,"ngFor","ngForOf"],[3,"station"]],template:function(r,i){1&r&&(h.TgZ(0,"title"),h._uU(1),h.ALo(2,"translate"),h.qZA(),h.TgZ(3,"ion-header",0),h.TgZ(4,"ion-toolbar"),h.TgZ(5,"ion-title",1),h._uU(6),h.ALo(7,"translate"),h.qZA(),h._UZ(8,"app-title",2),h.qZA(),h.qZA(),h.TgZ(9,"ion-content",3),h.TgZ(10,"ion-grid"),h.TgZ(11,"ion-row"),h.TgZ(12,"ion-col",4),h._UZ(13,"app-departures-card-quick-search"),h.qZA(),h.YNc(14,Uc,2,1,"ion-col",5),h.qZA(),h.qZA(),h.qZA()),2&r&&(h.xp6(1),h.hij("",h.lcZ(2,5,"departures.title")," \u2013 DVBetter"),h.xp6(2),h.Q6J("translucent",!0),h.xp6(3),h.hij(" ",h.lcZ(7,7,"departures.title")," "),h.xp6(3),h.Q6J("fullscreen",!0),h.xp6(5),h.Q6J("ngForOf",i.stations))},directives:[T.Gu,T.sr,T.wd,dt.z,T.W2,T.jY,T.Nd,T.wI,Ac,J.sg,kc],pipes:[ft.X$],styles:[""]}),t})()}];let Fc=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[k.Bz.forChild(Bc)],k.Bz]}),t})();var jc=I(933);let Gc=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[T.Pc,J.ez,P.u5,P.UX,Fc,ft.aw,jc.q]]}),t})()},1325:pt=>{function R(T,J,P,k,W,U,H){try{var B=T[U](H),N=B.value}catch(F){return void P(F)}B.done?J(N):Promise.resolve(N).then(k,W)}pt.exports=function(T){return function(){var J=this,P=arguments;return new Promise(function(k,W){var U=T.apply(J,P);function H(N){R(U,k,W,H,B,"next",N)}function B(N){R(U,k,W,H,B,"throw",N)}H(void 0)})}},pt.exports.default=pt.exports,pt.exports.__esModule=!0},5525:()=>{}}]);