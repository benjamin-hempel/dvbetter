(self.webpackChunkdvbetter=self.webpackChunkdvbetter||[]).push([[7138],{9234:gt=>{"use strict";gt.exports=function(I){return function(){var E=arguments.length;if(E){for(var J=[],P=-1;++P<E;)J[P]=arguments[P];return I.call(this,J)}return I.call(this,[])}}},8686:(gt,R,I)=>{gt.exports=I(5454)},4054:(gt,R,I)=>{"use strict";var E=I(9471),J=I(5650),P=I(7790),L=I(4634),W=I(1929),U=I(2984),H=I(5886);gt.exports=function(N){return new Promise(function(T,K){var Z=N.data,nt=N.headers;E.isFormData(Z)&&delete nt["Content-Type"];var y=new XMLHttpRequest;N.auth&&(nt.Authorization="Basic "+btoa((N.auth.username||"")+":"+(N.auth.password||"")));var g=L(N.baseURL,N.url);if(y.open(N.method.toUpperCase(),P(g,N.params,N.paramsSerializer),!0),y.timeout=N.timeout,y.onreadystatechange=function(){if(y&&4===y.readyState&&(0!==y.status||y.responseURL&&0===y.responseURL.indexOf("file:"))){var ht="getAllResponseHeaders"in y?W(y.getAllResponseHeaders()):null;J(T,K,{data:N.responseType&&"text"!==N.responseType?y.response:y.responseText,status:y.status,statusText:y.statusText,headers:ht,config:N,request:y}),y=null}},y.onabort=function(){!y||(K(H("Request aborted",N,"ECONNABORTED",y)),y=null)},y.onerror=function(){K(H("Network Error",N,null,y)),y=null},y.ontimeout=function(){var ht="timeout of "+N.timeout+"ms exceeded";N.timeoutErrorMessage&&(ht=N.timeoutErrorMessage),K(H(ht,N,"ECONNABORTED",y)),y=null},E.isStandardBrowserEnv()){var m=I(300),b=(N.withCredentials||U(g))&&N.xsrfCookieName?m.read(N.xsrfCookieName):void 0;b&&(nt[N.xsrfHeaderName]=b)}if("setRequestHeader"in y&&E.forEach(nt,function(ht,St){void 0===Z&&"content-type"===St.toLowerCase()?delete nt[St]:y.setRequestHeader(St,ht)}),E.isUndefined(N.withCredentials)||(y.withCredentials=!!N.withCredentials),N.responseType)try{y.responseType=N.responseType}catch(x){if("json"!==N.responseType)throw x}"function"==typeof N.onDownloadProgress&&y.addEventListener("progress",N.onDownloadProgress),"function"==typeof N.onUploadProgress&&y.upload&&y.upload.addEventListener("progress",N.onUploadProgress),N.cancelToken&&N.cancelToken.promise.then(function(ht){!y||(y.abort(),K(ht),y=null)}),void 0===Z&&(Z=null),y.send(Z)})}},5454:(gt,R,I)=>{"use strict";var E=I(9471),J=I(1533),P=I(3227),L=I(4018);function U(B){var N=new P(B),F=J(P.prototype.request,N);return E.extend(F,P.prototype,N),E.extend(F,N),F}var H=U(I(2567));H.Axios=P,H.create=function(N){return U(L(H.defaults,N))},H.Cancel=I(8728),H.CancelToken=I(701),H.isCancel=I(2130),H.all=function(N){return Promise.all(N)},H.spread=I(8908),gt.exports=H,gt.exports.default=H},8728:gt=>{"use strict";function R(I){this.message=I}R.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},R.prototype.__CANCEL__=!0,gt.exports=R},701:(gt,R,I)=>{"use strict";var E=I(8728);function J(P){if("function"!=typeof P)throw new TypeError("executor must be a function.");var L;this.promise=new Promise(function(H){L=H});var W=this;P(function(H){W.reason||(W.reason=new E(H),L(W.reason))})}J.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},J.source=function(){var L;return{token:new J(function(H){L=H}),cancel:L}},gt.exports=J},2130:gt=>{"use strict";gt.exports=function(I){return!(!I||!I.__CANCEL__)}},3227:(gt,R,I)=>{"use strict";var E=I(9471),J=I(7790),P=I(3976),L=I(6764),W=I(4018);function U(H){this.defaults=H,this.interceptors={request:new P,response:new P}}U.prototype.request=function(B){"string"==typeof B?(B=arguments[1]||{}).url=arguments[0]:B=B||{},(B=W(this.defaults,B)).method=B.method?B.method.toLowerCase():this.defaults.method?this.defaults.method.toLowerCase():"get";var N=[L,void 0],F=Promise.resolve(B);for(this.interceptors.request.forEach(function(K){N.unshift(K.fulfilled,K.rejected)}),this.interceptors.response.forEach(function(K){N.push(K.fulfilled,K.rejected)});N.length;)F=F.then(N.shift(),N.shift());return F},U.prototype.getUri=function(B){return B=W(this.defaults,B),J(B.url,B.params,B.paramsSerializer).replace(/^\?/,"")},E.forEach(["delete","get","head","options"],function(B){U.prototype[B]=function(N,F){return this.request(E.merge(F||{},{method:B,url:N}))}}),E.forEach(["post","put","patch"],function(B){U.prototype[B]=function(N,F,T){return this.request(E.merge(T||{},{method:B,url:N,data:F}))}}),gt.exports=U},3976:(gt,R,I)=>{"use strict";var E=I(9471);function J(){this.handlers=[]}J.prototype.use=function(L,W){return this.handlers.push({fulfilled:L,rejected:W}),this.handlers.length-1},J.prototype.eject=function(L){this.handlers[L]&&(this.handlers[L]=null)},J.prototype.forEach=function(L){E.forEach(this.handlers,function(U){null!==U&&L(U)})},gt.exports=J},4634:(gt,R,I)=>{"use strict";var E=I(5164),J=I(1540);gt.exports=function(L,W){return L&&!E(W)?J(L,W):W}},5886:(gt,R,I)=>{"use strict";var E=I(9570);gt.exports=function(P,L,W,U,H){var B=new Error(P);return E(B,L,W,U,H)}},6764:(gt,R,I)=>{"use strict";var E=I(9471),J=I(4284),P=I(2130),L=I(2567);function W(U){U.cancelToken&&U.cancelToken.throwIfRequested()}gt.exports=function(H){return W(H),H.headers=H.headers||{},H.data=J(H.data,H.headers,H.transformRequest),H.headers=E.merge(H.headers.common||{},H.headers[H.method]||{},H.headers),E.forEach(["delete","get","head","post","put","patch","common"],function(F){delete H.headers[F]}),(H.adapter||L.adapter)(H).then(function(F){return W(H),F.data=J(F.data,F.headers,H.transformResponse),F},function(F){return P(F)||(W(H),F&&F.response&&(F.response.data=J(F.response.data,F.response.headers,H.transformResponse))),Promise.reject(F)})}},9570:gt=>{"use strict";gt.exports=function(I,E,J,P,L){return I.config=E,J&&(I.code=J),I.request=P,I.response=L,I.isAxiosError=!0,I.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},I}},4018:(gt,R,I)=>{"use strict";var E=I(9471);gt.exports=function(P,L){L=L||{};var W={},U=["url","method","params","data"],H=["headers","auth","proxy"],B=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];E.forEach(U,function(K){void 0!==L[K]&&(W[K]=L[K])}),E.forEach(H,function(K){E.isObject(L[K])?W[K]=E.deepMerge(P[K],L[K]):void 0!==L[K]?W[K]=L[K]:E.isObject(P[K])?W[K]=E.deepMerge(P[K]):void 0!==P[K]&&(W[K]=P[K])}),E.forEach(B,function(K){void 0!==L[K]?W[K]=L[K]:void 0!==P[K]&&(W[K]=P[K])});var N=U.concat(H).concat(B),F=Object.keys(L).filter(function(K){return-1===N.indexOf(K)});return E.forEach(F,function(K){void 0!==L[K]?W[K]=L[K]:void 0!==P[K]&&(W[K]=P[K])}),W}},5650:(gt,R,I)=>{"use strict";var E=I(5886);gt.exports=function(P,L,W){var U=W.config.validateStatus;!U||U(W.status)?P(W):L(E("Request failed with status code "+W.status,W.config,null,W.request,W))}},4284:(gt,R,I)=>{"use strict";var E=I(9471);gt.exports=function(P,L,W){return E.forEach(W,function(H){P=H(P,L)}),P}},2567:(gt,R,I)=>{"use strict";var E=I(9471),J=I(2196),P={"Content-Type":"application/x-www-form-urlencoded"};function L(H,B){!E.isUndefined(H)&&E.isUndefined(H["Content-Type"])&&(H["Content-Type"]=B)}var H,U={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(H=I(4054)),H),transformRequest:[function(B,N){return J(N,"Accept"),J(N,"Content-Type"),E.isFormData(B)||E.isArrayBuffer(B)||E.isBuffer(B)||E.isStream(B)||E.isFile(B)||E.isBlob(B)?B:E.isArrayBufferView(B)?B.buffer:E.isURLSearchParams(B)?(L(N,"application/x-www-form-urlencoded;charset=utf-8"),B.toString()):E.isObject(B)?(L(N,"application/json;charset=utf-8"),JSON.stringify(B)):B}],transformResponse:[function(B){if("string"==typeof B)try{B=JSON.parse(B)}catch(N){}return B}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(B){return B>=200&&B<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};E.forEach(["delete","get","head"],function(B){U.headers[B]={}}),E.forEach(["post","put","patch"],function(B){U.headers[B]=E.merge(P)}),gt.exports=U},1533:gt=>{"use strict";gt.exports=function(I,E){return function(){for(var P=new Array(arguments.length),L=0;L<P.length;L++)P[L]=arguments[L];return I.apply(E,P)}}},7790:(gt,R,I)=>{"use strict";var E=I(9471);function J(P){return encodeURIComponent(P).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}gt.exports=function(L,W,U){if(!W)return L;var H;if(U)H=U(W);else if(E.isURLSearchParams(W))H=W.toString();else{var B=[];E.forEach(W,function(T,K){null==T||(E.isArray(T)?K+="[]":T=[T],E.forEach(T,function(nt){E.isDate(nt)?nt=nt.toISOString():E.isObject(nt)&&(nt=JSON.stringify(nt)),B.push(J(K)+"="+J(nt))}))}),H=B.join("&")}if(H){var N=L.indexOf("#");-1!==N&&(L=L.slice(0,N)),L+=(-1===L.indexOf("?")?"?":"&")+H}return L}},1540:gt=>{"use strict";gt.exports=function(I,E){return E?I.replace(/\/+$/,"")+"/"+E.replace(/^\/+/,""):I}},300:(gt,R,I)=>{"use strict";var E=I(9471);gt.exports=E.isStandardBrowserEnv()?{write:function(L,W,U,H,B,N){var F=[];F.push(L+"="+encodeURIComponent(W)),E.isNumber(U)&&F.push("expires="+new Date(U).toGMTString()),E.isString(H)&&F.push("path="+H),E.isString(B)&&F.push("domain="+B),!0===N&&F.push("secure"),document.cookie=F.join("; ")},read:function(L){var W=document.cookie.match(new RegExp("(^|;\\s*)("+L+")=([^;]*)"));return W?decodeURIComponent(W[3]):null},remove:function(L){this.write(L,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},5164:gt=>{"use strict";gt.exports=function(I){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(I)}},2984:(gt,R,I)=>{"use strict";var E=I(9471);gt.exports=E.isStandardBrowserEnv()?function(){var W,P=/(msie|trident)/i.test(navigator.userAgent),L=document.createElement("a");function U(H){var B=H;return P&&(L.setAttribute("href",B),B=L.href),L.setAttribute("href",B),{href:L.href,protocol:L.protocol?L.protocol.replace(/:$/,""):"",host:L.host,search:L.search?L.search.replace(/^\?/,""):"",hash:L.hash?L.hash.replace(/^#/,""):"",hostname:L.hostname,port:L.port,pathname:"/"===L.pathname.charAt(0)?L.pathname:"/"+L.pathname}}return W=U(window.location.href),function(B){var N=E.isString(B)?U(B):B;return N.protocol===W.protocol&&N.host===W.host}}():function(){return!0}},2196:(gt,R,I)=>{"use strict";var E=I(9471);gt.exports=function(P,L){E.forEach(P,function(U,H){H!==L&&H.toUpperCase()===L.toUpperCase()&&(P[L]=U,delete P[H])})}},1929:(gt,R,I)=>{"use strict";var E=I(9471),J=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];gt.exports=function(L){var U,H,B,W={};return L&&E.forEach(L.split("\n"),function(F){if(B=F.indexOf(":"),U=E.trim(F.substr(0,B)).toLowerCase(),H=E.trim(F.substr(B+1)),U){if(W[U]&&J.indexOf(U)>=0)return;W[U]="set-cookie"===U?(W[U]?W[U]:[]).concat([H]):W[U]?W[U]+", "+H:H}}),W}},8908:gt=>{"use strict";gt.exports=function(I){return function(J){return I.apply(null,J)}}},9471:(gt,R,I)=>{"use strict";var E=I(1533),J=Object.prototype.toString;function P(G){return"[object Array]"===J.call(G)}function L(G){return void 0===G}function T(G){return null!==G&&"object"==typeof G}function y(G){return"[object Function]"===J.call(G)}function b(G,ct){if(null!=G)if("object"!=typeof G&&(G=[G]),P(G))for(var Ot=0,Lt=G.length;Ot<Lt;Ot++)ct.call(null,G[Ot],Ot,G);else for(var te in G)Object.prototype.hasOwnProperty.call(G,te)&&ct.call(null,G[te],te,G)}gt.exports={isArray:P,isArrayBuffer:function(G){return"[object ArrayBuffer]"===J.call(G)},isBuffer:function(G){return null!==G&&!L(G)&&null!==G.constructor&&!L(G.constructor)&&"function"==typeof G.constructor.isBuffer&&G.constructor.isBuffer(G)},isFormData:function(G){return"undefined"!=typeof FormData&&G instanceof FormData},isArrayBufferView:function(G){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(G):G&&G.buffer&&G.buffer instanceof ArrayBuffer},isString:function(G){return"string"==typeof G},isNumber:function(G){return"number"==typeof G},isObject:T,isUndefined:L,isDate:function(G){return"[object Date]"===J.call(G)},isFile:function(G){return"[object File]"===J.call(G)},isBlob:function(G){return"[object Blob]"===J.call(G)},isFunction:y,isStream:function(G){return T(G)&&y(G.pipe)},isURLSearchParams:function(G){return"undefined"!=typeof URLSearchParams&&G instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:b,merge:function x(){var G={};function ct(te,Ht){G[Ht]="object"==typeof G[Ht]&&"object"==typeof te?x(G[Ht],te):te}for(var Ot=0,Lt=arguments.length;Ot<Lt;Ot++)b(arguments[Ot],ct);return G},deepMerge:function ht(){var G={};function ct(te,Ht){G[Ht]="object"==typeof G[Ht]&&"object"==typeof te?ht(G[Ht],te):"object"==typeof te?ht({},te):te}for(var Ot=0,Lt=arguments.length;Ot<Lt;Ot++)b(arguments[Ot],ct);return G},extend:function(G,ct,Ot){return b(ct,function(te,Ht){G[Ht]=Ot&&"function"==typeof te?E(te,Ot):te}),G},trim:function(G){return G.replace(/^\s*/,"").replace(/\s*$/,"")}}},2281:function(gt,R,I){"use strict";var E=this&&this.__createBinding||(Object.create?function(B,N,F,T){void 0===T&&(T=F),Object.defineProperty(B,T,{enumerable:!0,get:function(){return N[F]}})}:function(B,N,F,T){void 0===T&&(T=F),B[T]=N[F]}),J=this&&this.__setModuleDefault||(Object.create?function(B,N){Object.defineProperty(B,"default",{enumerable:!0,value:N})}:function(B,N){B.default=N}),P=this&&this.__importStar||function(B){if(B&&B.__esModule)return B;var N={};if(null!=B)for(var F in B)"default"!==F&&Object.hasOwnProperty.call(B,F)&&E(N,B,F);return J(N,B),N},L=this&&this.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(R,"__esModule",{value:!0}),R.coords=void 0;const W=L(I(8686)),U=P(I(7174));R.coords=function(B,N=5e3){return W.default({url:"https://www.dvb.de/apps/map/coordinates",params:{id:B},responseType:"text",timeout:N}).then(T=>{if(T.data){const K=T.data.split("|");if(K.length>1)return U.WmOrGK4toWGS84(K[1],K[0])}})}},3425:function(gt,R,I){"use strict";var E=I(1325).default,J=this&&this.__createBinding||(Object.create?function(Z,nt,y,C){void 0===C&&(C=y),Object.defineProperty(Z,C,{enumerable:!0,get:function(){return nt[y]}})}:function(Z,nt,y,C){void 0===C&&(C=y),Z[C]=nt[y]}),P=this&&this.__setModuleDefault||(Object.create?function(Z,nt){Object.defineProperty(Z,"default",{enumerable:!0,value:nt})}:function(Z,nt){Z.default=nt}),L=this&&this.__importStar||function(Z){if(Z&&Z.__esModule)return Z;var nt={};if(null!=Z)for(var y in Z)"default"!==y&&Object.hasOwnProperty.call(Z,y)&&J(nt,Z,y);return P(nt,Z),nt},W=this&&this.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(R,"__esModule",{value:!0}),R.findAddress=R.findPOI=R.findStop=void 0;const U=W(I(8686)),H=L(I(7174));function B(Z,nt,y,C){return N.apply(this,arguments)}function N(){return(N=E(function*(Z,nt,y,C){if("string"!=typeof Z)throw H.constructError("ValidationError","query has to be a string");const w=Z.trim();return U.default({url:"https://webapi.vvo-online.de/tr/pointfinder",params:{format:"json",stopsOnly:nt,assignedStops:y,limit:0,query:w,dvb:!0},timeout:C}).then(m=>{H.checkStatus(m.data);const b=[];return m.data.Points&&m.data.Points.forEach(x=>{const ht=x.split("|"),St=H.WmOrGK4toWGS84(ht[5],ht[4]),G=ht[3].replace(/'/g,"");if(G&&St){const ct=""===ht[2]?"Dresden":ht[2],{id:Ot,type:Lt}=H.parsePoiID(ht[0]);b.push({city:ct,coords:St,name:G,id:Ot,type:Lt})}}),b}).catch(H.convertError)})).apply(this,arguments)}R.findStop=function(Z,nt=5e3){return B(Z,!0,!1,nt)},R.findPOI=function(Z,nt=5e3){return B(Z,!1,!1,nt)},R.findAddress=function(Z,nt,y=5e3){const C=H.WGS84toGK4(Z,nt);return B(`coord:${C[0]}:${C[1]}`,!1,!0,y).then(w=>0===w.length?void 0:Object.assign(Object.assign({},w[0]),{stops:w.slice(1)||[]}))}},5417:function(gt,R,I){"use strict";var E=this&&this.__createBinding||(Object.create?function(N,F,T,K){void 0===K&&(K=T),Object.defineProperty(N,K,{enumerable:!0,get:function(){return F[T]}})}:function(N,F,T,K){void 0===K&&(K=T),N[K]=F[T]}),J=this&&this.__exportStar||function(N,F){for(var T in N)"default"!==T&&!F.hasOwnProperty(T)&&E(F,N,T)};Object.defineProperty(R,"__esModule",{value:!0});var P=I(2281);Object.defineProperty(R,"coords",{enumerable:!0,get:function(){return P.coords}});var L=I(3425);Object.defineProperty(R,"findAddress",{enumerable:!0,get:function(){return L.findAddress}}),Object.defineProperty(R,"findPOI",{enumerable:!0,get:function(){return L.findPOI}}),Object.defineProperty(R,"findStop",{enumerable:!0,get:function(){return L.findStop}});var W=I(8025);Object.defineProperty(R,"lines",{enumerable:!0,get:function(){return W.lines}});var U=I(3047);Object.defineProperty(R,"monitor",{enumerable:!0,get:function(){return U.monitor}});var H=I(8407);Object.defineProperty(R,"pins",{enumerable:!0,get:function(){return H.pins}});var B=I(1649);Object.defineProperty(R,"route",{enumerable:!0,get:function(){return B.route}}),J(I(7785),R)},7785:(gt,R)=>{"use strict";var J;Object.defineProperty(R,"__esModule",{value:!0}),R.PIN_TYPE=R.POI_TYPE=void 0,(J=R.POI_TYPE||(R.POI_TYPE={})).Address="Address",J.Coords="Coords",J.POI="POI",J.Stop="Stop",function(J){J.stop="stop",J.platform="platform",J.poi="poi",J.rentabike="rentabike",J.ticketmachine="ticketmachine",J.carsharing="carsharing",J.parkandride="parkandride",J.unknown="unknown"}(R.PIN_TYPE||(R.PIN_TYPE={}))},8025:function(gt,R,I){"use strict";var E=this&&this.__createBinding||(Object.create?function(F,T,K,Z){void 0===Z&&(Z=K),Object.defineProperty(F,Z,{enumerable:!0,get:function(){return T[K]}})}:function(F,T,K,Z){void 0===Z&&(Z=K),F[Z]=T[K]}),J=this&&this.__setModuleDefault||(Object.create?function(F,T){Object.defineProperty(F,"default",{enumerable:!0,value:T})}:function(F,T){F.default=T}),P=this&&this.__importStar||function(F){if(F&&F.__esModule)return F;var T={};if(null!=F)for(var K in F)"default"!==K&&Object.hasOwnProperty.call(F,K)&&E(T,F,K);return J(T,F),T},L=this&&this.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(R,"__esModule",{value:!0}),R.lines=void 0;const W=L(I(8686)),U=P(I(7174));function H(F){return F.Name}R.lines=function(F,T=5e3){return W.default({url:"https://webapi.vvo-online.de/stt/lines",params:{format:"json",stopid:F},timeout:T}).then(Z=>{U.checkStatus(Z.data);let nt=[];return Z.data.Lines&&(nt=Z.data.Lines.map(y=>function(F){return{name:F.Name,mode:U.parseMode(F.Mot),diva:U.parseDiva(F.Diva),directions:F.Directions.map(H)}}(y))),nt}).catch(U.convertError)}},3047:function(gt,R,I){"use strict";var E=this&&this.__importDefault||function(W){return W&&W.__esModule?W:{default:W}};Object.defineProperty(R,"__esModule",{value:!0}),R.monitor=void 0;const J=E(I(8686)),P=I(7174);R.monitor=function(W,U=0,H=0,B=5e3){const N=new Date,T={url:"https://webapi.vvo-online.de/dm",params:{format:"json",stopid:W,time:new Date(N.getTime()+60*U*1e3).toISOString(),isarrival:!1,limit:H,shorttermchanges:!0,mentzonly:!1},timeout:B};return J.default(T).then(K=>{P.checkStatus(K.data);let Z=[];return K.data.Departures&&(Z=K.data.Departures.map(nt=>{const y=P.parseDate(nt.RealTime?nt.RealTime:nt.ScheduledTime),C=P.parseDate(nt.ScheduledTime);return{arrivalTime:y,scheduledTime:C,id:nt.Id,line:nt.LineName,direction:nt.Direction,platform:P.parsePlatform(nt.Platform),arrivalTimeRelative:P.dateDifference(N,y),scheduledTimeRelative:P.dateDifference(N,C),delayTime:P.dateDifference(C,y),state:nt.State?nt.State:"Unknown",mode:P.parseMode(nt.Mot),diva:P.parseDiva(nt.Diva)}})),Z}).catch(P.convertError)}},8407:function(gt,R,I){"use strict";var E=this&&this.__createBinding||(Object.create?function(N,F,T,K){void 0===K&&(K=T),Object.defineProperty(N,K,{enumerable:!0,get:function(){return F[T]}})}:function(N,F,T,K){void 0===K&&(K=T),N[K]=F[T]}),J=this&&this.__setModuleDefault||(Object.create?function(N,F){Object.defineProperty(N,"default",{enumerable:!0,value:F})}:function(N,F){N.default=F}),P=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var F={};if(null!=N)for(var T in N)"default"!==T&&Object.hasOwnProperty.call(N,T)&&E(F,N,T);return J(F,N),F},L=this&&this.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(R,"__esModule",{value:!0}),R.pins=void 0;const W=L(I(8686)),U=I(7785),H=P(I(7174));R.pins=function(N,F,T,K,Z=[U.PIN_TYPE.stop],nt=5e3){const y=H.WGS84toWm(N,F),C=H.WGS84toWm(T,K);let w="https://www.dvb.de/apps/map/pins?showLines=true";return Z.forEach(m=>w+=`&pintypes=${m}`),W.default({url:w,params:{swlng:y[0],swlat:y[1],nelng:C[0],nelat:C[1]},responseType:"text",timeout:nt}).then(m=>m.data||[]).then(m=>m.map(b=>H.parsePin(b)))}},1649:function(gt,R,I){"use strict";var E=this&&this.__createBinding||(Object.create?function(B,N,F,T){void 0===T&&(T=F),Object.defineProperty(B,T,{enumerable:!0,get:function(){return N[F]}})}:function(B,N,F,T){void 0===T&&(T=F),B[T]=N[F]}),J=this&&this.__setModuleDefault||(Object.create?function(B,N){Object.defineProperty(B,"default",{enumerable:!0,value:N})}:function(B,N){B.default=N}),P=this&&this.__importStar||function(B){if(B&&B.__esModule)return B;var N={};if(null!=B)for(var F in B)"default"!==F&&Object.hasOwnProperty.call(B,F)&&E(N,B,F);return J(N,B),N},L=this&&this.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(R,"__esModule",{value:!0}),R.route=void 0;const W=L(I(8686)),U=P(I(7174));R.route=function(B,N,F=new Date,T=!0,K=15e3){const Z={url:"https://webapi.vvo-online.de/tr/trips",params:{format:"json",origin:B,destination:N,isarrivaltime:T,shorttermchanges:!0,time:F.toISOString()},timeout:K};return W.default(Z).then(nt=>{U.checkStatus(nt.data);let y,C,w=[];if(nt.data.Routes&&(w=nt.data.Routes.map(U.extractTrip),w&&w.length>0)){const g=w[0];g.departure&&(y={id:g.departure.id,name:g.departure.name,city:g.departure.city,coords:g.departure.coords}),g.arrival&&(C={id:g.arrival.id,name:g.arrival.name,city:g.arrival.city,coords:g.arrival.coords})}return{origin:y,destination:C,trips:w}}).catch(U.convertError)}},7174:function(gt,R,I){"use strict";var E=this&&this.__importDefault||function(G){return G&&G.__esModule?G:{default:G}};Object.defineProperty(R,"__esModule",{value:!0}),R.dateDifference=R.extractTrip=R.parsePoiID=R.parseMode=R.parsePin=R.parseConnections=R.MODES=R.parsePlatform=R.parseDiva=R.parseDate=R.convertError=R.constructError=R.checkStatus=R.convertCoordinates=R.WmOrGK4toWGS84=R.WGS84toWm=R.WGS84toGK4=void 0;const J=E(I(8994)),P=I(7785);function U(G,ct){const Ot=parseInt(ct,10),Lt=parseInt(G,10);if(!(0===Ot&&0===Lt||isNaN(Ot)||isNaN(Lt)))return J.default(Lt<25e5?"WM":"GK4","WGS84",[Lt,Ot])}function H(G){const ct=[];if(G){const Ot=G.split("|");let Lt=1;const te=Ot.length-1;for(;Lt<te;){const Ht=U(Ot[Lt+1],Ot[Lt]);Ht&&ct.push(Ht),Lt+=2}}return ct}function N(G,ct=""){const Ot=new Error(ct);return G&&(Ot.name=G),Ot}function T(G){const ct=G.match(/\d+/);return ct?new Date(parseInt(ct[0],10)):new Date}function K(G){return G&&G.Number?{number:parseInt(G.Number,10),network:G.Network}:void 0}function Z(G){return G?{name:G.Name,type:G.Type}:void 0}function C(G){let ct=[];return G.split("#").forEach(Ot=>{if(!Ot)return[];const Lt=Ot.split(":"),te=function(G){switch(G){case"1":return R.MODES.Tram;case"2":return R.MODES.CityBus;case"3":return R.MODES.IntercityBus;case"4":return R.MODES.Train;case"5":return R.MODES.SuburbanRailway;case"6":return R.MODES.HailedSharedTaxi;case"7":return R.MODES.Ferry;case"8":return R.MODES.Cableway;case"10":return R.MODES.PlusBus;default:return}}(Lt[0]);ct=ct.concat(Lt[1].split("~").map(Ht=>({line:Ht,mode:te})))}),ct}function g(G){if(G)switch(G.toLowerCase()){case"tram":return R.MODES.Tram;case"bus":case"citybus":return R.MODES.CityBus;case"intercitybus":return R.MODES.IntercityBus;case"suburbanrailway":return R.MODES.SuburbanRailway;case"train":case"rapidtransit":return R.MODES.Train;case"footpath":return R.MODES.Footpath;case"cableway":case"overheadrailway":return R.MODES.Cableway;case"ferry":return R.MODES.Ferry;case"hailedsharedtaxi":return R.MODES.HailedSharedTaxi;case"mobilitystairsup":return R.MODES.StairsUp;case"mobilitystairsdown":return R.MODES.StairsDown;case"mobilityescalatorup":return R.MODES.EscalatorUp;case"mobilityescalatordown":return R.MODES.EscalatorDown;case"mobilityelevatorup":return R.MODES.ElevatorUp;case"mobilityelevatordown":return R.MODES.ElevatorDown;case"stayforconnection":return R.MODES.StayForConnection;case"plusbus":return R.MODES.PlusBus;default:return{name:G,title:G.toLowerCase()}}}function b(G){return{id:G.DataId,name:G.Name.trim(),city:G.Place,type:G.Type,platform:Z(G.Platform),coords:U(G.Longitude,G.Latitude)||[0,0],arrival:T(G.ArrivalTime),departure:T(G.DepartureTime)}}J.default.defs("GK4","+proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000 +y_0=0 +ellps=bessel +datum=potsdam +units=m +no_defs"),J.default.defs("WM","+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 +b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),R.WGS84toGK4=function(G,ct){return J.default("WGS84","GK4",[G,ct]).map(Math.round)},R.WGS84toWm=function(G,ct){return J.default("WGS84","WM",[G,ct]).map(Math.round)},R.WmOrGK4toWGS84=U,R.convertCoordinates=H,R.checkStatus=function(G){if(!G||!G.Status)throw new Error("unexpected error");if("Ok"!==G.Status.Code){const ct=new Error(G.Status.Message);throw ct.name=G.Status.Code,ct}},R.constructError=N,R.convertError=function(G){throw G.response&&G.response.data&&G.response.data.Status?N(G.response.data.Status.Code,G.response.data.Status.Message):G},R.parseDate=T,R.parseDiva=K,R.parsePlatform=Z,R.MODES={Tram:{title:"Stra\xdfenbahn",name:"Tram",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-tram.svg"},CityBus:{title:"Bus",name:"CityBus",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-bus.svg"},IntercityBus:{title:"Regio-Bus",name:"IntercityBus",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-bus.svg"},SuburbanRailway:{title:"S-Bahn",name:"SuburbanRailway",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-metropolitan.svg"},Train:{title:"Zug",name:"Train",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-train.svg"},Cableway:{title:"Seil-/Schwebebahn",name:"Cableway",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-lift.svg"},Ferry:{title:"F\xe4hre",name:"Ferry",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-ferry.svg"},HailedSharedTaxi:{title:"Anrufsammeltaxi (AST)/ Rufbus",name:"HailedSharedTaxi",iconUrl:"https://www.dvb.de/assets/img/trans-icon/transport-alita.svg"},Footpath:{title:"Fussweg",name:"Footpath",iconUrl:"https://m.dvb.de/img/walk.svg"},StairsUp:{title:"Treppe aufw\xe4rts",name:"StairsUp",iconUrl:"https://m.dvb.de/img/stairs-up.svg"},StairsDown:{title:"Treppe abw\xe4rts",name:"StairsDown",iconUrl:"https://m.dvb.de/img/stairs-down.svg"},EscalatorUp:{title:"Rolltreppe aufw\xe4rts",name:"EscalatorUp",iconUrl:"https://m.dvb.de/img/escalator-up.svg"},EscalatorDown:{title:"Rolltreppe abw\xe4rts",name:"EscalatorDown",iconUrl:"https://m.dvb.de/img/escalator-down.svg"},ElevatorUp:{title:"Fahrstuhl aufw\xe4rts",name:"ElevatorUp",iconUrl:"https://m.dvb.de/img/elevator-up.svg"},ElevatorDown:{title:"Fahrstuhl abw\xe4rts",name:"ElevatorDown",iconUrl:"https://m.dvb.de/img/elevator-down.svg"},StayForConnection:{title:"gesicherter Anschluss",name:"StayForConnection",iconUrl:"https://m.dvb.de/img/sit.svg"},PlusBus:{title:"PlusBus",name:"PlusBus",iconUrl:"https://m.dvb.de/img/mot_icons/plusBus.svg"}},R.parseConnections=C,R.parsePin=function(G){const ct=G.split("|"),Ot=U(ct[5],ct[4])||[],Lt=function(G){switch(G){case"":return P.PIN_TYPE.stop;case"p":return P.PIN_TYPE.poi;case"pf":return P.PIN_TYPE.platform;case"pr":return P.PIN_TYPE.parkandride;case"r":return P.PIN_TYPE.rentabike;case"c":return P.PIN_TYPE.carsharing;case"t":return P.PIN_TYPE.ticketmachine}return P.PIN_TYPE.unknown}(ct[1]);return Lt===P.PIN_TYPE.platform?{coords:Ot,id:ct[0],name:ct[3],platformNr:ct[6],type:Lt}:Lt===P.PIN_TYPE.poi||Lt===P.PIN_TYPE.rentabike||Lt===P.PIN_TYPE.ticketmachine||Lt===P.PIN_TYPE.carsharing||Lt===P.PIN_TYPE.unknown?{coords:Ot,id:ct[0],name:ct[3],type:Lt}:Lt===P.PIN_TYPE.parkandride?{coords:Ot,id:ct[0],name:ct[3],info:ct[6],type:Lt}:{coords:Ot,id:ct[0],name:ct[3],connections:C(ct[7]),type:Lt}},R.parseMode=g,R.parsePoiID=function(G){let ct=G.split(":");if(ct.length>=4)switch(ct=ct.slice(0,4),ct[0]){case"streetID":return{id:ct.join(":"),type:P.POI_TYPE.Address};case"coord":return{id:ct.join(":"),type:P.POI_TYPE.Coords};case"poiID":return{id:ct.join(":"),type:P.POI_TYPE.POI}}return{id:G,type:P.POI_TYPE.Stop}},R.extractTrip=function(G){const ct=G.PartialRoutes.map(Ot=>function(G,ct){const Ot=G.RegularStops?G.RegularStops.map(b):[];let Lt,te;if(Ot&&Ot.length>1){const Ht=Ot[0],Ne=Ot[Ot.length-1];Lt={id:Ht.id,name:Ht.name,city:Ht.city,platform:Ht.platform,time:Ht.departure,coords:Ht.coords,type:Ht.type},te={id:Ne.id,name:Ne.name,city:Ne.city,platform:Ne.platform,time:Ne.arrival,coords:Ne.coords,type:Ne.type}}return{stops:Ot,departure:Lt,arrival:te,mode:g(G.Mot.Type),line:G.Mot.Name?G.Mot.Name:"",direction:G.Mot.Direction?G.Mot.Direction.trim():"",diva:K(G.Mot.Diva),duration:G.Duration||1,path:H(ct[G.MapDataIndex])}}(Ot,G.MapData));return{nodes:ct,departure:ct[0].departure,arrival:ct[ct.length-1].arrival,duration:G.Duration||1,interchanges:G.Interchanges}},R.dateDifference=function(G,ct){return Math.round((ct.getTime()-G.getTime())/1e3/60)}},3105:gt=>{"use strict";var E,R="object"==typeof Reflect?Reflect:null,I=R&&"function"==typeof R.apply?R.apply:function(b,x,ht){return Function.prototype.apply.call(b,x,ht)};E=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:function(b){return Object.getOwnPropertyNames(b)};var P=Number.isNaN||function(b){return b!=b};function L(){L.init.call(this)}gt.exports=L,gt.exports.once=function(m,b){return new Promise(function(x,ht){function St(ct){m.removeListener(b,G),ht(ct)}function G(){"function"==typeof m.removeListener&&m.removeListener("error",St),x([].slice.call(arguments))}g(m,b,G,{once:!0}),"error"!==b&&function(m,b,x){"function"==typeof m.on&&g(m,"error",b,{once:!0})}(m,St)})},L.EventEmitter=L,L.prototype._events=void 0,L.prototype._eventsCount=0,L.prototype._maxListeners=void 0;var W=10;function U(m){if("function"!=typeof m)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}function H(m){return void 0===m._maxListeners?L.defaultMaxListeners:m._maxListeners}function B(m,b,x,ht){var St,G,ct;if(U(x),void 0===(G=m._events)?(G=m._events=Object.create(null),m._eventsCount=0):(void 0!==G.newListener&&(m.emit("newListener",b,x.listener?x.listener:x),G=m._events),ct=G[b]),void 0===ct)ct=G[b]=x,++m._eventsCount;else if("function"==typeof ct?ct=G[b]=ht?[x,ct]:[ct,x]:ht?ct.unshift(x):ct.push(x),(St=H(m))>0&&ct.length>St&&!ct.warned){ct.warned=!0;var Ot=new Error("Possible EventEmitter memory leak detected. "+ct.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ot.name="MaxListenersExceededWarning",Ot.emitter=m,Ot.type=b,Ot.count=ct.length,function(m){console&&console.warn&&console.warn(m)}(Ot)}return m}function N(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function F(m,b,x){var ht={fired:!1,wrapFn:void 0,target:m,type:b,listener:x},St=N.bind(ht);return St.listener=x,ht.wrapFn=St,St}function T(m,b,x){var ht=m._events;if(void 0===ht)return[];var St=ht[b];return void 0===St?[]:"function"==typeof St?x?[St.listener||St]:[St]:x?function(m){for(var b=new Array(m.length),x=0;x<b.length;++x)b[x]=m[x].listener||m[x];return b}(St):Z(St,St.length)}function K(m){var b=this._events;if(void 0!==b){var x=b[m];if("function"==typeof x)return 1;if(void 0!==x)return x.length}return 0}function Z(m,b){for(var x=new Array(b),ht=0;ht<b;++ht)x[ht]=m[ht];return x}function g(m,b,x,ht){if("function"==typeof m.on)ht.once?m.once(b,x):m.on(b,x);else{if("function"!=typeof m.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof m);m.addEventListener(b,function St(G){ht.once&&m.removeEventListener(b,St),x(G)})}}Object.defineProperty(L,"defaultMaxListeners",{enumerable:!0,get:function(){return W},set:function(m){if("number"!=typeof m||m<0||P(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");W=m}}),L.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},L.prototype.setMaxListeners=function(b){if("number"!=typeof b||b<0||P(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this},L.prototype.getMaxListeners=function(){return H(this)},L.prototype.emit=function(b){for(var x=[],ht=1;ht<arguments.length;ht++)x.push(arguments[ht]);var St="error"===b,G=this._events;if(void 0!==G)St=St&&void 0===G.error;else if(!St)return!1;if(St){var ct;if(x.length>0&&(ct=x[0]),ct instanceof Error)throw ct;var Ot=new Error("Unhandled error."+(ct?" ("+ct.message+")":""));throw Ot.context=ct,Ot}var Lt=G[b];if(void 0===Lt)return!1;if("function"==typeof Lt)I(Lt,this,x);else{var te=Lt.length,Ht=Z(Lt,te);for(ht=0;ht<te;++ht)I(Ht[ht],this,x)}return!0},L.prototype.on=L.prototype.addListener=function(b,x){return B(this,b,x,!1)},L.prototype.prependListener=function(b,x){return B(this,b,x,!0)},L.prototype.once=function(b,x){return U(x),this.on(b,F(this,b,x)),this},L.prototype.prependOnceListener=function(b,x){return U(x),this.prependListener(b,F(this,b,x)),this},L.prototype.off=L.prototype.removeListener=function(b,x){var ht,St,G,ct,Ot;if(U(x),void 0===(St=this._events))return this;if(void 0===(ht=St[b]))return this;if(ht===x||ht.listener===x)0==--this._eventsCount?this._events=Object.create(null):(delete St[b],St.removeListener&&this.emit("removeListener",b,ht.listener||x));else if("function"!=typeof ht){for(G=-1,ct=ht.length-1;ct>=0;ct--)if(ht[ct]===x||ht[ct].listener===x){Ot=ht[ct].listener,G=ct;break}if(G<0)return this;0===G?ht.shift():function(m,b){for(;b+1<m.length;b++)m[b]=m[b+1];m.pop()}(ht,G),1===ht.length&&(St[b]=ht[0]),void 0!==St.removeListener&&this.emit("removeListener",b,Ot||x)}return this},L.prototype.removeAllListeners=function(b){var x,ht,St;if(void 0===(ht=this._events))return this;if(void 0===ht.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ht[b]&&(0==--this._eventsCount?this._events=Object.create(null):delete ht[b]),this;if(0===arguments.length){var ct,G=Object.keys(ht);for(St=0;St<G.length;++St)"removeListener"!==(ct=G[St])&&this.removeAllListeners(ct);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(x=ht[b]))this.removeListener(b,x);else if(void 0!==x)for(St=x.length-1;St>=0;St--)this.removeListener(b,x[St]);return this},L.prototype.listeners=function(b){return T(this,b,!0)},L.prototype.rawListeners=function(b){return T(this,b,!1)},L.listenerCount=function(m,b){return"function"==typeof m.listenerCount?m.listenerCount(b):K.call(m,b)},L.prototype.listenerCount=K,L.prototype.eventNames=function(){return this._eventsCount>0?E(this._events):[]}},4570:(gt,R,I)=>{"use strict";var J,P,E=[I(5525),I(7246),I(5302),I(1722),I(58),I(449)],L=-1,W=[],U=!1;function H(){!J||!P||(J=!1,P.length?W=P.concat(W):L=-1,W.length&&B())}function B(){if(!J){U=!1,J=!0;for(var nt=W.length,y=setTimeout(H);nt;){for(P=W,W=[];P&&++L<nt;)P[L].run();L=-1,nt=W.length}P=null,L=-1,J=!1,clearTimeout(y)}}for(var N,F=-1,T=E.length;++F<T;)if(E[F]&&E[F].test&&E[F].test()){N=E[F].install(B);break}function K(nt,y){this.fun=nt,this.array=y}K.prototype.run=function(){var nt=this.fun,y=this.array;switch(y.length){case 0:return nt();case 1:return nt(y[0]);case 2:return nt(y[0],y[1]);case 3:return nt(y[0],y[1],y[2]);default:return nt.apply(null,y)}},gt.exports=function(nt){var y=new Array(arguments.length-1);if(arguments.length>1)for(var C=1;C<arguments.length;C++)y[C-1]=arguments[C];W.push(new K(nt,y)),!U&&!J&&(U=!0,N())}},1722:(gt,R)=>{"use strict";R.test=function(){return!global.setImmediate&&void 0!==global.MessageChannel},R.install=function(I){var E=new global.MessageChannel;return E.port1.onmessage=I,function(){E.port2.postMessage(0)}}},5302:(gt,R)=>{"use strict";var I=global.MutationObserver||global.WebKitMutationObserver;R.test=function(){return I},R.install=function(E){var J=0,P=new I(E),L=global.document.createTextNode("");return P.observe(L,{characterData:!0}),function(){L.data=J=++J%2}}},7246:(gt,R)=>{"use strict";R.test=function(){return"function"==typeof global.queueMicrotask},R.install=function(I){return function(){global.queueMicrotask(I)}}},58:(gt,R)=>{"use strict";R.test=function(){return"document"in global&&"onreadystatechange"in global.document.createElement("script")},R.install=function(I){return function(){var E=global.document.createElement("script");return E.onreadystatechange=function(){I(),E.onreadystatechange=null,E.parentNode.removeChild(E),E=null},global.document.documentElement.appendChild(E),I}}},449:(gt,R)=>{"use strict";R.test=function(){return!0},R.install=function(I){return function(){setTimeout(I,0)}}},9879:gt=>{gt.exports="function"==typeof Object.create?function(I,E){E&&(I.super_=E,I.prototype=Object.create(E.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}))}:function(I,E){if(E){I.super_=E;var J=function(){};J.prototype=E.prototype,I.prototype=new J,I.prototype.constructor=I}}},8626:(gt,R)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;const I=[];for(let P=0;P<256;++P)I.push((P+256).toString(16).substr(1));R.default=function(P,L){const W=L||0;return(I[P[W+0]]+I[P[W+1]]+I[P[W+2]]+I[P[W+3]]+"-"+I[P[W+4]]+I[P[W+5]]+"-"+I[P[W+6]]+I[P[W+7]]+"-"+I[P[W+8]]+I[P[W+9]]+"-"+I[P[W+10]]+I[P[W+11]]+I[P[W+12]]+I[P[W+13]]+I[P[W+14]]+I[P[W+15]]).toLowerCase()}},7613:(gt,R,I)=>{"use strict";Object.defineProperty(R,"v1",{enumerable:!0,get:function(){return J.default}}),Object.defineProperty(R,"v3",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(R,"v4",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(R,"v5",{enumerable:!0,get:function(){return W.default}});var J=U(I(427)),P=U(I(7119)),L=U(I(9271)),W=U(I(1024));function U(H){return H&&H.__esModule?H:{default:H}}},8050:(gt,R)=>{"use strict";function J(Z){return 14+(Z+64>>>9<<4)+1}function W(Z,nt){const y=(65535&Z)+(65535&nt);return(Z>>16)+(nt>>16)+(y>>16)<<16|65535&y}function H(Z,nt,y,C,w,g){return W(function(Z,nt){return Z<<nt|Z>>>32-nt}(W(W(nt,Z),W(C,g)),w),y)}function B(Z,nt,y,C,w,g,m){return H(nt&y|~nt&C,Z,nt,w,g,m)}function N(Z,nt,y,C,w,g,m){return H(nt&C|y&~C,Z,nt,w,g,m)}function F(Z,nt,y,C,w,g,m){return H(nt^y^C,Z,nt,w,g,m)}function T(Z,nt,y,C,w,g,m){return H(y^(nt|~C),Z,nt,w,g,m)}Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0,R.default=function(Z){if("string"==typeof Z){const nt=unescape(encodeURIComponent(Z));Z=new Uint8Array(nt.length);for(let y=0;y<nt.length;++y)Z[y]=nt.charCodeAt(y)}return function(Z){const nt=[],y=32*Z.length,C="0123456789abcdef";for(let w=0;w<y;w+=8){const g=Z[w>>5]>>>w%32&255,m=parseInt(C.charAt(g>>>4&15)+C.charAt(15&g),16);nt.push(m)}return nt}(function(Z,nt){Z[nt>>5]|=128<<nt%32,Z[J(nt)-1]=nt;let y=1732584193,C=-271733879,w=-1732584194,g=271733878;for(let m=0;m<Z.length;m+=16){const b=y,x=C,ht=w,St=g;y=B(y,C,w,g,Z[m],7,-680876936),g=B(g,y,C,w,Z[m+1],12,-389564586),w=B(w,g,y,C,Z[m+2],17,606105819),C=B(C,w,g,y,Z[m+3],22,-1044525330),y=B(y,C,w,g,Z[m+4],7,-176418897),g=B(g,y,C,w,Z[m+5],12,1200080426),w=B(w,g,y,C,Z[m+6],17,-1473231341),C=B(C,w,g,y,Z[m+7],22,-45705983),y=B(y,C,w,g,Z[m+8],7,1770035416),g=B(g,y,C,w,Z[m+9],12,-1958414417),w=B(w,g,y,C,Z[m+10],17,-42063),C=B(C,w,g,y,Z[m+11],22,-1990404162),y=B(y,C,w,g,Z[m+12],7,1804603682),g=B(g,y,C,w,Z[m+13],12,-40341101),w=B(w,g,y,C,Z[m+14],17,-1502002290),C=B(C,w,g,y,Z[m+15],22,1236535329),y=N(y,C,w,g,Z[m+1],5,-165796510),g=N(g,y,C,w,Z[m+6],9,-1069501632),w=N(w,g,y,C,Z[m+11],14,643717713),C=N(C,w,g,y,Z[m],20,-373897302),y=N(y,C,w,g,Z[m+5],5,-701558691),g=N(g,y,C,w,Z[m+10],9,38016083),w=N(w,g,y,C,Z[m+15],14,-660478335),C=N(C,w,g,y,Z[m+4],20,-405537848),y=N(y,C,w,g,Z[m+9],5,568446438),g=N(g,y,C,w,Z[m+14],9,-1019803690),w=N(w,g,y,C,Z[m+3],14,-187363961),C=N(C,w,g,y,Z[m+8],20,1163531501),y=N(y,C,w,g,Z[m+13],5,-1444681467),g=N(g,y,C,w,Z[m+2],9,-51403784),w=N(w,g,y,C,Z[m+7],14,1735328473),C=N(C,w,g,y,Z[m+12],20,-1926607734),y=F(y,C,w,g,Z[m+5],4,-378558),g=F(g,y,C,w,Z[m+8],11,-2022574463),w=F(w,g,y,C,Z[m+11],16,1839030562),C=F(C,w,g,y,Z[m+14],23,-35309556),y=F(y,C,w,g,Z[m+1],4,-1530992060),g=F(g,y,C,w,Z[m+4],11,1272893353),w=F(w,g,y,C,Z[m+7],16,-155497632),C=F(C,w,g,y,Z[m+10],23,-1094730640),y=F(y,C,w,g,Z[m+13],4,681279174),g=F(g,y,C,w,Z[m],11,-358537222),w=F(w,g,y,C,Z[m+3],16,-722521979),C=F(C,w,g,y,Z[m+6],23,76029189),y=F(y,C,w,g,Z[m+9],4,-640364487),g=F(g,y,C,w,Z[m+12],11,-421815835),w=F(w,g,y,C,Z[m+15],16,530742520),C=F(C,w,g,y,Z[m+2],23,-995338651),y=T(y,C,w,g,Z[m],6,-198630844),g=T(g,y,C,w,Z[m+7],10,1126891415),w=T(w,g,y,C,Z[m+14],15,-1416354905),C=T(C,w,g,y,Z[m+5],21,-57434055),y=T(y,C,w,g,Z[m+12],6,1700485571),g=T(g,y,C,w,Z[m+3],10,-1894986606),w=T(w,g,y,C,Z[m+10],15,-1051523),C=T(C,w,g,y,Z[m+1],21,-2054922799),y=T(y,C,w,g,Z[m+8],6,1873313359),g=T(g,y,C,w,Z[m+15],10,-30611744),w=T(w,g,y,C,Z[m+6],15,-1560198380),C=T(C,w,g,y,Z[m+13],21,1309151649),y=T(y,C,w,g,Z[m+4],6,-145523070),g=T(g,y,C,w,Z[m+11],10,-1120210379),w=T(w,g,y,C,Z[m+2],15,718787259),C=T(C,w,g,y,Z[m+9],21,-343485551),y=W(y,b),C=W(C,x),w=W(w,ht),g=W(g,St)}return[y,C,w,g]}(function(Z){if(0===Z.length)return[];const nt=8*Z.length,y=new Uint32Array(J(nt));for(let C=0;C<nt;C+=8)y[C>>5]|=(255&Z[C/8])<<C%32;return y}(Z),8*Z.length))}},4175:(gt,R)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){if(!I)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(E)};const I="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),E=new Uint8Array(16)},4032:(gt,R)=>{"use strict";function I(L,W,U,H){switch(L){case 0:return W&U^~W&H;case 1:return W^U^H;case 2:return W&U^W&H^U&H;case 3:return W^U^H}}function E(L,W){return L<<W|L>>>32-W}Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0,R.default=function(L){const W=[1518500249,1859775393,2400959708,3395469782],U=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof L){const F=unescape(encodeURIComponent(L));L=[];for(let T=0;T<F.length;++T)L.push(F.charCodeAt(T))}L.push(128);const B=Math.ceil((L.length/4+2)/16),N=new Array(B);for(let F=0;F<B;++F){const T=new Uint32Array(16);for(let K=0;K<16;++K)T[K]=L[64*F+4*K]<<24|L[64*F+4*K+1]<<16|L[64*F+4*K+2]<<8|L[64*F+4*K+3];N[F]=T}N[B-1][14]=8*(L.length-1)/Math.pow(2,32),N[B-1][14]=Math.floor(N[B-1][14]),N[B-1][15]=8*(L.length-1)&4294967295;for(let F=0;F<B;++F){const T=new Uint32Array(80);for(let w=0;w<16;++w)T[w]=N[F][w];for(let w=16;w<80;++w)T[w]=E(T[w-3]^T[w-8]^T[w-14]^T[w-16],1);let K=U[0],Z=U[1],nt=U[2],y=U[3],C=U[4];for(let w=0;w<80;++w){const g=Math.floor(w/20),m=E(K,5)+I(g,Z,nt,y)+C+W[g]+T[w]>>>0;C=y,y=nt,nt=E(Z,30)>>>0,Z=K,K=m}U[0]=U[0]+K>>>0,U[1]=U[1]+Z>>>0,U[2]=U[2]+nt>>>0,U[3]=U[3]+y>>>0,U[4]=U[4]+C>>>0}return[U[0]>>24&255,U[0]>>16&255,U[0]>>8&255,255&U[0],U[1]>>24&255,U[1]>>16&255,U[1]>>8&255,255&U[1],U[2]>>24&255,U[2]>>16&255,U[2]>>8&255,255&U[2],U[3]>>24&255,U[3]>>16&255,U[3]>>8&255,255&U[3],U[4]>>24&255,U[4]>>16&255,U[4]>>8&255,255&U[4]]}},427:(gt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var E=P(I(4175)),J=P(I(8626));function P(F){return F&&F.__esModule?F:{default:F}}let L,W,U=0,H=0;R.default=function(F,T,K){let Z=T&&K||0;const nt=T||[];let y=(F=F||{}).node||L,C=void 0!==F.clockseq?F.clockseq:W;if(null==y||null==C){const ht=F.random||(F.rng||E.default)();null==y&&(y=L=[1|ht[0],ht[1],ht[2],ht[3],ht[4],ht[5]]),null==C&&(C=W=16383&(ht[6]<<8|ht[7]))}let w=void 0!==F.msecs?F.msecs:Date.now(),g=void 0!==F.nsecs?F.nsecs:H+1;const m=w-U+(g-H)/1e4;if(m<0&&void 0===F.clockseq&&(C=C+1&16383),(m<0||w>U)&&void 0===F.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");U=w,H=g,W=C,w+=122192928e5;const b=(1e4*(268435455&w)+g)%4294967296;nt[Z++]=b>>>24&255,nt[Z++]=b>>>16&255,nt[Z++]=b>>>8&255,nt[Z++]=255&b;const x=w/4294967296*1e4&268435455;nt[Z++]=x>>>8&255,nt[Z++]=255&x,nt[Z++]=x>>>24&15|16,nt[Z++]=x>>>16&255,nt[Z++]=C>>>8|128,nt[Z++]=255&C;for(let ht=0;ht<6;++ht)nt[Z+ht]=y[ht];return T||(0,J.default)(nt)}},7119:(gt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var E=P(I(1959)),J=P(I(8050));function P(U){return U&&U.__esModule?U:{default:U}}var W=(0,E.default)("v3",48,J.default);R.default=W},1959:(gt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(B,N,F){function T(K,Z,nt,y){const C=nt&&y||0;if("string"==typeof K&&(K=function(B){B=unescape(encodeURIComponent(B));const N=[];for(let F=0;F<B.length;++F)N.push(B.charCodeAt(F));return N}(K)),"string"==typeof Z&&(Z=function(B){const N=[];return B.replace(/[a-fA-F0-9]{2}/g,function(F){N.push(parseInt(F,16))}),N}(Z)),!Array.isArray(K))throw TypeError("value must be an array of bytes");if(!Array.isArray(Z)||16!==Z.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");const w=F(Z.concat(K));if(w[6]=15&w[6]|N,w[8]=63&w[8]|128,nt)for(let g=0;g<16;++g)nt[C+g]=w[g];return nt||(0,E.default)(w)}try{T.name=B}catch(K){}return T.DNS=W,T.URL=U,T},R.URL=R.DNS=void 0;var B,E=(B=I(8626))&&B.__esModule?B:{default:B};const W="6ba7b810-9dad-11d1-80b4-00c04fd430c8";R.DNS=W;const U="6ba7b811-9dad-11d1-80b4-00c04fd430c8";R.URL=U},9271:(gt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var E=P(I(4175)),J=P(I(8626));function P(U){return U&&U.__esModule?U:{default:U}}R.default=function(U,H,B){"string"==typeof U&&(H="binary"===U?new Uint8Array(16):null,U=null);const N=(U=U||{}).random||(U.rng||E.default)();if(N[6]=15&N[6]|64,N[8]=63&N[8]|128,H){const F=B||0;for(let T=0;T<16;++T)H[F+T]=N[T];return H}return(0,J.default)(N)}},1024:(gt,R,I)=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var E=P(I(1959)),J=P(I(4032));function P(U){return U&&U.__esModule?U:{default:U}}var W=(0,E.default)("v5",80,J.default);R.default=W},8994:(gt,R,I)=>{"use strict";I.r(R),I.d(R,{default:()=>ma});var H=6378137,N=.0066943799901413165,F=484813681109536e-20,T=Math.PI/2,y=1e-10,C=.017453292519943295,w=57.29577951308232,g=Math.PI/4,m=2*Math.PI,b=3.14159265359,x={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const ht={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var St=/[\s_\-\/\(\)]/g;function G(r,a){if(r[a])return r[a];for(var v,s=Object.keys(r),h=a.toLowerCase().replace(St,""),c=-1;++c<s.length;)if((v=s[c]).toLowerCase().replace(St,"")===h)return r[v]}function ct(r){var h,c,v,a={},s=r.split("+").map(function(l){return l.trim()}).filter(function(l){return l}).reduce(function(l,S){var D=S.split("=");return D.push(!0),l[D[0].toLowerCase()]=D[1],l},{}),p={proj:"projName",datum:"datumCode",rf:function(l){a.rf=parseFloat(l)},lat_0:function(l){a.lat0=l*C},lat_1:function(l){a.lat1=l*C},lat_2:function(l){a.lat2=l*C},lat_ts:function(l){a.lat_ts=l*C},lon_0:function(l){a.long0=l*C},lon_1:function(l){a.long1=l*C},lon_2:function(l){a.long2=l*C},alpha:function(l){a.alpha=parseFloat(l)*C},gamma:function(l){a.rectified_grid_angle=parseFloat(l)},lonc:function(l){a.longc=l*C},x_0:function(l){a.x0=parseFloat(l)},y_0:function(l){a.y0=parseFloat(l)},k_0:function(l){a.k0=parseFloat(l)},k:function(l){a.k0=parseFloat(l)},a:function(l){a.a=parseFloat(l)},b:function(l){a.b=parseFloat(l)},r_a:function(){a.R_A=!0},zone:function(l){a.zone=parseInt(l,10)},south:function(){a.utmSouth=!0},towgs84:function(l){a.datum_params=l.split(",").map(function(S){return parseFloat(S)})},to_meter:function(l){a.to_meter=parseFloat(l)},units:function(l){a.units=l;var S=G(ht,l);S&&(a.to_meter=S.to_meter)},from_greenwich:function(l){a.from_greenwich=l*C},pm:function(l){var S=G(x,l);a.from_greenwich=(S||parseFloat(l))*C},nadgrids:function(l){"@null"===l?a.datumCode="none":a.nadgrids=l},axis:function(l){var S="ewnsud";3===l.length&&-1!==S.indexOf(l.substr(0,1))&&-1!==S.indexOf(l.substr(1,1))&&-1!==S.indexOf(l.substr(2,1))&&(a.axis=l)},approx:function(){a.approx=!0}};for(h in s)c=s[h],h in p?"function"==typeof(v=p[h])?v(c):a[v]=c:a[h]=c;return"string"==typeof a.datumCode&&"WGS84"!==a.datumCode&&(a.datumCode=a.datumCode.toLowerCase()),a}var r,_a=/\s/,Le=/[A-Za-z]/,$r=/[A-Za-z84]/,yn=/[,\]]/,ya=/[\d\.E\-\+]/;function Ue(r){if("string"!=typeof r)throw new Error("not a string");this.text=r.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function fi(r,a,s){Array.isArray(a)&&(s.unshift(a),a=null);var c=s.reduce(function(v,p){return Ye(p,v),v},a?{}:r);a&&(r[a]=c)}function Ye(r,a){if(Array.isArray(r)){var s=r.shift();if("PARAMETER"===s&&(s=r.shift()),1===r.length)return Array.isArray(r[0])?(a[s]={},void Ye(r[0],a[s])):void(a[s]=r[0]);if(r.length)if("TOWGS84"!==s){if("AXIS"===s)return s in a||(a[s]=[]),void a[s].push(r);var h;switch(Array.isArray(s)||(a[s]={}),s){case"UNIT":case"PRIMEM":case"VERT_DATUM":return a[s]={name:r[0].toLowerCase(),convert:r[1]},void(3===r.length&&Ye(r[2],a[s]));case"SPHEROID":case"ELLIPSOID":return a[s]={name:r[0],a:r[1],rf:r[2]},void(4===r.length&&Ye(r[3],a[s]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return r[0]=["name",r[0]],void fi(a,s,r);default:for(h=-1;++h<r.length;)if(!Array.isArray(r[h]))return Ye(r,a[s]);return fi(a,s,r)}}else a[s]=r;else a[s]=!0}else a[r]=!0}function Ae(r){return.017453292519943295*r}function Te(r){var a=function(r){return new Ue(r).output()}(r),s=a.shift(),h=a.shift();a.unshift(["name",h]),a.unshift(["type",s]);var c={};return Ye(a,c),function(r){if("GEOGCS"===r.type?r.projName="longlat":"LOCAL_CS"===r.type?(r.projName="identity",r.local=!0):r.projName="object"==typeof r.PROJECTION?Object.keys(r.PROJECTION)[0]:r.PROJECTION,r.AXIS){for(var a="",s=0,h=r.AXIS.length;s<h;++s){var c=[r.AXIS[s][0].toLowerCase(),r.AXIS[s][1].toLowerCase()];-1!==c[0].indexOf("north")||("y"===c[0]||"lat"===c[0])&&"north"===c[1]?a+="n":-1!==c[0].indexOf("south")||("y"===c[0]||"lat"===c[0])&&"south"===c[1]?a+="s":-1!==c[0].indexOf("east")||("x"===c[0]||"lon"===c[0])&&"east"===c[1]?a+="e":(-1!==c[0].indexOf("west")||("x"===c[0]||"lon"===c[0])&&"west"===c[1])&&(a+="w")}2===a.length&&(a+="u"),3===a.length&&(r.axis=a)}r.UNIT&&(r.units=r.UNIT.name.toLowerCase(),"metre"===r.units&&(r.units="meter"),r.UNIT.convert&&("GEOGCS"===r.type?r.DATUM&&r.DATUM.SPHEROID&&(r.to_meter=r.UNIT.convert*r.DATUM.SPHEROID.a):r.to_meter=r.UNIT.convert));var v=r.GEOGCS;function p(D){return D*(r.to_meter||1)}"GEOGCS"===r.type&&(v=r),v&&(r.datumCode=v.DATUM?v.DATUM.name.toLowerCase():v.name.toLowerCase(),"d_"===r.datumCode.slice(0,2)&&(r.datumCode=r.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===r.datumCode||"new_zealand_1949"===r.datumCode)&&(r.datumCode="nzgd49"),("wgs_1984"===r.datumCode||"world_geodetic_system_1984"===r.datumCode)&&("Mercator_Auxiliary_Sphere"===r.PROJECTION&&(r.sphere=!0),r.datumCode="wgs84"),"_ferro"===r.datumCode.slice(-6)&&(r.datumCode=r.datumCode.slice(0,-6)),"_jakarta"===r.datumCode.slice(-8)&&(r.datumCode=r.datumCode.slice(0,-8)),~r.datumCode.indexOf("belge")&&(r.datumCode="rnb72"),v.DATUM&&v.DATUM.SPHEROID&&(r.ellps=v.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===r.ellps.toLowerCase().slice(0,13)&&(r.ellps="intl"),r.a=v.DATUM.SPHEROID.a,r.rf=parseFloat(v.DATUM.SPHEROID.rf,10)),v.DATUM&&v.DATUM.TOWGS84&&(r.datum_params=v.DATUM.TOWGS84),~r.datumCode.indexOf("osgb_1936")&&(r.datumCode="osgb36"),~r.datumCode.indexOf("osni_1952")&&(r.datumCode="osni52"),(~r.datumCode.indexOf("tm65")||~r.datumCode.indexOf("geodetic_datum_of_1965"))&&(r.datumCode="ire65"),"ch1903+"===r.datumCode&&(r.datumCode="ch1903"),~r.datumCode.indexOf("israel")&&(r.datumCode="isr93")),r.b&&!isFinite(r.b)&&(r.b=r.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ae],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ae],["x0","false_easting",p],["y0","false_northing",p],["long0","central_meridian",Ae],["lat0","latitude_of_origin",Ae],["lat0","standard_parallel_1",Ae],["lat1","standard_parallel_1",Ae],["lat2","standard_parallel_2",Ae],["azimuth","Azimuth"],["alpha","azimuth",Ae],["srsCode","name"]].forEach(function(D){return function(r,a){var s=a[0],h=a[1];!(s in r)&&h in r&&(r[s]=r[h],3===a.length&&(r[s]=a[2](r[s])))}(r,D)}),!r.long0&&r.longc&&("Albers_Conic_Equal_Area"===r.projName||"Lambert_Azimuthal_Equal_Area"===r.projName)&&(r.long0=r.longc),!r.lat_ts&&r.lat1&&("Stereographic_South_Pole"===r.projName||"Polar Stereographic (variant B)"===r.projName)&&(r.lat0=Ae(r.lat1>0?90:-90),r.lat_ts=r.lat1)}(c),c}function Ee(r){var a=this;if(2===arguments.length){var s=arguments[1];Ee[r]="string"==typeof s?"+"===s.charAt(0)?ct(arguments[1]):Te(arguments[1]):s}else if(1===arguments.length){if(Array.isArray(r))return r.map(function(h){Array.isArray(h)?Ee.apply(a,h):Ee(h)});if("string"==typeof r){if(r in Ee)return Ee[r]}else"EPSG"in r?Ee["EPSG:"+r.EPSG]=r:"ESRI"in r?Ee["ESRI:"+r.ESRI]=r:"IAU2000"in r?Ee["IAU2000:"+r.IAU2000]=r:console.log(r);return}}Ue.prototype.readCharicter=function(){var r=this.text[this.place++];if(4!==this.state)for(;_a.test(r);){if(this.place>=this.text.length)return;r=this.text[this.place++]}switch(this.state){case 1:return this.neutral(r);case 2:return this.keyword(r);case 4:return this.quoted(r);case 5:return this.afterquote(r);case 3:return this.number(r);case-1:return}},Ue.prototype.afterquote=function(r){if('"'===r)return this.word+='"',void(this.state=4);if(yn.test(r))return this.word=this.word.trim(),void this.afterItem(r);throw new Error("havn't handled \""+r+'" in afterquote yet, index '+this.place)},Ue.prototype.afterItem=function(r){return","===r?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===r?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Ue.prototype.number=function(r){if(!ya.test(r)){if(yn.test(r))return this.word=parseFloat(this.word),void this.afterItem(r);throw new Error("havn't handled \""+r+'" in number yet, index '+this.place)}this.word+=r},Ue.prototype.quoted=function(r){'"'!==r?this.word+=r:this.state=5},Ue.prototype.keyword=function(r){if($r.test(r))this.word+=r;else{if("["===r){var a=[];return a.push(this.word),this.level++,null===this.root?this.root=a:this.currentObject.push(a),this.stack.push(this.currentObject),this.currentObject=a,void(this.state=1)}if(!yn.test(r))throw new Error("havn't handled \""+r+'" in keyword yet, index '+this.place);this.afterItem(r)}},Ue.prototype.neutral=function(r){if(Le.test(r))return this.word=r,void(this.state=2);if('"'===r)return this.word="",void(this.state=4);if(ya.test(r))return this.word=r,void(this.state=3);if(!yn.test(r))throw new Error("havn't handled \""+r+'" in neutral yet, index '+this.place);this.afterItem(r)},Ue.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)},(r=Ee)("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),r("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),r("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),r.WGS84=r["EPSG:4326"],r["EPSG:3785"]=r["EPSG:3857"],r.GOOGLE=r["EPSG:3857"],r["EPSG:900913"]=r["EPSG:3857"],r["EPSG:102113"]=r["EPSG:3857"];const _e=Ee;var Je=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],Sa=["3857","900913","3785","102113"];function Mn(r,a){var s,h;if(r=r||{},!a)return r;for(h in a)void 0!==(s=a[h])&&(r[h]=s);return r}function Be(r,a,s){var h=r*a;return s/Math.sqrt(1-h*h)}function Er(r){return r<0?-1:1}function Mt(r){return Math.abs(r)<=b?r:r-Er(r)*m}function Pe(r,a,s){var h=r*s;return h=Math.pow((1-h)/(1+h),.5*r),Math.tan(.5*(T-a))/h}function gr(r,a){for(var h,c,s=.5*r,v=T-2*Math.atan(a),p=0;p<=15;p++)if(h=r*Math.sin(v),v+=c=T-2*Math.atan(a*Math.pow((1-h)/(1+h),s))-v,Math.abs(c)<=1e-10)return v;return-9999}function wn(r){return r}var Pa=[{init:function(){var r=this.b/this.a;this.es=1-r*r,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):Be(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function(r){var h,c,a=r.x,s=r.y;if(s*w>90&&s*w<-90&&a*w>180&&a*w<-180)return null;if(Math.abs(Math.abs(s)-T)<=y)return null;if(this.sphere)h=this.x0+this.a*this.k0*Mt(a-this.long0),c=this.y0+this.a*this.k0*Math.log(Math.tan(g+.5*s));else{var v=Math.sin(s),p=Pe(this.e,s,v);h=this.x0+this.a*this.k0*Mt(a-this.long0),c=this.y0-this.a*this.k0*Math.log(p)}return r.x=h,r.y=c,r},inverse:function(r){var h,c,a=r.x-this.x0,s=r.y-this.y0;if(this.sphere)c=T-2*Math.atan(Math.exp(-s/(this.a*this.k0)));else{var v=Math.exp(-s/(this.a*this.k0));if(-9999===(c=gr(this.e,v)))return null}return h=Mt(this.long0+a/(this.a*this.k0)),r.x=h,r.y=c,r},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:wn,inverse:wn,names:["longlat","identity"]}],Qe={},be=[];function di(r,a){var s=be.length;return r.names?(be[s]=r,r.names.forEach(function(h){Qe[h.toLowerCase()]=s}),this):(console.log(a),!0)}const Cn={start:function(){Pa.forEach(di)},add:di,get:function(r){if(!r)return!1;var a=r.toLowerCase();return void 0!==Qe[a]&&be[Qe[a]]?be[Qe[a]]:void 0}};var Rt={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},ie=Rt.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Rt.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var ee={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};var mi={};function gi(r){if(0===r.length)return null;var a="@"===r[0];return a&&(r=r.slice(1)),"null"===r?{name:"null",mandatory:!a,grid:null,isNull:!0}:{name:r,mandatory:!a,grid:mi[r]||null,isNull:!1}}function Ve(r){return r/3600*Math.PI/180}function Kr(r,a,s){return String.fromCharCode.apply(null,new Uint8Array(r.buffer.slice(a,s)))}function An(r){return r.map(function(a){return[Ve(a.longitudeShift),Ve(a.latitudeShift)]})}function Ro(r,a,s){return{name:Kr(r,a+8,a+16).trim(),parent:Kr(r,a+24,a+24+8).trim(),lowerLatitude:r.getFloat64(a+72,s),upperLatitude:r.getFloat64(a+88,s),lowerLongitude:r.getFloat64(a+104,s),upperLongitude:r.getFloat64(a+120,s),latitudeInterval:r.getFloat64(a+136,s),longitudeInterval:r.getFloat64(a+152,s),gridNodeCount:r.getInt32(a+168,s)}}function On(r,a,s,h){for(var c=a+176,p=[],l=0;l<s.gridNodeCount;l++){var S={latitudeShift:r.getFloat32(c+16*l,h),longitudeShift:r.getFloat32(c+16*l+4,h),latitudeAccuracy:r.getFloat32(c+16*l+8,h),longitudeAccuracy:r.getFloat32(c+16*l+12,h)};p.push(S)}return p}function Dr(r,a){if(!(this instanceof Dr))return new Dr(r);a=a||function(D){if(D)throw D};var s=function(r){if(!function(r){return"string"==typeof r}(r))return r;if(function(r){return r in _e}(r))return _e[r];if(function(r){return Je.some(function(a){return r.indexOf(a)>-1})}(r)){var a=Te(r);if(function(r){var a=G(r,"authority");if(a){var s=G(a,"epsg");return s&&Sa.indexOf(s)>-1}}(a))return _e["EPSG:3857"];var s=function(r){var a=G(r,"extension");if(a)return G(a,"proj4")}(a);return s?ct(s):a}return function(r){return"+"===r[0]}(r)?ct(r):void 0}(r);if("object"==typeof s){var h=Dr.projections.get(s.projName);if(h){if(s.datumCode&&"none"!==s.datumCode){var c=G(ee,s.datumCode);c&&(s.datum_params=s.datum_params||(c.towgs84?c.towgs84.split(","):null),s.ellps=c.ellipse,s.datumName=c.datumName?c.datumName:s.datumCode)}s.k0=s.k0||1,s.axis=s.axis||"enu",s.ellps=s.ellps||"wgs84",s.lat1=s.lat1||s.lat0;var v=function(r,a,s,h,c){if(!r){var v=G(Rt,h);v||(v=ie),r=v.a,a=v.b,s=v.rf}return s&&!a&&(a=(1-1/s)*r),(0===s||Math.abs(r-a)<y)&&(c=!0,a=r),{a:r,b:a,rf:s,sphere:c}}(s.a,s.b,s.rf,s.ellps,s.sphere),p=function(r,a,s,h){var c=r*r,v=a*a,p=(c-v)/c,l=0;return h?(c=(r*=1-p*(.16666666666666666+p*(.04722222222222222+.022156084656084655*p)))*r,p=0):l=Math.sqrt(p),{es:p,e:l,ep2:(c-v)/v}}(v.a,v.b,0,s.R_A),l=function(r){return void 0===r?null:r.split(",").map(gi)}(s.nadgrids),S=s.datum||function(r,a,s,h,c,v,p){var l={};return l.datum_type=void 0===r||"none"===r?5:4,a&&(l.datum_params=a.map(parseFloat),(0!==l.datum_params[0]||0!==l.datum_params[1]||0!==l.datum_params[2])&&(l.datum_type=1),l.datum_params.length>3&&(0!==l.datum_params[3]||0!==l.datum_params[4]||0!==l.datum_params[5]||0!==l.datum_params[6])&&(l.datum_type=2,l.datum_params[3]*=F,l.datum_params[4]*=F,l.datum_params[5]*=F,l.datum_params[6]=l.datum_params[6]/1e6+1)),p&&(l.datum_type=3,l.grids=p),l.a=s,l.b=h,l.es=c,l.ep2=v,l}(s.datumCode,s.datum_params,v.a,v.b,p.es,p.ep2,l);Mn(this,s),Mn(this,h),this.a=v.a,this.b=v.b,this.rf=v.rf,this.sphere=v.sphere,this.es=p.es,this.e=p.e,this.ep2=p.ep2,this.datum=S,this.init(),a(null,this)}else a(r)}else a(r)}(Dr.projections=Cn).start();const Vr=Dr;function Tn(r,a,s){var p,l,D,h=r.x,c=r.y,v=r.z?r.z:0;if(c<-T&&c>-1.001*T)c=-T;else if(c>T&&c<1.001*T)c=T;else{if(c<-T)return{x:-1/0,y:-1/0,z:r.z};if(c>T)return{x:1/0,y:1/0,z:r.z}}return h>Math.PI&&(h-=2*Math.PI),l=Math.sin(c),D=Math.cos(c),{x:((p=s/Math.sqrt(1-a*(l*l)))+v)*D*Math.cos(h),y:(p+v)*D*Math.sin(h),z:(p*(1-a)+v)*l}}function Ra(r,a,s,h){var l,S,D,X,z,st,ft,dt,lt,mt,Pt,Ft,Qt,we,Ze,$t=r.x,Jt=r.y,Xt=r.z?r.z:0;if(l=Math.sqrt($t*$t+Jt*Jt),S=Math.sqrt($t*$t+Jt*Jt+Xt*Xt),l/s<1e-12){if(we=0,S/s<1e-12)return Ze=-h,{x:r.x,y:r.y,z:r.z}}else we=Math.atan2(Jt,$t);D=Xt/S,dt=(X=l/S)*(1-a)*(z=1/Math.sqrt(1-a*(2-a)*X*X)),lt=D*z,Qt=0;do{Qt++,st=a*(ft=s/Math.sqrt(1-a*lt*lt))/(ft+(Ze=l*dt+Xt*lt-ft*(1-a*lt*lt))),Ft=(Pt=D*(z=1/Math.sqrt(1-st*(2-st)*X*X)))*dt-(mt=X*(1-st)*z)*lt,dt=mt,lt=Pt}while(Ft*Ft>1e-24&&Qt<30);return{x:we,y:Math.atan(Pt/Math.abs(mt)),z:Ze}}function jt(r){return 1===r||2===r}function pi(r,a,s){if(null===r.grids||0===r.grids.length)return console.log("Grid shift grids not found"),-1;for(var h={x:-s.x,y:s.y},c={x:Number.NaN,y:Number.NaN},p=[],l=0;l<r.grids.length;l++){var S=r.grids[l];if(p.push(S.name),S.isNull){c=h;break}if(null!==S.grid){var D=S.grid.subgrids[0],X=(Math.abs(D.del[1])+Math.abs(D.del[0]))/1e4;if(!(D.ll[1]-X>h.y||D.ll[0]-X>h.x||D.ll[1]+(D.lim[1]-1)*D.del[1]+X<h.y||D.ll[0]+(D.lim[0]-1)*D.del[0]+X<h.x||(c=En(h,a,D),isNaN(c.x))))break}else if(S.mandatory)return console.log("Unable to find mandatory grid '"+S.name+"'"),-1}return isNaN(c.x)?(console.log("Failed to find a grid shift table for location '"+-h.x*w+" "+h.y*w+" tried: '"+p+"'"),-1):(s.x=-c.x,s.y=c.y,0)}function En(r,a,s){var h={x:Number.NaN,y:Number.NaN};if(isNaN(r.x))return h;var c={x:r.x,y:r.y};c.x-=s.ll[0],c.y-=s.ll[1],c.x=Mt(c.x-Math.PI)+Math.PI;var v=Ir(c,s);if(a){if(isNaN(v.x))return h;v.x=c.x-v.x,v.y=c.y-v.y;var S,D,p=9;do{if(D=Ir(v,s),isNaN(D.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}v.x+=(S={x:c.x-(D.x+v.x),y:c.y-(D.y+v.y)}).x,v.y+=S.y}while(p--&&Math.abs(S.x)>1e-12&&Math.abs(S.y)>1e-12);if(p<0)return console.log("Inverse grid shift iterator failed to converge."),h;h.x=Mt(v.x+s.ll[0]),h.y=v.y+s.ll[1]}else isNaN(v.x)||(h.x=r.x+v.x,h.y=r.y+v.y);return h}function Ir(r,a){var p,s={x:r.x/a.del[0],y:r.y/a.del[1]},h_x=Math.floor(s.x),h_y=Math.floor(s.y),c_x=s.x-1*h_x,c_y=s.y-1*h_y,v={x:Number.NaN,y:Number.NaN};if(h_x<0||h_x>=a.lim[0]||h_y<0||h_y>=a.lim[1])return v;var l_x=a.cvs[p=h_y*a.lim[0]+h_x][0],l_y=a.cvs[p][1];p++;var S_x=a.cvs[p][0],S_y=a.cvs[p][1],D_x=a.cvs[p+=a.lim[0]][0],D_y=a.cvs[p][1];p--;var X_y=a.cvs[p][1],z=c_x*c_y,st=c_x*(1-c_y),ft=(1-c_x)*(1-c_y),dt=(1-c_x)*c_y;return v.x=ft*l_x+st*S_x+dt*a.cvs[p][0]+z*D_x,v.y=ft*l_y+st*S_y+dt*X_y+z*D_y,v}function Pn(r,a,s){var p,l,S,h=s.x,c=s.y,v=s.z||0,D={};for(S=0;S<3;S++)if(!a||2!==S||void 0!==s.z)switch(0===S?(p=h,l=-1!=="ew".indexOf(r.axis[S])?"x":"y"):1===S?(p=c,l=-1!=="ns".indexOf(r.axis[S])?"y":"x"):(p=v,l="z"),r.axis[S]){case"e":D[l]=p;break;case"w":D[l]=-p;break;case"n":D[l]=p;break;case"s":D[l]=-p;break;case"u":void 0!==s[l]&&(D.z=p);break;case"d":void 0!==s[l]&&(D.z=-p);break;default:return null}return D}function qe(r){var a={x:r[0],y:r[1]};return r.length>2&&(a.z=r[2]),r.length>3&&(a.m=r[3]),a}function tn(r){if("function"==typeof Number.isFinite){if(Number.isFinite(r))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof r||r!=r||!isFinite(r))throw new TypeError("coordinates must be finite numbers")}function Nr(r,a,s,h){var c;if(Array.isArray(s)&&(s=qe(s)),function(r){tn(r.x),tn(r.y)}(s),r.datum&&a.datum&&function(r,a){return(1===r.datum.datum_type||2===r.datum.datum_type)&&"WGS84"!==a.datumCode||(1===a.datum.datum_type||2===a.datum.datum_type)&&"WGS84"!==r.datumCode}(r,a)&&(s=Nr(r,c=new Vr("WGS84"),s,h),r=c),h&&"enu"!==r.axis&&(s=Pn(r,!1,s)),"longlat"===r.projName)s={x:s.x*C,y:s.y*C,z:s.z||0};else if(r.to_meter&&(s={x:s.x*r.to_meter,y:s.y*r.to_meter,z:s.z||0}),!(s=r.inverse(s)))return;if(r.from_greenwich&&(s.x+=r.from_greenwich),s=function(r,a,s){if(function(r,a){return!(r.datum_type!==a.datum_type||r.a!==a.a||Math.abs(r.es-a.es)>5e-11)&&(1===r.datum_type?r.datum_params[0]===a.datum_params[0]&&r.datum_params[1]===a.datum_params[1]&&r.datum_params[2]===a.datum_params[2]:2!==r.datum_type||r.datum_params[0]===a.datum_params[0]&&r.datum_params[1]===a.datum_params[1]&&r.datum_params[2]===a.datum_params[2]&&r.datum_params[3]===a.datum_params[3]&&r.datum_params[4]===a.datum_params[4]&&r.datum_params[5]===a.datum_params[5]&&r.datum_params[6]===a.datum_params[6])}(r,a)||5===r.datum_type||5===a.datum_type)return s;var h=r.a,c=r.es;if(3===r.datum_type){if(0!==pi(r,!1,s))return;h=H,c=N}var p=a.a,l=a.b,S=a.es;return 3===a.datum_type&&(p=H,l=6356752.314,S=N),c!==S||h!==p||jt(r.datum_type)||jt(a.datum_type)?(s=Tn(s,c,h),jt(r.datum_type)&&(s=function(r,a,s){if(1===a)return{x:r.x+s[0],y:r.y+s[1],z:r.z+s[2]};if(2===a){var p=s[3],l=s[4],S=s[5],D=s[6];return{x:D*(r.x-S*r.y+l*r.z)+s[0],y:D*(S*r.x+r.y-p*r.z)+s[1],z:D*(-l*r.x+p*r.y+r.z)+s[2]}}}(s,r.datum_type,r.datum_params)),jt(a.datum_type)&&(s=function(r,a,s){if(1===a)return{x:r.x-s[0],y:r.y-s[1],z:r.z-s[2]};if(2===a){var p=s[3],l=s[4],S=s[5],D=s[6],X=(r.x-s[0])/D,z=(r.y-s[1])/D,st=(r.z-s[2])/D;return{x:X+S*z-l*st,y:-S*X+z+p*st,z:l*X-p*z+st}}}(s,a.datum_type,a.datum_params)),s=Ra(s,S,p,l),3!==a.datum_type||0===pi(a,!0,s)?s:void 0):s}(r.datum,a.datum,s))return a.from_greenwich&&(s={x:s.x-a.from_greenwich,y:s.y,z:s.z||0}),"longlat"===a.projName?s={x:s.x*w,y:s.y*w,z:s.z||0}:(s=a.forward(s),a.to_meter&&(s={x:s.x/a.to_meter,y:s.y/a.to_meter,z:s.z||0})),h&&"enu"!==a.axis?Pn(a,!0,s):s}var Dn=Vr("WGS84");function In(r,a,s,h){var c,v,p;return Array.isArray(s)?(c=Nr(r,a,s,h)||{x:NaN,y:NaN},s.length>2?void 0!==r.name&&"geocent"===r.name||void 0!==a.name&&"geocent"===a.name?"number"==typeof c.z?[c.x,c.y,c.z].concat(s.splice(3)):[c.x,c.y,s[2]].concat(s.splice(3)):[c.x,c.y].concat(s.splice(2)):[c.x,c.y]):(v=Nr(r,a,s,h),2===(p=Object.keys(s)).length||p.forEach(function(l){if(void 0!==r.name&&"geocent"===r.name||void 0!==a.name&&"geocent"===a.name){if("x"===l||"y"===l||"z"===l)return}else if("x"===l||"y"===l)return;v[l]=s[l]}),v)}function yi(r){return r instanceof Vr?r:r.oProj?r.oProj:Vr(r)}const Se=function(r,a,s){r=yi(r);var c,h=!1;return void 0===a?(a=r,r=Dn,h=!0):(void 0!==a.x||Array.isArray(a))&&(s=a,a=r,r=Dn,h=!0),a=yi(a),s?In(r,a,s):(c={forward:function(v,p){return In(r,a,v,p)},inverse:function(v,p){return In(a,r,v,p)}},h&&(c.oProj=a),c)};const Ua={forward:Nn,inverse:function(r){var a=Rn(kn(r.toUpperCase()));return a.lat&&a.lon?[a.lon,a.lat,a.lon,a.lat]:[a.left,a.bottom,a.right,a.top]},toPoint:rn};function Nn(r,a){return a=a||5,function(r,a){var s="00000"+r.easting,h="00000"+r.northing;return r.zoneNumber+r.zoneLetter+function(r,a,s){var h=nn(s);return function(r,a,s){var h=s-1,c="AJSAJS".charCodeAt(h),v="AFAFAF".charCodeAt(h),p=c+r-1,l=v+a,S=!1;return p>90&&(p=p-90+65-1,S=!0),(73===p||c<73&&p>73||(p>73||c<73)&&S)&&p++,(79===p||c<79&&p>79||(p>79||c<79)&&S)&&73==++p&&p++,p>90&&(p=p-90+65-1),l>86?(l=l-86+65-1,S=!0):S=!1,(73===l||v<73&&l>73||(l>73||v<73)&&S)&&l++,(79===l||v<79&&l>79||(l>79||v<79)&&S)&&73==++l&&l++,l>86&&(l=l-86+65-1),String.fromCharCode(p)+String.fromCharCode(l)}(Math.floor(r/1e5),Math.floor(a/1e5)%20,h)}(r.easting,r.northing,r.zoneNumber)+s.substr(s.length-5,a)+h.substr(h.length-5,a)}(function(r){var l,S,D,X,z,lt,mt,a=r.lat,s=r.lon,h=6378137,c=.00669438,v=.9996,ft=qn(a),dt=qn(s);mt=Math.floor((s+180)/6)+1,180===s&&(mt=60),a>=56&&a<64&&s>=3&&s<12&&(mt=32),a>=72&&a<84&&(s>=0&&s<9?mt=31:s>=9&&s<21?mt=33:s>=21&&s<33?mt=35:s>=33&&s<42&&(mt=37)),lt=qn(6*(mt-1)-180+3),l=c/(1-c),S=h/Math.sqrt(1-c*Math.sin(ft)*Math.sin(ft)),D=Math.tan(ft)*Math.tan(ft),X=l*Math.cos(ft)*Math.cos(ft);var Pt=v*S*((z=Math.cos(ft)*(dt-lt))+(1-D+X)*z*z*z/6+(5-18*D+D*D+72*X-58*l)*z*z*z*z*z/120)+5e5,Ft=v*(h*(.9983242984503243*ft-.002514607064228144*Math.sin(2*ft)+2639046602129982e-21*Math.sin(4*ft)-35*c*c*c/3072*Math.sin(6*ft))+S*Math.tan(ft)*(z*z/2+(5-D+9*X+4*X*X)*z*z*z*z/24+(61-58*D+D*D+600*X-330*l)*z*z*z*z*z*z/720));return a<0&&(Ft+=1e7),{northing:Math.round(Ft),easting:Math.round(Pt),zoneNumber:mt,zoneLetter:Fa(a)}}({lat:r[1],lon:r[0]}),a)}function rn(r){var a=Rn(kn(r.toUpperCase()));return a.lat&&a.lon?[a.lon,a.lat]:[(a.left+a.right)/2,(a.top+a.bottom)/2]}function qn(r){return r*(Math.PI/180)}function Si(r){return r/Math.PI*180}function Rn(r){var a=r.northing,s=r.easting,h=r.zoneLetter,c=r.zoneNumber;if(c<0||c>60)return null;var S,X,z,st,ft,dt,mt,Pt,Ft,v=.9996,p=6378137,l=.00669438,D=(1-Math.sqrt(1-l))/(1+Math.sqrt(1-l)),Qt=s-5e5,$t=a;h<"N"&&($t-=1e7),mt=6*(c-1)-180+3,S=l/(1-l),Ft=(Pt=$t/v/6367449.145945056)+(3*D/2-27*D*D*D/32)*Math.sin(2*Pt)+(21*D*D/16-55*D*D*D*D/32)*Math.sin(4*Pt)+151*D*D*D/96*Math.sin(6*Pt),X=p/Math.sqrt(1-l*Math.sin(Ft)*Math.sin(Ft)),z=Math.tan(Ft)*Math.tan(Ft),st=S*Math.cos(Ft)*Math.cos(Ft),ft=p*(1-l)/Math.pow(1-l*Math.sin(Ft)*Math.sin(Ft),1.5),dt=Qt/(X*v);var Jt=Ft-X*Math.tan(Ft)/ft*(dt*dt/2-(5+3*z+10*st-4*st*st-9*S)*dt*dt*dt*dt/24+(61+90*z+298*st+45*z*z-252*S-3*st*st)*dt*dt*dt*dt*dt*dt/720);Jt=Si(Jt);var we,Xt=(dt-(1+2*z+st)*dt*dt*dt/6+(5-2*st+28*z-3*st*st+8*S+24*z*z)*dt*dt*dt*dt*dt/120)/Math.cos(Ft);if(Xt=mt+Si(Xt),r.accuracy){var he=Rn({northing:r.northing+r.accuracy,easting:r.easting+r.accuracy,zoneLetter:r.zoneLetter,zoneNumber:r.zoneNumber});we={top:he.lat,right:he.lon,bottom:Jt,left:Xt}}else we={lat:Jt,lon:Xt};return we}function Fa(r){var a="Z";return 84>=r&&r>=72?a="X":72>r&&r>=64?a="W":64>r&&r>=56?a="V":56>r&&r>=48?a="U":48>r&&r>=40?a="T":40>r&&r>=32?a="S":32>r&&r>=24?a="R":24>r&&r>=16?a="Q":16>r&&r>=8?a="P":8>r&&r>=0?a="N":0>r&&r>=-8?a="M":-8>r&&r>=-16?a="L":-16>r&&r>=-24?a="K":-24>r&&r>=-32?a="J":-32>r&&r>=-40?a="H":-40>r&&r>=-48?a="G":-48>r&&r>=-56?a="F":-56>r&&r>=-64?a="E":-64>r&&r>=-72?a="D":-72>r&&r>=-80&&(a="C"),a}function nn(r){var a=r%6;return 0===a&&(a=6),a}function kn(r){if(r&&0===r.length)throw"MGRSPoint coverting from nothing";for(var c,a=r.length,s=null,h="",v=0;!/[A-Z]/.test(c=r.charAt(v));){if(v>=2)throw"MGRSPoint bad conversion from: "+r;h+=c,v++}var p=parseInt(h,10);if(0===v||v+3>a)throw"MGRSPoint bad conversion from: "+r;var l=r.charAt(v++);if(l<="A"||"B"===l||"Y"===l||l>="Z"||"I"===l||"O"===l)throw"MGRSPoint zone letter "+l+" not handled: "+r;s=r.substring(v,v+=2);for(var S=nn(p),D=function(r,a){for(var s="AJSAJS".charCodeAt(a-1),h=1e5,c=!1;s!==r.charCodeAt(0);){if(73==++s&&s++,79===s&&s++,s>90){if(c)throw"Bad character: "+r;s=65,c=!0}h+=1e5}return h}(s.charAt(0),S),X=function(r,a){if(r>"V")throw"MGRSPoint given invalid Northing "+r;for(var s="AFAFAF".charCodeAt(a-1),h=0,c=!1;s!==r.charCodeAt(0);){if(73==++s&&s++,79===s&&s++,s>86){if(c)throw"Bad character: "+r;s=65,c=!0}h+=1e5}return h}(s.charAt(1),S);X<nr(l);)X+=2e6;var z=a-v;if(z%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+r;var lt,mt,Pt,st=z/2,ft=0,dt=0;return st>0&&(lt=1e5/Math.pow(10,st),mt=r.substring(v,v+st),ft=parseFloat(mt)*lt,Pt=r.substring(v+st),dt=parseFloat(Pt)*lt),{easting:ft+D,northing:dt+X,zoneLetter:l,zoneNumber:p,accuracy:lt}}function nr(r){var a;switch(r){case"C":a=11e5;break;case"D":a=2e6;break;case"E":a=28e5;break;case"F":a=37e5;break;case"G":a=46e5;break;case"H":a=55e5;break;case"J":a=64e5;break;case"K":a=73e5;break;case"L":a=82e5;break;case"M":a=91e5;break;case"N":a=0;break;case"P":a=8e5;break;case"Q":a=17e5;break;case"R":a=26e5;break;case"S":a=35e5;break;case"T":a=44e5;break;case"U":a=53e5;break;case"V":a=62e5;break;case"W":a=7e6;break;case"X":a=79e5;break;default:a=-1}if(a>=0)return a;throw"Invalid zone letter: "+r}function yr(r,a,s){if(!(this instanceof yr))return new yr(r,a,s);if(Array.isArray(r))this.x=r[0],this.y=r[1],this.z=r[2]||0;else if("object"==typeof r)this.x=r.x,this.y=r.y,this.z=r.z||0;else if("string"==typeof r&&void 0===a){var h=r.split(",");this.x=parseFloat(h[0],10),this.y=parseFloat(h[1],10),this.z=parseFloat(h[2],10)||0}else this.x=r,this.y=a,this.z=s||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}yr.fromMGRS=function(r){return new yr(rn(r))},yr.prototype.toMGRS=function(r){return Nn([this.x,this.y],r)};const Ln=yr;var Ci=.01953125,Ai=.01068115234375;function Di(r){var a=[];a[0]=1-r*(.25+r*(.046875+r*(Ci+r*Ai))),a[1]=r*(.75-r*(.046875+r*(Ci+r*Ai)));var s=r*r;return a[2]=s*(.46875-r*(.013020833333333334+.007120768229166667*r)),a[3]=(s*=r)*(.3645833333333333-.005696614583333333*r),a[4]=s*r*.3076171875,a}function sn(r,a,s,h){return h[0]*r-(s*=a)*(h[1]+(a*=a)*(h[2]+a*(h[3]+a*h[4])))}function $e(r,a,s){for(var h=1/(1-a),c=r,v=20;v;--v){var p=Math.sin(c),l=1-a*p*p;if(c-=l=(sn(c,p,Math.cos(c),s)-r)*(l*Math.sqrt(l))*h,Math.abs(l)<y)return c}return c}const kr={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Di(this.es),this.ml0=sn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(r){var c,v,p,s=r.y,h=Mt(r.x-this.long0),l=Math.sin(s),S=Math.cos(s);if(this.es){var X=S*h,z=Math.pow(X,2),st=this.ep2*Math.pow(S,2),ft=Math.pow(st,2),dt=Math.abs(S)>y?Math.tan(s):0,lt=Math.pow(dt,2),mt=Math.pow(lt,2);c=1-this.es*Math.pow(l,2),X/=Math.sqrt(c);var Pt=sn(s,l,S,this.en);v=this.a*(this.k0*X*(1+z/6*(1-lt+st+z/20*(5-18*lt+mt+14*st-58*lt*st+z/42*(61+179*mt-mt*lt-479*lt)))))+this.x0,p=this.a*(this.k0*(Pt-this.ml0+l*h*X/2*(1+z/12*(5-lt+9*st+4*ft+z/30*(61+mt-58*lt+270*st-330*lt*st+z/56*(1385+543*mt-mt*lt-3111*lt))))))+this.y0}else{var D=S*Math.sin(h);if(Math.abs(Math.abs(D)-1)<y)return 93;if(v=.5*this.a*this.k0*Math.log((1+D)/(1-D))+this.x0,p=S*Math.cos(h)/Math.sqrt(1-Math.pow(D,2)),(D=Math.abs(p))>=1){if(D-1>y)return 93;p=0}else p=Math.acos(p);s<0&&(p=-p),p=this.a*this.k0*(p-this.lat0)+this.y0}return r.x=v,r.y=p,r},inverse:function(r){var a,s,h,c,v=1/this.a*(r.x-this.x0),p=1/this.a*(r.y-this.y0);if(this.es)if(s=$e(a=this.ml0+p/this.k0,this.es,this.en),Math.abs(s)<T){var z=Math.sin(s),st=Math.cos(s),ft=Math.abs(st)>y?Math.tan(s):0,dt=this.ep2*Math.pow(st,2),lt=Math.pow(dt,2),mt=Math.pow(ft,2),Pt=Math.pow(mt,2);a=1-this.es*Math.pow(z,2);var Ft=v*Math.sqrt(a)/this.k0,Qt=Math.pow(Ft,2);h=s-(a*=ft)*Qt/(1-this.es)*.5*(1-Qt/12*(5+3*mt-9*dt*mt+dt-4*lt-Qt/30*(61+90*mt-252*dt*mt+45*Pt+46*dt-Qt/56*(1385+3633*mt+4095*Pt+1574*Pt*mt)))),c=Mt(this.long0+Ft*(1-Qt/6*(1+2*mt+dt-Qt/20*(5+28*mt+24*Pt+8*dt*mt+6*dt-Qt/42*(61+662*mt+1320*Pt+720*Pt*mt))))/st)}else h=T*Er(p),c=0;else{var l=Math.exp(v/this.k0),S=.5*(l-1/l),X=Math.cos(this.lat0+p/this.k0);a=Math.sqrt((1-Math.pow(X,2))/(1+Math.pow(S,2))),h=Math.asin(a),p<0&&(h=-h),c=0===S&&0===X?0:Mt(Math.atan2(S,X)+this.long0)}return r.x=c,r.y=h,r},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function on(r){var a=Math.exp(r);return(a-1/a)/2}function un(r,a){r=Math.abs(r),a=Math.abs(a);var s=Math.max(r,a),h=Math.min(r,a)/(s||1);return s*Math.sqrt(1+Math.pow(h,2))}function Fn(r,a){for(var p,s=2*Math.cos(2*a),h=r.length-1,c=r[h],v=0;--h>=0;)p=s*c-v+r[h],v=c,c=p;return a+p*Math.sin(2*a)}function se(r,a,s){for(var dt,lt,h=Math.sin(a),c=Math.cos(a),v=on(s),p=function(r){var a=Math.exp(r);return(a+1/a)/2}(s),l=2*c*p,S=-2*h*v,D=r.length-1,X=r[D],z=0,st=0,ft=0;--D>=0;)dt=st,lt=z,X=l*(st=X)-dt-S*(z=ft)+r[D],ft=S*st-lt+l*z;return[(l=h*p)*X-(S=c*v)*ft,l*ft+S*X]}const cn={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(kr.init.apply(this),this.forward=kr.forward,this.inverse=kr.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var r=this.es/(1+Math.sqrt(1-this.es)),a=r/(2-r),s=a;this.cgb[0]=a*(2+a*(-2/3+a*(a*(116/45+a*(26/45+a*(-2854/675)))-2))),this.cbg[0]=a*(a*(2/3+a*(4/3+a*(-82/45+a*(32/45+a*(4642/4725)))))-2),this.cgb[1]=(s*=a)*(7/3+a*(a*(-227/45+a*(2704/315+a*(2323/945)))-1.6)),this.cbg[1]=s*(5/3+a*(-16/15+a*(-13/9+a*(904/315+a*(-1522/945))))),this.cgb[2]=(s*=a)*(56/15+a*(-136/35+a*(-1262/105+a*(73814/2835)))),this.cbg[2]=s*(-26/15+a*(34/21+a*(1.6+a*(-12686/2835)))),this.cgb[3]=(s*=a)*(4279/630+a*(-332/35+a*(-399572/14175))),this.cbg[3]=s*(1237/630+a*(a*(-24832/14175)-2.4)),this.cgb[4]=(s*=a)*(4174/315+a*(-144838/6237)),this.cbg[4]=s*(-734/315+a*(109598/31185)),this.cgb[5]=(s*=a)*(601676/22275),this.cbg[5]=s*(444337/155925),s=Math.pow(a,2),this.Qn=this.k0/(1+a)*(1+s*(1/4+s*(1/64+s/256))),this.utg[0]=a*(a*(2/3+a*(-37/96+a*(1/360+a*(81/512+a*(-96199/604800)))))-.5),this.gtu[0]=a*(.5+a*(-2/3+a*(5/16+a*(41/180+a*(-127/288+a*(7891/37800)))))),this.utg[1]=s*(-1/48+a*(-1/15+a*(437/1440+a*(-46/105+a*(1118711/3870720))))),this.gtu[1]=s*(13/48+a*(a*(557/1440+a*(281/630+a*(-1983433/1935360)))-.6)),this.utg[2]=(s*=a)*(-17/480+a*(37/840+a*(209/4480+a*(-5569/90720)))),this.gtu[2]=s*(61/240+a*(-103/140+a*(15061/26880+a*(167603/181440)))),this.utg[3]=(s*=a)*(-4397/161280+a*(11/504+a*(830251/7257600))),this.gtu[3]=s*(49561/161280+a*(-179/168+a*(6601661/7257600))),this.utg[4]=(s*=a)*(-4583/161280+a*(108847/3991680)),this.gtu[4]=s*(34729/80640+a*(-3418889/1995840)),this.utg[5]=(s*=a)*(-20648693/638668800),this.gtu[5]=.6650675310896665*s;var h=Fn(this.cbg,this.lat0);this.Zb=-this.Qn*(h+function(r,a){for(var p,s=2*Math.cos(a),h=r.length-1,c=r[h],v=0;--h>=0;)p=s*c-v+r[h],v=c,c=p;return Math.sin(a)*p}(this.gtu,2*h))},forward:function(r){var a=Mt(r.x-this.long0),s=r.y;s=Fn(this.cbg,s);var h=Math.sin(s),c=Math.cos(s),v=Math.sin(a),p=Math.cos(a);s=Math.atan2(h,p*c),a=Math.atan2(v*c,un(h,c*p)),a=function(r){var a=Math.abs(r);return a=function(r){var a=1+r,s=a-1;return 0===s?r:r*Math.log(a)/s}(a*(1+a/(un(1,a)+1))),r<0?-a:a}(Math.tan(a));var S,D,l=se(this.gtu,2*s,2*a);return s+=l[0],a+=l[1],Math.abs(a)<=2.623395162778?(S=this.a*(this.Qn*a)+this.x0,D=this.a*(this.Qn*s+this.Zb)+this.y0):(S=1/0,D=1/0),r.x=S,r.y=D,r},inverse:function(r){var h,c,a=1/this.a*(r.x-this.x0),s=1/this.a*(r.y-this.y0);if(s=(s-this.Zb)/this.Qn,a/=this.Qn,Math.abs(a)<=2.623395162778){var v=se(this.utg,2*s,2*a);s+=v[0],a+=v[1],a=Math.atan(on(a));var p=Math.sin(s),l=Math.cos(s),S=Math.sin(a),D=Math.cos(a);s=Math.atan2(p*D,un(S,D*l)),h=Mt((a=Math.atan2(S,D*l))+this.long0),c=Fn(this.cgb,s)}else h=1/0,c=1/0;return r.x=h,r.y=c,r},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]},rs={init:function(){var r=function(r,a){if(void 0===r){if((r=Math.floor(30*(Mt(a)+Math.PI)/Math.PI)+1)<0)return 0;if(r>60)return 60}return r}(this.zone,this.long0);if(void 0===r)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(r)-183)*C,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,cn.init.apply(this),this.forward=cn.forward,this.inverse=cn.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function fn(r,a){return Math.pow((1-r)/(1+r),a)}const jn={init:function(){var r=Math.sin(this.lat0),a=Math.cos(this.lat0);a*=a,this.rc=Math.sqrt(1-this.es)/(1-this.es*r*r),this.C=Math.sqrt(1+this.es*a*a/(1-this.es)),this.phic0=Math.asin(r/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+g)/(Math.pow(Math.tan(.5*this.lat0+g),this.C)*fn(this.e*r,this.ratexp))},forward:function(r){var a=r.x,s=r.y;return r.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*s+g),this.C)*fn(this.e*Math.sin(s),this.ratexp))-T,r.x=this.C*a,r},inverse:function(r){for(var s=r.x/this.C,h=r.y,c=Math.pow(Math.tan(.5*h+g)/this.K,1/this.C),v=20;v>0&&(h=2*Math.atan(c*fn(this.e*Math.sin(r.y),-.5*this.e))-T,!(Math.abs(h-r.y)<1e-14));--v)r.y=h;return v?(r.x=s,r.y=h,r):null},names:["gauss"]},us={init:function(){jn.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(r){var a,s,h,c;return r.x=Mt(r.x-this.long0),jn.forward.apply(this,[r]),a=Math.sin(r.y),s=Math.cos(r.y),h=Math.cos(r.x),r.x=(c=this.k0*this.R2/(1+this.sinc0*a+this.cosc0*s*h))*s*Math.sin(r.x),r.y=c*(this.cosc0*a-this.sinc0*s*h),r.x=this.a*r.x+this.x0,r.y=this.a*r.y+this.y0,r},inverse:function(r){var a,s,h,c,v;if(r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,r.x/=this.k0,r.y/=this.k0,v=Math.sqrt(r.x*r.x+r.y*r.y)){var p=2*Math.atan2(v,this.R2);a=Math.sin(p),s=Math.cos(p),c=Math.asin(s*this.sinc0+r.y*a*this.cosc0/v),h=Math.atan2(r.x*a,v*this.cosc0*s-r.y*this.sinc0*a)}else c=this.phic0,h=0;return r.x=h,r.y=c,jn.inverse.apply(this,[r]),r.x=Mt(r.x+this.long0),r},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},Fi={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=y&&(this.k0=.5*(1+Er(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=y&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=y&&(this.k0=.5*this.cons*Be(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Pe(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Be(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-T,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(r){var v,p,l,S,D,X,a=r.x,s=r.y,h=Math.sin(s),c=Math.cos(s),z=Mt(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=y&&Math.abs(s+this.lat0)<=y?(r.x=NaN,r.y=NaN,r):this.sphere?(v=2*this.k0/(1+this.sinlat0*h+this.coslat0*c*Math.cos(z)),r.x=this.a*v*c*Math.sin(z)+this.x0,r.y=this.a*v*(this.coslat0*h-this.sinlat0*c*Math.cos(z))+this.y0,r):(p=2*Math.atan(this.ssfn_(s,h,this.e))-T,S=Math.cos(p),l=Math.sin(p),Math.abs(this.coslat0)<=y?(D=Pe(this.e,s*this.con,this.con*h),r.x=this.x0+(X=2*this.a*this.k0*D/this.cons)*Math.sin(a-this.long0),r.y=this.y0-this.con*X*Math.cos(a-this.long0),r):(Math.abs(this.sinlat0)<y?(v=2*this.a*this.k0/(1+S*Math.cos(z)),r.y=v*l):(v=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*l+this.cosX0*S*Math.cos(z))),r.y=v*(this.cosX0*l-this.sinX0*S*Math.cos(z))+this.y0),r.x=v*S*Math.sin(z)+this.x0,r))},inverse:function(r){r.x-=this.x0,r.y-=this.y0;var a,s,c,v,p=Math.sqrt(r.x*r.x+r.y*r.y);if(this.sphere){var l=2*Math.atan(p/(2*this.a*this.k0));return a=this.long0,s=this.lat0,p<=y?(r.x=a,r.y=s,r):(s=Math.asin(Math.cos(l)*this.sinlat0+r.y*Math.sin(l)*this.coslat0/p),a=Math.abs(this.coslat0)<y?Mt(this.lat0>0?this.long0+Math.atan2(r.x,-1*r.y):this.long0+Math.atan2(r.x,r.y)):Mt(this.long0+Math.atan2(r.x*Math.sin(l),p*this.coslat0*Math.cos(l)-r.y*this.sinlat0*Math.sin(l))),r.x=a,r.y=s,r)}if(Math.abs(this.coslat0)<=y){if(p<=y)return s=this.lat0,r.x=a=this.long0,r.y=s,r;r.x*=this.con,r.y*=this.con,s=this.con*gr(this.e,p*this.cons/(2*this.a*this.k0)),a=this.con*Mt(this.con*this.long0+Math.atan2(r.x,-1*r.y))}else c=2*Math.atan(p*this.cosX0/(2*this.a*this.k0*this.ms1)),a=this.long0,p<=y?v=this.X0:(v=Math.asin(Math.cos(c)*this.sinX0+r.y*Math.sin(c)*this.cosX0/p),a=Mt(this.long0+Math.atan2(r.x*Math.sin(c),p*this.cosX0*Math.cos(c)-r.y*this.sinX0*Math.sin(c)))),s=-1*gr(this.e,Math.tan(.5*(T+v)));return r.x=a,r.y=s,r},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(r,a,s){return a*=s,Math.tan(.5*(T+r))*Math.pow((1-a)/(1+a),.5*s)}},ls={init:function(){var r=this.lat0;this.lambda0=this.long0;var a=Math.sin(r),s=this.a,c=1/this.rf,v=2*c-Math.pow(c,2),p=this.e=Math.sqrt(v);this.R=this.k0*s*Math.sqrt(1-v)/(1-v*Math.pow(a,2)),this.alpha=Math.sqrt(1+v/(1-v)*Math.pow(Math.cos(r),4)),this.b0=Math.asin(a/this.alpha);var l=Math.log(Math.tan(Math.PI/4+this.b0/2)),S=Math.log(Math.tan(Math.PI/4+r/2)),D=Math.log((1+p*a)/(1-p*a));this.K=l-this.alpha*S+this.alpha*p/2*D},forward:function(r){var a=Math.log(Math.tan(Math.PI/4-r.y/2)),s=this.e/2*Math.log((1+this.e*Math.sin(r.y))/(1-this.e*Math.sin(r.y))),c=2*(Math.atan(Math.exp(-this.alpha*(a+s)+this.K))-Math.PI/4),v=this.alpha*(r.x-this.lambda0),p=Math.atan(Math.sin(v)/(Math.sin(this.b0)*Math.tan(c)+Math.cos(this.b0)*Math.cos(v))),l=Math.asin(Math.cos(this.b0)*Math.sin(c)-Math.sin(this.b0)*Math.cos(c)*Math.cos(v));return r.y=this.R/2*Math.log((1+Math.sin(l))/(1-Math.sin(l)))+this.y0,r.x=this.R*p+this.x0,r},inverse:function(r){for(var h=(r.x-this.x0)/this.R,c=2*(Math.atan(Math.exp((r.y-this.y0)/this.R))-Math.PI/4),v=Math.asin(Math.cos(this.b0)*Math.sin(c)+Math.sin(this.b0)*Math.cos(c)*Math.cos(h)),p=Math.atan(Math.sin(h)/(Math.cos(this.b0)*Math.cos(h)-Math.sin(this.b0)*Math.tan(c))),l=this.lambda0+p/this.alpha,S=0,D=v,X=-1e3,z=0;Math.abs(D-X)>1e-7;){if(++z>20)return;S=1/this.alpha*(Math.log(Math.tan(Math.PI/4+v/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(D))/2)),X=D,D=2*Math.atan(Math.exp(S))-Math.PI/2}return r.x=l,r.y=D,r},names:["somerc"]};var Me=1e-7;const _s={init:function(){var r,a,s,h,c,v,p,l,S,D,z,X=0,st=0,ft=0,dt=0,lt=0,mt=0,Pt=0;this.no_off=function(r){var s="object"==typeof r.PROJECTION?Object.keys(r.PROJECTION)[0]:r.PROJECTION;return"no_uoff"in r||"no_off"in r||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(s)}(this),this.no_rot="no_rot"in this;var Qt=!1;"alpha"in this&&(Qt=!0);var $t=!1;if("rectified_grid_angle"in this&&($t=!0),Qt&&(Pt=this.alpha),$t&&(X=this.rectified_grid_angle*C),Qt||$t)st=this.longc;else if(ft=this.long1,lt=this.lat1,dt=this.long2,mt=this.lat2,Math.abs(lt-mt)<=Me||(r=Math.abs(lt))<=Me||Math.abs(r-T)<=Me||Math.abs(Math.abs(this.lat0)-T)<=Me||Math.abs(Math.abs(mt)-T)<=Me)throw new Error;var Jt=1-this.es;a=Math.sqrt(Jt),Math.abs(this.lat0)>y?(l=Math.sin(this.lat0),s=Math.cos(this.lat0),r=1-this.es*l*l,this.B=s*s,this.B=Math.sqrt(1+this.es*this.B*this.B/Jt),this.A=this.B*this.k0*a/r,(c=(h=this.B*a/(s*Math.sqrt(r)))*h-1)<=0?c=0:(c=Math.sqrt(c),this.lat0<0&&(c=-c)),this.E=c+=h,this.E*=Math.pow(Pe(this.e,this.lat0,l),this.B)):(this.B=1/a,this.A=this.k0,this.E=h=c=1),Qt||$t?(Qt?(z=Math.asin(Math.sin(Pt)/h),$t||(X=Pt)):(z=X,Pt=Math.asin(h*Math.sin(z))),this.lam0=st-Math.asin(.5*(c-1/c)*Math.tan(z))/this.B):(v=Math.pow(Pe(this.e,lt,Math.sin(lt)),this.B),p=Math.pow(Pe(this.e,mt,Math.sin(mt)),this.B),c=this.E/v,S=(p-v)/(p+v),D=((D=this.E*this.E)-p*v)/(D+p*v),(r=ft-dt)<-Math.pi?dt-=m:r>Math.pi&&(dt+=m),this.lam0=Mt(.5*(ft+dt)-Math.atan(D*Math.tan(.5*this.B*(ft-dt))/S)/this.B),z=Math.atan(2*Math.sin(this.B*Mt(ft-this.lam0))/(c-1/c)),X=Pt=Math.asin(h*Math.sin(z))),this.singam=Math.sin(z),this.cosgam=Math.cos(z),this.sinrot=Math.sin(X),this.cosrot=Math.cos(X),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(h*h-1)/Math.cos(Pt))),this.lat0<0&&(this.u_0=-this.u_0)),c=.5*z,this.v_pole_n=this.ArB*Math.log(Math.tan(g-c)),this.v_pole_s=this.ArB*Math.log(Math.tan(g+c))},forward:function(r){var s,h,c,v,p,l,S,D,a={};if(r.x=r.x-this.lam0,Math.abs(Math.abs(r.y)-T)>y){if(s=.5*((p=this.E/Math.pow(Pe(this.e,r.y,Math.sin(r.y)),this.B))-(l=1/p)),h=.5*(p+l),v=Math.sin(this.B*r.x),c=(s*this.singam-v*this.cosgam)/h,Math.abs(Math.abs(c)-1)<y)throw new Error;D=.5*this.ArB*Math.log((1-c)/(1+c)),l=Math.cos(this.B*r.x),S=Math.abs(l)<Me?this.A*r.x:this.ArB*Math.atan2(s*this.cosgam+v*this.singam,l)}else D=r.y>0?this.v_pole_n:this.v_pole_s,S=this.ArB*r.y;return this.no_rot?(a.x=S,a.y=D):(a.x=D*this.cosrot+(S-=this.u_0)*this.sinrot,a.y=S*this.cosrot-D*this.sinrot),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a},inverse:function(r){var a,s,h,c,v,p,l,S={};if(r.x=1/this.a*(r.x-this.x0),r.y=1/this.a*(r.y-this.y0),this.no_rot?(s=r.y,a=r.x):(s=r.x*this.cosrot-r.y*this.sinrot,a=r.y*this.cosrot+r.x*this.sinrot+this.u_0),c=.5*((h=Math.exp(-this.BrA*s))-1/h),v=.5*(h+1/h),l=((p=Math.sin(this.BrA*a))*this.cosgam+c*this.singam)/v,Math.abs(Math.abs(l)-1)<y)S.x=0,S.y=l<0?-T:T;else{if(S.y=this.E/Math.sqrt((1+l)/(1-l)),S.y=gr(this.e,Math.pow(S.y,1/this.B)),S.y===1/0)throw new Error;S.x=-this.rB*Math.atan2(c*this.cosgam-p*this.singam,Math.cos(this.BrA*a))}return S.x+=this.lam0,S},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},wr={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<y)){var r=this.b/this.a;this.e=Math.sqrt(1-r*r);var a=Math.sin(this.lat1),s=Math.cos(this.lat1),h=Be(this.e,a,s),c=Pe(this.e,this.lat1,a),v=Math.sin(this.lat2),p=Math.cos(this.lat2),l=Be(this.e,v,p),S=Pe(this.e,this.lat2,v),D=Pe(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>y?Math.log(h/l)/Math.log(c/S):a,isNaN(this.ns)&&(this.ns=a),this.f0=h/(this.ns*Math.pow(c,this.ns)),this.rh=this.a*this.f0*Math.pow(D,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(r){var a=r.x,s=r.y;Math.abs(2*Math.abs(s)-Math.PI)<=y&&(s=Er(s)*(T-2*y));var c,v,h=Math.abs(Math.abs(s)-T);if(h>y)c=Pe(this.e,s,Math.sin(s)),v=this.a*this.f0*Math.pow(c,this.ns);else{if((h=s*this.ns)<=0)return null;v=0}var p=this.ns*Mt(a-this.long0);return r.x=this.k0*(v*Math.sin(p))+this.x0,r.y=this.k0*(this.rh-v*Math.cos(p))+this.y0,r},inverse:function(r){var a,s,h,c,v,p=(r.x-this.x0)/this.k0,l=this.rh-(r.y-this.y0)/this.k0;this.ns>0?(a=Math.sqrt(p*p+l*l),s=1):(a=-Math.sqrt(p*p+l*l),s=-1);var S=0;if(0!==a&&(S=Math.atan2(s*p,s*l)),0!==a||this.ns>0){if(s=1/this.ns,h=Math.pow(a/(this.a*this.f0),s),-9999===(c=gr(this.e,h)))return null}else c=-T;return v=Mt(S/this.ns+this.long0),r.x=v,r.y=c,r},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc"]},ar={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(r){var a,s,h,c,v,p,l,D=r.y,X=Mt(r.x-this.long0);return a=Math.pow((1+this.e*Math.sin(D))/(1-this.e*Math.sin(D)),this.alfa*this.e/2),s=2*(Math.atan(this.k*Math.pow(Math.tan(D/2+this.s45),this.alfa)/a)-this.s45),h=-X*this.alfa,c=Math.asin(Math.cos(this.ad)*Math.sin(s)+Math.sin(this.ad)*Math.cos(s)*Math.cos(h)),v=Math.asin(Math.cos(s)*Math.sin(h)/Math.cos(c)),p=this.n*v,l=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(c/2+this.s45),this.n),r.y=l*Math.cos(p)/1,r.x=l*Math.sin(p)/1,this.czech||(r.y*=-1,r.x*=-1),r},inverse:function(r){var a,s,h,c,p,l,S,D=r.x;r.x=r.y,r.y=D,this.czech||(r.y*=-1,r.x*=-1),p=Math.sqrt(r.x*r.x+r.y*r.y),c=Math.atan2(r.y,r.x)/Math.sin(this.s0),h=2*(Math.atan(Math.pow(this.ro0/p,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),a=Math.asin(Math.cos(this.ad)*Math.sin(h)-Math.sin(this.ad)*Math.cos(h)*Math.cos(c)),s=Math.asin(Math.cos(h)*Math.sin(c)/Math.cos(a)),r.x=this.long0-s/this.alfa,l=a,S=0;var X=0;do{r.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(a/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.e/2))-this.s45),Math.abs(l-r.y)<1e-10&&(S=1),l=r.y,X+=1}while(0===S&&X<15);return X>=15?null:r},names:["Krovak","krovak"]};function xe(r,a,s,h,c){return r*c-a*Math.sin(2*c)+s*Math.sin(4*c)-h*Math.sin(6*c)}function br(r){return 1-.25*r*(1+r/16*(3+1.25*r))}function Fr(r){return.375*r*(1+.25*r*(1+.46875*r))}function jr(r){return.05859375*r*r*(1+.75*r)}function Gr(r){return r*r*r*(35/3072)}function Sr(r,a,s){var h=a*s;return r/Math.sqrt(1-h*h)}function sr(r){return Math.abs(r)<T?r:r-Er(r)*Math.PI}function hn(r,a,s,h,c){var v,p;v=r/a;for(var l=0;l<15;l++)if(v+=p=(r-(a*v-s*Math.sin(2*v)+h*Math.sin(4*v)-c*Math.sin(6*v)))/(a-2*s*Math.cos(2*v)+4*h*Math.cos(4*v)-6*c*Math.cos(6*v)),Math.abs(p)<=1e-10)return v;return NaN}const Ts={init:function(){this.sphere||(this.e0=br(this.es),this.e1=Fr(this.es),this.e2=jr(this.es),this.e3=Gr(this.es),this.ml0=this.a*xe(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(r){var a,s,h=r.x,c=r.y;if(h=Mt(h-this.long0),this.sphere)a=this.a*Math.asin(Math.cos(c)*Math.sin(h)),s=this.a*(Math.atan2(Math.tan(c),Math.cos(h))-this.lat0);else{var v=Math.sin(c),p=Math.cos(c),l=Sr(this.a,this.e,v),S=Math.tan(c)*Math.tan(c),D=h*Math.cos(c),X=D*D,z=this.es*p*p/(1-this.es);a=l*D*(1-X*S*(1/6-(8-S+8*z)*X/120)),s=this.a*xe(this.e0,this.e1,this.e2,this.e3,c)-this.ml0+l*v/p*X*(.5+(5-S+6*z)*X/24)}return r.x=a+this.x0,r.y=s+this.y0,r},inverse:function(r){r.x-=this.x0,r.y-=this.y0;var h,c,a=r.x/this.a,s=r.y/this.a;if(this.sphere){var v=s+this.lat0;h=Math.asin(Math.sin(v)*Math.cos(a)),c=Math.atan2(Math.tan(a),Math.cos(v))}else{var l=hn(this.ml0/this.a+s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(l)-T)<=y)return r.x=this.long0,r.y=T,s<0&&(r.y*=-1),r;var S=Sr(this.a,this.e,Math.sin(l)),D=S*S*S/this.a/this.a*(1-this.es),X=Math.pow(Math.tan(l),2),z=a*this.a/S,st=z*z;h=l-S*Math.tan(l)/D*z*z*(.5-(1+3*X)*z*z/24),c=z*(1-st*(X/3+(1+3*X)*X*st/15))/Math.cos(l)}return r.x=Mt(c+this.long0),r.y=sr(h),r},names:["Cassini","Cassini_Soldner","cass"]};function He(r,a){var s;return r>1e-7?(1-r*r)*(a/(1-(s=r*a)*s)-.5/r*Math.log((1-s)/(1+s))):2*a}const de={init:function(){var a,r=Math.abs(this.lat0);if(this.mode=Math.abs(r-T)<y?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(r)<y?this.EQUIT:this.OBLIQ,this.es>0)switch(this.qp=He(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(r){var a,s=[];return s[0]=.3333333333333333*r,s[0]+=.17222222222222222*(a=r*r),s[1]=.06388888888888888*a,s[0]+=.10257936507936508*(a*=r),s[1]+=.0664021164021164*a,s[2]=.016415012942191543*a,s}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),a=Math.sin(this.lat0),this.sinb1=He(this.e,a)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*a*a)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(r){var a,s,h,c,v,p,l,S,D,X,z=r.x,st=r.y;if(z=Mt(z-this.long0),this.sphere){if(v=Math.sin(st),X=Math.cos(st),h=Math.cos(z),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((s=this.mode===this.EQUIT?1+X*h:1+this.sinph0*v+this.cosph0*X*h)<=y)return null;a=(s=Math.sqrt(2/s))*X*Math.sin(z),s*=this.mode===this.EQUIT?v:this.cosph0*v-this.sinph0*X*h}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(h=-h),Math.abs(st+this.lat0)<y)return null;s=g-.5*st,a=(s=2*(this.mode===this.S_POLE?Math.cos(s):Math.sin(s)))*Math.sin(z),s*=h}}else{switch(l=0,S=0,D=0,h=Math.cos(z),c=Math.sin(z),v=Math.sin(st),p=He(this.e,v),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(l=p/this.qp,S=Math.sqrt(1-l*l)),this.mode){case this.OBLIQ:D=1+this.sinb1*l+this.cosb1*S*h;break;case this.EQUIT:D=1+S*h;break;case this.N_POLE:D=T+st,p=this.qp-p;break;case this.S_POLE:D=st-T,p=this.qp+p}if(Math.abs(D)<y)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:D=Math.sqrt(2/D),s=this.mode===this.OBLIQ?this.ymf*D*(this.cosb1*l-this.sinb1*S*h):(D=Math.sqrt(2/(1+S*h)))*l*this.ymf,a=this.xmf*D*S*c;break;case this.N_POLE:case this.S_POLE:p>=0?(a=(D=Math.sqrt(p))*c,s=h*(this.mode===this.S_POLE?D:-D)):a=s=0}}return r.x=this.a*a+this.x0,r.y=this.a*s+this.y0,r},inverse:function(r){r.x-=this.x0,r.y-=this.y0;var h,c,v,p,l,S,D,a=r.x/this.a,s=r.y/this.a;if(this.sphere){var z,X=0,st=0;if((c=.5*(z=Math.sqrt(a*a+s*s)))>1)return null;switch(c=2*Math.asin(c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(st=Math.sin(c),X=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(z)<=y?0:Math.asin(s*st/z),a*=st,s=X*z;break;case this.OBLIQ:c=Math.abs(z)<=y?this.lat0:Math.asin(X*this.sinph0+s*st*this.cosph0/z),a*=st*this.cosph0,s=(X-Math.sin(c)*this.sinph0)*z;break;case this.N_POLE:s=-s,c=T-c;break;case this.S_POLE:c-=T}h=0!==s||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(a,s):0}else{if(D=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(a/=this.dd,s*=this.dd,(S=Math.sqrt(a*a+s*s))<y)return r.x=this.long0,r.y=this.lat0,r;p=2*Math.asin(.5*S/this.rq),v=Math.cos(p),a*=p=Math.sin(p),this.mode===this.OBLIQ?(l=this.qp*(D=v*this.sinb1+s*p*this.cosb1/S),s=S*this.cosb1*v-s*this.sinb1*p):(l=this.qp*(D=s*p/S),s=S*v)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(s=-s),!(l=a*a+s*s))return r.x=this.long0,r.y=this.lat0,r;D=1-l/this.qp,this.mode===this.S_POLE&&(D=-D)}h=Math.atan2(a,s),c=function(r,a){var s=r+r;return r+a[0]*Math.sin(s)+a[1]*Math.sin(s+s)+a[2]*Math.sin(s+s+s)}(Math.asin(D),this.apa)}return r.x=Mt(this.long0+h),r.y=c,r},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function ce(r){return Math.abs(r)>1&&(r=r>1?1:-1),Math.asin(r)}const Gs={init:function(){Math.abs(this.lat1+this.lat2)<y||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Be(this.e3,this.sin_po,this.cos_po),this.qs1=He(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Be(this.e3,this.sin_po,this.cos_po),this.qs2=He(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=He(this.e3,this.sin_po),this.ns0=Math.abs(this.lat1-this.lat2)>y?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(r){var a=r.x,s=r.y;this.sin_phi=Math.sin(s),this.cos_phi=Math.cos(s);var h=He(this.e3,this.sin_phi),c=this.a*Math.sqrt(this.c-this.ns0*h)/this.ns0,v=this.ns0*Mt(a-this.long0),p=c*Math.sin(v)+this.x0,l=this.rh-c*Math.cos(v)+this.y0;return r.x=p,r.y=l,r},inverse:function(r){var a,h,c,v,p;return r.x-=this.x0,r.y=this.rh-r.y+this.y0,this.ns0>=0?(a=Math.sqrt(r.x*r.x+r.y*r.y),h=1):(a=-Math.sqrt(r.x*r.x+r.y*r.y),h=-1),c=0,0!==a&&(c=Math.atan2(h*r.x,h*r.y)),h=a*this.ns0/this.a,p=this.sphere?Math.asin((this.c-h*h)/(2*this.ns0)):this.phi1z(this.e3,(this.c-h*h)/this.ns0),v=Mt(c/this.ns0+this.long0),r.x=v,r.y=p,r},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(r,a){var s,c,v,p,l=ce(.5*a);if(r<y)return l;for(var S=r*r,D=1;D<=25;D++)if(l+=p=.5*(v=1-(c=r*(s=Math.sin(l)))*c)*v/Math.cos(l)*(a/(1-S)-s/v+.5/r*Math.log((1-c)/(1+c))),Math.abs(p)<=1e-7)return l;return null}},ln={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(r){var a,s,h,c,p,l,S,X=r.y;return h=Mt(r.x-this.long0),a=Math.sin(X),s=Math.cos(X),c=Math.cos(h),(p=this.sin_p14*a+this.cos_p14*s*c)>0||Math.abs(p)<=y?(l=this.x0+1*this.a*s*Math.sin(h)/p,S=this.y0+1*this.a*(this.cos_p14*a-this.sin_p14*s*c)/p):(l=this.x0+this.infinity_dist*s*Math.sin(h),S=this.y0+this.infinity_dist*(this.cos_p14*a-this.sin_p14*s*c)),r.x=l,r.y=S,r},inverse:function(r){var a,s,h,c,v,p;return r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,r.x/=this.k0,r.y/=this.k0,(a=Math.sqrt(r.x*r.x+r.y*r.y))?(c=Math.atan2(a,this.rc),s=Math.sin(c),p=ce((h=Math.cos(c))*this.sin_p14+r.y*s*this.cos_p14/a),v=Math.atan2(r.x*s,a*this.cos_p14*h-r.y*this.sin_p14*s),v=Mt(this.long0+v)):(p=this.phic0,v=0),r.x=v,r.y=p,r},names:["gnom"]},Zr={init:function(){this.sphere||(this.k0=Be(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(r){var h,c,s=r.y,v=Mt(r.x-this.long0);if(this.sphere)h=this.x0+this.a*v*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(s)/Math.cos(this.lat_ts);else{var p=He(this.e,Math.sin(s));h=this.x0+this.a*this.k0*v,c=this.y0+this.a*p*.5/this.k0}return r.x=h,r.y=c,r},inverse:function(r){var a,s;return r.x-=this.x0,r.y-=this.y0,this.sphere?(a=Mt(this.long0+r.x/this.a/Math.cos(this.lat_ts)),s=Math.asin(r.y/this.a*Math.cos(this.lat_ts))):(s=function(r,a){var s=1-(1-r*r)/(2*r)*Math.log((1-r)/(1+r));if(Math.abs(Math.abs(a)-s)<1e-6)return a<0?-1*T:T;for(var c,v,p,l,h=Math.asin(.5*a),S=0;S<30;S++)if(v=Math.sin(h),p=Math.cos(h),l=r*v,h+=c=Math.pow(1-l*l,2)/(2*p)*(a/(1-r*r)-v/(1-l*l)+.5/r*Math.log((1-l)/(1+l))),Math.abs(c)<=1e-10)return h;return NaN}(this.e,2*r.y*this.k0/this.a),a=Mt(this.long0+r.x/(this.a*this.k0))),r.x=a,r.y=s,r},names:["cea"]},Ys={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(r){var s=r.y,h=Mt(r.x-this.long0),c=sr(s-this.lat0);return r.x=this.x0+this.a*h*this.rc,r.y=this.y0+this.a*c,r},inverse:function(r){var s=r.y;return r.x=Mt(this.long0+(r.x-this.x0)/(this.a*this.rc)),r.y=sr(this.lat0+(s-this.y0)/this.a),r},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Hs={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=br(this.es),this.e1=Fr(this.es),this.e2=jr(this.es),this.e3=Gr(this.es),this.ml0=this.a*xe(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(r){var h,c,v,s=r.y,p=Mt(r.x-this.long0);if(v=p*Math.sin(s),this.sphere)Math.abs(s)<=y?(h=this.a*p,c=-1*this.a*this.lat0):(h=this.a*Math.sin(v)/Math.tan(s),c=this.a*(sr(s-this.lat0)+(1-Math.cos(v))/Math.tan(s)));else if(Math.abs(s)<=y)h=this.a*p,c=-1*this.ml0;else{var l=Sr(this.a,this.e,Math.sin(s))/Math.tan(s);h=l*Math.sin(v),c=this.a*xe(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+l*(1-Math.cos(v))}return r.x=h+this.x0,r.y=c+this.y0,r},inverse:function(r){var a,s,h,c,v,p,l,S,D;if(h=r.x-this.x0,c=r.y-this.y0,this.sphere)if(Math.abs(c+this.a*this.lat0)<=y)a=Mt(h/this.a+this.long0),s=0;else{var X;for(l=h*h/this.a/this.a+(p=this.lat0+c/this.a)*p,S=p,v=20;v;--v)if(S+=D=-1*(p*(S*(X=Math.tan(S))+1)-S-.5*(S*S+l)*X)/((S-p)/X-1),Math.abs(D)<=y){s=S;break}a=Mt(this.long0+Math.asin(h*Math.tan(S)/this.a)/Math.sin(s))}else if(Math.abs(c+this.ml0)<=y)s=0,a=Mt(this.long0+h/this.a);else{var z,st,ft,dt,lt;for(l=h*h/this.a/this.a+(p=(this.ml0+c)/this.a)*p,S=p,v=20;v;--v)if(lt=this.e*Math.sin(S),z=Math.sqrt(1-lt*lt)*Math.tan(S),st=this.a*xe(this.e0,this.e1,this.e2,this.e3,S),ft=this.e0-2*this.e1*Math.cos(2*S)+4*this.e2*Math.cos(4*S)-6*this.e3*Math.cos(6*S),S-=D=(p*(z*(dt=st/this.a)+1)-dt-.5*z*(dt*dt+l))/(this.es*Math.sin(2*S)*(dt*dt+l-2*p*dt)/(4*z)+(p-dt)*(z*ft-2/Math.sin(2*S))-ft),Math.abs(D)<=y){s=S;break}z=Math.sqrt(1-this.es*Math.pow(Math.sin(s),2))*Math.tan(s),a=Mt(this.long0+Math.asin(h*z/this.a)/Math.sin(s))}return r.x=a,r.y=s,r},names:["Polyconic","poly"]},Xn={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(r){var a,p=(r.y-this.lat0)/F*1e-5,l=r.x-this.long0,S=1,D=0;for(a=1;a<=10;a++)D+=this.A[a]*(S*=p);var lt,X=D,z=l,st=1,ft=0,mt=0,Pt=0;for(a=1;a<=6;a++)lt=ft*X+st*z,mt=mt+this.B_re[a]*(st=st*X-ft*z)-this.B_im[a]*(ft=lt),Pt=Pt+this.B_im[a]*st+this.B_re[a]*ft;return r.x=Pt*this.a+this.x0,r.y=mt*this.a+this.y0,r},inverse:function(r){var a,z,p=(r.y-this.y0)/this.a,l=(r.x-this.x0)/this.a,S=1,D=0,st=0,ft=0;for(a=1;a<=6;a++)z=D*p+S*l,st=st+this.C_re[a]*(S=S*p-D*l)-this.C_im[a]*(D=z),ft=ft+this.C_im[a]*S+this.C_re[a]*D;for(var dt=0;dt<this.iterations;dt++){var Ft,lt=st,mt=ft,Qt=p,$t=l;for(a=2;a<=6;a++)Ft=mt*st+lt*ft,Qt+=(a-1)*(this.B_re[a]*(lt=lt*st-mt*ft)-this.B_im[a]*(mt=Ft)),$t+=(a-1)*(this.B_im[a]*lt+this.B_re[a]*mt);lt=1,mt=0;var Jt=this.B_re[1],Xt=this.B_im[1];for(a=2;a<=6;a++)Ft=mt*st+lt*ft,Jt+=a*(this.B_re[a]*(lt=lt*st-mt*ft)-this.B_im[a]*(mt=Ft)),Xt+=a*(this.B_im[a]*lt+this.B_re[a]*mt);var we=Jt*Jt+Xt*Xt;st=(Qt*Jt+$t*Xt)/we,ft=($t*Jt-Qt*Xt)/we}var he=st,Ze=ft,dr=1,vr=0;for(a=1;a<=9;a++)vr+=this.D[a]*(dr*=he);var Xe=this.lat0+vr*F*1e5;return r.x=this.long0+Ze,r.y=Xe,r},names:["New_Zealand_Map_Grid","nzmg"]},no={init:function(){},forward:function(r){var s=r.y,h=Mt(r.x-this.long0),c=this.x0+this.a*h,v=this.y0+this.a*Math.log(Math.tan(Math.PI/4+s/2.5))*1.25;return r.x=c,r.y=v,r},inverse:function(r){r.x-=this.x0,r.y-=this.y0;var a=Mt(this.long0+r.x/this.a),s=2.5*(Math.atan(Math.exp(.8*r.y/this.a))-Math.PI/4);return r.x=a,r.y=s,r},names:["Miller_Cylindrical","mill"]},cr={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Di(this.es)},forward:function(r){var a,s,h=r.x,c=r.y;if(h=Mt(h-this.long0),this.sphere){if(this.m)for(var v=this.n*Math.sin(c),p=20;p;--p){var l=(this.m*c+Math.sin(c)-v)/(this.m+Math.cos(c));if(c-=l,Math.abs(l)<y)break}else c=1!==this.n?Math.asin(this.n*Math.sin(c)):c;a=this.a*this.C_x*h*(this.m+Math.cos(c)),s=this.a*this.C_y*c}else{var S=Math.sin(c),D=Math.cos(c);s=this.a*sn(c,S,D,this.en),a=this.a*h*D/Math.sqrt(1-this.es*S*S)}return r.x=a,r.y=s,r},inverse:function(r){var a,h,c;return r.x-=this.x0,h=r.x/this.a,r.y-=this.y0,a=r.y/this.a,this.sphere?(a/=this.C_y,h/=this.C_x*(this.m+Math.cos(a)),this.m?a=ce((this.m*a+Math.sin(a))/this.n):1!==this.n&&(a=ce(Math.sin(a)/this.n)),h=Mt(h+this.long0),a=sr(a)):(a=$e(r.y/this.a,this.es,this.en),(c=Math.abs(a))<T?(c=Math.sin(a),h=Mt(this.long0+r.x*Math.sqrt(1-this.es*c*c)/(this.a*Math.cos(a)))):c-y<T&&(h=this.long0)),r.x=h,r.y=a,r},names:["Sinusoidal","sinu"]},vn={init:function(){},forward:function(r){for(var s=r.y,h=Mt(r.x-this.long0),c=s,v=Math.PI*Math.sin(s);;){var p=-(c+Math.sin(c)-v)/(1+Math.cos(c));if(c+=p,Math.abs(p)<y)break}c/=2,Math.PI/2-Math.abs(s)<y&&(h=0);var l=.900316316158*this.a*h*Math.cos(c)+this.x0,S=1.4142135623731*this.a*Math.sin(c)+this.y0;return r.x=l,r.y=S,r},inverse:function(r){var a,s;r.x-=this.x0,r.y-=this.y0,s=r.y/(1.4142135623731*this.a),Math.abs(s)>.999999999999&&(s=.999999999999),a=Math.asin(s);var h=Mt(this.long0+r.x/(.900316316158*this.a*Math.cos(a)));h<-Math.PI&&(h=-Math.PI),h>Math.PI&&(h=Math.PI),s=(2*a+Math.sin(2*a))/Math.PI,Math.abs(s)>1&&(s=1);var c=Math.asin(s);return r.x=h,r.y=c,r},names:["Mollweide","moll"]},fr={init:function(){Math.abs(this.lat1+this.lat2)<y||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=br(this.es),this.e1=Fr(this.es),this.e2=jr(this.es),this.e3=Gr(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Be(this.e,this.sinphi,this.cosphi),this.ml1=xe(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<y?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Be(this.e,this.sinphi,this.cosphi),this.ml2=xe(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=xe(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(r){var h,a=r.x,s=r.y;if(this.sphere)h=this.a*(this.g-s);else{var c=xe(this.e0,this.e1,this.e2,this.e3,s);h=this.a*(this.g-c)}var v=this.ns*Mt(a-this.long0),p=this.x0+h*Math.sin(v),l=this.y0+this.rh-h*Math.cos(v);return r.x=p,r.y=l,r},inverse:function(r){var a,s,h,c;r.x-=this.x0,r.y=this.rh-r.y+this.y0,this.ns>=0?(s=Math.sqrt(r.x*r.x+r.y*r.y),a=1):(s=-Math.sqrt(r.x*r.x+r.y*r.y),a=-1);var v=0;return 0!==s&&(v=Math.atan2(a*r.x,a*r.y)),this.sphere?(c=Mt(this.long0+v/this.ns),h=sr(this.g-s/this.a),r.x=c,r.y=h,r):(h=hn(this.g-s/this.a,this.e0,this.e1,this.e2,this.e3),c=Mt(this.long0+v/this.ns),r.x=c,r.y=h,r)},names:["Equidistant_Conic","eqdc"]},ho={init:function(){this.R=this.a},forward:function(r){var c,v,s=r.y,h=Mt(r.x-this.long0);Math.abs(s)<=y&&(c=this.x0+this.R*h,v=this.y0);var p=ce(2*Math.abs(s/Math.PI));(Math.abs(h)<=y||Math.abs(Math.abs(s)-T)<=y)&&(c=this.x0,v=s>=0?this.y0+Math.PI*this.R*Math.tan(.5*p):this.y0+Math.PI*this.R*-Math.tan(.5*p));var l=.5*Math.abs(Math.PI/h-h/Math.PI),S=l*l,D=Math.sin(p),X=Math.cos(p),z=X/(D+X-1),ft=z*(2/D-1),dt=ft*ft,lt=Math.PI*this.R*(l*(z-dt)+Math.sqrt(S*(z-dt)*(z-dt)-(dt+S)*(z*z-dt)))/(dt+S);h<0&&(lt=-lt),c=this.x0+lt;var mt=S+z;return lt=Math.PI*this.R*(ft*mt-l*Math.sqrt((dt+S)*(S+1)-mt*mt))/(dt+S),v=s>=0?this.y0+lt:this.y0-lt,r.x=c,r.y=v,r},inverse:function(r){var a,s,h,c,v,p,l,S,D,X,z,st;return r.x-=this.x0,r.y-=this.y0,z=Math.PI*this.R,v=(h=r.x/z)*h+(c=r.y/z)*c,z=3*(c*c/(S=-2*(p=-Math.abs(c)*(1+v))+1+2*c*c+v*v)+(2*(l=p-2*c*c+h*h)*l*l/S/S/S-9*p*l/S/S)/27)/(D=(p-l*l/3/S)/S)/(X=2*Math.sqrt(-D/3)),Math.abs(z)>1&&(z=z>=0?1:-1),st=Math.acos(z)/3,s=r.y>=0?(-X*Math.cos(st+Math.PI/3)-l/3/S)*Math.PI:-(-X*Math.cos(st+Math.PI/3)-l/3/S)*Math.PI,a=Math.abs(h)<y?this.long0:Mt(this.long0+Math.PI*(v-1+Math.sqrt(1+2*(h*h-c*c)+v*v))/2/h),r.x=a,r.y=s,r},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},ii={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(r){var p,l,S,D,X,z,st,ft,dt,lt,mt,Pt,Ft,Qt,$t,Jt,Xt,we,he,Ze,dr,vr,a=r.x,s=r.y,h=Math.sin(r.y),c=Math.cos(r.y),v=Mt(a-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=y?(r.x=this.x0+this.a*(T-s)*Math.sin(v),r.y=this.y0-this.a*(T-s)*Math.cos(v),r):Math.abs(this.sin_p12+1)<=y?(r.x=this.x0+this.a*(T+s)*Math.sin(v),r.y=this.y0+this.a*(T+s)*Math.cos(v),r):(we=this.sin_p12*h+this.cos_p12*c*Math.cos(v),Xt=(Jt=Math.acos(we))?Jt/Math.sin(Jt):1,r.x=this.x0+this.a*Xt*c*Math.sin(v),r.y=this.y0+this.a*Xt*(this.cos_p12*h-this.sin_p12*c*Math.cos(v)),r):(p=br(this.es),l=Fr(this.es),S=jr(this.es),D=Gr(this.es),Math.abs(this.sin_p12-1)<=y?(X=this.a*xe(p,l,S,D,T),z=this.a*xe(p,l,S,D,s),r.x=this.x0+(X-z)*Math.sin(v),r.y=this.y0-(X-z)*Math.cos(v),r):Math.abs(this.sin_p12+1)<=y?(X=this.a*xe(p,l,S,D,T),z=this.a*xe(p,l,S,D,s),r.x=this.x0+(X+z)*Math.sin(v),r.y=this.y0+(X+z)*Math.cos(v),r):(st=h/c,ft=Sr(this.a,this.e,this.sin_p12),dt=Sr(this.a,this.e,h),lt=Math.atan((1-this.es)*st+this.es*ft*this.sin_p12/(dt*c)),he=0===(mt=Math.atan2(Math.sin(v),this.cos_p12*Math.tan(lt)-this.sin_p12*Math.cos(v)))?Math.asin(this.cos_p12*Math.sin(lt)-this.sin_p12*Math.cos(lt)):Math.abs(Math.abs(mt)-Math.PI)<=y?-Math.asin(this.cos_p12*Math.sin(lt)-this.sin_p12*Math.cos(lt)):Math.asin(Math.sin(v)*Math.cos(lt)/Math.sin(mt)),Pt=this.e*this.sin_p12/Math.sqrt(1-this.es),Ft=this.e*this.cos_p12*Math.cos(mt)/Math.sqrt(1-this.es),r.x=this.x0+(Jt=ft*he*(1-(Ze=he*he)*($t=Ft*Ft)*(1-$t)/6+(dr=Ze*he)/8*(Qt=Pt*Ft)*(1-2*$t)+(vr=dr*he)/120*($t*(4-7*$t)-3*Pt*Pt*(1-7*$t))-vr*he/48*Qt))*Math.sin(mt),r.y=this.y0+Jt*Math.cos(mt),r))},inverse:function(r){var a,s,h,c,v,p,l,S,D,X,z,st,dt,lt,mt,Pt,Ft,Qt,$t,Jt,Xt,we,he;return r.x-=this.x0,r.y-=this.y0,this.sphere?(a=Math.sqrt(r.x*r.x+r.y*r.y))>2*T*this.a?void 0:(s=a/this.a,h=Math.sin(s),c=Math.cos(s),v=this.long0,Math.abs(a)<=y?p=this.lat0:(p=ce(c*this.sin_p12+r.y*h*this.cos_p12/a),l=Math.abs(this.lat0)-T,v=Math.abs(l)<=y?Mt(this.lat0>=0?this.long0+Math.atan2(r.x,-r.y):this.long0-Math.atan2(-r.x,r.y)):Mt(this.long0+Math.atan2(r.x*h,a*this.cos_p12*c-r.y*this.sin_p12*h))),r.x=v,r.y=p,r):(S=br(this.es),D=Fr(this.es),X=jr(this.es),z=Gr(this.es),Math.abs(this.sin_p12-1)<=y?(p=hn(((st=this.a*xe(S,D,X,z,T))-(a=Math.sqrt(r.x*r.x+r.y*r.y)))/this.a,S,D,X,z),v=Mt(this.long0+Math.atan2(r.x,-1*r.y)),r.x=v,r.y=p,r):Math.abs(this.sin_p12+1)<=y?(st=this.a*xe(S,D,X,z,T),p=hn(((a=Math.sqrt(r.x*r.x+r.y*r.y))-st)/this.a,S,D,X,z),v=Mt(this.long0+Math.atan2(r.x,r.y)),r.x=v,r.y=p,r):(a=Math.sqrt(r.x*r.x+r.y*r.y),mt=Math.atan2(r.x,r.y),dt=Sr(this.a,this.e,this.sin_p12),Pt=Math.cos(mt),$t=3*this.es*(1-(Qt=-(Ft=this.e*this.cos_p12*Pt)*Ft/(1-this.es)))*this.sin_p12*this.cos_p12*Pt/(1-this.es),we=1-Qt*(Xt=(Jt=a/dt)-Qt*(1+Qt)*Math.pow(Jt,3)/6-$t*(1+3*Qt)*Math.pow(Jt,4)/24)*Xt/2-Jt*Xt*Xt*Xt/6,lt=Math.asin(this.sin_p12*Math.cos(Xt)+this.cos_p12*Math.sin(Xt)*Pt),v=Mt(this.long0+Math.asin(Math.sin(mt)*Math.sin(Xt)/Math.cos(lt))),he=Math.sin(lt),p=Math.atan2((he-this.es*we*this.sin_p12)*Math.tan(lt),he*(1-this.es)),r.x=v,r.y=p,r))},names:["Azimuthal_Equidistant","aeqd"]},Wr={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(r){var a,s,h,c,p,l,S,X=r.y;return h=Mt(r.x-this.long0),a=Math.sin(X),s=Math.cos(X),c=Math.cos(h),((p=this.sin_p14*a+this.cos_p14*s*c)>0||Math.abs(p)<=y)&&(l=1*this.a*s*Math.sin(h),S=this.y0+1*this.a*(this.cos_p14*a-this.sin_p14*s*c)),r.x=l,r.y=S,r},inverse:function(r){var a,s,h,c,v,p,l;return r.x-=this.x0,r.y-=this.y0,s=ce((a=Math.sqrt(r.x*r.x+r.y*r.y))/this.a),h=Math.sin(s),c=Math.cos(s),p=this.long0,Math.abs(a)<=y?(l=this.lat0,r.x=p,r.y=l,r):(l=ce(c*this.sin_p14+r.y*h*this.cos_p14/a),v=Math.abs(this.lat0)-T,Math.abs(v)<=y?(p=Mt(this.lat0>=0?this.long0+Math.atan2(r.x,-r.y):this.long0-Math.atan2(-r.x,r.y)),r.x=p,r.y=l,r):(p=Mt(this.long0+Math.atan2(r.x*h,a*this.cos_p14*c-r.y*this.sin_p14*h)),r.x=p,r.y=l,r))},names:["ortho"]};function Qr(r,a,s,h){var c;return r<y?(h.value=1,c=0):(c=Math.atan2(a,s),Math.abs(c)<=g?h.value=1:c>g&&c<=T+g?(h.value=2,c-=T):c>T+g||c<=-(T+g)?(h.value=3,c=c>=0?c-b:c+b):(h.value=4,c+=T)),c}function Ke(r,a){var s=r+a;return s<-b?s+=m:s>+b&&(s-=m),s}const ia={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.face=this.lat0>=T-g/2?5:this.lat0<=-(T-g/2)?6:Math.abs(this.long0)<=g?1:Math.abs(this.long0)<=T+g?this.long0>0?2:4:3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(r){var s,h,c,v,p,l,a={x:0,y:0},S={value:0};if(r.x-=this.long0,s=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(r.y)):r.y,h=r.x,5===this.face)v=T-s,h>=g&&h<=T+g?(S.value=1,c=h-T):h>T+g||h<=-(T+g)?(S.value=2,c=h>0?h-b:h+b):h>-(T+g)&&h<=-g?(S.value=3,c=h+T):(S.value=4,c=h);else if(6===this.face)v=T+s,h>=g&&h<=T+g?(S.value=1,c=-h+T):h<g&&h>=-g?(S.value=2,c=-h):h<-g&&h>=-(T+g)?(S.value=3,c=-h-T):(S.value=4,c=h>0?-h+b:-h-b);else{var D,X,z,st,ft,dt;2===this.face?h=Ke(h,+T):3===this.face?h=Ke(h,+b):4===this.face&&(h=Ke(h,-T)),st=Math.sin(s),ft=Math.cos(s),dt=Math.sin(h),D=ft*Math.cos(h),X=ft*dt,z=st,1===this.face?c=Qr(v=Math.acos(D),z,X,S):2===this.face?c=Qr(v=Math.acos(X),z,-D,S):3===this.face?c=Qr(v=Math.acos(-D),z,-X,S):4===this.face?c=Qr(v=Math.acos(-X),z,D,S):(v=c=0,S.value=1)}return l=Math.atan(12/b*(c+Math.acos(Math.sin(c)*Math.cos(g))-T)),p=Math.sqrt((1-Math.cos(v))/(Math.cos(l)*Math.cos(l))/(1-Math.cos(Math.atan(1/Math.cos(c))))),2===S.value?l+=T:3===S.value?l+=b:4===S.value&&(l+=1.5*b),a.x=p*Math.cos(l),a.y=p*Math.sin(l),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,r.x=a.x,r.y=a.y,r},inverse:function(r){var s,h,c,v,p,l,S,D,X,lt,mt,Pt,a={lam:0,phi:0},z={value:0};if(r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,h=Math.atan(Math.sqrt(r.x*r.x+r.y*r.y)),s=Math.atan2(r.y,r.x),r.x>=0&&r.x>=Math.abs(r.y)?z.value=1:r.y>=0&&r.y>=Math.abs(r.x)?(z.value=2,s-=T):r.x<0&&-r.x>=Math.abs(r.y)?(z.value=3,s=s<0?s+b:s-b):(z.value=4,s+=T),X=b/12*Math.tan(s),p=Math.sin(X)/(Math.cos(X)-1/Math.sqrt(2)),l=Math.atan(p),(S=1-(c=Math.cos(s))*c*(v=Math.tan(h))*v*(1-Math.cos(Math.atan(1/Math.cos(l)))))<-1?S=-1:S>1&&(S=1),5===this.face)D=Math.acos(S),a.phi=T-D,a.lam=1===z.value?l+T:2===z.value?l<0?l+b:l-b:3===z.value?l-T:l;else if(6===this.face)D=Math.acos(S),a.phi=D-T,a.lam=1===z.value?-l+T:2===z.value?-l:3===z.value?-l-T:l<0?-l-b:-l+b;else{var st,ft,dt;X=(st=S)*st,ft=(X+=(dt=X>=1?0:Math.sqrt(1-X)*Math.sin(l))*dt)>=1?0:Math.sqrt(1-X),2===z.value?(X=ft,ft=-dt,dt=X):3===z.value?(ft=-ft,dt=-dt):4===z.value&&(X=ft,ft=dt,dt=-X),2===this.face?(X=st,st=-ft,ft=X):3===this.face?(st=-st,ft=-ft):4===this.face&&(X=st,st=ft,ft=-X),a.phi=Math.acos(-dt)-T,a.lam=Math.atan2(ft,st),2===this.face?a.lam=Ke(a.lam,-T):3===this.face?a.lam=Ke(a.lam,-b):4===this.face&&(a.lam=Ke(a.lam,+T))}return 0!==this.es&&(lt=a.phi<0?1:0,mt=Math.tan(a.phi),Pt=this.b/Math.sqrt(mt*mt+this.one_minus_f_squared),a.phi=Math.atan(Math.sqrt(this.a*this.a-Pt*Pt)/(this.one_minus_f*Pt)),lt&&(a.phi=-a.phi)),a.lam+=this.long0,r.x=a.lam,r.y=a.phi,r},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var ai=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],hr=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],zr=function(r,a){return r[0]+a*(r[1]+a*(r[2]+a*r[3]))};const bo={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(r){var a=Mt(r.x-this.long0),s=Math.abs(r.y),h=Math.floor(11.459155902616464*s);h<0?h=0:h>=18&&(h=17);var c={x:zr(ai[h],s=w*(s-.08726646259971647*h))*a,y:zr(hr[h],s)};return r.y<0&&(c.y=-c.y),c.x=c.x*this.a*.8487+this.x0,c.y=c.y*this.a*1.3523+this.y0,c},inverse:function(r){var a={x:(r.x-this.x0)/(.8487*this.a),y:Math.abs(r.y-this.y0)/(1.3523*this.a)};if(a.y>=1)a.x/=ai[18][0],a.y=r.y<0?-T:T;else{var s=Math.floor(18*a.y);for(s<0?s=0:s>=18&&(s=17);;)if(hr[s][0]>a.y)--s;else{if(!(hr[s+1][0]<=a.y))break;++s}var h=hr[s],c=5*(a.y-h[0])/(hr[s+1][0]-h[0]);c=function(r,a,s,h){for(var c=a;h;--h){var v=r(c);if(c-=v,Math.abs(v)<1e-10)break}return c}(function(v){return(zr(h,v)-a.y)/function(r,a){return r[1]+a*(2*r[2]+3*a*r[3])}(h,v)},c,0,100),a.x/=zr(ai[s],c),a.y=(5*s+c)*C,r.y<0&&(a.y=-a.y)}return a.x=Mt(a.x+this.long0),a},names:["Robinson","robin"]},Co={init:function(){this.name="geocent"},forward:function(r){return Tn(r,this.es,this.a)},inverse:function(r){return Ra(r,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var lr={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const si={init:function(){if(Object.keys(lr).forEach(function(s){if(void 0===this[s])this[s]=lr[s].def;else{if(lr[s].num&&isNaN(this[s]))throw new Error("Invalid parameter value, must be numeric "+s+" = "+this[s]);lr[s].num&&(this[s]=parseFloat(this[s]))}lr[s].degrees&&(this[s]=this[s]*C)}.bind(this)),Math.abs(Math.abs(this.lat0)-T)<y?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<y?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var r=this.tilt,a=this.azi;this.cg=Math.cos(a),this.sg=Math.sin(a),this.cw=Math.cos(r),this.sw=Math.sin(r)},forward:function(r){r.x-=this.long0;var c,v,p,l,a=Math.sin(r.y),s=Math.cos(r.y),h=Math.cos(r.x);switch(this.mode){case 3:v=this.sinph0*a+this.cosph0*s*h;break;case 2:v=s*h;break;case 1:v=-a;break;case 0:v=a}switch(c=(v=this.pn1/(this.p-v))*s*Math.sin(r.x),this.mode){case 3:v*=this.cosph0*a-this.sinph0*s*h;break;case 2:v*=a;break;case 0:v*=-s*h;break;case 1:v*=s*h}return c=(c*this.cg-v*this.sg)*this.cw*(l=1/((p=v*this.cg+c*this.sg)*this.sw*this.h1+this.cw)),v=p*l,r.x=c*this.a,r.y=v*this.a,r},inverse:function(r){r.x/=this.a,r.y/=this.a;var s,h,c,a={x:r.x,y:r.y};r.x=(s=this.pn1*r.x*(c=1/(this.pn1-r.y*this.sw)))*this.cg+(h=this.pn1*r.y*this.cw*c)*this.sg,r.y=h*this.cg-s*this.sg;var v=un(r.x,r.y);if(Math.abs(v)<y)a.x=0,a.y=r.y;else{var p,l;switch(l=1-v*v*this.pfact,l=(this.p-Math.sqrt(l))/(this.pn1/v+v/this.pn1),p=Math.sqrt(1-l*l),this.mode){case 3:a.y=Math.asin(p*this.sinph0+r.y*l*this.cosph0/v),r.y=(p-this.sinph0*Math.sin(a.y))*v,r.x*=l*this.cosph0;break;case 2:a.y=Math.asin(r.y*l/v),r.y=p*v,r.x*=l;break;case 0:a.y=Math.asin(p),r.y=-r.y;break;case 1:a.y=-Math.asin(p)}a.x=Math.atan2(r.x,r.y)}return r.x=a.x+this.long0,r.y=a.y,r},names:["Tilted_Perspective","tpers"]};Se.defaultDatum="WGS84",Se.Proj=Vr,Se.WGS84=new Se.Proj("WGS84"),Se.Point=Ln,Se.toPoint=qe,Se.defs=_e,Se.nadgrid=function(r,a){var s=new DataView(a),h=function(r){var a=r.getInt32(8,!1);return 11!==a&&(11!==(a=r.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(s),c=function(r,a){return{nFields:r.getInt32(8,a),nSubgridFields:r.getInt32(24,a),nSubgrids:r.getInt32(40,a),shiftType:Kr(r,56,64).trim(),fromSemiMajorAxis:r.getFloat64(120,a),fromSemiMinorAxis:r.getFloat64(136,a),toSemiMajorAxis:r.getFloat64(152,a),toSemiMinorAxis:r.getFloat64(168,a)}}(s,h);c.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var v=function(r,a,s){for(var c=[],v=0;v<a.nSubgrids;v++){var p=Ro(r,176,s),l=On(r,176,p,s),S=Math.round(1+(p.upperLongitude-p.lowerLongitude)/p.longitudeInterval),D=Math.round(1+(p.upperLatitude-p.lowerLatitude)/p.latitudeInterval);c.push({ll:[Ve(p.lowerLongitude),Ve(p.lowerLatitude)],del:[Ve(p.longitudeInterval),Ve(p.latitudeInterval)],lim:[S,D],count:p.gridNodeCount,cvs:An(l)})}return c}(s,c,h),p={header:c,subgrids:v};return mi[r]=p,p},Se.transform=Nr,Se.mgrs=Ua,Se.version="__VERSION__",function(r){r.Proj.projections.add(kr),r.Proj.projections.add(cn),r.Proj.projections.add(rs),r.Proj.projections.add(us),r.Proj.projections.add(Fi),r.Proj.projections.add(ls),r.Proj.projections.add(_s),r.Proj.projections.add(wr),r.Proj.projections.add(ar),r.Proj.projections.add(Ts),r.Proj.projections.add(de),r.Proj.projections.add(Gs),r.Proj.projections.add(ln),r.Proj.projections.add(Zr),r.Proj.projections.add(Ys),r.Proj.projections.add(Hs),r.Proj.projections.add(Xn),r.Proj.projections.add(no),r.Proj.projections.add(cr),r.Proj.projections.add(vn),r.Proj.projections.add(fr),r.Proj.projections.add(ho),r.Proj.projections.add(ii),r.Proj.projections.add(Wr),r.Proj.projections.add(ia),r.Proj.projections.add(bo),r.Proj.projections.add(Co),r.Proj.projections.add(si)}(Se);const ma=Se},6985:gt=>{gt.exports=function(R){"use strict";var E=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function P(C,w){var g=C[0],m=C[1],b=C[2],x=C[3];m=((m+=((b=((b+=((x=((x+=((g=((g+=(m&b|~m&x)+w[0]-680876936|0)<<7|g>>>25)+m|0)&m|~g&b)+w[1]-389564586|0)<<12|x>>>20)+g|0)&g|~x&m)+w[2]+606105819|0)<<17|b>>>15)+x|0)&x|~b&g)+w[3]-1044525330|0)<<22|m>>>10)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m&b|~m&x)+w[4]-176418897|0)<<7|g>>>25)+m|0)&m|~g&b)+w[5]+1200080426|0)<<12|x>>>20)+g|0)&g|~x&m)+w[6]-1473231341|0)<<17|b>>>15)+x|0)&x|~b&g)+w[7]-45705983|0)<<22|m>>>10)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m&b|~m&x)+w[8]+1770035416|0)<<7|g>>>25)+m|0)&m|~g&b)+w[9]-1958414417|0)<<12|x>>>20)+g|0)&g|~x&m)+w[10]-42063|0)<<17|b>>>15)+x|0)&x|~b&g)+w[11]-1990404162|0)<<22|m>>>10)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m&b|~m&x)+w[12]+1804603682|0)<<7|g>>>25)+m|0)&m|~g&b)+w[13]-40341101|0)<<12|x>>>20)+g|0)&g|~x&m)+w[14]-1502002290|0)<<17|b>>>15)+x|0)&x|~b&g)+w[15]+1236535329|0)<<22|m>>>10)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m&x|b&~x)+w[1]-165796510|0)<<5|g>>>27)+m|0)&b|m&~b)+w[6]-1069501632|0)<<9|x>>>23)+g|0)&m|g&~m)+w[11]+643717713|0)<<14|b>>>18)+x|0)&g|x&~g)+w[0]-373897302|0)<<20|m>>>12)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m&x|b&~x)+w[5]-701558691|0)<<5|g>>>27)+m|0)&b|m&~b)+w[10]+38016083|0)<<9|x>>>23)+g|0)&m|g&~m)+w[15]-660478335|0)<<14|b>>>18)+x|0)&g|x&~g)+w[4]-405537848|0)<<20|m>>>12)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m&x|b&~x)+w[9]+568446438|0)<<5|g>>>27)+m|0)&b|m&~b)+w[14]-1019803690|0)<<9|x>>>23)+g|0)&m|g&~m)+w[3]-187363961|0)<<14|b>>>18)+x|0)&g|x&~g)+w[8]+1163531501|0)<<20|m>>>12)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m&x|b&~x)+w[13]-1444681467|0)<<5|g>>>27)+m|0)&b|m&~b)+w[2]-51403784|0)<<9|x>>>23)+g|0)&m|g&~m)+w[7]+1735328473|0)<<14|b>>>18)+x|0)&g|x&~g)+w[12]-1926607734|0)<<20|m>>>12)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m^b^x)+w[5]-378558|0)<<4|g>>>28)+m|0)^m^b)+w[8]-2022574463|0)<<11|x>>>21)+g|0)^g^m)+w[11]+1839030562|0)<<16|b>>>16)+x|0)^x^g)+w[14]-35309556|0)<<23|m>>>9)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m^b^x)+w[1]-1530992060|0)<<4|g>>>28)+m|0)^m^b)+w[4]+1272893353|0)<<11|x>>>21)+g|0)^g^m)+w[7]-155497632|0)<<16|b>>>16)+x|0)^x^g)+w[10]-1094730640|0)<<23|m>>>9)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m^b^x)+w[13]+681279174|0)<<4|g>>>28)+m|0)^m^b)+w[0]-358537222|0)<<11|x>>>21)+g|0)^g^m)+w[3]-722521979|0)<<16|b>>>16)+x|0)^x^g)+w[6]+76029189|0)<<23|m>>>9)+b|0,m=((m+=((b=((b+=((x=((x+=((g=((g+=(m^b^x)+w[9]-640364487|0)<<4|g>>>28)+m|0)^m^b)+w[12]-421815835|0)<<11|x>>>21)+g|0)^g^m)+w[15]+530742520|0)<<16|b>>>16)+x|0)^x^g)+w[2]-995338651|0)<<23|m>>>9)+b|0,m=((m+=((x=((x+=(m^((g=((g+=(b^(m|~x))+w[0]-198630844|0)<<6|g>>>26)+m|0)|~b))+w[7]+1126891415|0)<<10|x>>>22)+g|0)^((b=((b+=(g^(x|~m))+w[14]-1416354905|0)<<15|b>>>17)+x|0)|~g))+w[5]-57434055|0)<<21|m>>>11)+b|0,m=((m+=((x=((x+=(m^((g=((g+=(b^(m|~x))+w[12]+1700485571|0)<<6|g>>>26)+m|0)|~b))+w[3]-1894986606|0)<<10|x>>>22)+g|0)^((b=((b+=(g^(x|~m))+w[10]-1051523|0)<<15|b>>>17)+x|0)|~g))+w[1]-2054922799|0)<<21|m>>>11)+b|0,m=((m+=((x=((x+=(m^((g=((g+=(b^(m|~x))+w[8]+1873313359|0)<<6|g>>>26)+m|0)|~b))+w[15]-30611744|0)<<10|x>>>22)+g|0)^((b=((b+=(g^(x|~m))+w[6]-1560198380|0)<<15|b>>>17)+x|0)|~g))+w[13]+1309151649|0)<<21|m>>>11)+b|0,m=((m+=((x=((x+=(m^((g=((g+=(b^(m|~x))+w[4]-145523070|0)<<6|g>>>26)+m|0)|~b))+w[11]-1120210379|0)<<10|x>>>22)+g|0)^((b=((b+=(g^(x|~m))+w[2]+718787259|0)<<15|b>>>17)+x|0)|~g))+w[9]-343485551|0)<<21|m>>>11)+b|0,C[0]=g+C[0]|0,C[1]=m+C[1]|0,C[2]=b+C[2]|0,C[3]=x+C[3]|0}function L(C){var g,w=[];for(g=0;g<64;g+=4)w[g>>2]=C.charCodeAt(g)+(C.charCodeAt(g+1)<<8)+(C.charCodeAt(g+2)<<16)+(C.charCodeAt(g+3)<<24);return w}function W(C){var g,w=[];for(g=0;g<64;g+=4)w[g>>2]=C[g]+(C[g+1]<<8)+(C[g+2]<<16)+(C[g+3]<<24);return w}function U(C){var m,b,x,ht,St,G,w=C.length,g=[1732584193,-271733879,-1732584194,271733878];for(m=64;m<=w;m+=64)P(g,L(C.substring(m-64,m)));for(b=(C=C.substring(m-64)).length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;m<b;m+=1)x[m>>2]|=C.charCodeAt(m)<<(m%4<<3);if(x[m>>2]|=128<<(m%4<<3),m>55)for(P(g,x),m=0;m<16;m+=1)x[m]=0;return ht=(ht=8*w).toString(16).match(/(.*?)(.{0,8})$/),St=parseInt(ht[2],16),G=parseInt(ht[1],16)||0,x[14]=St,x[15]=G,P(g,x),g}function B(C){var g,w="";for(g=0;g<4;g+=1)w+=E[C>>8*g+4&15]+E[C>>8*g&15];return w}function N(C){var w;for(w=0;w<C.length;w+=1)C[w]=B(C[w]);return C.join("")}function F(C){return/[\u0080-\uFFFF]/.test(C)&&(C=unescape(encodeURIComponent(C))),C}function nt(C){var m,w=[],g=C.length;for(m=0;m<g-1;m+=2)w.push(parseInt(C.substr(m,2),16));return String.fromCharCode.apply(String,w)}function y(){this.reset()}return N(U("hello")),"undefined"!=typeof ArrayBuffer&&!ArrayBuffer.prototype.slice&&function(){function C(w,g){return(w=0|w||0)<0?Math.max(w+g,0):Math.min(w,g)}ArrayBuffer.prototype.slice=function(w,g){var ht,St,G,ct,m=this.byteLength,b=C(w,m),x=m;return undefined!==g&&(x=C(g,m)),b>x?new ArrayBuffer(0):(ht=x-b,St=new ArrayBuffer(ht),G=new Uint8Array(St),ct=new Uint8Array(this,b,ht),G.set(ct),St)}}(),y.prototype.append=function(C){return this.appendBinary(F(C)),this},y.prototype.appendBinary=function(C){this._buff+=C,this._length+=C.length;var g,w=this._buff.length;for(g=64;g<=w;g+=64)P(this._hash,L(this._buff.substring(g-64,g)));return this._buff=this._buff.substring(g-64),this},y.prototype.end=function(C){var m,x,w=this._buff,g=w.length,b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(m=0;m<g;m+=1)b[m>>2]|=w.charCodeAt(m)<<(m%4<<3);return this._finish(b,g),x=N(this._hash),C&&(x=nt(x)),this.reset(),x},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},y.prototype.setState=function(C){return this._buff=C.buff,this._length=C.length,this._hash=C.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(C,w){var m,b,x,g=w;if(C[g>>2]|=128<<(g%4<<3),g>55)for(P(this._hash,C),g=0;g<16;g+=1)C[g]=0;m=(m=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),b=parseInt(m[2],16),x=parseInt(m[1],16)||0,C[14]=b,C[15]=x,P(this._hash,C)},y.hash=function(C,w){return y.hashBinary(F(C),w)},y.hashBinary=function(C,w){var m=N(U(C));return w?nt(m):m},(y.ArrayBuffer=function(){this.reset()}).prototype.append=function(C){var m,w=function(C,w,g){var m=new Uint8Array(C.byteLength+w.byteLength);return m.set(new Uint8Array(C)),m.set(new Uint8Array(w),C.byteLength),g?m:m.buffer}(this._buff.buffer,C,!0),g=w.length;for(this._length+=C.byteLength,m=64;m<=g;m+=64)P(this._hash,W(w.subarray(m-64,m)));return this._buff=m-64<g?new Uint8Array(w.buffer.slice(m-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(C){var b,x,w=this._buff,g=w.length,m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;b<g;b+=1)m[b>>2]|=w[b]<<(b%4<<3);return this._finish(m,g),x=N(this._hash),C&&(x=nt(x)),this.reset(),x},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var C=y.prototype.getState.call(this);return C.buff=function(C){return String.fromCharCode.apply(null,new Uint8Array(C))}(C.buff),C},y.ArrayBuffer.prototype.setState=function(C){return C.buff=function(C,w){var x,g=C.length,m=new ArrayBuffer(g),b=new Uint8Array(m);for(x=0;x<g;x+=1)b[x]=C.charCodeAt(x);return w?b:m}(C.buff,!0),y.prototype.setState.call(this,C)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(C,w){var m=N(function(C){var m,b,x,ht,St,G,w=C.length,g=[1732584193,-271733879,-1732584194,271733878];for(m=64;m<=w;m+=64)P(g,W(C.subarray(m-64,m)));for(b=(C=m-64<w?C.subarray(m-64):new Uint8Array(0)).length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;m<b;m+=1)x[m>>2]|=C[m]<<(m%4<<3);if(x[m>>2]|=128<<(m%4<<3),m>55)for(P(g,x),m=0;m<16;m+=1)x[m]=0;return ht=(ht=8*w).toString(16).match(/(.*?)(.{0,8})$/),St=parseInt(ht[2],16),G=parseInt(ht[1],16)||0,x[14]=St,x[15]=G,P(g,x),g}(new Uint8Array(C)));return w?nt(m):m},y}()},5186:(gt,R)=>{"use strict";function I(E,J,P){var L=P[P.length-1];E===L.element&&(P.pop(),L=P[P.length-1]);var W=L.element,U=L.index;Array.isArray(W)?W.push(E):U===J.length-2?W[J.pop()]=E:J.push(E)}R.stringify=function(J){var P=[];P.push({obj:J});for(var W,U,B,N,T,K,Z,nt,y,L="";W=P.pop();)if(U=W.obj,L+=W.prefix||"",B=W.val||"")L+=B;else if("object"!=typeof U)L+=void 0===U?null:JSON.stringify(U);else if(null===U)L+="null";else if(Array.isArray(U)){for(P.push({val:"]"}),N=U.length-1;N>=0;N--)P.push({obj:U[N],prefix:0===N?"":","});P.push({val:"["})}else{for(K in T=[],U)U.hasOwnProperty(K)&&T.push(K);for(P.push({val:"}"}),N=T.length-1;N>=0;N--)nt=U[Z=T[N]],y=N>0?",":"",y+=JSON.stringify(Z)+":",P.push({obj:nt,prefix:y});P.push({val:"{"})}return L},R.parse=function(E){for(var W,U,H,B,N,F,T,K,Z,J=[],P=[],L=0;;)if("}"!==(W=E[L++])&&"]"!==W&&void 0!==W)switch(W){case" ":case"\t":case"\n":case":":case",":break;case"n":L+=3,I(null,J,P);break;case"t":L+=3,I(!0,J,P);break;case"f":L+=4,I(!1,J,P);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(U="",L--;;){if(H=E[L++],!/[\d\.\-e\+]/.test(H)){L--;break}U+=H}I(parseFloat(U),J,P);break;case'"':for(B="",N=void 0,F=0;'"'!==(T=E[L++])||"\\"===N&&F%2==1;)B+=T,"\\"===(N=T)?F++:F=0;I(JSON.parse('"'+B+'"'),J,P);break;case"[":J.push((K={element:[],index:J.length}).element),P.push(K);break;case"{":J.push((Z={element:{},index:J.length}).element),P.push(Z);break;default:throw new Error("unexpectedly reached end of input: "+W)}else{if(1===J.length)return J.pop();I(J.pop(),J,P)}}},7138:(gt,R,I)=>{"use strict";I.r(R),I.d(R,{DeparturesPageModule:()=>Yc});var E=I(7823),J=I(8583),P=I(3679),L=I(1348);function K(t,n,e,i){return new(e||(e=Promise))(function(u,d){function M($){try{k(i.next($))}catch(_){d(_)}}function A($){try{k(i.throw($))}catch(_){d(_)}}function k($){$.done?u($.value):function(u){return u instanceof e?u:new e(function(d){d(u)})}($.value).then(M,A)}k((i=i.apply(t,n||[])).next())})}var f=I(8720),Or=I(9765),_a=I(4570),Le=I.n(_a);const Ue=I(7613).v4;var mr,Oe,fi=I(6985),Ye=I.n(fi),hi=I(5186),Ma=I(9234),Ae=I.n(Ma),wa=I(9879),Te=I.n(wa),Ee=I(3105),_e=I.n(Ee);function Hr(t){return"$"+t}function ba(t){return t.substring(1)}function Je(){this._store={}}function Tr(t){if(this._store=new Je,t&&Array.isArray(t))for(var n=0,e=t.length;n<e;n++)this.add(t[n])}Je.prototype.get=function(t){var n=Hr(t);return this._store[n]},Je.prototype.set=function(t,n){var e=Hr(t);return this._store[e]=n,!0},Je.prototype.has=function(t){return Hr(t)in this._store},Je.prototype.delete=function(t){var n=Hr(t),e=n in this._store;return delete this._store[n],e},Je.prototype.forEach=function(t){for(var n=Object.keys(this._store),e=0,i=n.length;e<i;e++){var o=n[e];t(this._store[o],o=ba(o))}},Object.defineProperty(Je.prototype,"size",{get:function(){return Object.keys(this._store).length}}),Tr.prototype.add=function(t){return this._store.set(t,!0)},Tr.prototype.has=function(t){return this._store.has(t)},Tr.prototype.forEach=function(t){this._store.forEach(function(n,e){t(e)})},Object.defineProperty(Tr.prototype,"size",{get:function(){return this._store.size}}),function(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var t=Object.getOwnPropertyDescriptor(Map,Symbol.species);return t&&"get"in t&&Map[Symbol.species]===Map}()?(mr=Set,Oe=Map):(mr=Tr,Oe=Je);var bn,Mn=Function.prototype.toString,Be=Mn.call(Object);function Mt(t){var n,e,i;if(!t||"object"!=typeof t)return t;if(Array.isArray(t)){for(n=[],e=0,i=t.length;e<i;e++)n[e]=Mt(t[e]);return n}if(t instanceof Date)return t.toISOString();if(function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}(t))return function(t){if(t instanceof ArrayBuffer)return function(t){if("function"==typeof t.slice)return t.slice(0);var n=new ArrayBuffer(t.byteLength),e=new Uint8Array(n),i=new Uint8Array(t);return e.set(i),n}(t);var n=t.size,e=t.type;return"function"==typeof t.slice?t.slice(0,n,e):t.webkitSlice(0,n,e)}(t);if(!function(t){var n=Object.getPrototypeOf(t);if(null===n)return!0;var e=n.constructor;return"function"==typeof e&&e instanceof e&&Mn.call(e)==Be}(t))return t;for(e in n={},t)if(Object.prototype.hasOwnProperty.call(t,e)){var o=Mt(t[e]);void 0!==o&&(n[e]=o)}return n}function Pe(t){var n=!1;return Ae()(function(e){if(n)throw new Error("once called more than once");n=!0,t.apply(this,e)})}function gr(t){return Ae()(function(n){n=Mt(n);var e=this,i="function"==typeof n[n.length-1]&&n.pop(),o=new Promise(function(u,d){var M;try{var A=Pe(function(k,$){k?d(k):u($)});n.push(A),(M=t.apply(e,n))&&"function"==typeof M.then&&u(M)}catch(k){d(k)}});return i&&o.then(function(u){i(null,u)},i),o})}function le(t,n){return gr(Ae()(function(e){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var i=this;return function(t,n,e){if(t.constructor.listeners("debug").length){for(var i=["api",t.name,n],o=0;o<e.length-1;o++)i.push(e[o]);t.constructor.emit("debug",i);var u=e[e.length-1];e[e.length-1]=function(d,M){var A=["api",t.name,n];A=A.concat(d?["error",d]:["success",M]),t.constructor.emit("debug",A),u(d,M)}}}(i,t,e),this.taskqueue.isReady?n.apply(this,e):new Promise(function(o,u){i.taskqueue.addTask(function(d){d?u(d):o(i[t].apply(i,e))})})}))}function Pr(t,n){for(var e={},i=0,o=n.length;i<o;i++){var u=n[i];u in t&&(e[u]=t[u])}return e}function li(t){return t}function Ea(t){return[{ok:t}]}function wn(t,n,e){var i=n.docs,o=new Oe;i.forEach(function(j){o.has(j.id)?o.get(j.id).push(j):o.set(j.id,[j])});var u=o.size,d=0,M=new Array(u);var _=[];o.forEach(function(j,V){_.push(V)});var q=0;!function Q(){if(!(q>=_.length)){var j=Math.min(q+6,_.length),V=_.slice(q,j);(function(j,V){j.forEach(function(et,rt){var Y=V+rt,ut=o.get(et),vt=Pr(ut[0],["atts_since","attachments"]);vt.open_revs=ut.map(function(yt){return yt.rev}),vt.open_revs=vt.open_revs.filter(li);var xt=li;0===vt.open_revs.length&&(delete vt.open_revs,xt=Ea),["revs","attachments","binary","ajax","latest"].forEach(function(yt){yt in n&&(vt[yt]=n[yt])}),t.get(et,vt,function(yt,At){var It;It=yt?[{error:yt}]:xt(At),function(j,V,et){M[j]={id:V,docs:et},function(){var j;++d===u&&(j=[],M.forEach(function(V){V.docs.forEach(function(et){j.push({id:V.id,docs:[et]})})}),e(null,{results:j}))}()}(Y,et,It),Q()})})})(V,q),q+=V.length}}()}try{localStorage.setItem("_pouch_check_localstorage",1),bn=!!localStorage.getItem("_pouch_check_localstorage")}catch(t){bn=!1}function Sn(){return bn}function Qe(){var t;_e().call(this),this._listeners={},t=this,Sn()&&addEventListener("storage",function(n){t.emit(n.key)})}function be(t){if("undefined"!=typeof console&&"function"==typeof console[t]){var n=Array.prototype.slice.call(arguments,1);console[t].apply(console,n)}}function Da(t){var n=0;return t||(n=2e3),function(t,n){var e=6e5;return t=parseInt(t,10)||0,(n=parseInt(n,10))!=n||n<=t?n=(t||1)<<1:n+=1,n>e&&(t=e>>1,n=e),~~((n-t)*Math.random()+t)}(t,n)}function xn(t,n){be("info","The above "+t+" is totally normal. "+n)}Te()(Qe,_e()),Qe.prototype.addListener=function(t,n,e,i){if(!this._listeners[n]){var o=this,u=!1;this._listeners[n]=d,this.on(t,d)}function d(){if(o._listeners[n])if(u)u="waiting";else{u=!0;var M=Pr(i,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);e.changes(M).on("change",function(k){k.seq>i.since&&!i.cancelled&&(i.since=k.seq,i.onChange(k))}).on("complete",function(){"waiting"===u&&Le()(d),u=!1}).on("error",function(){u=!1})}}},Qe.prototype.removeListener=function(t,n){n in this._listeners&&(_e().prototype.removeListener.call(this,t,this._listeners[n]),delete this._listeners[n])},Qe.prototype.notifyLocalWindows=function(t){Sn()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},Qe.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var Rt="function"==typeof Object.assign?Object.assign:function(t){for(var n=Object(t),e=1;e<arguments.length;e++){var i=arguments[e];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n};function ie(t,n,e){Error.call(this,e),this.status=t,this.name=n,this.message=e,this.error=!0}Te()(ie,Error),ie.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})},new ie(401,"unauthorized","Name or password is incorrect.");var Ia=new ie(400,"bad_request","Missing JSON list of 'docs'"),ee=new ie(404,"not_found","missing"),pr=new ie(409,"conflict","Document update conflict"),vi=new ie(400,"bad_request","_id field must contain a string"),mi=new ie(412,"missing_id","_id is required for puts"),Na=new ie(400,"bad_request","Only reserved document ids may start with underscore."),gi=(new ie(412,"precondition_failed","Database not open"),new ie(500,"unknown_error","Database encountered an unknown error")),Ve=new ie(500,"badarg","Some query argument is invalid"),qa=(new ie(400,"invalid_request","Request was invalid"),new ie(400,"query_parse_error","Some query parameter is invalid")),Kr=new ie(500,"doc_validation","Bad special document member"),Xr=new ie(400,"bad_request","Something wrong with the request"),An=new ie(400,"bad_request","Document must be a JSON object"),On=(new ie(404,"not_found","Database not found"),new ie(500,"indexed_db_went_bad","unknown")),Tn=(new ie(500,"web_sql_went_bad","unknown"),new ie(500,"levelDB_went_went_bad","unknown"),new ie(403,"forbidden","Forbidden by design doc validate_doc_update function"),new ie(400,"bad_request","Invalid rev format")),ka=(new ie(412,"file_exists","The database could not be created, the file already exists."),new ie(412,"missing_stub","A pre-existing attachment stub wasn't found"));function jt(t,n){function e(i){for(var o=Object.getOwnPropertyNames(t),u=0,d=o.length;u<d;u++)"function"!=typeof t[o[u]]&&(this[o[u]]=t[o[u]]);void 0!==i&&(this.reason=i)}return e.prototype=ie.prototype,new e(n)}function _r(t){if("object"!=typeof t){var n=t;(t=gi).data=n}return"error"in t&&"conflict"===t.error&&(t.name="conflict",t.status=409),"name"in t||(t.name=t.error||"unknown"),"status"in t||(t.status=500),"message"in t||(t.message=t.message||t.reason),t}function En(t){var n={},e=t.filter&&"function"==typeof t.filter;return n.query=t.query_params,function(o){o.doc||(o.doc={});var u=e&&function(t,n,e){try{return!t(n,e)}catch(o){var i="Filter function threw: "+o.toString();return jt(Xr,i)}}(t.filter,o.doc,n);if("object"==typeof u)return u;if(u)return!1;if(t.include_docs){if(!t.attachments)for(var d in o.doc._attachments)o.doc._attachments.hasOwnProperty(d)&&(o.doc._attachments[d].stub=!0)}else delete o.doc;return!0}}function Ir(t){for(var n=[],e=0,i=t.length;e<i;e++)n=n.concat(t[e]);return n}function Pn(t){var n;if(t?"string"!=typeof t?n=jt(vi):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(n=jt(Na)):n=jt(mi),n)throw n}function qe(t){return"boolean"==typeof t._remote?t._remote:"function"==typeof t.type&&(be("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===t.type())}function tn(t){if(!t)return null;var n=t.split("/");return 2===n.length?n:1===n.length?[t,t]:null}function _i(t){var n=tn(t);return n?n.join("/"):null}new ie(413,"invalid_url","Provided URL is invalid");var Nr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Dn="queryKey",In=/(?:^|&)([^&=]*)=?([^&]*)/g,yi=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function Mi(t){for(var n=yi.exec(t),e={},i=14;i--;){var o=Nr[i],u=n[i]||"",d=-1!==["user","password"].indexOf(o);e[o]=d?decodeURIComponent(u):u}return e[Dn]={},e[Nr[12]].replace(In,function(M,A,k){A&&(e[Dn][A]=k)}),e}function Se(t,n){var e=[],i=[];for(var o in n)n.hasOwnProperty(o)&&(e.push(o),i.push(n[o]));return e.push(t),Function.apply(null,e).apply(null,i)}function qr(t,n,e){return new Promise(function(i,o){t.get(n,function(u,d){if(u){if(404!==u.status)return o(u);d={}}var M=d._rev,A=e(d);if(!A)return i({updated:!1,rev:M});A._id=n,A._rev=M,i(function(t,n,e){return t.put(n).then(function(i){return{updated:!0,rev:i.rev}},function(i){if(409!==i.status)throw i;return qr(t,n._id,e)})}(t,A,e))})})}var en=function(t){return atob(t)},Fe=function(t){return btoa(t)};function ye(t,n){t=t||[],n=n||{};try{return new Blob(t,n)}catch(u){if("TypeError"!==u.name)throw u;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),o=0;o<t.length;o+=1)i.append(t[o]);return i.getBlob(n.type)}}function De(t){for(var n=t.length,e=new ArrayBuffer(n),i=new Uint8Array(e),o=0;o<n;o++)i[o]=t.charCodeAt(o);return e}function tr(t,n){return ye([De(t)],{type:n})}function er(t,n){return tr(en(t),n)}function Nn(t,n){var e=new FileReader,i="function"==typeof e.readAsBinaryString;e.onloadend=function(o){var u=o.target.result||"";if(i)return n(u);n(function(t){for(var n="",e=new Uint8Array(t),i=e.byteLength,o=0;o<i;o++)n+=String.fromCharCode(e[o]);return n}(u))},i?e.readAsBinaryString(t):e.readAsArrayBuffer(t)}function bi(t,n){Nn(t,function(e){n(e)})}function rn(t,n){bi(t,function(e){n(Fe(e))})}var Si=self.setImmediate||self.setTimeout;function ja(t,n,e,i,o){(e>0||i<n.size)&&(n=function(t,n,e){return t.webkitSlice?t.webkitSlice(n,e):t.slice(n,e)}(n,e,i)),function(t,n){var e=new FileReader;e.onloadend=function(i){var o=i.target.result||new ArrayBuffer(0);n(o)},e.readAsArrayBuffer(t)}(n,function(u){t.append(u),o()})}function Ga(t,n,e,i,o){(e>0||i<n.length)&&(n=n.substring(e,i)),t.appendBinary(n),o()}function nn(t,n){var e="string"==typeof t,i=e?t.length:t.size,o=Math.min(32768,i),u=Math.ceil(i/o),d=0,M=e?new(Ye()):new(Ye().ArrayBuffer),A=e?Ga:ja;function k(){Si(_)}function $(){var Q=function(t){return Fe(t)}(M.end(!0));n(Q),M.destroy()}function _(){var q=d*o;d++,A(M,t,q,q+o,d<u?k:$)}_()}function xi(t){return Ye().hash(t)}function kn(t,n){var e=Mt(t);return n?(delete e._rev_tree,xi(JSON.stringify(e))):Ue().replace(/-/g,"").toLowerCase()}var an=Ue;function rr(t){for(var n,e,i,u,o=t.rev_tree.slice();u=o.pop();){var d=u.ids,M=d[2],A=u.pos;if(M.length)for(var k=0,$=M.length;k<$;k++)o.push({pos:A+1,ids:M[k]});else{var _=!!d[1].deleted,q=d[0];(!n||(i!==_?i:e!==A?e<A:n<q))&&(n=q,e=A,i=_)}}return e+"-"+n}function nr(t,n){for(var i,e=t.slice();i=e.pop();)for(var o=i.pos,u=i.ids,d=u[2],M=n(0===d.length,o,u[0],i.ctx,u[1]),A=0,k=d.length;A<k;A++)e.push({pos:o+1,ids:d[A],ctx:M})}function yr(t,n){return t.pos-n.pos}function Ln(t){var n=[];nr(t,function(o,u,d,M,A){o&&n.push({rev:u+"-"+d,pos:u,opts:A})}),n.sort(yr).reverse();for(var e=0,i=n.length;e<i;e++)delete n[e].pos;return n}function Un(t){for(var n=rr(t),e=Ln(t.rev_tree),i=[],o=0,u=e.length;o<u;o++){var d=e[o];d.rev!==n&&!d.opts.deleted&&i.push(d.rev)}return i}function Bn(t){for(var i,n=[],e=t.slice();i=e.pop();){var o=i.pos,u=i.ids,d=u[0],M=u[1],A=u[2],k=0===A.length,$=i.history?i.history.slice():[];$.push({id:d,opts:M}),k&&n.push({pos:o+1-$.length,ids:$});for(var _=0,q=A.length;_<q;_++)e.push({pos:o+1,ids:A[_],history:$})}return n.reverse()}function Ci(t,n){return t.pos-n.pos}function Wa(t,n,e){var i=function(t,n,e){for(var u,i=0,o=t.length;i<o;)e(t[u=i+o>>>1],n)<0?i=u+1:o=u;return i}(t,n,e);t.splice(i,0,n)}function Oi(t,n){for(var e,i,o=n,u=t.length;o<u;o++){var d=t[o],M=[d.id,d.opts,[]];i?(i[2].push(M),i=M):e=i=M}return e}function Qa(t,n){return t[0]<n[0]?-1:1}function Ti(t,n){for(var e=[{tree1:t,tree2:n}],i=!1;e.length>0;){var o=e.pop(),u=o.tree1,d=o.tree2;(u[1].status||d[1].status)&&(u[1].status="available"===u[1].status||"available"===d[1].status?"available":"missing");for(var M=0;M<d[2].length;M++)if(u[2][0]){for(var A=!1,k=0;k<u[2].length;k++)u[2][k][0]===d[2][M][0]&&(e.push({tree1:u[2][k],tree2:d[2][M]}),A=!0);A||(i="new_branch",Wa(u[2],d[2][M],Qa))}else i="new_leaf",u[2][0]=d[2][M]}return{conflicts:i,tree:t}}function Ei(t,n,e){var d,i=[],o=!1,u=!1;if(!t.length)return{tree:[n],conflicts:"new_leaf"};for(var M=0,A=t.length;M<A;M++){var k=t[M];if(k.pos===n.pos&&k.ids[0]===n.ids[0])d=Ti(k.ids,n.ids),i.push({pos:k.pos,ids:d.tree}),o=o||d.conflicts,u=!0;else if(!0!==e){var $=k.pos<n.pos?k:n,_=k.pos<n.pos?n:k,Q=[],O=[];for(O.push({ids:$.ids,diff:_.pos-$.pos,parent:null,parentIdx:null});O.length>0;){var j=O.pop();if(0!==j.diff)for(var V=j.ids[2],et=0,rt=V.length;et<rt;et++)O.push({ids:V[et],diff:j.diff-1,parent:j.ids,parentIdx:et});else j.ids[0]===_.ids[0]&&Q.push(j)}var Y=Q[0];Y?(d=Ti(Y.ids,_.ids),Y.parent[2][Y.parentIdx]=d.tree,i.push({pos:$.pos,ids:$.ids}),o=o||d.conflicts,u=!0):i.push(k)}else i.push(k)}return u||i.push(n),i.sort(Ci),{tree:i,conflicts:o||"internal_node"}}function Pi(t,n,e){var i=Ei(t,n),o=function(t,n){for(var i,o,e=Bn(t),u=0,d=e.length;u<d;u++){var k,M=e[u],A=M.ids;if(A.length>n){i||(i={});var $=A.length-n;k={pos:M.pos+$,ids:Oi(A,$)};for(var _=0;_<$;_++)i[M.pos+_+"-"+A[_].id]=!0}else k={pos:M.pos,ids:Oi(A,0)};o=o?Ei(o,k,!0).tree:[k]}return i&&nr(o,function(Q,O,j){delete i[O+"-"+j]}),{tree:o,revs:i?Object.keys(i):[]}}(i.tree,e);return{tree:o.tree,stemmedRevs:o.revs,conflicts:i.conflicts}}function sn(t){return t.ids}function ze(t,n){n||(n=rr(t));for(var o,e=n.substring(n.indexOf("-")+1),i=t.rev_tree.map(sn);o=i.pop();){if(o[0]===e)return!!o[1].deleted;i=i.concat(o[2])}}function $e(t){return/^_local/.test(t)}function Rr(t,n,e){_e().call(this);var i=this;this.db=t;var o=(n=n?Mt(n):{}).complete=Pe(function(M,A){M?function(t,n){return"listenerCount"in t?t.listenerCount(n):_e().listenerCount(t,n)}(i,"error")>0&&i.emit("error",M):i.emit("complete",A),i.removeAllListeners(),t.removeListener("destroyed",u)});function u(){i.cancel()}e&&(i.on("complete",function(M){e(null,M)}),i.on("error",e)),t.once("destroyed",u),n.onChange=function(M,A,k){i.isCancelled||function(t,n,e,i){try{t.emit("change",n,e,i)}catch(o){be("error",'Error in .on("change", function):',o)}}(i,M,A,k)};var d=new Promise(function(M,A){n.complete=function(k,$){k?A(k):M($)}});i.once("cancel",function(){t.removeListener("destroyed",u),n.complete(null,{status:"cancelled"})}),this.then=d.then.bind(d),this.catch=d.catch.bind(d),this.then(function(M){o(null,M)},o),t.taskqueue.isReady?i.validateChanges(n):t.taskqueue.addTask(function(M){M?n.complete(M):i.isCancelled?i.emit("cancel"):i.validateChanges(n)})}function $a(t,n,e){var i=[{rev:t._rev}];"all_docs"===e.style&&(i=Ln(n.rev_tree).map(function(u){return{rev:u.rev}}));var o={id:n.id,changes:i,doc:t};return ze(n,t._rev)&&(o.deleted=!0),e.conflicts&&(o.doc._conflicts=Un(n),o.doc._conflicts.length||delete o.doc._conflicts),o}function kr(t,n){return t<n?-1:t>n?1:0}function on(t,n){return function(e,i){e||i[0]&&i[0].error?((e=e||i[0]).docId=n,t(e)):t(null,i.length?i[0]:i)}}function Ha(t,n){var e=kr(t._id,n._id);return 0!==e?e:kr(t._revisions?t._revisions.start:0,n._revisions?n._revisions.start:0)}function Ii(t){var n=t._compactionQueue[0],e=n.opts,i=n.callback;t.get("_local/compaction").catch(function(){return!1}).then(function(o){o&&o.last_seq&&(e.last_seq=o.last_seq),t._compact(e,function(u,d){u?i(u):i(null,d),Le()(function(){t._compactionQueue.shift(),t._compactionQueue.length&&Ii(t)})})})}function se(){for(var t in _e().call(this),se.prototype)"function"==typeof this[t]&&(this[t]=this[t].bind(this))}function Lr(){this.isReady=!1,this.failed=!1,this.queue=[]}function Gt(t,n){if(!(this instanceof Gt))return new Gt(t,n);var e=this;if(n=n||{},t&&"object"==typeof t&&(t=(n=t).name,delete n.name),void 0===n.deterministic_revs&&(n.deterministic_revs=!0),this.__opts=n=Mt(n),e.auto_compaction=n.auto_compaction,e.prefix=Gt.prefix,"string"!=typeof t)throw new Error("Missing/invalid DB name");var o=function(t,n){var e=t.match(/([a-z-]*):\/\/(.*)/);if(e)return{name:/https?/.test(e[1])?e[1]+"://"+e[2]:e[2],adapter:e[1]};var i=Gt.adapters,o=Gt.preferredAdapters,u=Gt.prefix,d=n.adapter;if(!d)for(var M=0;M<o.length&&"idb"===(d=o[M])&&"websql"in i&&Sn()&&localStorage["_pouch__websqldb_"+u+t];++M)be("log",'PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var A=i[d];return{name:A&&"use_prefix"in A&&!A.use_prefix?t:u+t,adapter:d}}((n.prefix||"")+t,n);if(n.name=o.name,n.adapter=n.adapter||o.adapter,e.name=t,e._adapter=n.adapter,Gt.emit("debug",["adapter","Picked adapter: ",n.adapter]),!Gt.adapters[n.adapter]||!Gt.adapters[n.adapter].valid())throw new Error("Invalid Adapter: "+n.adapter);se.call(e),e.taskqueue=new Lr,e.adapter=n.adapter,Gt.adapters[n.adapter].call(e,n,function(u){if(u)return e.taskqueue.fail(u);(function(t){function n(i){t.removeListener("closed",e),i||t.constructor.emit("destroyed",t.name)}function e(){t.removeListener("destroyed",n),t.constructor.emit("unref",t)}t.once("destroyed",n),t.once("closed",e),t.constructor.emit("ref",t)})(e),e.emit("created",e),Gt.emit("created",e.name),e.taskqueue.ready(e)})}Te()(Rr,_e()),Rr.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Rr.prototype.validateChanges=function(t){var n=t.complete,e=this;Gt._changesFilterPlugin?Gt._changesFilterPlugin.validate(t,function(i){if(i)return n(i);e.doChanges(t)}):e.doChanges(t)},Rr.prototype.doChanges=function(t){var n=this,e=t.complete;if("live"in(t=Mt(t))&&!("continuous"in t)&&(t.continuous=t.live),t.processChange=$a,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"!==t.since){if(Gt._changesFilterPlugin){if(Gt._changesFilterPlugin.normalize(t),Gt._changesFilterPlugin.shouldFilter(this,t))return Gt._changesFilterPlugin.filter(this,t)}else["doc_ids","filter","selector","view"].forEach(function(u){u in t&&be("warn",'The "'+u+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=e;var i=this.db._changes(t);if(i&&"function"==typeof i.cancel){var o=n.cancel;n.cancel=Ae()(function(u){i.cancel(),o.apply(this,u)})}}else this.db.info().then(function(u){n.isCancelled?e(null,{status:"cancelled"}):(t.since=u.update_seq,n.doChanges(t))},e)},Te()(se,_e()),se.prototype.post=le("post",function(t,n,e){if("function"==typeof n&&(e=n,n={}),"object"!=typeof t||Array.isArray(t))return e(jt(An));this.bulkDocs({docs:[t]},n,on(e,t._id))}),se.prototype.put=le("put",function(t,n,e){if("function"==typeof n&&(e=n,n={}),"object"!=typeof t||Array.isArray(t))return e(jt(An));if(Pn(t._id),$e(t._id)&&"function"==typeof this._putLocal)return t._deleted?this._removeLocal(t,e):this._putLocal(t,e);var d,M,k,$,i=this;function u(d){"function"==typeof i._put&&!1!==n.new_edits?i._put(t,n,d):i.bulkDocs({docs:[t]},n,on(d,t._id))}n.force&&t._rev?(M=(d=t._rev.split("-"))[1],k=parseInt(d[0],10)+1,$=kn(),t._revisions={start:k,ids:[$,M]},t._rev=k+"-"+$,n.new_edits=!1,u(function(d){e(d,d?null:{ok:!0,id:t._id,rev:t._rev})})):u(e)}),se.prototype.putAttachment=le("putAttachment",function(t,n,e,i,o){var u=this;function d(M){var A="_rev"in M?parseInt(M._rev,10):0;return M._attachments=M._attachments||{},M._attachments[n]={content_type:o,data:i,revpos:++A},u.put(M)}return"function"==typeof o&&(o=i,i=e,e=null),void 0===o&&(o=i,i=e,e=null),o||be("warn","Attachment",n,"on document",t,"is missing content_type"),u.get(t).then(function(M){if(M._rev!==e)throw jt(pr);return d(M)},function(M){if(M.reason===ee.message)return d({_id:t});throw M})}),se.prototype.removeAttachment=le("removeAttachment",function(t,n,e,i){var o=this;o.get(t,function(u,d){if(u)i(u);else{if(d._rev===e)return d._attachments?(delete d._attachments[n],0===Object.keys(d._attachments).length&&delete d._attachments,void o.put(d,i)):i();i(jt(pr))}})}),se.prototype.remove=le("remove",function(t,n,e,i){var o;"string"==typeof n?(o={_id:t,_rev:n},"function"==typeof e&&(i=e,e={})):(o=t,"function"==typeof n?(i=n,e={}):(i=e,e=n)),(e=e||{}).was_delete=!0;var u={_id:o._id,_rev:o._rev||e.rev,_deleted:!0};if($e(u._id)&&"function"==typeof this._removeLocal)return this._removeLocal(o,i);this.bulkDocs({docs:[u]},e,on(i,u._id))}),se.prototype.revsDiff=le("revsDiff",function(t,n,e){"function"==typeof n&&(e=n,n={});var i=Object.keys(t);if(!i.length)return e(null,{});var o=0,u=new Oe;function d(A,k){u.has(A)||u.set(A,{missing:[]}),u.get(A).missing.push(k)}i.map(function(A){this._getRevisionTree(A,function(k,$){if(k&&404===k.status&&"missing"===k.message)u.set(A,{missing:t[A]});else{if(k)return e(k);!function(A,k){var $=t[A].slice(0);nr(k,function(_,q,Q,O,j){var V=q+"-"+Q,et=$.indexOf(V);-1!==et&&($.splice(et,1),"available"!==j.status&&d(A,V))}),$.forEach(function(_){d(A,_)})}(A,$)}if(++o===i.length){var _={};return u.forEach(function(q,Q){_[Q]=q}),e(null,_)}})},this)}),se.prototype.bulkGet=le("bulkGet",function(t,n){wn(this,t,n)}),se.prototype.compactDocument=le("compactDocument",function(t,n,e){var i=this;this._getRevisionTree(t,function(o,u){if(o)return e(o);var d=function(t){var n={},e=[];return nr(t,function(i,o,u,d){var M=o+"-"+u;return i&&(n[M]=0),void 0!==d&&e.push({from:d,to:M}),M}),e.reverse(),e.forEach(function(i){n[i.from]=void 0===n[i.from]?1+n[i.to]:Math.min(n[i.from],1+n[i.to])}),n}(u),M=[],A=[];Object.keys(d).forEach(function(k){d[k]>n&&M.push(k)}),nr(u,function(k,$,_,q,Q){var O=$+"-"+_;"available"===Q.status&&-1!==M.indexOf(O)&&A.push(O)}),i._doCompaction(t,A,e)})}),se.prototype.compact=le("compact",function(t,n){"function"==typeof t&&(n=t,t={});var e=this;t=t||{},e._compactionQueue=e._compactionQueue||[],e._compactionQueue.push({opts:t,callback:n}),1===e._compactionQueue.length&&Ii(e)}),se.prototype._compact=function(t,n){var e=this,o=[];e.changes({return_docs:!1,last_seq:t.last_seq||0}).on("change",function(M){o.push(e.compactDocument(M.id,0))}).on("complete",function(M){var A=M.last_seq;Promise.all(o).then(function(){return qr(e,"_local/compaction",function($){return(!$.last_seq||$.last_seq<A)&&($.last_seq=A,$)})}).then(function(){n(null,{ok:!0})}).catch(n)}).on("error",n)},se.prototype.get=le("get",function(t,n,e){if("function"==typeof n&&(e=n,n={}),"string"!=typeof t)return e(jt(vi));if($e(t)&&"function"==typeof this._getLocal)return this._getLocal(t,e);var i=[],o=this;function u(){var A=[],k=i.length;if(!k)return e(null,A);i.forEach(function($){o.get(t,{rev:$,revs:n.revs,latest:n.latest,attachments:n.attachments,binary:n.binary},function(_,q){if(_)A.push({missing:$});else{for(var Q,O=0,j=A.length;O<j;O++)if(A[O].ok&&A[O].ok._rev===q._rev){Q=!0;break}Q||A.push({ok:q})}--k||e(null,A)})})}if(!n.open_revs)return this._get(t,n,function(A,k){if(A)return A.docId=t,e(A);var $=k.doc,_=k.metadata,q=k.ctx;if(n.conflicts){var Q=Un(_);Q.length&&($._conflicts=Q)}if(ze(_,$._rev)&&($._deleted=!0),n.revs||n.revs_info){for(var O=$._rev.split("-"),j=parseInt(O[0],10),V=O[1],et=Bn(_.rev_tree),rt=null,Y=0;Y<et.length;Y++){var ut=et[Y],vt=ut.ids.map(function(Zt){return Zt.id}).indexOf(V);(vt===j-1||!rt&&-1!==vt)&&(rt=ut)}if(!rt)return(A=new Error("invalid rev tree")).docId=t,e(A);var yt=rt.ids.map(function(Zt){return Zt.id}).indexOf($._rev.split("-")[1])+1;if(rt.ids.splice(yt,rt.ids.length-yt),rt.ids.reverse(),n.revs&&($._revisions={start:rt.pos+rt.ids.length-1,ids:rt.ids.map(function(Zt){return Zt.id})}),n.revs_info){var It=rt.pos+rt.ids.length;$._revs_info=rt.ids.map(function(Zt){return{rev:--It+"-"+Zt.id,status:Zt.opts.status}})}}if(n.attachments&&$._attachments){var Ct=$._attachments,Ut=Object.keys(Ct).length;if(0===Ut)return e(null,$);Object.keys(Ct).forEach(function(Zt){this._getAttachment($._id,Zt,Ct[Zt],{rev:$._rev,binary:n.binary,ctx:q},function(Bt,qt){var Yt=$._attachments[Zt];Yt.data=qt,delete Yt.stub,delete Yt.length,--Ut||e(null,$)})},o)}else{if($._attachments)for(var Wt in $._attachments)$._attachments.hasOwnProperty(Wt)&&($._attachments[Wt].stub=!0);e(null,$)}});if("all"===n.open_revs)this._getRevisionTree(t,function(A,k){if(A)return e(A);i=Ln(k).map(function($){return $.rev}),u()});else{if(!Array.isArray(n.open_revs))return e(jt(gi,"function_clause"));i=n.open_revs;for(var d=0;d<i.length;d++){var M=i[d];if("string"!=typeof M||!/^\d+-/.test(M))return e(jt(Tn))}u()}}),se.prototype.getAttachment=le("getAttachment",function(t,n,e,i){var o=this;e instanceof Function&&(i=e,e={}),this._get(t,e,function(u,d){return u?i(u):d.doc._attachments&&d.doc._attachments[n]?(e.ctx=d.ctx,e.binary=!0,void o._getAttachment(t,n,d.doc._attachments[n],e,i)):i(jt(ee))})}),se.prototype.allDocs=le("allDocs",function(t,n){if("function"==typeof t&&(n=t,t={}),t.skip=void 0!==t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys"in t){if(!Array.isArray(t.keys))return n(new TypeError("options.keys must be an array"));var e=["startkey","endkey","key"].filter(function(i){return i in t})[0];if(e)return void n(jt(qa,"Query parameter `"+e+"` is not compatible with multi-get"));if(!qe(this)&&(function(t){var n="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;t.keys=n,t.skip=0,delete t.limit,t.descending&&(n.reverse(),t.descending=!1)}(t),0===t.keys.length))return this._allDocs({limit:0},n)}return this._allDocs(t,n)}),se.prototype.changes=function(t,n){return"function"==typeof t&&(n=t,t={}),(t=t||{}).return_docs="return_docs"in t?t.return_docs:!t.live,new Rr(this,t,n)},se.prototype.close=le("close",function(t){return this._closed=!0,this.emit("closed"),this._close(t)}),se.prototype.info=le("info",function(t){var n=this;this._info(function(e,i){if(e)return t(e);i.db_name=i.db_name||n.name,i.auto_compaction=!(!n.auto_compaction||qe(n)),i.adapter=n.adapter,t(null,i)})}),se.prototype.id=le("id",function(t){return this._id(t)}),se.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},se.prototype.bulkDocs=le("bulkDocs",function(t,n,e){if("function"==typeof n&&(e=n,n={}),n=n||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs))return e(jt(Ia));for(var i=0;i<t.docs.length;++i)if("object"!=typeof t.docs[i]||Array.isArray(t.docs[i]))return e(jt(An));var o;if(t.docs.forEach(function(M){M._attachments&&Object.keys(M._attachments).forEach(function(A){o=o||function(t){return"_"===t.charAt(0)&&t+" is not a valid attachment name, attachment names cannot start with '_'"}(A),M._attachments[A].content_type||be("warn","Attachment",A,"on document",M._id,"is missing content_type")})}),o)return e(jt(Xr,o));"new_edits"in n||(n.new_edits=!("new_edits"in t)||t.new_edits);var u=this;!n.new_edits&&!qe(u)&&t.docs.sort(Ha),function(t){for(var n=0;n<t.length;n++){var e=t[n];if(e._deleted)delete e._attachments;else if(e._attachments)for(var i=Object.keys(e._attachments),o=0;o<i.length;o++){var u=i[o];e._attachments[u]=Pr(e._attachments[u],["data","digest","content_type","length","revpos","stub"])}}}(t.docs);var d=t.docs.map(function(M){return M._id});return this._bulkDocs(t,n,function(M,A){if(M)return e(M);if(n.new_edits||(A=A.filter(function(_){return _.error})),!qe(u))for(var k=0,$=A.length;k<$;k++)A[k].id=A[k].id||d[k];e(null,A)})}),se.prototype.registerDependentDatabase=le("registerDependentDatabase",function(t,n){var e=new this.constructor(t,this.__opts);qr(this,"_local/_pouch_dependentDbs",function(o){return o.dependentDbs=o.dependentDbs||{},!o.dependentDbs[t]&&(o.dependentDbs[t]=!0,o)}).then(function(){n(null,{db:e})}).catch(n)}),se.prototype.destroy=le("destroy",function(t,n){"function"==typeof t&&(n=t,t={});var e=this,i=!("use_prefix"in e)||e.use_prefix;function o(){e._destroy(t,function(u,d){if(u)return n(u);e._destroyed=!0,e.emit("destroyed"),n(null,d||{ok:!0})})}if(qe(e))return o();e.get("_local/_pouch_dependentDbs",function(u,d){if(u)return 404!==u.status?n(u):o();var A=e.constructor,k=Object.keys(d.dependentDbs).map(function($){var _=i?$.replace(new RegExp("^"+A.prefix),""):$;return new A(_,e.__opts).destroy()});Promise.all(k).then(o,n)})}),Lr.prototype.execute=function(){var t;if(this.failed)for(;t=this.queue.shift();)t(this.failed);else for(;t=this.queue.shift();)t()},Lr.prototype.fail=function(t){this.failed=t,this.execute()},Lr.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},Lr.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},Te()(Gt,se);var cn="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},Ni=fetch,Mr=Headers;Gt.adapters={},Gt.preferredAdapters=[],Gt.prefix="_pouch_";var qi=new(_e());function fn(t,n){for(var e=t,i=0,o=n.length;i<o&&(e=e[n[i]]);i++);return e}function Ri(t){for(var n=[],e="",i=0,o=t.length;i<o;i++){var u=t[i];"."===u?i>0&&"\\"===t[i-1]?e=e.substring(0,e.length-1)+".":(n.push(e),e=""):e+=u}return n.push(e),n}(function(t){Object.keys(_e().prototype).forEach(function(e){"function"==typeof _e().prototype[e]&&(t[e]=qi[e].bind(qi))});var n=t._destructionListeners=new Oe;t.on("ref",function(i){n.has(i.name)||n.set(i.name,[]),n.get(i.name).push(i)}),t.on("unref",function(i){if(n.has(i.name)){var o=n.get(i.name),u=o.indexOf(i);u<0||(o.splice(u,1),o.length>1?n.set(i.name,o):n.delete(i.name))}}),t.on("destroyed",function(i){if(n.has(i)){var o=n.get(i);n.delete(i),o.forEach(function(u){u.emit("destroyed",!0)})}})})(Gt),Gt.adapter=function(t,n,e){n.valid()&&(Gt.adapters[t]=n,e&&Gt.preferredAdapters.push(t))},Gt.plugin=function(t){if("function"==typeof t)t(Gt);else{if("object"!=typeof t||0===Object.keys(t).length)throw new Error('Invalid plugin: got "'+t+'", expected an object or a function');Object.keys(t).forEach(function(n){Gt.prototype[n]=t[n]})}return this.__defaults&&(Gt.__defaults=Rt({},this.__defaults)),Gt},Gt.defaults=function(t){function n(e,i){if(!(this instanceof n))return new n(e,i);i=i||{},e&&"object"==typeof e&&(e=(i=e).name,delete i.name),i=Rt({},n.__defaults,i),Gt.call(this,e,i)}return Te()(n,Gt),n.preferredAdapters=Gt.preferredAdapters.slice(),Object.keys(Gt).forEach(function(e){e in n||(n[e]=Gt[e])}),n.__defaults=Rt({},this.__defaults,t),n},Gt.fetch=function(t,n){return Ni(t,n)};var is=["$or","$nor","$not"];function ki(t){return is.indexOf(t)>-1}function Li(t){return Object.keys(t)[0]}function Ur(t){var n={};return t.forEach(function(e){Object.keys(e).forEach(function(i){var o=e[i];if("object"!=typeof o&&(o={$eq:o}),ki(i))n[i]=o instanceof Array?o.map(function(d){return Ur([d])}):Ur([o]);else{var u=n[i]=n[i]||{};Object.keys(o).forEach(function(d){var M=o[d];return"$gt"===d||"$gte"===d?function(t,n,e){void 0===e.$eq&&(void 0!==e.$gte?"$gte"===t?n>e.$gte&&(e.$gte=n):n>=e.$gte&&(delete e.$gte,e.$gt=n):void 0!==e.$gt?"$gte"===t?n>e.$gt&&(delete e.$gt,e.$gte=n):n>e.$gt&&(e.$gt=n):e[t]=n)}(d,M,u):"$lt"===d||"$lte"===d?function(t,n,e){void 0===e.$eq&&(void 0!==e.$lte?"$lte"===t?n<e.$lte&&(e.$lte=n):n<=e.$lte&&(delete e.$lte,e.$lt=n):void 0!==e.$lt?"$lte"===t?n<e.$lt&&(delete e.$lt,e.$lte=n):n<e.$lt&&(e.$lt=n):e[t]=n)}(d,M,u):"$ne"===d?function(t,n){"$ne"in n?n.$ne.push(t):n.$ne=[t]}(M,u):"$eq"===d?function(t,n){delete n.$gt,delete n.$gte,delete n.$lt,delete n.$lte,delete n.$ne,n.$eq=t}(M,u):void(u[d]=M)})}})}),n}function Ui(t){for(var n in t){if(Array.isArray(t))for(var e in t)t[e].$and&&(t[e]=Ur(t[e].$and));var i=t[n];"object"==typeof i&&Ui(i)}return t}function Bi(t,n){for(var e in t){"$and"===e&&(n=!0);var i=t[e];"object"==typeof i&&(n=Bi(i,n))}return n}function cs(t){var n=Mt(t),e=!1;Bi(n,!1)&&("$and"in(n=Ui(n))&&(n=Ur(n.$and)),e=!0),["$or","$nor"].forEach(function(M){M in n&&n[M].forEach(function(A){for(var k=Object.keys(A),$=0;$<k.length;$++){var _=k[$],q=A[_];("object"!=typeof q||null===q)&&(A[_]={$eq:q})}})}),"$not"in n&&(n.$not=Ur([n.$not]));for(var i=Object.keys(n),o=0;o<i.length;o++){var u=i[o],d=n[u];"object"!=typeof d||null===d?d={$eq:d}:"$ne"in d&&!e&&(d.$ne=[d.$ne]),n[u]=d}return n}function pe(t,n){if(t===n)return 0;t=ir(t),n=ir(n);var e=Wn(t),i=Wn(n);if(e-i!=0)return e-i;switch(typeof t){case"number":return t-n;case"boolean":return t<n?-1:1;case"string":return function(t,n){return t===n?0:t>n?1:-1}(t,n)}return Array.isArray(t)?function(t,n){for(var e=Math.min(t.length,n.length),i=0;i<e;i++){var o=pe(t[i],n[i]);if(0!==o)return o}return t.length===n.length?0:t.length>n.length?1:-1}(t,n):function(t,n){for(var e=Object.keys(t),i=Object.keys(n),o=Math.min(e.length,i.length),u=0;u<o;u++){var d=pe(e[u],i[u]);if(0!==d||0!==(d=pe(t[e[u]],n[i[u]])))return d}return e.length===i.length?0:e.length>i.length?1:-1}(t,n)}function ir(t){switch(typeof t){case"undefined":return null;case"number":return t===1/0||t===-1/0||isNaN(t)?null:t;case"object":var n=t;if(Array.isArray(t)){var e=t.length;t=new Array(e);for(var i=0;i<e;i++)t[i]=ir(n[i])}else{if(t instanceof Date)return t.toJSON();if(null!==t)for(var o in t={},n)if(n.hasOwnProperty(o)){var u=n[o];void 0!==u&&(t[o]=ir(u))}}}return t}function Me(t){return Wn(t=ir(t))+""+function(t){if(null!==t)switch(typeof t){case"boolean":return t?1:0;case"number":return function(t){if(0===t)return"1";var n=t.toExponential().split(/e\+?/),e=parseInt(n[1],10),i=t<0,o=i?"0":"2";o+=""+function(t,n,e){return function(t,n,e){for(var i="",o=3-t.length;i.length<o;)i+="0";return i}(t)+t}(((i?-e:e)- -324).toString());var M=Math.abs(parseFloat(n[0]));i&&(M=10-M);var A=M.toFixed(20);return o+""+A.replace(/\.?0+$/,"")}(t);case"string":return t.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01");case"object":var n=Array.isArray(t),e=n?t:Object.keys(t),i=-1,o=e.length,u="";if(n)for(;++i<o;)u+=Me(e[i]);else for(;++i<o;){var d=e[i];u+=Me(d)+Me(t[d])}return u}return""}(t)+"\0"}function ds(t,n){var i,e=n;if("1"===t[n])i=0,n++;else{var u="0"===t[n];n++;var d="",M=t.substring(n,n+3),A=parseInt(M,10)+-324;for(u&&(A=-A),n+=3;;){var k=t[n];if("\0"===k)break;d+=k,n++}i=1===(d=d.split(".")).length?parseInt(d,10):parseFloat(d[0]+"."+d[1]),u&&(i-=10),0!==A&&(i=parseFloat(i+"e"+A))}return{num:i,length:n-e}}function vs(t,n){var e=t.pop();if(n.length){var i=n[n.length-1];e===i.element&&(n.pop(),i=n[n.length-1]);var o=i.element,u=i.index;Array.isArray(o)?o.push(e):u===t.length-2?o[t.pop()]=e:t.push(e)}}function Wn(t){var e=["boolean","number","string","object"].indexOf(typeof t);return~e?null===t?1:Array.isArray(t)?5:e<3?e+2:e+3:Array.isArray(t)?5:void 0}function wr(t,n,e){return e.every(function(i){var o=n[i],u=Ri(i),d=fn(t,u);return ki(i)?function(t,n,e){return"$or"===t?n.some(function(i){return wr(e,i,Object.keys(i))}):"$not"===t?!wr(e,n,Object.keys(n)):!n.find(function(i){return wr(e,i,Object.keys(i))})}(i,o,t):Qn(o,t,u,d)})}function Qn(t,n,e,i){return!t||("object"==typeof t?Object.keys(t).every(function(o){return function(t,n,e,i,o){if(!sr[t])throw new Error('unknown operator "'+t+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return sr[t](n,e,i,o)}(o,n,t[o],e,i)}):t===i)}function Br(t){return null!=t}function ar(t){return void 0!==t}function br(t,n){return n.some(function(e){return t instanceof Array?t.indexOf(e)>-1:t===e})}var sr={$elemMatch:function(t,n,e,i){return!(!Array.isArray(i)||0===i.length)&&i.some("object"==typeof i[0]?function(o){return wr(o,n,Object.keys(n))}:function(o){return Qn(n,t,e,o)})},$allMatch:function(t,n,e,i){return!(!Array.isArray(i)||0===i.length)&&i.every("object"==typeof i[0]?function(o){return wr(o,n,Object.keys(n))}:function(o){return Qn(n,t,e,o)})},$eq:function(t,n,e,i){return ar(i)&&0===pe(i,n)},$gte:function(t,n,e,i){return ar(i)&&pe(i,n)>=0},$gt:function(t,n,e,i){return ar(i)&&pe(i,n)>0},$lte:function(t,n,e,i){return ar(i)&&pe(i,n)<=0},$lt:function(t,n,e,i){return ar(i)&&pe(i,n)<0},$exists:function(t,n,e,i){return n?ar(i):!ar(i)},$mod:function(t,n,e,i){return Br(i)&&function(t,n){var e=n[0],i=n[1];if(0===e)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(e,10)!==e)throw new Error("Divisor is not an integer");if(parseInt(i,10)!==i)throw new Error("Modulus is not an integer");return parseInt(t,10)===t&&t%e===i}(i,n)},$ne:function(t,n,e,i){return n.every(function(o){return 0!==pe(i,o)})},$in:function(t,n,e,i){return Br(i)&&br(i,n)},$nin:function(t,n,e,i){return Br(i)&&!br(i,n)},$size:function(t,n,e,i){return Br(i)&&function(t,n){return t.length===n}(i,n)},$all:function(t,n,e,i){return Array.isArray(i)&&function(t,n){return n.every(function(e){return t.indexOf(e)>-1})}(i,n)},$regex:function(t,n,e,i){return Br(i)&&function(t,n){return new RegExp(n).test(t)}(i,n)},$type:function(t,n,e,i){return function(t,n){switch(n){case"null":return null===t;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t;case"string":return"string"==typeof t;case"array":return t instanceof Array;case"object":return"[object Object]"==={}.toString.call(t)}throw new Error(n+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}(i,n)}};function As(t,n){if(t.selector&&t.filter&&"_selector"!==t.filter)return n(new Error('selector invalid for filter "'+("string"==typeof t.filter?t.filter:"function")+'"'));n()}function Os(t){t.view&&!t.filter&&(t.filter="_view"),t.selector&&!t.filter&&(t.filter="_selector"),t.filter&&"string"==typeof t.filter&&("_view"===t.filter?t.view=_i(t.view):t.filter=_i(t.filter))}function Ts(t,n){return n.filter&&"string"==typeof n.filter&&!n.doc_ids&&!qe(t.db)}function He(t,n){var e=n.complete;if("_view"===n.filter){if(!n.view||"string"!=typeof n.view){var i=jt(Xr,"`view` filter parameter not found or invalid.");return e(i)}var o=tn(n.view);t.db.get("_design/"+o[0],function(d,M){if(t.isCancelled)return e(null,{status:"cancelled"});if(d)return e(_r(d));var A=M&&M.views&&M.views[o[1]]&&M.views[o[1]].map;if(!A)return e(jt(ee,M.views?"missing json key: "+o[1]:"missing json key: views"));n.filter=function(t){return Se(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+t+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{})}(A),t.doChanges(n)})}else if(n.selector)n.filter=function(d){return function(t,n){if("object"!=typeof n)throw new Error("Selector error: expected a JSON object");var i=function(t,n,e){if(t=t.filter(function(d){return wr(d.doc,n.selector,e)}),n.sort){var i=function(t){function n(e){return t.map(function(i){var u=Ri(Li(i));return fn(e,u)})}return function(e,i){var d=pe(n(e.doc),n(i.doc));return 0!==d?d:function(t,n){return t<n?-1:t>n?1:0}(e.doc._id,i.doc._id)}}(n.sort);t=t.sort(i),"string"!=typeof n.sort[0]&&"desc"===function(t){return t[Li(t)]}(n.sort[0])&&(t=t.reverse())}if("limit"in n||"skip"in n){var o=n.skip||0;t=t.slice(o,("limit"in n?n.limit:t.length)+o)}return t}([{doc:t}],{selector:n=cs(n)},Object.keys(n));return i&&1===i.length}(d,n.selector)},t.doChanges(n);else{var u=tn(n.filter);t.db.get("_design/"+u[0],function(d,M){if(t.isCancelled)return e(null,{status:"cancelled"});if(d)return e(_r(d));var A=M&&M.filters&&M.filters[u[1]];if(!A)return e(jt(ee,M&&M.filters?"missing json key: "+u[1]:"missing json key: filters"));n.filter=function(t){return Se('"use strict";\nreturn '+t+";",{})}(A),t.doChanges(n)})}}function ji(t){return t.reduce(function(n,e){return n[e]=!0,n},{})}Gt.plugin(function(t){t._changesFilterPlugin={validate:As,normalize:Os,shouldFilter:Ts,filter:He}}),Gt.version="7.2.2";var Ps=ji(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Ds=ji(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function Gi(t){if(!/^\d+-/.test(t))return jt(Tn);var n=t.indexOf("-"),e=t.substring(0,n),i=t.substring(n+1);return{prefix:parseInt(e,10),id:i}}function Zi(t,n,e){e||(e={deterministic_revs:!0});var i,o,u,d={status:"available"};if(t._deleted&&(d.deleted=!0),n)if(t._id||(t._id=an()),o=kn(t,e.deterministic_revs),t._rev){if((u=Gi(t._rev)).error)return u;t._rev_tree=[{pos:u.prefix,ids:[u.id,{status:"missing"},[[o,d,[]]]]}],i=u.prefix+1}else t._rev_tree=[{pos:1,ids:[o,d,[]]}],i=1;else if(t._revisions&&(t._rev_tree=function(t,n){for(var e=t.start-t.ids.length+1,i=t.ids,o=[i[0],n,[]],u=1,d=i.length;u<d;u++)o=[i[u],{status:"missing"},[o]];return[{pos:e,ids:o}]}(t._revisions,d),i=t._revisions.start,o=t._revisions.ids[0]),!t._rev_tree){if((u=Gi(t._rev)).error)return u;t._rev_tree=[{pos:i=u.prefix,ids:[o=u.id,d,[]]}]}Pn(t._id),t._rev=i+"-"+o;var M={metadata:{},data:{}};for(var A in t)if(Object.prototype.hasOwnProperty.call(t,A)){var k="_"===A[0];if(k&&!Ps[A]){var $=jt(Kr,A);throw $.message=Kr.message+": "+A,$}k&&!Ds[A]?M.metadata[A.slice(1)]=t[A]:M.data[A]=t[A]}return M}function ks(t,n,e){if(t.stub)return e();"string"==typeof t.data?function(t,n,e){var i=function(t){try{return en(t)}catch(e){return{error:jt(Ve,"Attachment is not a valid base64 string")}}}(t.data);if(i.error)return e(i.error);t.length=i.length,t.data="blob"===n?tr(i,t.content_type):"base64"===n?Fe(i):i,nn(i,function(o){t.digest="md5-"+o,e()})}(t,n,e):function(t,n,e){nn(t.data,function(i){t.digest="md5-"+i,t.length=t.data.size||t.data.length||0,"binary"===n?bi(t.data,function(o){t.data=o,e()}):"base64"===n?rn(t.data,function(o){t.data=o,e()}):e()})}(t,n,e)}function Fs(t,n,e,i,o,u,d,M,A){t=t||1e3;var $=M.new_edits,_=new Oe,q=0,Q=n.length;function O(){++q===Q&&A&&A()}n.forEach(function(j,V){if(j._id&&$e(j._id))e[j._deleted?"_removeLocal":"_putLocal"](j,{ctx:o},function(Y,ut){u[V]=Y||ut,O()});else{var rt=j.metadata.id;_.has(rt)?(Q--,_.get(rt).push([j,V])):_.set(rt,[[j,V]])}}),_.forEach(function(j,V){var et=0;function rt(){++et<j.length?Y():O()}function Y(){var ut=j[et],vt=ut[0],xt=ut[1];if(i.has(V))!function(t,n,e,i,o,u,d,M){if(function(t,n){for(var d,e=t.slice(),i=n.split("-"),o=parseInt(i[0],10),u=i[1];d=e.pop();){if(d.pos===o&&d.ids[0]===u)return!0;for(var M=d.ids[2],A=0,k=M.length;A<k;A++)e.push({pos:d.pos+1,ids:M[A]})}return!1}(n.rev_tree,e.metadata.rev)&&!M)return i[o]=e,u();var A=n.winningRev||rr(n),k="deleted"in n?n.deleted:ze(n,A),$="deleted"in e.metadata?e.metadata.deleted:ze(e.metadata),_=/^1-/.test(e.metadata.rev);if(k&&!$&&M&&_){var q=e.data;q._rev=A,q._id=e.metadata.id,e=Zi(q,M)}var Q=Pi(n.rev_tree,e.metadata.rev_tree[0],t);if(M&&(k&&$&&"new_leaf"!==Q.conflicts||!k&&"new_leaf"!==Q.conflicts||k&&!$&&"new_branch"===Q.conflicts)){var j=jt(pr);return i[o]=j,u()}var V=e.metadata.rev;e.metadata.rev_tree=Q.tree,e.stemmedRevs=Q.stemmedRevs||[],n.rev_map&&(e.metadata.rev_map=n.rev_map);var et=rr(e.metadata),rt=ze(e.metadata,et),Y=k===rt?0:k<rt?-1:1;d(e,et,rt,V===et?rt:ze(e.metadata,V),!0,Y,o,u)}(t,i.get(V),vt,u,xt,rt,d,$);else{var yt=Pi([],vt.metadata.rev_tree[0],t);vt.metadata.rev_tree=yt.tree,vt.stemmedRevs=yt.stemmedRevs||[],function(j,V,et){var rt=rr(j.metadata),Y=ze(j.metadata,rt);if("was_delete"in M&&Y)return u[V]=jt(ee,"deleted"),et();if($&&function(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}(j)){var vt=jt(pr);return u[V]=vt,et()}d(j,rt,Y,Y,!1,Y?0:1,V,et)}(vt,xt,rt)}}Y()})}var de="document-store",ce="by-sequence",Ie="attach-store",or="attach-seq-store",Ce="meta-store",je="local-store",zn="detect-blob-support";function Zs(t){try{return JSON.stringify(t)}catch(n){return hi.stringify(t)}}function Ge(t){return function(n){var e="unknown_error";n.target&&n.target.error&&(e=n.target.error.name||n.target.error.message),t(jt(On,e))}}function Yn(t,n,e){return{data:Zs(t),winningRev:n,deletedOrLocal:e?"1":"0",seq:t.seq,id:t.id}}function ur(t){if(!t)return null;var n=function(t){try{return JSON.parse(t)}catch(n){return hi.parse(t)}}(t.data);return n.winningRev=t.winningRev,n.deleted="1"===t.deletedOrLocal,n.seq=t.seq,n}function ln(t){if(!t)return t;var n=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,n-1),t._rev=t._doc_id_rev.substring(n+1),delete t._doc_id_rev,t}function Wi(t,n,e,i){e?i(t?"string"!=typeof t?t:er(t,n):ye([""],{type:n})):t?"string"!=typeof t?Nn(t,function(o){i(Fe(o))}):i(t):i("")}function Qi(t,n,e,i){var o=Object.keys(t._attachments||{});if(!o.length)return i&&i();var u=0;function d(){++u===o.length&&i&&i()}o.forEach(function(A){n.attachments&&n.include_docs?function(A,k){var $=A._attachments[k],_=$.digest;e.objectStore(Ie).get(_).onsuccess=function(Q){$.body=Q.target.result.body,d()}}(t,A):(t._attachments[A].stub=!0,d())})}function Jn(t,n){return Promise.all(t.map(function(e){if(e.doc&&e.doc._attachments){var i=Object.keys(e.doc._attachments);return Promise.all(i.map(function(o){var u=e.doc._attachments[o];if("body"in u){var d=u.body,M=u.content_type;return new Promise(function(A){Wi(d,M,n,function(k){e.doc._attachments[o]=Rt(Pr(u,["digest","content_type"]),{data:k}),A()})})}}))}}))}function zi(t,n,e){var i=[],o=e.objectStore(ce),u=e.objectStore(Ie),d=e.objectStore(or),M=t.length;function A(){--M||!i.length||i.forEach(function($){d.index("digestSeq").count(IDBKeyRange.bound($+"::",$+"::\uffff",!1,!1)).onsuccess=function(q){q.target.result||u.delete($)}})}t.forEach(function($){o.index("_doc_id_rev").getKey(n+"::"+$).onsuccess=function(Q){var O=Q.target.result;if("number"!=typeof O)return A();o.delete(O),d.index("seq").openCursor(IDBKeyRange.only(O)).onsuccess=function(V){var et=V.target.result;if(et){var rt=et.value.digestSeq.split("::")[0];i.push(rt),d.delete(et.primaryKey),et.continue()}else A()}}})}function Re(t,n,e){try{return{txn:t.transaction(n,e)}}catch(i){return{error:i}}}var Zr=new Qe;function Ws(t,n,e,i,o,u){for(var M,A,k,$,_,q,Q,O,d=n.docs,j=0,V=d.length;j<V;j++){var et=d[j];et._id&&$e(et._id)||(et=d[j]=Zi(et,e.new_edits,t)).error&&!Q&&(Q=et)}if(Q)return u(Q);var rt=!1,Y=0,ut=new Array(d.length),vt=new Oe,xt=!1;function It(){rt=!0,Ut()}function Ut(){!O||!rt||(O.docCount+=Y,q.put(O))}function Zt(){xt||(Zr.notify(i._meta.name),u(null,ut))}function Yt(pt,at,_t,Tt,Et,kt,Dt,wt){pt.metadata.winningRev=at,pt.metadata.deleted=_t;var Nt=pt.data;if(Nt._id=pt.metadata.id,Nt._rev=pt.metadata.rev,Tt&&(Nt._deleted=!0),Nt._attachments&&Object.keys(Nt._attachments).length)return function(pt,at,_t,Tt,Et,kt){var wt=0,Nt=Object.keys(pt.data._attachments);function zt(){wt===Nt.length&&tt(pt,at,_t,Tt,Et,kt)}function ue(){wt++,zt()}Nt.forEach(function(re){var Vt=pt.data._attachments[re];if(Vt.stub)wt++,zt();else{var ne=Vt.data;delete Vt.data,Vt.revpos=parseInt(at,10),function(pt,at,_t){$.count(pt).onsuccess=function(Et){if(Et.target.result)return _t();$.put({digest:pt,body:at}).onsuccess=_t}}(Vt.digest,ne,ue)}})}(pt,at,_t,Et,Dt,wt);Y+=kt,Ut(),tt(pt,at,_t,Et,Dt,wt)}function tt(pt,at,_t,Tt,Et,kt){var Dt=pt.data,wt=pt.metadata;function Nt(Vt){var ne=pt.stemmedRevs||[];Tt&&i.auto_compaction&&(ne=ne.concat(function(t){var n=[];return nr(t.rev_tree,function(e,i,o,u,d){"available"===d.status&&!e&&(n.push(i+"-"+o),d.status="missing")}),n}(pt.metadata))),ne&&ne.length&&zi(ne,pt.metadata.id,M),wt.seq=Vt.target.result;var ve=Yn(wt,at,_t);A.put(ve).onsuccess=ue}function ue(){ut[Et]={ok:!0,id:wt.id,rev:wt.rev},vt.set(pt.metadata.id,pt.metadata),function(pt,at,_t){var Tt=0,Et=Object.keys(pt.data._attachments||{});if(!Et.length)return _t();function kt(){++Tt===Et.length&&_t()}function Dt(Nt){var ue=_.put({seq:at,digestSeq:pt.data._attachments[Nt].digest+"::"+at});ue.onsuccess=kt,ue.onerror=function(re){re.preventDefault(),re.stopPropagation(),kt()}}for(var wt=0;wt<Et.length;wt++)Dt(Et[wt])}(pt,wt.seq,kt)}Dt._doc_id_rev=wt.id+"::"+wt.rev,delete Dt._id,delete Dt._rev;var re=k.put(Dt);re.onsuccess=Nt,re.onerror=function(Vt){Vt.preventDefault(),Vt.stopPropagation(),k.index("_doc_id_rev").getKey(Dt._doc_id_rev).onsuccess=function(We){k.put(Dt,We.target.result).onsuccess=Nt}}}!function(t,n,e){if(!t.length)return e();var o,i=0;function u(){i++,t.length===i&&(o?e(o):e())}t.forEach(function(d){var M=d.data&&d.data._attachments?Object.keys(d.data._attachments):[],A=0;if(!M.length)return u();function k(_){o=_,++A===M.length&&u()}for(var $ in d.data._attachments)d.data._attachments.hasOwnProperty($)&&ks(d.data._attachments[$],n,k)})}(d,i._meta.blobSupport?"blob":"base64",function(pt){if(pt)return u(pt);!function(){var at=Re(o,[de,ce,Ie,je,or,Ce],"readwrite");if(at.error)return u(at.error);(M=at.txn).onabort=Ge(u),M.ontimeout=Ge(u),M.oncomplete=Zt,A=M.objectStore(de),k=M.objectStore(ce),$=M.objectStore(Ie),_=M.objectStore(or),(q=M.objectStore(Ce)).get(Ce).onsuccess=function(_t){O=_t.target.result,Ut()},function(pt){var at=[];if(d.forEach(function(kt){kt.data&&kt.data._attachments&&Object.keys(kt.data._attachments).forEach(function(Dt){var wt=kt.data._attachments[Dt];wt.stub&&at.push(wt.digest)})}),!at.length)return pt();var Tt,_t=0;at.forEach(function(kt){!function(pt,at){$.get(pt).onsuccess=function(Tt){if(Tt.target.result)at();else{var Et=jt(ka,"unknown stub attachment with digest "+pt);Et.status=412,at(Et)}}}(kt,function(Dt){Dt&&!Tt&&(Tt=Dt),++_t===at.length&&pt(Tt)})})}(function(_t){if(_t)return xt=!0,u(_t);!function(){if(d.length)for(var pt=0,Tt=0,Et=d.length;Tt<Et;Tt++){var kt=d[Tt];kt._id&&$e(kt._id)?at():A.get(kt.metadata.id).onsuccess=_t}function at(){++pt===d.length&&Fs(t.revs_limit,d,i,vt,M,ut,Yt,e,It)}function _t(wt){var Nt=ur(wt.target.result);Nt&&vt.set(Nt.id,Nt),at()}}()})}()})}function Yi(t,n,e,i,o){var d,M,A;function k(Q){M=Q.target.result,d&&o(d,M,A)}function $(Q){d=Q.target.result,M&&o(d,M,A)}function q(Q){var O=Q.target.result;if(!O)return o();o([O.key],[O.value],O)}-1===i&&(i=1e3),"function"==typeof t.getAll&&"function"==typeof t.getAllKeys&&i>1&&!e?(A={continue:function(){if(!d.length)return o();var O,Q=d[d.length-1];if(n&&n.upper)try{O=IDBKeyRange.bound(Q,n.upper,!0,n.upperOpen)}catch(j){if("DataError"===j.name&&0===j.code)return o()}else O=IDBKeyRange.lowerBound(Q,!0);d=null,M=null,t.getAll(n=O,i).onsuccess=k,t.getAllKeys(n,i).onsuccess=$}},t.getAll(n,i).onsuccess=k,t.getAllKeys(n,i).onsuccess=$):e?t.openCursor(n,"prev").onsuccess=q:t.openCursor(n).onsuccess=q}var $n=!1,Hn=[];function Ks(){$n||!Hn.length||($n=!0,Hn.shift()())}var Kn,xr=new Oe,Xn=new Oe;function $i(t,n){var e=this;!function(t,n,e){Hn.push(function(){t(function(u,d){(function(t,n,e,i){try{t(n,e)}catch(o){i.emit("error",o)}})(n,u,d,e),$n=!1,Le()(function(){Ks()})})}),Ks()}(function(i){!function(t,n,e){var i=n.name,o=null;function d(O,j){var V=O.objectStore(de);V.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),V.openCursor().onsuccess=function(et){var rt=et.target.result;if(rt){var Y=rt.value,ut=ze(Y);Y.deletedOrLocal=ut?"1":"0",V.put(Y),rt.continue()}else j()}}function A(O,j){var V=O.objectStore(je),et=O.objectStore(de),rt=O.objectStore(ce);et.openCursor().onsuccess=function(ut){var vt=ut.target.result;if(vt){var xt=vt.value,yt=xt.id,At=$e(yt),It=rr(xt);if(At){var Ct=yt+"::"+It,Ut=yt+"::",Wt=yt+"::~",Zt=rt.index("_doc_id_rev"),Bt=IDBKeyRange.bound(Ut,Wt,!1,!1),qt=Zt.openCursor(Bt);qt.onsuccess=function(Yt){if(qt=Yt.target.result){var tt=qt.value;tt._doc_id_rev===Ct&&V.put(tt),rt.delete(qt.primaryKey),qt.continue()}else et.delete(vt.primaryKey),vt.continue()}}else vt.continue()}else j&&j()}}function $(O,j){var V=O.objectStore(ce),et=O.objectStore(Ie),rt=O.objectStore(or);et.count().onsuccess=function(ut){if(!ut.target.result)return j();V.openCursor().onsuccess=function(xt){var yt=xt.target.result;if(!yt)return j();for(var At=yt.value,It=yt.primaryKey,Ct=Object.keys(At._attachments||{}),Ut={},Wt=0;Wt<Ct.length;Wt++)Ut[At._attachments[Ct[Wt]].digest]=!0;var Bt=Object.keys(Ut);for(Wt=0;Wt<Bt.length;Wt++)rt.put({seq:It,digestSeq:Bt[Wt]+"::"+It});yt.continue()}}}function _(O){var V=O.objectStore(ce),et=O.objectStore(de);et.openCursor().onsuccess=function(Y){var At,It,Ct,Ut,ut=Y.target.result;if(ut){var vt=function(Y){return Y.data?ur(Y):(Y.deleted="1"===Y.deletedOrLocal,Y)}(ut.value);if(vt.winningRev=vt.winningRev||rr(vt),vt.seq)return yt();At=vt.id+"::",It=vt.id+"::\uffff",Ct=V.index("_doc_id_rev").openCursor(IDBKeyRange.bound(At,It)),Ut=0,Ct.onsuccess=function(Wt){var Zt=Wt.target.result;if(!Zt)return vt.seq=Ut,yt();var Bt=Zt.primaryKey;Bt>Ut&&(Ut=Bt),Zt.continue()}}function yt(){var At=Yn(vt,vt.winningRev,vt.deleted);et.put(At).onsuccess=function(){ut.continue()}}}}t._meta=null,t._remote=!1,t.type=function(){return"idb"},t._id=gr(function(O){O(null,t._meta.instanceId)}),t._bulkDocs=function(j,V,et){Ws(n,j,V,t,o,et)},t._get=function(j,V,et){var rt,Y,ut,vt=V.ctx;if(!vt){var xt=Re(o,[de,ce,Ie],"readonly");if(xt.error)return et(xt.error);vt=xt.txn}function yt(){et(ut,{doc:rt,metadata:Y,ctx:vt})}vt.objectStore(de).get(j).onsuccess=function(At){if(!(Y=ur(At.target.result)))return ut=jt(ee,"missing"),yt();var It;if(V.rev)It=V.latest?function(t,n){for(var i,e=n.rev_tree.slice();i=e.pop();){var o=i.pos,u=i.ids,d=u[0],M=u[1],A=u[2],k=0===A.length,$=i.history?i.history.slice():[];if($.push({id:d,pos:o,opts:M}),k)for(var _=0,q=$.length;_<q;_++){var Q=$[_];if(Q.pos+"-"+Q.id===t)return o+"-"+d}for(var j=0,V=A.length;j<V;j++)e.push({pos:o+1,ids:A[j],history:$})}throw new Error("Unable to resolve latest revision for id "+n.id+", rev "+t)}(V.rev,Y):V.rev;else if(It=Y.winningRev,ze(Y))return ut=jt(ee,"deleted"),yt();var Ut=vt.objectStore(ce),Wt=Y.id+"::"+It;Ut.index("_doc_id_rev").get(Wt).onsuccess=function(Zt){if((rt=Zt.target.result)&&(rt=ln(rt)),!rt)return ut=jt(ee,"missing"),yt();yt()}}},t._getAttachment=function(O,j,V,et,rt){var Y;if(et.ctx)Y=et.ctx;else{var ut=Re(o,[de,ce,Ie],"readonly");if(ut.error)return rt(ut.error);Y=ut.txn}var vt=V.digest,xt=V.content_type;Y.objectStore(Ie).get(vt).onsuccess=function(yt){Wi(yt.target.result.body,xt,et.binary,function(It){rt(null,It)})}},t._info=function(j){var V,et,rt=Re(o,[Ce,ce],"readonly");if(rt.error)return j(rt.error);var Y=rt.txn;Y.objectStore(Ce).get(Ce).onsuccess=function(ut){et=ut.target.result.docCount},Y.objectStore(ce).openCursor(null,"prev").onsuccess=function(ut){var vt=ut.target.result;V=vt?vt.key:0},Y.oncomplete=function(){j(null,{doc_count:et,update_seq:V,idb_attachment_format:t._meta.blobSupport?"binary":"base64"})}},t._allDocs=function(j,V){!function(t,n,e){var $,_,d="keys"in t&&t.keys,M=t.skip||0,A="number"==typeof t.limit?t.limit:-1;if(!d&&(_=($=function(t,n,e,i,o){try{if(t&&n)return o?IDBKeyRange.bound(n,t,!e,!1):IDBKeyRange.bound(t,n,!1,!e);if(t)return o?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(t);if(n)return o?IDBKeyRange.lowerBound(n,!e):IDBKeyRange.upperBound(n,!e);if(i)return IDBKeyRange.only(i)}catch(u){return{error:u}}return null}("startkey"in t&&t.startkey,"endkey"in t&&t.endkey,!1!==t.inclusive_end,"key"in t&&t.key,t.descending))&&$.error)&&("DataError"!==_.name||0!==_.code))return e(jt(On,_.name));var q=[de,ce,Ce];t.attachments&&q.push(Ie);var Q=Re(n,q,"readonly");if(Q.error)return e(Q.error);var O=Q.txn;O.oncomplete=function(){t.attachments?Jn(Y,t.binary).then(Wt):Wt()},O.onabort=Ge(e);var ut,vt,qt,j=O.objectStore(de),V=O.objectStore(ce),et=O.objectStore(Ce),rt=V.index("_doc_id_rev"),Y=[];function At(Bt,qt){var Yt={id:qt.id,key:qt.id,value:{rev:Bt}};qt.deleted?d&&(Y.push(Yt),Yt.value.deleted=!0,Yt.doc=null):M--<=0&&(Y.push(Yt),t.include_docs&&function(Bt,qt,Yt){rt.get(Bt.id+"::"+Yt).onsuccess=function(ot){if(qt.doc=ln(ot.target.result)||{},t.conflicts){var bt=Un(Bt);bt.length&&(qt.doc._conflicts=bt)}Qi(qt.doc,t,O)}}(qt,Yt,Bt))}function It(Bt){for(var qt=0,Yt=Bt.length;qt<Yt&&Y.length!==A;qt++){var tt=Bt[qt];if(tt.error&&d)Y.push(tt);else{var it=ur(tt);At(it.winningRev,it)}}}function Ct(Bt,qt,Yt){!Yt||(It(qt),Y.length<A&&Yt.continue())}function Wt(){var Bt={total_rows:ut,offset:t.skip,rows:Y};t.update_seq&&void 0!==vt&&(Bt.update_seq=vt),e(null,Bt)}if(et.get(Ce).onsuccess=function(Bt){ut=Bt.target.result.docCount},t.update_seq&&(qt=function(Bt){Bt.target.result&&Bt.target.result.length>0&&(vt=Bt.target.result[0])},V.openCursor(null,"prev").onsuccess=function(tt){var it=tt.target.result,ot=void 0;return it&&it.key&&(ot=it.key),qt({target:{result:[ot]}})}),!_&&0!==A){if(d)return function(t,n,e){var i=new Array(t.length),o=0;t.forEach(function(u,d){n.get(u).onsuccess=function(M){i[d]=M.target.result?M.target.result:{key:u,error:"not_found"},++o===t.length&&e(t,i,{})}})}(t.keys,j,Ct);if(-1===A)return function(t,n,e){if("function"!=typeof t.getAll){var i=[];t.openCursor(n).onsuccess=function(u){var d=u.target.result;d?(i.push(d.value),d.continue()):e({target:{result:i}})}}else t.getAll(n).onsuccess=e}(j,$,function(Bt){var qt=Bt.target.result;t.descending&&(qt=qt.reverse()),It(qt)});Yi(j,$,t.descending,A+M,Ct)}}(j,o,V)},t._changes=function(j){return function(t,n,e,i){if((t=Mt(t)).continuous){var o=e+":"+an();return Zr.addListener(e,o,n,t),Zr.notify(e),{cancel:function(){Zr.removeListener(e,o)}}}var u=t.doc_ids&&new mr(t.doc_ids);t.since=t.since||0;var d=t.since,M="limit"in t?t.limit:-1;0===M&&(M=1);var q,Q,O,j,A=[],k=0,$=En(t),_=new Oe;function et(At,It,Ct,Ut){return Ct.seq!==It?Ut():Ct.winningRev===At._rev?Ut(Ct,At):void(j.get(At._id+"::"+Ct.winningRev).onsuccess=function(Bt){Ut(Ct,ln(Bt.target.result))})}function Y(){t.complete(null,{results:A,last_seq:d})}var vt=[de,ce];t.attachments&&vt.push(Ie);var xt=Re(i,vt,"readonly");if(xt.error)return t.complete(xt.error);(q=xt.txn).onabort=Ge(t.complete),q.oncomplete=function(){!t.continuous&&t.attachments?Jn(A).then(Y):Y()},Q=q.objectStore(ce),O=q.objectStore(de),j=Q.index("_doc_id_rev"),Yi(Q,t.since&&!t.descending?IDBKeyRange.lowerBound(t.since,!0):null,t.descending,M,function(At,It,Ct){if(Ct&&At.length){var Ut=new Array(At.length),Wt=new Array(At.length),qt=0;It.forEach(function(Yt,tt){!function(At,It,Ct){if(u&&!u.has(At._id))return Ct();var Ut=_.get(At._id);if(Ut)return et(At,It,Ut,Ct);O.get(At._id).onsuccess=function(Wt){Ut=ur(Wt.target.result),_.set(At._id,Ut),et(At,It,Ut,Ct)}}(ln(Yt),At[tt],function(bt,pt){Wt[tt]=bt,Ut[tt]=pt,++qt===At.length&&function(){for(var Yt=[],tt=0,it=Ut.length;tt<it&&k!==M;tt++){var ot=Ut[tt];ot&&Yt.push(Zt(Wt[tt],ot))}Promise.all(Yt).then(function(pt){for(var at=0,_t=pt.length;at<_t;at++)pt[at]&&t.onChange(pt[at])}).catch(t.complete),k!==M&&Ct.continue()}()})})}function Zt(Yt,tt){var it=t.processChange(tt,Yt,t);d=it.seq=Yt.seq;var ot=$(it);return"object"==typeof ot?Promise.reject(ot):ot?(k++,t.return_docs&&A.push(it),t.attachments&&t.include_docs?new Promise(function(bt){Qi(tt,t,q,function(){Jn([it],t.binary).then(function(){bt(it)})})}):Promise.resolve(it)):Promise.resolve()}})}(j,t,i,o)},t._close=function(O){o.close(),xr.delete(i),O()},t._getRevisionTree=function(O,j){var V=Re(o,[de],"readonly");if(V.error)return j(V.error);V.txn.objectStore(de).get(O).onsuccess=function(Y){var ut=ur(Y.target.result);ut?j(null,ut.rev_tree):j(jt(ee))}},t._doCompaction=function(O,j,V){var rt=Re(o,[de,ce,Ie,or],"readwrite");if(rt.error)return V(rt.error);var Y=rt.txn;Y.objectStore(de).get(O).onsuccess=function(vt){var xt=ur(vt.target.result);nr(xt.rev_tree,function(It,Ct,Ut,Wt,Zt){-1!==j.indexOf(Ct+"-"+Ut)&&(Zt.status="missing")}),zi(j,O,Y);var yt=xt.winningRev,At=xt.deleted;Y.objectStore(de).put(Yn(xt,yt,At))},Y.onabort=Ge(V),Y.oncomplete=function(){V()}},t._getLocal=function(O,j){var V=Re(o,[je],"readonly");if(V.error)return j(V.error);var rt=V.txn.objectStore(je).get(O);rt.onerror=Ge(j),rt.onsuccess=function(Y){var ut=Y.target.result;ut?(delete ut._doc_id_rev,j(null,ut)):j(jt(ee))}},t._putLocal=function(O,j,V){"function"==typeof j&&(V=j,j={}),delete O._revisions;var et=O._rev,rt=O._id;O._rev=et?"0-"+(parseInt(et.split("-")[1],10)+1):"0-1";var ut,Y=j.ctx;if(!Y){var vt=Re(o,[je],"readwrite");if(vt.error)return V(vt.error);(Y=vt.txn).onerror=Ge(V),Y.oncomplete=function(){ut&&V(null,ut)}}var yt,xt=Y.objectStore(je);et?(yt=xt.get(rt)).onsuccess=function(At){var It=At.target.result;It&&It._rev===et?xt.put(O).onsuccess=function(){ut={ok:!0,id:O._id,rev:O._rev},j.ctx&&V(null,ut)}:V(jt(pr))}:((yt=xt.add(O)).onerror=function(At){V(jt(pr)),At.preventDefault(),At.stopPropagation()},yt.onsuccess=function(){ut={ok:!0,id:O._id,rev:O._rev},j.ctx&&V(null,ut)})},t._removeLocal=function(O,j,V){"function"==typeof j&&(V=j,j={});var et=j.ctx;if(!et){var rt=Re(o,[je],"readwrite");if(rt.error)return V(rt.error);(et=rt.txn).oncomplete=function(){Y&&V(null,Y)}}var Y,ut=O._id,vt=et.objectStore(je),xt=vt.get(ut);xt.onerror=Ge(V),xt.onsuccess=function(yt){var At=yt.target.result;At&&At._rev===O._rev?(vt.delete(ut),Y={ok:!0,id:ut,rev:"0-0"},j.ctx&&V(null,Y)):V(jt(ee))}},t._destroy=function(O,j){Zr.removeAllListeners(i);var V=Xn.get(i);V&&V.result&&(V.result.close(),xr.delete(i));var et=indexedDB.deleteDatabase(i);et.onsuccess=function(){Xn.delete(i),Sn()&&i in localStorage&&delete localStorage[i],j(null,{ok:!0})},et.onerror=Ge(j)};var q=xr.get(i);if(q)return o=q.idb,t._meta=q.global,Le()(function(){e(null,t)});var Q=indexedDB.open(i,5);Xn.set(i,Q),Q.onupgradeneeded=function(O){var j=O.target.result;if(O.oldVersion<1)return function(O){var j=O.createObjectStore(de,{keyPath:"id"});O.createObjectStore(ce,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),O.createObjectStore(Ie,{keyPath:"digest"}),O.createObjectStore(Ce,{keyPath:"id",autoIncrement:!1}),O.createObjectStore(zn),j.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),O.createObjectStore(je,{keyPath:"_id"});var V=O.createObjectStore(or,{autoIncrement:!0});V.createIndex("seq","seq"),V.createIndex("digestSeq","digestSeq",{unique:!0})}(j);var V=O.currentTarget.transaction;O.oldVersion<3&&function(O){O.createObjectStore(je,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}(j),O.oldVersion<4&&function(O){var j=O.createObjectStore(or,{autoIncrement:!0});j.createIndex("seq","seq"),j.createIndex("digestSeq","digestSeq",{unique:!0})}(j);var et=[d,A,$,_],rt=O.oldVersion;!function Y(){var ut=et[rt-1];rt++,ut&&ut(V,Y)}()},Q.onsuccess=function(O){(o=O.target.result).onversionchange=function(){o.close(),xr.delete(i)},o.onabort=function(yt){be("error","Database has a global failure",yt.target.error),o.close(),xr.delete(i)};var et,rt,Y,ut,j=o.transaction([Ce,zn,de],"readwrite"),V=!1;function vt(){void 0===Y||!V||(t._meta={name:i,instanceId:ut,blobSupport:Y},xr.set(i,{idb:o,global:t._meta}),e(null,t))}function xt(){if(void 0!==rt&&void 0!==et){var yt=i+"_id";yt in et?ut=et[yt]:et[yt]=ut=an(),et.docCount=rt,j.objectStore(Ce).put(et)}}j.objectStore(Ce).get(Ce).onsuccess=function(yt){et=yt.target.result||{id:Ce},xt()},function(t,n){t.objectStore(de).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(i){rt=i.target.result,xt()}}(j),Kn||(Kn=function(t){return new Promise(function(n){var e=ye([""]),i=t.objectStore(zn).put(e,"key");i.onsuccess=function(){var o=navigator.userAgent.match(/Chrome\/(\d+)/),u=navigator.userAgent.match(/Edge\//);n(u||!o||parseInt(o[1],10)>=43)},i.onerror=t.onabort=function(o){o.preventDefault(),o.stopPropagation(),n(!1)}}).catch(function(){return!1})}(j)),Kn.then(function(yt){Y=yt,vt()}),j.oncomplete=function(){V=!0,vt()},j.onabort=Ge(e)},Q.onerror=function(O){var j=O.target.error&&O.target.error.message;j?-1!==j.indexOf("stored database is a higher version")&&(j=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):j="Failed to open indexedDB, are you in private browsing mode?",be("error",j),e(jt(On,j))}}(e,t,i)},n,e.constructor)}$i.valid=function(){try{return"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}};var Vn={};function ti(t){var n=t.doc||t.ok,e=n&&n._attachments;!e||Object.keys(e).forEach(function(i){var o=e[i];o.data=er(o.data,o.content_type)})}function cr(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function Hi(t){return t._attachments&&Object.keys(t._attachments)?Promise.all(Object.keys(t._attachments).map(function(n){var e=t._attachments[n];if(e.data&&"string"!=typeof e.data)return new Promise(function(i){rn(e.data,i)}).then(function(i){e.data=i})})):Promise.resolve()}function me(t,n){return vn(t,t.db+"/"+n)}function vn(t,n){return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+(t.path?"/":"")+n}function mn(t){return"?"+Object.keys(t).map(function(n){return n+"="+encodeURIComponent(t[n])}).join("&")}function ei(t,n){var e=this,i=function(t,n){if(function(t){if(!t.prefix)return!1;var n=Mi(t.prefix).protocol;return"http"===n||"https"===n}(n)){var e=n.name.substr(n.prefix.length);t=n.prefix.replace(/\/?$/,"/")+encodeURIComponent(e)}var o=Mi(t);(o.user||o.password)&&(o.auth={username:o.user,password:o.password});var u=o.path.replace(/(^\/|\/$)/g,"").split("/");return o.db=u.pop(),-1===o.db.indexOf("%")&&(o.db=encodeURIComponent(o.db)),o.path=u.join("/"),o}(t.name,t),o=me(i,"");t=Mt(t);var A,u=function(_,q){if((q=q||{}).headers=q.headers||new Mr,q.credentials="include",t.auth||i.auth){var Q=t.auth||i.auth,j=Fe(unescape(encodeURIComponent(Q.username+":"+Q.password)));q.headers.set("Authorization","Basic "+j)}var V=t.headers||{};return Object.keys(V).forEach(function(rt){q.headers.append(rt,V[rt])}),function(t){var n="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",e=-1!==n.indexOf("msie"),i=-1!==n.indexOf("trident"),o=-1!==n.indexOf("edge");return(e||i||o)&&(!("method"in t)||"GET"===t.method)}(q)&&(_+=(-1===_.indexOf("?")?"?":"&")+"_nonce="+Date.now()),(t.fetch||Ni)(_,q)};function d(_,q){return le(_,Ae()(function(Q){k().then(function(){return q.apply(this,Q)}).catch(function(O){Q.pop()(O)})})).bind(e)}function M(_,q,Q){var O={};return(q=q||{}).headers=q.headers||new Mr,q.headers.get("Content-Type")||q.headers.set("Content-Type","application/json"),q.headers.get("Accept")||q.headers.set("Accept","application/json"),u(_,q).then(function(j){return O.ok=j.ok,O.status=j.status,j.json()}).then(function(j){if(O.data=j,!O.ok){O.data.status=O.status;var V=_r(O.data);if(Q)return Q(V);throw V}if(Array.isArray(O.data)&&(O.data=O.data.map(function(et){return et.error||et.missing?_r(et):et})),!Q)return O;Q(null,O.data)})}function k(){return t.skip_setup?Promise.resolve():A||((A=M(o).catch(function(_){return _&&_.status&&404===_.status?(xn(404,"PouchDB is just detecting if the remote exists."),M(o,{method:"PUT"})):Promise.reject(_)}).catch(function(_){return!(!_||!_.status||412!==_.status)||Promise.reject(_)})).catch(function(){A=null}),A)}function $(_){return _.split("/").map(encodeURIComponent).join("/")}Le()(function(){n(null,e)}),e._remote=!0,e.type=function(){return"http"},e.id=d("id",function(_){u(vn(i,"")).then(function(q){return q.json()}).catch(function(){return{}}).then(function(q){var Q=q&&q.uuid?q.uuid+i.db:me(i,"");_(null,Q)})}),e.compact=d("compact",function(_,q){"function"==typeof _&&(q=_,_={}),_=Mt(_),M(me(i,"_compact"),{method:"POST"}).then(function(){!function Q(){e.info(function(O,j){j&&!j.compact_running?q(null,{ok:!0}):setTimeout(Q,_.interval||200)})}()})}),e.bulkGet=le("bulkGet",function(_,q){var Q=this;function O(rt){var Y={};_.revs&&(Y.revs=!0),_.attachments&&(Y.attachments=!0),_.latest&&(Y.latest=!0),M(me(i,"_bulk_get"+mn(Y)),{method:"POST",body:JSON.stringify({docs:_.docs})}).then(function(ut){_.attachments&&_.binary&&ut.data.results.forEach(function(vt){vt.docs.forEach(ti)}),rt(null,ut.data)}).catch(rt)}function j(){var Y=Math.ceil(_.docs.length/50),ut=0,vt=new Array(Y);function xt(It){return function(Ct,Ut){vt[It]=Ut.results,++ut===Y&&q(null,{results:Ir(vt)})}}for(var yt=0;yt<Y;yt++){var At=Pr(_,["revs","attachments","binary","latest"]);At.docs=_.docs.slice(50*yt,Math.min(_.docs.length,50*(yt+1))),wn(Q,At,xt(yt))}}var V=vn(i,""),et=Vn[V];"boolean"!=typeof et?O(function(rt,Y){rt?(Vn[V]=!1,xn(rt.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),j()):(Vn[V]=!0,q(null,Y))}):et?O(q):j()}),e._info=function(_){k().then(function(){return u(me(i,""))}).then(function(q){return q.json()}).then(function(q){q.host=me(i,""),_(null,q)}).catch(_)},e.fetch=function(_,q){return k().then(function(){var Q="/"===_.substring(0,1)?vn(i,_.substring(1)):me(i,_);return u(Q,q)})},e.get=d("get",function(_,q,Q){"function"==typeof q&&(Q=q,q={});var O={};function j(rt){var Y=rt._attachments,ut=Y&&Object.keys(Y);if(Y&&ut.length)return function(t,n){return new Promise(function(e,i){var A,o=0,u=0,d=0,M=t.length;function $(){++d===M?A?i(A):e():Q()}function _(){o--,$()}function q(O){o--,A=A||O,$()}function Q(){for(;o<5&&u<M;)o++,t[u++]().then(_,q)}Q()})}(ut.map(function(yt){return function(){return function(yt){var At=Y[yt],It=cr(rt._id)+"/"+$(yt)+"?rev="+rt._rev;return u(me(i,It)).then(function(Ct){return"buffer"in Ct?Ct.buffer():Ct.blob()}).then(function(Ct){if(q.binary){var Ut=Object.getOwnPropertyDescriptor(Ct.__proto__,"type");return(!Ut||Ut.set)&&(Ct.type=At.content_type),Ct}return new Promise(function(Wt){rn(Ct,Wt)})}).then(function(Ct){delete At.stub,delete At.length,At.data=Ct})}(yt)}}))}(q=Mt(q)).revs&&(O.revs=!0),q.revs_info&&(O.revs_info=!0),q.latest&&(O.latest=!0),q.open_revs&&("all"!==q.open_revs&&(q.open_revs=JSON.stringify(q.open_revs)),O.open_revs=q.open_revs),q.rev&&(O.rev=q.rev),q.conflicts&&(O.conflicts=q.conflicts),q.update_seq&&(O.update_seq=q.update_seq),_=cr(_),M(me(i,_+mn(O))).then(function(rt){return Promise.resolve().then(function(){if(q.attachments)return function(rt){return Array.isArray(rt)?Promise.all(rt.map(function(Y){if(Y.ok)return j(Y.ok)})):j(rt)}(rt.data)}).then(function(){Q(null,rt.data)})}).catch(function(rt){rt.docId=_,Q(rt)})}),e.remove=d("remove",function(_,q,Q,O){var j;"string"==typeof q?(j={_id:_,_rev:q},"function"==typeof Q&&(O=Q,Q={})):(j=_,"function"==typeof q?(O=q,Q={}):(O=Q,Q=q));var V=j._rev||Q.rev;M(me(i,cr(j._id))+"?rev="+V,{method:"DELETE"},O).catch(O)}),e.getAttachment=d("getAttachment",function(_,q,Q,O){"function"==typeof Q&&(O=Q,Q={});var et,j=Q.rev?"?rev="+Q.rev:"",V=me(i,cr(_))+"/"+$(q)+j;u(V,{method:"GET"}).then(function(rt){if(et=rt.headers.get("content-type"),rt.ok)return"undefined"==typeof process||process.browser||"function"!=typeof rt.buffer?rt.blob():rt.buffer();throw rt}).then(function(rt){"undefined"!=typeof process&&!process.browser&&(rt.type=et),O(null,rt)}).catch(function(rt){O(rt)})}),e.removeAttachment=d("removeAttachment",function(_,q,Q,O){M(me(i,cr(_)+"/"+$(q))+"?rev="+Q,{method:"DELETE"},O).catch(O)}),e.putAttachment=d("putAttachment",function(_,q,Q,O,j,V){"function"==typeof j&&(V=j,j=O,O=Q,Q=null);var et=cr(_)+"/"+$(q),rt=me(i,et);if(Q&&(rt+="?rev="+Q),"string"==typeof O){var Y;try{Y=en(O)}catch(ut){return V(jt(Ve,"Attachment is not a valid base64 string"))}O=Y?tr(Y,j):""}M(rt,{headers:new Mr({"Content-Type":j}),method:"PUT",body:O},V).catch(V)}),e._bulkDocs=function(_,q,Q){_.new_edits=q.new_edits,k().then(function(){return Promise.all(_.docs.map(Hi))}).then(function(){return M(me(i,"_bulk_docs"),{method:"POST",body:JSON.stringify(_)},Q)}).catch(Q)},e._put=function(_,q,Q){k().then(function(){return Hi(_)}).then(function(){return M(me(i,cr(_._id)),{method:"PUT",body:JSON.stringify(_)})}).then(function(O){Q(null,O.data)}).catch(function(O){O.docId=_&&_._id,Q(O)})},e.allDocs=d("allDocs",function(_,q){"function"==typeof _&&(q=_,_={});var O,Q={},j="GET";(_=Mt(_)).conflicts&&(Q.conflicts=!0),_.update_seq&&(Q.update_seq=!0),_.descending&&(Q.descending=!0),_.include_docs&&(Q.include_docs=!0),_.attachments&&(Q.attachments=!0),_.key&&(Q.key=JSON.stringify(_.key)),_.start_key&&(_.startkey=_.start_key),_.startkey&&(Q.startkey=JSON.stringify(_.startkey)),_.end_key&&(_.endkey=_.end_key),_.endkey&&(Q.endkey=JSON.stringify(_.endkey)),void 0!==_.inclusive_end&&(Q.inclusive_end=!!_.inclusive_end),void 0!==_.limit&&(Q.limit=_.limit),void 0!==_.skip&&(Q.skip=_.skip);var V=mn(Q);void 0!==_.keys&&(j="POST",O={keys:_.keys}),M(me(i,"_all_docs"+V),{method:j,body:JSON.stringify(O)}).then(function(et){_.include_docs&&_.attachments&&_.binary&&et.data.rows.forEach(ti),q(null,et.data)}).catch(q)}),e._changes=function(_){var q="batch_size"in _?_.batch_size:25;(_=Mt(_)).continuous&&!("heartbeat"in _)&&(_.heartbeat=1e4);var Q="timeout"in _?_.timeout:3e4;"timeout"in _&&_.timeout&&Q-_.timeout<5e3&&(Q=_.timeout+5e3),"heartbeat"in _&&_.heartbeat&&Q-_.heartbeat<5e3&&(Q=_.heartbeat+5e3);var O={};"timeout"in _&&_.timeout&&(O.timeout=_.timeout);var j=void 0!==_.limit&&_.limit,V=j;if(_.style&&(O.style=_.style),(_.include_docs||_.filter&&"function"==typeof _.filter)&&(O.include_docs=!0),_.attachments&&(O.attachments=!0),_.continuous&&(O.feed="longpoll"),_.seq_interval&&(O.seq_interval=_.seq_interval),_.conflicts&&(O.conflicts=!0),_.descending&&(O.descending=!0),_.update_seq&&(O.update_seq=!0),"heartbeat"in _&&_.heartbeat&&(O.heartbeat=_.heartbeat),_.filter&&"string"==typeof _.filter&&(O.filter=_.filter),_.view&&"string"==typeof _.view&&(O.filter="_view",O.view=_.view),_.query_params&&"object"==typeof _.query_params)for(var et in _.query_params)_.query_params.hasOwnProperty(et)&&(O[et]=_.query_params[et]);var Y,rt="GET";_.doc_ids?(O.filter="_doc_ids",rt="POST",Y={doc_ids:_.doc_ids}):_.selector&&(O.filter="_selector",rt="POST",Y={selector:_.selector});var vt,ut=new cn,xt=function(It,Ct){if(!_.aborted){O.since=It,"object"==typeof O.since&&(O.since=JSON.stringify(O.since)),_.descending?j&&(O.limit=V):O.limit=!j||V>q?q:V;var Ut=me(i,"_changes"+mn(O)),Wt={signal:ut.signal,method:rt,body:JSON.stringify(Y)};vt=It,!_.aborted&&k().then(function(){return M(Ut,Wt,Ct)}).catch(Ct)}},yt={results:[]},At=function(It,Ct){if(!_.aborted){var Ut=0;if(Ct&&Ct.results){Ut=Ct.results.length,yt.last_seq=Ct.last_seq;var Wt=null,Zt=null;"number"==typeof Ct.pending&&(Wt=Ct.pending),("string"==typeof yt.last_seq||"number"==typeof yt.last_seq)&&(Zt=yt.last_seq),Ct.results=Ct.results.filter(function(Yt){V--;var tt=En(_)(Yt);return tt&&(_.include_docs&&_.attachments&&_.binary&&ti(Yt),_.return_docs&&yt.results.push(Yt),_.onChange(Yt,Wt,Zt)),tt})}else if(It)return _.aborted=!0,void _.complete(It);Ct&&Ct.last_seq&&(vt=Ct.last_seq),(!_.continuous||j&&V<=0)&&(j&&V<=0||Ct&&Ut<q||_.descending)?_.complete(null,yt):Le()(function(){xt(vt,At)})}};return xt(_.since||0,At),{cancel:function(){_.aborted=!0,ut.abort()}}},e.revsDiff=d("revsDiff",function(_,q,Q){"function"==typeof q&&(Q=q,q={}),M(me(i,"_revs_diff"),{method:"POST",body:JSON.stringify(_)},Q).catch(Q)}),e._close=function(_){_()},e._destroy=function(_,q){M(me(i,""),{method:"DELETE"}).then(function(Q){q(null,Q)}).catch(function(Q){404===Q.status?q(null,{ok:!0}):q(Q)})}}function fr(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,fr)}catch(n){}}function gn(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,gn)}catch(n){}}function pn(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,pn)}catch(n){}}function Ki(t,n){return n&&t.then(function(e){Le()(function(){n(null,e)})},function(e){Le()(function(){n(e)})}),t}function ri(t,n){return function(){var e=arguments,i=this;return t.add(function(){return n.apply(i,e)})}}function Xi(t){var n=new mr(t),e=new Array(n.size),i=-1;return n.forEach(function(o){e[++i]=o}),e}function ni(t){var n=new Array(t.size),e=-1;return t.forEach(function(i,o){n[++e]=o}),n}function Vi(t){return new pn("builtin "+t+" function requires map values to be numbers or number arrays")}function ii(t){for(var n=0,e=0,i=t.length;e<i;e++){var o=t[e];if("number"!=typeof o){if(!Array.isArray(o))throw Vi("_sum");n="number"==typeof n?[n]:n;for(var u=0,d=o.length;u<d;u++){var M=o[u];if("number"!=typeof M)throw Vi("_sum");void 0===n[u]?n.push(M):n[u]+=M}}else"number"==typeof n?n+=o:n[0]+=o}return n}ei.valid=function(){return!0},Te()(fr,Error),Te()(gn,Error),Te()(pn,Error);var lo=be.bind(null,"log"),vo=Array.isArray,mo=JSON.parse;function ta(t,n){return Se("return ("+t.replace(/;\s*$/,"")+");",{emit:n,sum:ii,log:lo,isArray:vo,toJSON:mo})}function Wr(){this.promise=new Promise(function(t){t()})}function fe(t){if(!t)return"undefined";switch(typeof t){case"function":case"string":return t.toString();default:return JSON.stringify(t)}}function ea(t,n,e,i,o,u){var M,d=function(t,n){return fe(t)+fe(n)+"undefined"}(e,i);if(!o&&(M=t._cachedViews=t._cachedViews||{})[d])return M[d];var A=t.info().then(function(k){var $=k.db_name+"-mrview-"+(o?"temp":xi(d));return qr(t,"_local/"+u,function(q){q.views=q.views||{};var Q=n;-1===Q.indexOf("/")&&(Q=n+"/"+n);var O=q.views[Q]=q.views[Q]||{};if(!O[$])return O[$]=!0,q}).then(function(){return t.registerDependentDatabase($).then(function(q){var Q=q.db;Q.auto_compaction=!0;var O={name:$,db:Q,sourceDB:t,adapter:t.adapter,mapFun:e,reduceFun:i};return O.db.get("_local/lastSeq").catch(function(j){if(404!==j.status)throw j}).then(function(j){return O.seq=j?j.seq:0,M&&O.db.once("destroyed",function(){delete M[d]}),O})})})});return M&&(M[d]=A),A}Wr.prototype.add=function(t){return this.promise=this.promise.catch(function(){}).then(function(){return t()}),this.promise},Wr.prototype.finish=function(){return this.promise};var ra={},na=new Wr;function Ke(t){return-1===t.indexOf("/")?[t,t]:t.split("/")}function ia(t,n){try{t.emit("error",n)}catch(e){be("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),be("error",n)}}var hr__sum=function(t,n){return ii(n)},hr__count=function(t,n){return n.length},hr__stats=function(t,n){return{sum:ii(n),min:Math.min.apply(null,n),max:Math.max.apply(null,n),count:n.length,sumsqr:function(i){for(var o=0,u=0,d=i.length;u<d;u++){var M=i[u];o+=M*M}return o}(n)}},zr=function(t,n,e,i){function o(tt,it,ot){try{it(ot)}catch(bt){ia(tt,bt)}}function u(tt,it,ot,bt,pt){try{return{output:it(ot,bt,pt)}}catch(at){return ia(tt,at),{error:at}}}function d(tt,it){var ot=pe(tt.key,it.key);return 0!==ot?ot:pe(tt.value,it.value)}function M(tt,it,ot){return ot=ot||0,"number"==typeof it?tt.slice(ot,it+ot):ot>0?tt.slice(ot):tt}function A(tt){var it=tt.value;return it&&"object"==typeof it&&it._id||tt.id}function $(tt){return function(it){return tt.include_docs&&tt.attachments&&tt.binary&&function(tt){tt.rows.forEach(function(it){var ot=it.doc&&it.doc._attachments;!ot||Object.keys(ot).forEach(function(bt){var pt=ot[bt];ot[bt].data=er(pt.data,pt.content_type)})})}(it),it}}function _(tt,it,ot,bt){var pt=it[tt];void 0!==pt&&(bt&&(pt=encodeURIComponent(JSON.stringify(pt))),ot.push(tt+"="+pt))}function q(tt){if(void 0!==tt){var it=Number(tt);return isNaN(it)||it!==parseInt(tt,10)?tt:it}}function j(tt,it){var ot=tt.descending?"endkey":"startkey",bt=tt.descending?"startkey":"endkey";if(void 0!==tt[ot]&&void 0!==tt[bt]&&pe(tt[ot],tt[bt])>0)throw new fr("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(it.reduce&&!1!==tt.reduce){if(tt.include_docs)throw new fr("{include_docs:true} is invalid for reduce");if(tt.keys&&tt.keys.length>1&&!tt.group&&!tt.group_level)throw new fr("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(pt){var at=function(tt){if(tt){if("number"!=typeof tt)return new fr('Invalid value for integer: "'+tt+'"');if(tt<0)return new fr('Invalid value for positive integer: "'+tt+'"')}}(tt[pt]);if(at)throw at})}function Y(tt){return function(it){if(404===it.status)return tt;throw it}}function xt(tt){var it="string"==typeof tt?tt:tt.name,ot=ra[it];return ot||(ot=ra[it]=new Wr),ot}function yt(tt){return ri(xt(tt),function(){return function(tt){var it,ot;var pt=function(t,n){if("function"==typeof t&&2===t.length){var e=t;return function(i){return e(i,n)}}return ta(t.toString(),n)}(tt.mapFun,function(Nt,zt){var ue={id:ot._id,key:ir(Nt)};null!=zt&&(ue.value=ir(zt)),it.push(ue)}),at=tt.seq||0;function _t(Nt,zt){return function(){return function(tt,it,ot){var bt="_local/lastSeq";return tt.db.get(bt).catch(Y({_id:bt,seq:0})).then(function(pt){var at=ni(it);return Promise.all(at.map(function(_t){return function(tt,it,ot){var bt="_local/doc_"+tt,pt={_id:bt,keys:[]},at=ot.get(tt),_t=at[0];return(function(t){return 1===t.length&&/^1-/.test(t[0].rev)}(at[1])?Promise.resolve(pt):it.db.get(bt).catch(Y(pt))).then(function(wt){return function(wt){return wt.keys.length?it.db.allDocs({keys:wt.keys,include_docs:!0}):Promise.resolve({rows:[]})}(wt).then(function(Nt){return function(wt,Nt){for(var zt=[],ue=new mr,re=0,Vt=Nt.rows.length;re<Vt;re++){var ve=Nt.rows[re].doc;if(ve&&(zt.push(ve),ue.add(ve._id),ve._deleted=!_t.has(ve._id),!ve._deleted)){var We=_t.get(ve._id);"value"in We&&(ve.value=We.value)}}var ke=ni(_t);return ke.forEach(function(ui){if(!ue.has(ui)){var ci={_id:ui},Ho=_t.get(ui);"value"in Ho&&(ci.value=Ho.value),zt.push(ci)}}),wt.keys=Xi(ke.concat(wt.keys)),zt.push(wt),zt}(wt,Nt)})})}(_t,tt,it)})).then(function(_t){var Tt=Ir(_t);return pt.seq=ot,Tt.push(pt),tt.db.bulkDocs({docs:Tt})})})}(tt,Nt,zt)}}var Tt=new Wr;function Et(){return tt.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:at,limit:50}).then(kt)}function kt(Nt){var zt=Nt.results;if(zt.length){var ue=function(Nt){for(var zt=new Oe,ue=0,re=Nt.length;ue<re;ue++){var Vt=Nt[ue];if("_"!==Vt.doc._id[0]){it=[],(ot=Vt.doc)._deleted||o(tt.sourceDB,pt,ot),it.sort(d);var ne=wt(it);zt.set(Vt.doc._id,[ne,Vt.changes])}at=Vt.seq}return zt}(zt);if(Tt.add(_t(ue,at)),!(zt.length<50))return Et()}}function wt(Nt){for(var ue,zt=new Oe,re=0,Vt=Nt.length;re<Vt;re++){var ne=Nt[re],ve=[ne.key,ne.id];re>0&&0===pe(ne.key,ue)&&ve.push(re),zt.set(Me(ve),ne),ue=ne.key}return zt}return Et().then(function(){return Tt.finish()}).then(function(){tt.seq=at})}(tt)})()}function Ct(tt,it){return ri(xt(tt),function(){return function(tt,it){var ot,bt=tt.reduceFun&&!1!==it.reduce,pt=it.skip||0;function at(re){return re.include_docs=!0,tt.db.allDocs(re).then(function(Vt){return ot=Vt.total_rows,Vt.rows.map(function(ne){if("value"in ne.doc&&"object"==typeof ne.doc.value&&null!==ne.doc.value){var ve=Object.keys(ne.doc.value).sort(),We=["id","key","value"];if(!(ve<We||ve>We))return ne.doc.value}var ke=function(t){for(var n=[],e=[],i=0;;){var o=t[i++];if("\0"!==o)switch(o){case"1":n.push(null);break;case"2":n.push("1"===t[i]),i++;break;case"3":var u=ds(t,i);n.push(u.num),i+=u.length;break;case"4":for(var d="";;){var M=t[i];if("\0"===M)break;d+=M,i++}d=d.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02"),n.push(d);break;case"5":var A={element:[],index:n.length};n.push(A.element),e.push(A);break;case"6":var k={element:{},index:n.length};n.push(k.element),e.push(k);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+o)}else{if(1===n.length)return n.pop();vs(n,e)}}}(ne.doc._id);return{key:ke[0],id:ke[1],value:"value"in ne.doc?ne.doc.value:null}})})}function _t(re){var Vt;if(Vt=bt?function(tt,it,ot){0===ot.group_level&&delete ot.group_level;var bt=ot.group||ot.group_level,pt=function(t){var n=t.toString();return function(t){if(/^_sum/.test(t))return hr__sum;if(/^_count/.test(t))return hr__count;if(/^_stats/.test(t))return hr__stats;if(/^_/.test(t))throw new Error(t+" is not a supported reduce function.")}(n)||ta(n)}(tt.reduceFun),at=[],_t=isNaN(ot.group_level)?Number.POSITIVE_INFINITY:ot.group_level;it.forEach(function(wt){var Nt=at[at.length-1],zt=bt?wt.key:null;if(bt&&Array.isArray(zt)&&(zt=zt.slice(0,_t)),Nt&&0===pe(Nt.groupKey,zt))return Nt.keys.push([wt.key,wt.id]),void Nt.values.push(wt.value);at.push({keys:[[wt.key,wt.id]],values:[wt.value],groupKey:zt})}),it=[];for(var Tt=0,Et=at.length;Tt<Et;Tt++){var kt=at[Tt],Dt=u(tt.sourceDB,pt,kt.keys,kt.values,!1);if(Dt.error&&Dt.error instanceof pn)throw Dt.error;it.push({value:Dt.error?null:Dt.output,key:kt.groupKey})}return{rows:M(it,ot.limit,ot.skip)}}(tt,re,it):{total_rows:ot,offset:pt,rows:re},it.update_seq&&(Vt.update_seq=tt.seq),it.include_docs){var ne=Xi(re.map(A));return tt.sourceDB.allDocs({keys:ne,include_docs:!0,conflicts:it.conflicts,attachments:it.attachments,binary:it.binary}).then(function(ve){var We=new Oe;return ve.rows.forEach(function(ke){We.set(ke.id,ke.doc)}),re.forEach(function(ke){var ui=A(ke),ci=We.get(ui);ci&&(ke.doc=ci)}),Vt})}return Vt}if(void 0!==it.keys&&!it.keys.length&&(it.limit=0,delete it.keys),void 0!==it.keys){var Et=it.keys.map(function(re){var Vt={startkey:Me([re]),endkey:Me([re,{}])};return it.update_seq&&(Vt.update_seq=!0),at(Vt)});return Promise.all(Et).then(Ir).then(_t)}var Dt,wt,kt={descending:it.descending};if(it.update_seq&&(kt.update_seq=!0),"start_key"in it&&(Dt=it.start_key),"startkey"in it&&(Dt=it.startkey),"end_key"in it&&(wt=it.end_key),"endkey"in it&&(wt=it.endkey),void 0!==Dt&&(kt.startkey=Me(it.descending?[Dt,{}]:[Dt])),void 0!==wt){var Nt=!1!==it.inclusive_end;it.descending&&(Nt=!Nt),kt.endkey=Me(Nt?[wt,{}]:[wt])}if(void 0!==it.key){var zt=Me([it.key]),ue=Me([it.key,{}]);kt.descending?(kt.endkey=zt,kt.startkey=ue):(kt.startkey=zt,kt.endkey=ue)}return bt||("number"==typeof it.limit&&(kt.limit=it.limit),kt.skip=pt),at(kt).then(_t)}(tt,it)})()}function Bt(tt,it,ot){if("function"==typeof tt._query)return function(tt,it,ot){return new Promise(function(bt,pt){tt._query(it,ot,function(at,_t){if(at)return pt(at);bt(_t)})})}(tt,it,ot);if(qe(tt))return function(tt,it,ot){var pt,_t,Tt,bt=[],at="GET";if(_("reduce",ot,bt),_("include_docs",ot,bt),_("attachments",ot,bt),_("limit",ot,bt),_("descending",ot,bt),_("group",ot,bt),_("group_level",ot,bt),_("skip",ot,bt),_("stale",ot,bt),_("conflicts",ot,bt),_("startkey",ot,bt,!0),_("start_key",ot,bt,!0),_("endkey",ot,bt,!0),_("end_key",ot,bt,!0),_("inclusive_end",ot,bt),_("key",ot,bt,!0),_("update_seq",ot,bt),bt=""===(bt=bt.join("&"))?"":"?"+bt,void 0!==ot.keys){var kt="keys="+encodeURIComponent(JSON.stringify(ot.keys));kt.length+bt.length+1<=2e3?bt+=("?"===bt[0]?"&":"?")+kt:(at="POST","string"==typeof it?pt={keys:ot.keys}:it.keys=ot.keys)}if("string"==typeof it){var Dt=Ke(it);return tt.fetch("_design/"+Dt[0]+"/_view/"+Dt[1]+bt,{headers:new Mr({"Content-Type":"application/json"}),method:at,body:JSON.stringify(pt)}).then(function(wt){return _t=wt.ok,Tt=wt.status,wt.json()}).then(function(wt){if(!_t)throw wt.status=Tt,_r(wt);return wt.rows.forEach(function(Nt){if(Nt.value&&Nt.value.error&&"builtin_reduce_error"===Nt.value.error)throw new Error(Nt.reason)}),wt}).then($(ot))}return pt=pt||{},Object.keys(it).forEach(function(wt){pt[wt]=Array.isArray(it[wt])?it[wt]:it[wt].toString()}),tt.fetch("_temp_view"+bt,{headers:new Mr({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(pt)}).then(function(wt){return _t=wt.ok,Tt=wt.status,wt.json()}).then(function(wt){if(!_t)throw wt.status=Tt,_r(wt);return wt}).then($(ot))}(tt,it,ot);if("string"!=typeof it)return j(ot,it),na.add(function(){return ea(tt,"temp_view/temp_view",it.map,it.reduce,!0,t).then(function(Et){return function(t,n){return t.then(function(e){return n().then(function(){return e})},function(e){return n().then(function(){throw e})})}(yt(Et).then(function(){return Ct(Et,ot)}),function(){return Et.db.destroy()})})}),na.finish();var bt=it,pt=Ke(bt),_t=pt[1];return tt.get("_design/"+pt[0]).then(function(Tt){var Et=Tt.views&&Tt.views[_t];if(!Et)throw new gn("ddoc "+Tt._id+" has no view named "+_t);return function(t,n){var e=t.views&&t.views[n];if("string"!=typeof e.map)throw new gn("ddoc "+t._id+" has no string view named "+n+", instead found object of type: "+typeof e.map)}(Tt,_t),j(ot,Et),ea(tt,bt,Et.map,Et.reduce,!1,t).then(function(Dt){return"ok"===ot.stale||"update_after"===ot.stale?("update_after"===ot.stale&&Le()(function(){yt(Dt)}),Ct(Dt,ot)):yt(Dt).then(function(){return Ct(Dt,ot)})})})}return{query:function(tt,it,ot){var bt=this;"function"==typeof it&&(ot=it,it={}),it=it?function(tt){return tt.group_level=q(tt.group_level),tt.limit=q(tt.limit),tt.skip=q(tt.skip),tt}(it):{},"function"==typeof tt&&(tt={map:tt});var pt=Promise.resolve().then(function(){return Bt(bt,tt,it)});return Ki(pt,ot),pt},viewCleanup:function(t){return Ae()(function(n){var e=n.pop(),i=t.apply(this,n);return"function"==typeof e&&Ki(i,e),i})}(function(){var tt=this;return"function"==typeof tt._viewCleanup?function(tt){return new Promise(function(it,ot){tt._viewCleanup(function(bt,pt){if(bt)return ot(bt);it(pt)})})}(tt):qe(tt)?function(tt){return tt.fetch("_view_cleanup",{headers:new Mr({"Content-Type":"application/json"}),method:"POST"}).then(function(it){return it.json()})}(tt):function(tt){return tt.get("_local/"+t).then(function(it){var ot=new Oe;Object.keys(it.views).forEach(function(pt){var at=Ke(pt),_t="_design/"+at[0],Tt=at[1],Et=ot.get(_t);Et||(Et=new mr,ot.set(_t,Et)),Et.add(Tt)});var bt={keys:ni(ot),include_docs:!0};return tt.allDocs(bt).then(function(pt){var at={};pt.rows.forEach(function(Et){var kt=Et.key.substring(8);ot.get(Et.key).forEach(function(Dt){var wt=kt+"/"+Dt;it.views[wt]||(wt=Dt);var Nt=Object.keys(it.views[wt]),zt=Et.doc&&Et.doc.views&&Et.doc.views[Dt];Nt.forEach(function(ue){at[ue]=at[ue]||zt})})});var Tt=Object.keys(at).filter(function(Et){return!at[Et]}).map(function(Et){return ri(xt(Et),function(){return new tt.constructor(Et,tt.__opts).destroy()})()});return Promise.all(Tt).then(function(){return{ok:!0}})})},Y({ok:!0}))}(tt)})}}("mrviews"),Mo={query:function(t,n,e){return zr.query.call(this,t,n,e)},viewCleanup:function(t){return zr.viewCleanup.call(this,t)}};function ua(t){return/^1-/.test(t)}function ca(t,n){var e=Object.keys(n._attachments);return Promise.all(e.map(function(i){return t.getAttachment(n._id,i,{rev:n._rev})}))}function xo(t,n,e,i){e=Mt(e);var o=[],u=!0;return Promise.resolve().then(function(){var q=Object.keys(e).filter(function(Q){var O=e[Q].missing;return 1===O.length&&ua(O[0])});if(q.length>0)return function(q){return t.allDocs({keys:q,include_docs:!0,conflicts:!0}).then(function(Q){if(i.cancelled)throw new Error("cancelled");Q.rows.forEach(function(O){O.deleted||!O.doc||!ua(O.value.rev)||function(q){return q._attachments&&Object.keys(q._attachments).length>0}(O.doc)||function(q){return q._conflicts&&q._conflicts.length>0}(O.doc)||(O.doc._conflicts&&delete O.doc._conflicts,o.push(O.doc),delete e[O.id])})})}(q)}).then(function(){var q=function(t){var n=[];return Object.keys(t).forEach(function(e){t[e].missing.forEach(function(o){n.push({id:e,rev:o})})}),{docs:n,revs:!0,latest:!0}}(e);if(q.docs.length)return t.bulkGet(q).then(function(Q){if(i.cancelled)throw new Error("cancelled");return Promise.all(Q.results.map(function(O){return Promise.all(O.docs.map(function(j){var V=j.ok;return j.error&&(u=!1),V&&V._attachments?function(t,n,e){var i=qe(n)&&!qe(t),o=Object.keys(e._attachments);return i?t.get(e._id).then(function(u){return Promise.all(o.map(function(d){return function(t,n,e){return!t._attachments||!t._attachments[e]||t._attachments[e].digest!==n._attachments[e].digest}(u,e,d)?n.getAttachment(e._id,d):t.getAttachment(u._id,d)}))}).catch(function(u){if(404!==u.status)throw u;return ca(n,e)}):ca(n,e)}(n,t,V).then(function(et){var rt=Object.keys(V._attachments);return et.forEach(function(Y,ut){var vt=V._attachments[rt[ut]];delete vt.stub,delete vt.length,vt.data=Y}),V}):V}))})).then(function(O){o=o.concat(Ir(O).filter(Boolean))})})}).then(function(){return{ok:u,docs:o}})}var ha="pouchdb";function lr(t,n,e,i,o){return t.get(n).catch(function(u){if(404===u.status)return("http"===t.adapter||"https"===t.adapter)&&xn(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:i,_id:n,history:[],replicator:ha,version:1};throw u}).then(function(u){if(!o.cancelled&&u.last_seq!==e)return u.history=(u.history||[]).filter(function(d){return d.session_id!==i}),u.history.unshift({last_seq:e,session_id:i}),u.history=u.history.slice(0,5),u.version=1,u.replicator=ha,u.session_id=i,u.last_seq=e,t.put(u).catch(function(d){if(409===d.status)return lr(t,n,e,i,o);throw d})})}function Yr(t,n,e,i,o){this.src=t,this.target=n,this.id=e,this.returnValue=i,this.opts=o||{}}Yr.prototype.writeCheckpoint=function(t,n){var e=this;return this.updateTarget(t,n).then(function(){return e.updateSource(t,n)})},Yr.prototype.updateTarget=function(t,n){return this.opts.writeTargetCheckpoint?lr(this.target,this.id,t,n,this.returnValue):Promise.resolve(!0)},Yr.prototype.updateSource=function(t,n){if(this.opts.writeSourceCheckpoint){var e=this;return lr(this.src,this.id,t,n,this.returnValue).catch(function(i){if(va(i))return e.opts.writeSourceCheckpoint=!1,!0;throw i})}return Promise.resolve(!0)};var la={undefined:function(t,n){return 0===pe(t.last_seq,n.last_seq)?n.last_seq:0},1:function(t,n){return function(t,n){return t.session_id===n.session_id?{last_seq:t.last_seq,history:t.history}:da(t.history,n.history)}(n,t).last_seq}};function da(t,n){var e=t[0],i=t.slice(1),o=n[0],u=n.slice(1);return e&&0!==n.length?si(e.session_id,n)?{last_seq:e.last_seq,history:t}:si(o.session_id,i)?{last_seq:o.last_seq,history:u}:da(i,u):{last_seq:0,history:[]}}function si(t,n){var e=n[0],i=n.slice(1);return!(!t||0===n.length)&&(t===e.session_id||si(t,i))}function va(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function h(t,n,e,i,o){var d,Y,u=[],M={seq:0,changes:[],docs:[]},A=!1,k=!1,$=!1,_=0,q=e.continuous||e.live||!1,Q=e.batch_size||100,O=e.batches_limit||10,j=!1,V=e.doc_ids,et=e.selector,ut=[],vt=an();o=o||{ok:!0,start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var xt={};function yt(){return Y?Promise.resolve():function(t,n,e){var i=e.doc_ids?e.doc_ids.sort(pe):"",o=e.filter?e.filter.toString():"",u="",d="",M="";return e.selector&&(M=JSON.stringify(e.selector)),e.filter&&e.query_params&&(u=JSON.stringify(function(t){return Object.keys(t).sort(pe).reduce(function(n,e){return n[e]=t[e],n},{})}(e.query_params))),e.filter&&"_view"===e.filter&&(d=e.view.toString()),Promise.all([t.id(),n.id()]).then(function(A){var k=A[0]+A[1]+o+d+u+i+M;return new Promise(function($){nn(k,$)})}).then(function(A){return"_local/"+A.replace(/\//g,".").replace(/\+/g,"_")})}(t,n,e).then(function(at){Y=new Yr(t,n,at,i,!1===e.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===e.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===e.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0})})}function At(){if(ut=[],0!==d.docs.length){var at=d.docs;return n.bulkDocs({docs:at,new_edits:!1},{timeout:e.timeout}).then(function(Tt){if(i.cancelled)throw qt(),new Error("cancelled");var Et=Object.create(null);Tt.forEach(function(Dt){Dt.error&&(Et[Dt.id]=Dt)});var kt=Object.keys(Et).length;o.doc_write_failures+=kt,o.docs_written+=at.length-kt,at.forEach(function(Dt){var wt=Et[Dt._id];if(wt){o.errors.push(wt);var Nt=(wt.name||"").toLowerCase();if("unauthorized"!==Nt&&"forbidden"!==Nt)throw wt;i.emit("denied",Mt(wt))}else ut.push(Dt)})},function(Tt){throw o.doc_write_failures+=at.length,Tt})}}function It(){if(d.error)throw new Error("There was a problem getting docs.");o.last_seq=_=d.seq;var at=Mt(o);return ut.length&&(at.docs=ut,"number"==typeof d.pending&&(at.pending=d.pending,delete d.pending),i.emit("change",at)),A=!0,Y.writeCheckpoint(d.seq,vt).then(function(){if(A=!1,i.cancelled)throw qt(),new Error("cancelled");d=void 0,ot()}).catch(function(_t){throw pt(_t),_t})}function Ut(){return xo(t,n,d.diffs,i).then(function(at){d.error=!at.ok,at.docs.forEach(function(_t){delete d.diffs[_t._id],o.docs_read++,d.docs.push(_t)})})}function Wt(){if(!i.cancelled&&!d){if(0===u.length)return void Zt(!0);d=u.shift(),(at={},d.changes.forEach(function(_t){"_user/"!==_t.id&&(at[_t.id]=_t.changes.map(function(Tt){return Tt.rev}))}),n.revsDiff(at).then(function(_t){if(i.cancelled)throw qt(),new Error("cancelled");d.diffs=_t})).then(Ut).then(At).then(It).then(Wt).catch(function(at){Bt("batch processing terminated with error",at)})}var at}function Zt(at){0!==M.changes.length?(at||k||M.changes.length>=Q)&&(u.push(M),M={seq:0,changes:[],docs:[]},("pending"===i.state||"stopped"===i.state)&&(i.state="active",i.emit("active")),Wt()):0===u.length&&!d&&((q&&xt.live||k)&&(i.state="pending",i.emit("paused")),k&&qt())}function Bt(at,_t){$||(_t.message||(_t.message=at),o.ok=!1,o.status="aborting",u=[],M={seq:0,changes:[],docs:[]},qt(_t))}function qt(at){if(!($||i.cancelled&&(o.status="cancelled",A)))if(o.status=o.status||"complete",o.end_time=(new Date).toISOString(),o.last_seq=_,$=!0,at){(at=jt(at)).result=o;var _t=(at.name||"").toLowerCase();"unauthorized"===_t||"forbidden"===_t?(i.emit("error",at),i.removeAllListeners()):function(t,n,e,i){if(!1===t.retry)return n.emit("error",e),void n.removeAllListeners();if("function"!=typeof t.back_off_function&&(t.back_off_function=Da),n.emit("requestError",e),"active"===n.state||"pending"===n.state){n.emit("paused",e),n.state="stopped";var o=function(){t.current_back_off=0};n.once("paused",function(){n.removeListener("active",o)}),n.once("active",o)}t.current_back_off=t.current_back_off||0,t.current_back_off=t.back_off_function(t.current_back_off),setTimeout(i,t.current_back_off)}(e,i,at,function(){h(t,n,e,i)})}else i.emit("complete",o),i.removeAllListeners()}function Yt(at,_t,Tt){if(i.cancelled)return qt();"number"==typeof _t&&(M.pending=_t),!En(e)(at)||(M.seq=at.seq||Tt,M.changes.push(at),Le()(function(){Zt(0===u.length&&xt.live)}))}function tt(at){if(j=!1,i.cancelled)return qt();if(at.results.length>0)xt.since=at.results[at.results.length-1].seq,ot(),Zt(!0);else{var _t=function(){q?(xt.live=!0,ot()):k=!0,Zt(!0)};d||0!==at.results.length?_t():(A=!0,Y.writeCheckpoint(at.last_seq,vt).then(function(){A=!1,o.last_seq=_=at.last_seq,_t()}).catch(pt))}}function it(at){if(j=!1,i.cancelled)return qt();Bt("changes rejected",at)}function ot(){if(!j&&!k&&u.length<O){j=!0,i._changes&&(i.removeListener("cancel",i._abortChanges),i._changes.cancel()),i.once("cancel",at);var Tt=t.changes(xt).on("change",Yt);Tt.then(_t,_t),Tt.then(tt).catch(it),e.retry&&(i._changes=Tt,i._abortChanges=at)}function at(){Tt.cancel()}function _t(){i.removeListener("cancel",at)}}function bt(){yt().then(function(){if(!i.cancelled)return Y.getCheckpoint().then(function(at){xt={since:_=at,limit:Q,batch_size:Q,style:"all_docs",doc_ids:V,selector:et,return_docs:!0},e.filter&&("string"!=typeof e.filter?xt.include_docs=!0:xt.filter=e.filter),"heartbeat"in e&&(xt.heartbeat=e.heartbeat),"timeout"in e&&(xt.timeout=e.timeout),e.query_params&&(xt.query_params=e.query_params),e.view&&(xt.view=e.view),ot()});qt()}).catch(function(at){Bt("getCheckpoint rejected with ",at)})}function pt(at){A=!1,Bt("writeCheckpoint completed with error",at)}i.ready(t,n),i.cancelled?qt():(i._addedListeners||(i.once("cancel",qt),"function"==typeof e.complete&&(i.once("error",e.complete),i.once("complete",function(at){e.complete(null,at)})),i._addedListeners=!0),void 0===e.since?bt():yt().then(function(){return A=!0,Y.writeCheckpoint(e.since,vt)}).then(function(){A=!1,i.cancelled?qt():(_=e.since,bt())}).catch(pt))}function c(){_e().call(this),this.cancelled=!1,this.state="pending";var t=this,n=new Promise(function(e,i){t.once("complete",e),t.once("error",i)});t.then=function(e,i){return n.then(e,i)},t.catch=function(e){return n.catch(e)},t.catch(function(){})}function v(t,n){return"string"==typeof t?new(0,n.PouchConstructor)(t,n):t}function p(t,n,e,i){if("function"==typeof e&&(i=e,e={}),void 0===e&&(e={}),e.doc_ids&&!Array.isArray(e.doc_ids))throw jt(Xr,"`doc_ids` filter parameter is not a list.");e.complete=i,(e=Mt(e)).continuous=e.continuous||e.live,e.retry="retry"in e&&e.retry,e.PouchConstructor=e.PouchConstructor||this;var o=new c(e);return h(v(t,e),v(n,e),e,o),o}function l(t,n,e,i){return"function"==typeof e&&(i=e,e={}),void 0===e&&(e={}),(e=Mt(e)).PouchConstructor=e.PouchConstructor||this,new S(t=v(t,e),n=v(n,e),e,i)}function S(t,n,e,i){var o=this;this.canceled=!1;var u=e.push?Rt({},e,e.push):e,d=e.pull?Rt({},e,e.pull):e;function M(Y){o.emit("change",{direction:"pull",change:Y})}function A(Y){o.emit("change",{direction:"push",change:Y})}function k(Y){o.emit("denied",{direction:"push",doc:Y})}function $(Y){o.emit("denied",{direction:"pull",doc:Y})}function _(){o.pushPaused=!0,o.pullPaused&&o.emit("paused")}function q(){o.pullPaused=!0,o.pushPaused&&o.emit("paused")}function Q(){o.pushPaused=!1,o.pullPaused&&o.emit("active",{direction:"push"})}function O(){o.pullPaused=!1,o.pushPaused&&o.emit("active",{direction:"pull"})}this.push=p(t,n,u),this.pull=p(n,t,d),this.pushPaused=!0,this.pullPaused=!0;var j={};function V(Y){return function(ut,vt){("change"===ut&&(vt===M||vt===A)||"denied"===ut&&(vt===$||vt===k)||"paused"===ut&&(vt===q||vt===_)||"active"===ut&&(vt===O||vt===Q))&&(ut in j||(j[ut]={}),j[ut][Y]=!0,2===Object.keys(j[ut]).length&&o.removeAllListeners(ut))}}function et(Y,ut,vt){-1==Y.listeners(ut).indexOf(vt)&&Y.on(ut,vt)}e.live&&(this.push.on("complete",o.pull.cancel.bind(o.pull)),this.pull.on("complete",o.push.cancel.bind(o.push))),this.on("newListener",function(Y){"change"===Y?(et(o.pull,"change",M),et(o.push,"change",A)):"denied"===Y?(et(o.pull,"denied",$),et(o.push,"denied",k)):"active"===Y?(et(o.pull,"active",O),et(o.push,"active",Q)):"paused"===Y&&(et(o.pull,"paused",q),et(o.push,"paused",_))}),this.on("removeListener",function(Y){"change"===Y?(o.pull.removeListener("change",M),o.push.removeListener("change",A)):"denied"===Y?(o.pull.removeListener("denied",$),o.push.removeListener("denied",k)):"active"===Y?(o.pull.removeListener("active",O),o.push.removeListener("active",Q)):"paused"===Y&&(o.pull.removeListener("paused",q),o.push.removeListener("paused",_))}),this.pull.on("removeListener",V("pull")),this.push.on("removeListener",V("push"));var rt=Promise.all([this.push,this.pull]).then(function(Y){var ut={push:Y[0],pull:Y[1]};return o.emit("complete",ut),i&&i(null,ut),o.removeAllListeners(),ut},function(Y){if(o.cancel(),i?i(Y):o.emit("error",Y),o.removeAllListeners(),i)throw Y});this.then=function(Y,ut){return rt.then(Y,ut)},this.catch=function(Y){return rt.catch(Y)}}Yr.prototype.getCheckpoint=function(){var t=this;return t.opts&&t.opts.writeSourceCheckpoint&&!t.opts.writeTargetCheckpoint?t.src.get(t.id).then(function(n){return n.last_seq||0}).catch(function(n){if(404!==n.status)throw n;return 0}):t.target.get(t.id).then(function(n){return t.opts&&t.opts.writeTargetCheckpoint&&!t.opts.writeSourceCheckpoint?n.last_seq||0:t.src.get(t.id).then(function(e){return n.version!==e.version?0:(i=n.version?n.version.toString():"undefined")in la?la[i](n,e):0;var i},function(e){if(404===e.status&&n.last_seq)return t.src.put({_id:t.id,last_seq:0}).then(function(){return 0},function(i){return va(i)?(t.opts.writeSourceCheckpoint=!1,n.last_seq):0});throw e})}).catch(function(n){if(404!==n.status)throw n;return 0})},Te()(c,_e()),c.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},c.prototype.ready=function(t,n){var e=this;function i(){e.cancel()}e._readyCalled||(e._readyCalled=!0,t.once("destroyed",i),n.once("destroyed",i),e.once("complete",function(){t.removeListener("destroyed",i),n.removeListener("destroyed",i)}))},Te()(S,_e()),S.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},Gt.plugin(function(t){t.adapter("idb",$i,!0)}).plugin(function(t){t.adapter("http",ei,!1),t.adapter("https",ei,!1)}).plugin(Mo).plugin(function(t){t.replicate=p,t.sync=l,Object.defineProperty(t.prototype,"replicate",{get:function(){var n=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(e,i,o){return n.constructor.replicate(e,n,i,o)},to:function(e,i,o){return n.constructor.replicate(n,e,i,o)}}),this.replicateMethods}}),t.prototype.sync=function(n,e,i){return this.constructor.sync(this,n,e,i)}});const X=Gt;let z=(()=>{class t{constructor(){this.db=new X("stations")}getStations(){return K(this,void 0,void 0,function*(){return(yield this.db.allDocs({include_docs:!0})).rows.map(i=>i.doc)})}getStation(e){return K(this,void 0,void 0,function*(){try{return yield this.db.get(e)}catch(i){return null}})}addUpdateStation(e){return K(this,void 0,void 0,function*(){return yield this.db.put(e),yield this.db.get(e._id)})}deleteStation(e){return K(this,void 0,void 0,function*(){return yield this.db.remove(e),e._rev="",e})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),st=(()=>{class t{constructor(e){this.stationStorageService=e,this.stationCreated=new Or.xQ,this.stationUpdated=new Or.xQ,this.stationDeleted=new Or.xQ}getStationCreated(){return this.stationCreated.asObservable()}getStationUpdated(){return this.stationUpdated.asObservable()}getStationDeleted(){return this.stationDeleted.asObservable()}getStations(){return K(this,void 0,void 0,function*(){return this.stations||(this.stations=yield this.stationStorageService.getStations()),this.stations})}getStation(e){return K(this,void 0,void 0,function*(){return yield this.stationStorageService.getStation(e)})}createStation(e){return K(this,void 0,void 0,function*(){const i=yield this.stationStorageService.addUpdateStation(e);this.stationCreated.next(i)})}updateStation(e){return K(this,void 0,void 0,function*(){const i=yield this.stationStorageService.addUpdateStation(e);this.stationUpdated.next(i)})}deleteStation(e){return K(this,void 0,void 0,function*(){const i=yield this.stationStorageService.deleteStation(e);this.stationDeleted.next(i)})}}return t.\u0275fac=function(e){return new(e||t)(f.LFG(z))},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var ft=I(1056),dt=I(7453);function lt(t,n){if(n.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+n.length+" present")}function mt(t){lt(1,arguments);var n=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===n?new Date(t.getTime()):"number"==typeof t||"[object Number]"===n?new Date(t):(("string"==typeof t||"[object String]"===n)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function Pt(t){lt(1,arguments);var n=mt(t);return!isNaN(n)}var Ft={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function $t(t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.width?String(n.width):t.defaultWidth,i=t.formats[e]||t.formats[t.defaultWidth];return i}}var t,he={date:$t({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:$t({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:$t({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},dr={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Xe(t){return function(n,e){var u,i=e||{};if("formatting"===(i.context?String(i.context):"standalone")&&t.formattingValues){var d=t.defaultFormattingWidth||t.defaultWidth,M=i.width?String(i.width):d;u=t.formattingValues[M]||t.formattingValues[d]}else{var A=t.defaultWidth,k=i.width?String(i.width):t.defaultWidth;u=t.values[k]||t.values[A]}return u[t.argumentCallback?t.argumentCallback(n):n]}}function oi(t){return function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.width,o=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],u=n.match(o);if(!u)return null;var k,d=u[0],M=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],A=Array.isArray(M)?ou(M,function(_){return _.test(d)}):su(M,function(_){return _.test(d)});k=t.valueCallback?t.valueCallback(A):A,k=e.valueCallback?e.valueCallback(k):k;var $=n.slice(d.length);return{value:k,rest:$}}}function su(t,n){for(var e in t)if(t.hasOwnProperty(e)&&n(t[e]))return e}function ou(t,n){for(var e=0;e<t.length;e++)if(n(t[e]))return e}const bu={code:"en-US",formatDistance:function(t,n,e){var i;return e=e||{},i="string"==typeof Ft[t]?Ft[t]:1===n?Ft[t].one:Ft[t].other.replace("{{count}}",n),e.addSuffix?e.comparison>0?"in "+i:i+" ago":i},formatLong:he,formatRelative:function(t,n,e,i){return dr[t]},localize:{ordinalNumber:function(t,n){var e=Number(t),i=e%100;if(i>20||i<10)switch(i%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},era:Xe({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Xe({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(t){return Number(t)-1}}),month:Xe({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Xe({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Xe({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(t={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(t){return parseInt(t,10)}},function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.match(t.matchPattern);if(!i)return null;var o=i[0],u=n.match(t.parsePattern);if(!u)return null;var d=t.valueCallback?t.valueCallback(u[0]):u[0];d=e.valueCallback?e.valueCallback(d):d;var M=n.slice(o.length);return{value:d,rest:M}}),era:oi({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:oi({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:oi({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:oi({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:oi({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function ge(t){if(null===t||!0===t||!1===t)return NaN;var n=Number(t);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}function Su(t,n){lt(2,arguments);var e=mt(t).getTime(),i=ge(n);return new Date(e+i)}function xu(t,n){lt(2,arguments);var e=ge(n);return Su(t,-e)}function ae(t,n){for(var e=t<0?"-":"",i=Math.abs(t).toString();i.length<n;)i="0"+i;return e+i}const Ar_y=function(t,n){var e=t.getUTCFullYear(),i=e>0?e:1-e;return ae("yy"===n?i%100:i,n.length)},Ar_M=function(t,n){var e=t.getUTCMonth();return"M"===n?String(e+1):ae(e+1,2)},Ar_d=function(t,n){return ae(t.getUTCDate(),n.length)},Ar_h=function(t,n){return ae(t.getUTCHours()%12||12,n.length)},Ar_H=function(t,n){return ae(t.getUTCHours(),n.length)},Ar_m=function(t,n){return ae(t.getUTCMinutes(),n.length)},Ar_s=function(t,n){return ae(t.getUTCSeconds(),n.length)},Ar_S=function(t,n){var e=n.length,i=t.getUTCMilliseconds();return ae(Math.floor(i*Math.pow(10,e-3)),n.length)};function ga(t){lt(1,arguments);var n=1,e=mt(t),i=e.getUTCDay(),o=(i<n?7:0)+i-n;return e.setUTCDate(e.getUTCDate()-o),e.setUTCHours(0,0,0,0),e}function Uo(t){lt(1,arguments);var n=mt(t),e=n.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(e+1,0,4),i.setUTCHours(0,0,0,0);var o=ga(i),u=new Date(0);u.setUTCFullYear(e,0,4),u.setUTCHours(0,0,0,0);var d=ga(u);return n.getTime()>=o.getTime()?e+1:n.getTime()>=d.getTime()?e:e-1}function Tu(t){lt(1,arguments);var n=Uo(t),e=new Date(0);e.setUTCFullYear(n,0,4),e.setUTCHours(0,0,0,0);var i=ga(e);return i}var Eu=6048e5;function pa(t,n){lt(1,arguments);var e=n||{},i=e.locale,o=i&&i.options&&i.options.weekStartsOn,u=null==o?0:ge(o),d=null==e.weekStartsOn?u:ge(e.weekStartsOn);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var M=mt(t),A=M.getUTCDay(),k=(A<d?7:0)+A-d;return M.setUTCDate(M.getUTCDate()-k),M.setUTCHours(0,0,0,0),M}function Bo(t,n){lt(1,arguments);var e=mt(t,n),i=e.getUTCFullYear(),o=n||{},u=o.locale,d=u&&u.options&&u.options.firstWeekContainsDate,M=null==d?1:ge(d),A=null==o.firstWeekContainsDate?M:ge(o.firstWeekContainsDate);if(!(A>=1&&A<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var k=new Date(0);k.setUTCFullYear(i+1,0,A),k.setUTCHours(0,0,0,0);var $=pa(k,n),_=new Date(0);_.setUTCFullYear(i,0,A),_.setUTCHours(0,0,0,0);var q=pa(_,n);return e.getTime()>=$.getTime()?i+1:e.getTime()>=q.getTime()?i:i-1}function Du(t,n){lt(1,arguments);var e=n||{},i=e.locale,o=i&&i.options&&i.options.firstWeekContainsDate,u=null==o?1:ge(o),d=null==e.firstWeekContainsDate?u:ge(e.firstWeekContainsDate),M=Bo(t,n),A=new Date(0);A.setUTCFullYear(M,0,d),A.setUTCHours(0,0,0,0);var k=pa(A,n);return k}var Iu=6048e5;function Fo(t,n){var e=t>0?"-":"+",i=Math.abs(t),o=Math.floor(i/60),u=i%60;if(0===u)return e+String(o);var d=n||"";return e+String(o)+d+ae(u,2)}function jo(t,n){return t%60==0?(t>0?"-":"+")+ae(Math.abs(t)/60,2):Jr(t,n)}function Jr(t,n){var e=n||"",i=t>0?"-":"+",o=Math.abs(t);return i+ae(Math.floor(o/60),2)+e+ae(o%60,2)}const Ru={G:function(t,n,e){var i=t.getUTCFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return e.era(i,{width:"abbreviated"});case"GGGGG":return e.era(i,{width:"narrow"});case"GGGG":default:return e.era(i,{width:"wide"})}},y:function(t,n,e){if("yo"===n){var i=t.getUTCFullYear();return e.ordinalNumber(i>0?i:1-i,{unit:"year"})}return Ar_y(t,n)},Y:function(t,n,e,i){var o=Bo(t,i),u=o>0?o:1-o;return"YY"===n?ae(u%100,2):"Yo"===n?e.ordinalNumber(u,{unit:"year"}):ae(u,n.length)},R:function(t,n){return ae(Uo(t),n.length)},u:function(t,n){return ae(t.getUTCFullYear(),n.length)},Q:function(t,n,e){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(n){case"Q":return String(i);case"QQ":return ae(i,2);case"Qo":return e.ordinalNumber(i,{unit:"quarter"});case"QQQ":return e.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,n,e){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(n){case"q":return String(i);case"qq":return ae(i,2);case"qo":return e.ordinalNumber(i,{unit:"quarter"});case"qqq":return e.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,n,e){var i=t.getUTCMonth();switch(n){case"M":case"MM":return Ar_M(t,n);case"Mo":return e.ordinalNumber(i+1,{unit:"month"});case"MMM":return e.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(i,{width:"wide",context:"formatting"})}},L:function(t,n,e){var i=t.getUTCMonth();switch(n){case"L":return String(i+1);case"LL":return ae(i+1,2);case"Lo":return e.ordinalNumber(i+1,{unit:"month"});case"LLL":return e.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(i,{width:"wide",context:"standalone"})}},w:function(t,n,e,i){var o=function(t,n){lt(1,arguments);var e=mt(t),i=pa(e,n).getTime()-Du(e,n).getTime();return Math.round(i/Iu)+1}(t,i);return"wo"===n?e.ordinalNumber(o,{unit:"week"}):ae(o,n.length)},I:function(t,n,e){var i=function(t){lt(1,arguments);var n=mt(t),e=ga(n).getTime()-Tu(n).getTime();return Math.round(e/Eu)+1}(t);return"Io"===n?e.ordinalNumber(i,{unit:"week"}):ae(i,n.length)},d:function(t,n,e){return"do"===n?e.ordinalNumber(t.getUTCDate(),{unit:"date"}):Ar_d(t,n)},D:function(t,n,e){var i=function(t){lt(1,arguments);var n=mt(t),e=n.getTime();n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0);var i=n.getTime();return Math.floor((e-i)/864e5)+1}(t);return"Do"===n?e.ordinalNumber(i,{unit:"dayOfYear"}):ae(i,n.length)},E:function(t,n,e){var i=t.getUTCDay();switch(n){case"E":case"EE":case"EEE":return e.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(i,{width:"short",context:"formatting"});case"EEEE":default:return e.day(i,{width:"wide",context:"formatting"})}},e:function(t,n,e,i){var o=t.getUTCDay(),u=(o-i.weekStartsOn+8)%7||7;switch(n){case"e":return String(u);case"ee":return ae(u,2);case"eo":return e.ordinalNumber(u,{unit:"day"});case"eee":return e.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(o,{width:"short",context:"formatting"});case"eeee":default:return e.day(o,{width:"wide",context:"formatting"})}},c:function(t,n,e,i){var o=t.getUTCDay(),u=(o-i.weekStartsOn+8)%7||7;switch(n){case"c":return String(u);case"cc":return ae(u,n.length);case"co":return e.ordinalNumber(u,{unit:"day"});case"ccc":return e.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(o,{width:"narrow",context:"standalone"});case"cccccc":return e.day(o,{width:"short",context:"standalone"});case"cccc":default:return e.day(o,{width:"wide",context:"standalone"})}},i:function(t,n,e){var i=t.getUTCDay(),o=0===i?7:i;switch(n){case"i":return String(o);case"ii":return ae(o,n.length);case"io":return e.ordinalNumber(o,{unit:"day"});case"iii":return e.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(i,{width:"short",context:"formatting"});case"iiii":default:return e.day(i,{width:"wide",context:"formatting"})}},a:function(t,n,e){var o=t.getUTCHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return e.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,n,e){var o,i=t.getUTCHours();switch(o=12===i?"noon":0===i?"midnight":i/12>=1?"pm":"am",n){case"b":case"bb":return e.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,n,e){var o,i=t.getUTCHours();switch(o=i>=17?"evening":i>=12?"afternoon":i>=4?"morning":"night",n){case"B":case"BB":case"BBB":return e.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,n,e){if("ho"===n){var i=t.getUTCHours()%12;return 0===i&&(i=12),e.ordinalNumber(i,{unit:"hour"})}return Ar_h(t,n)},H:function(t,n,e){return"Ho"===n?e.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Ar_H(t,n)},K:function(t,n,e){var i=t.getUTCHours()%12;return"Ko"===n?e.ordinalNumber(i,{unit:"hour"}):ae(i,n.length)},k:function(t,n,e){var i=t.getUTCHours();return 0===i&&(i=24),"ko"===n?e.ordinalNumber(i,{unit:"hour"}):ae(i,n.length)},m:function(t,n,e){return"mo"===n?e.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Ar_m(t,n)},s:function(t,n,e){return"so"===n?e.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Ar_s(t,n)},S:function(t,n){return Ar_S(t,n)},X:function(t,n,e,i){var u=(i._originalDate||t).getTimezoneOffset();if(0===u)return"Z";switch(n){case"X":return jo(u);case"XXXX":case"XX":return Jr(u);case"XXXXX":case"XXX":default:return Jr(u,":")}},x:function(t,n,e,i){var u=(i._originalDate||t).getTimezoneOffset();switch(n){case"x":return jo(u);case"xxxx":case"xx":return Jr(u);case"xxxxx":case"xxx":default:return Jr(u,":")}},O:function(t,n,e,i){var u=(i._originalDate||t).getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Fo(u,":");case"OOOO":default:return"GMT"+Jr(u,":")}},z:function(t,n,e,i){var u=(i._originalDate||t).getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Fo(u,":");case"zzzz":default:return"GMT"+Jr(u,":")}},t:function(t,n,e,i){return ae(Math.floor((i._originalDate||t).getTime()/1e3),n.length)},T:function(t,n,e,i){return ae((i._originalDate||t).getTime(),n.length)}};function Go(t,n){switch(t){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}}function Zo(t,n){switch(t){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}}const Uu={p:Zo,P:function(t,n){var u,e=t.match(/(P+)(p+)?/),i=e[1],o=e[2];if(!o)return Go(t,n);switch(i){case"P":u=n.dateTime({width:"short"});break;case"PP":u=n.dateTime({width:"medium"});break;case"PPP":u=n.dateTime({width:"long"});break;case"PPPP":default:u=n.dateTime({width:"full"})}return u.replace("{{date}}",Go(i,n)).replace("{{time}}",Zo(o,n))}};function Bu(t){var n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),t.getTime()-n.getTime()}var Fu=["D","DD"],ju=["YY","YYYY"];function Gu(t){return-1!==Fu.indexOf(t)}function Zu(t){return-1!==ju.indexOf(t)}function Wo(t,n,e){if("YYYY"===t)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(n,"`) for formatting years to the input `").concat(e,"`; see: https://git.io/fxCyr"));if("YY"===t)throw new RangeError("Use `yy` instead of `YY` (in `".concat(n,"`) for formatting years to the input `").concat(e,"`; see: https://git.io/fxCyr"));if("D"===t)throw new RangeError("Use `d` instead of `D` (in `".concat(n,"`) for formatting days of the month to the input `").concat(e,"`; see: https://git.io/fxCyr"));if("DD"===t)throw new RangeError("Use `dd` instead of `DD` (in `".concat(n,"`) for formatting days of the month to the input `").concat(e,"`; see: https://git.io/fxCyr"))}var Wu=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Qu=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zu=/^'([^]*?)'?$/,Yu=/''/g,Ju=/[a-zA-Z]/;function To(t,n,e){lt(2,arguments);var i=String(n),o=e||{},u=o.locale||bu,d=u.options&&u.options.firstWeekContainsDate,M=null==d?1:ge(d),A=null==o.firstWeekContainsDate?M:ge(o.firstWeekContainsDate);if(!(A>=1&&A<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var k=u.options&&u.options.weekStartsOn,$=null==k?0:ge(k),_=null==o.weekStartsOn?$:ge(o.weekStartsOn);if(!(_>=0&&_<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!u.localize)throw new RangeError("locale must contain localize property");if(!u.formatLong)throw new RangeError("locale must contain formatLong property");var q=mt(t);if(!Pt(q))throw new RangeError("Invalid time value");var Q=Bu(q),O=xu(q,Q),j={firstWeekContainsDate:A,weekStartsOn:_,locale:u,_originalDate:q},V=i.match(Qu).map(function(et){var rt=et[0];return"p"===rt||"P"===rt?(0,Uu[rt])(et,u.formatLong,j):et}).join("").match(Wu).map(function(et){if("''"===et)return"'";var rt=et[0];if("'"===rt)return $u(et);var Y=Ru[rt];if(Y)return!o.useAdditionalWeekYearTokens&&Zu(et)&&Wo(et,n,t),!o.useAdditionalDayOfYearTokens&&Gu(et)&&Wo(et,n,t),Y(O,et,u.localize,j);if(rt.match(Ju))throw new RangeError("Format string contains an unescaped latin alphabet character `"+rt+"`");return et}).join("");return V}function $u(t){return t.match(zu)[1].replace(Yu,"'")}function Hu(t,n){lt(2,arguments);var e=mt(t),i=ge(n);return isNaN(i)?new Date(NaN):(i&&e.setDate(e.getDate()+i),e)}function Ku(t,n){lt(2,arguments);var e=mt(t),i=ge(n);if(isNaN(i))return new Date(NaN);if(!i)return e;var o=e.getDate(),u=new Date(e.getTime());u.setMonth(e.getMonth()+i+1,0);var d=u.getDate();return o>=d?u:(e.setFullYear(u.getFullYear(),u.getMonth(),o),e)}function Qo(t,n){lt(2,arguments);var e=mt(t),i=mt(n);return e.getTime()-i.getTime()}let Eo=(()=>{class t{constructor(){}getSecondsElapsed(e){return function(t,n){lt(2,arguments);var e=Qo(t,n)/1e3;return e>0?Math.floor(e):Math.ceil(e)}(new Date,e)}getMinutesFromNow(e){return function(t,n){lt(2,arguments);var e=Qo(t,n)/6e4;return e>0?Math.floor(e):Math.ceil(e)}(e,new Date)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var zo=I(5417);class rc{constructor(){this.departureCount=5}}class nc{}let Po=(()=>{class t{constructor(){}getStations(e){return K(this,void 0,void 0,function*(){try{return(yield zo.findStop(e)).map(o=>{const u=new rc;return u._id=o.id,u.name=o.name,u.city=o.city,u})}catch(i){return[]}})}getDepartures(e,i=0){return K(this,void 0,void 0,function*(){try{return(yield zo.monitor(e._id,i,e.departureCount)).map(u=>{const d=new nc;return d.line=u.line,d.destination=u.direction,d.arrival=u.arrivalTime,d.relativeArrival=u.arrivalTimeRelative,d.relativeDelay=u.delayTime,d.hasLiveData="Unknown"!==u.state,d.isCancelled="Cancelled"===u.state,d.platformType=u.platform.type,d.platformName=u.platform.name,d.modeIconUrl=u.mode.iconUrl,d})}catch(o){return[]}})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ic(t,n){1&t&&(f.TgZ(0,"ion-item"),f.TgZ(1,"ion-label"),f.TgZ(2,"h2"),f._UZ(3,"ion-skeleton-text",1),f.qZA(),f.TgZ(4,"ion-card-subtitle"),f._UZ(5,"ion-skeleton-text",1),f.qZA(),f.qZA(),f.qZA())}let ac=(()=>{class t{constructor(){}ngOnInit(){}get skeletons(){return Array(3)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-station-picker-skeleton"]],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["animated",""]],template:function(e,i){1&e&&(f.TgZ(0,"ion-list"),f.YNc(1,ic,6,0,"ion-item",0),f.qZA()),2&e&&(f.xp6(1),f.Q6J("ngForOf",i.skeletons))},directives:[E.q_,J.sg,E.Ie,E.Q$,E.CK,E.tO],styles:[""]}),t})();function sc(t,n){1&t&&(f.TgZ(0,"ion-text",4),f._uU(1),f.ALo(2,"translate"),f.qZA()),2&t&&(f.xp6(1),f.hij(" ",f.lcZ(2,1,"shared.inputs.restraints.station"),""))}function oc(t,n){if(1&t){const e=f.EpF();f.TgZ(0,"ion-item",6),f.NdJ("click",function(){const u=f.CHM(e).$implicit;return f.oxw(2).onSelect(u)}),f.TgZ(1,"ion-label"),f.TgZ(2,"h2"),f._uU(3),f.qZA(),f.TgZ(4,"ion-card-subtitle"),f._uU(5),f.qZA(),f.qZA(),f.qZA()}if(2&t){const e=n.$implicit;f.xp6(3),f.Oqu(e.name),f.xp6(2),f.Oqu(e.city)}}function uc(t,n){if(1&t&&(f.TgZ(0,"ion-list"),f.YNc(1,oc,6,2,"ion-item",5),f.qZA()),2&t){const e=f.oxw();f.xp6(1),f.Q6J("ngForOf",e.matchingStations)}}function cc(t,n){1&t&&f._UZ(0,"app-station-picker-skeleton")}let fc=(()=>{class t{constructor(e){this.apiService=e,this.stationSelected=new f.vpe,this.isUpdating=!1}ngOnInit(){this.stationName=new P.NI(this.combinedStationName(),[P.kI.required])}combinedStationName(){return this.selectedStation?this.selectedStation.name+", "+this.selectedStation.city:""}onInput(e){return K(this,void 0,void 0,function*(){const i=e.target.value;this.selectedStation&&i!==this.combinedStationName()&&(this.selectedStation=null,this.stationSelected.emit(null)),!i||i.length<3?this.matchingStations=[]:setTimeout(()=>this.onDebounceElapsed(i),300)})}onDebounceElapsed(e){return K(this,void 0,void 0,function*(){e===this.stationName.value&&(this.isUpdating=!0,this.matchingStations=(yield this.apiService.getStations(e)).slice(0,3),this.isUpdating=!1)})}onSelect(e){this.selectedStation=e,this.stationName.setValue(this.combinedStationName()),this.matchingStations=[],this.stationSelected.emit(e)}}return t.\u0275fac=function(e){return new(e||t)(f.Y36(Po))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-station-picker"]],outputs:{stationSelected:"stationSelected"},decls:8,vars:7,consts:[["position","floating"],["type","text",3,"formControl","ionInput"],["color","danger",4,"ngIf"],[4,"ngIf"],["color","danger"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"]],template:function(e,i){1&e&&(f.TgZ(0,"ion-item"),f.TgZ(1,"ion-label",0),f._uU(2),f.ALo(3,"translate"),f.qZA(),f.TgZ(4,"ion-input",1),f.NdJ("ionInput",function(u){return i.onInput(u)}),f.qZA(),f.qZA(),f.YNc(5,sc,3,3,"ion-text",2),f.YNc(6,uc,2,1,"ion-list",3),f.YNc(7,cc,1,0,"app-station-picker-skeleton",3)),2&e&&(f.xp6(2),f.Oqu(f.lcZ(3,5,"shared.inputs.station")),f.xp6(2),f.Q6J("formControl",i.stationName),f.xp6(1),f.Q6J("ngIf",!i.selectedStation&&(i.stationName.dirty||i.stationName.touched)),f.xp6(1),f.Q6J("ngIf",!i.isUpdating),f.xp6(1),f.Q6J("ngIf",i.isUpdating))},directives:[E.Ie,E.Q$,E.pK,E.j9,P.JJ,P.oH,J.O5,E.yW,E.q_,J.sg,E.tO,ac],pipes:[ft.X$],styles:[""]}),t})();function hc(t,n){1&t&&f._UZ(0,"ion-spinner",4)}function lc(t,n){if(1&t&&f._UZ(0,"ion-icon",5),2&t){const e=f.oxw();f.Q6J("color",e.clickable?"default":"medium")}}const dc=function(t){return{clickable:t}};let Yo=(()=>{class t{constructor(e){this.dateTimeService=e,this.value=0}set start(e){this._start=e,this.compute()}ngOnInit(){this.updateInterval=setInterval(()=>{this.compute()},500)}get start(){return this._start}compute(){this.update&&(this.value=this.start?this.dateTimeService.getSecondsElapsed(this.start):0)}}return t.\u0275fac=function(e){return new(e||t)(f.Y36(Eo))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-timer"]],inputs:{update:"update",clickable:"clickable",updating:"updating",start:"start"},decls:6,vars:7,consts:[["lines","none",3,"ngClass"],["name","crescent","color","medium",4,"ngIf"],["name","timer-outline",3,"color",4,"ngIf"],[3,"color"],["name","crescent","color","medium"],["name","timer-outline",3,"color"]],template:function(e,i){1&e&&(f.TgZ(0,"ion-item",0),f.YNc(1,hc,1,0,"ion-spinner",1),f.YNc(2,lc,1,1,"ion-icon",2),f._uU(3," \xa0 "),f.TgZ(4,"ion-text",3),f._uU(5),f.qZA(),f.qZA()),2&e&&(f.Q6J("ngClass",f.VKq(5,dc,i.clickable)),f.xp6(1),f.Q6J("ngIf",i.updating),f.xp6(1),f.Q6J("ngIf",!i.updating),f.xp6(2),f.Q6J("color",i.clickable?"default":"medium"),f.xp6(1),f.hij("",i.value>99?">99":i.value,"s"))},directives:[E.Ie,J.mk,J.O5,E.yW,E.PQ,E.gu],styles:[""]}),t})(),vc=(()=>{class t{constructor(e){this.translateService=e}getDepartureTime(e){if(0===e.relativeArrival)return this.translateService.instant("departures.arrival-times.now");if(e.relativeArrival<0)return this.translateService.instant("departures.arrival-times.min-ago");if(e.relativeArrival>30){const i=e.arrival.getHours(),o=e.arrival.getMinutes();return o<10?i+":0"+o:i+":"+o}return this.translateService.instant("departures.arrival-times.min",{count:e.relativeArrival})}getDelay(e){return e.hasLiveData?e.isCancelled?this.translateService.instant("departures.delays.cancelled"):0===e.relativeDelay?this.translateService.instant("departures.delays.on-time"):e.relativeDelay<0?this.translateService.instant("departures.delays.early",{count:Math.abs(e.relativeDelay)}):this.translateService.instant("departures.delays.late",{count:e.relativeDelay}):this.translateService.instant("departures.delays.scheduled")}}return t.\u0275fac=function(e){return new(e||t)(f.LFG(ft.sK))},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),mc=(()=>{class t{getDelayColor(e,i,o,u){switch(!0){case!u:case e<0:return"color-departed";case o:return"color-cancelled";case i<-2:return"color-early";case i<0:return"color-slightly-early";case 0===i:return"color-on-time";case i<3:return"color-slightly-late";case i<5:return"color-late";case i<10:return"color-very-late";default:return"color-cancelled"}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const gc=function(t){return{"filter-grayscale":t}},pc=function(t,n){return{"color-departed":t,strikethrough:n}},_c=function(t){return{"color-departed":t}};let yc=(()=>{class t{constructor(e,i){this.stringService=e,this.colorService=i}ngOnInit(){}get departureTime(){return this.stringService.getDepartureTime(this.departure)}get delay(){return this.stringService.getDelay(this.departure)}get delayColor(){return this.colorService.getDelayColor(this.departure.relativeArrival,this.departure.relativeDelay,this.departure.isCancelled,this.departure.hasLiveData)}}return t.\u0275fac=function(e){return new(e||t)(f.Y36(vc),f.Y36(mc))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-departures-item"]],inputs:{departure:"departure"},decls:15,vars:24,consts:[["slot","start"],["onerror","this.onerror=null; this.src='assets/unknown-mode.svg'","alt","",3,"src","ngClass"],[3,"ngClass"],["slot","end",1,"ion-text-end",3,"ngClass"]],template:function(e,i){1&e&&(f.TgZ(0,"ion-item"),f.TgZ(1,"ion-avatar",0),f._UZ(2,"img",1),f.qZA(),f.TgZ(3,"ion-label",2),f.TgZ(4,"h2"),f._uU(5),f.qZA(),f.TgZ(6,"h3"),f._uU(7),f.ALo(8,"translate"),f.ALo(9,"lowercase"),f.qZA(),f.qZA(),f.TgZ(10,"ion-note",3),f.TgZ(11,"h3"),f._uU(12),f.qZA(),f.TgZ(13,"h3"),f._uU(14),f.qZA(),f.qZA(),f.qZA()),2&e&&(f.xp6(2),f.s9C("src","https://m.dvb.de/img/mot_icons/plusBus.svg"===i.departure.modeIconUrl?"assets/plusbus.svg":i.departure.modeIconUrl,f.LSH),f.Q6J("ngClass",f.VKq(17,gc,i.departure.relativeArrival<0)),f.xp6(1),f.Q6J("ngClass",f.WLB(19,pc,i.departure.relativeArrival<0,i.departure.isCancelled)),f.xp6(2),f.AsE("",i.departure.line," ",i.departure.destination,""),f.xp6(2),f.AsE("",f.lcZ(8,13,f.lcZ(9,15,"shared.station-types."+i.departure.platformType))," ",i.departure.platformName,""),f.xp6(3),f.Q6J("ngClass",f.VKq(22,_c,i.departure.relativeArrival<0)),f.xp6(2),f.Oqu(i.departureTime),f.xp6(1),f.Tol(i.delayColor),f.xp6(1),f.Oqu(i.delay))},directives:[E.Ie,E.BJ,J.mk,E.Q$,E.uN],pipes:[ft.X$,J.i8],styles:["ion-avatar[_ngcontent-%COMP%]{--border-radius: 0px;margin-left:unset;margin-inline-start:-16px}ion-note[_ngcontent-%COMP%]{color:var(--ion-text-color);padding:12px 0 10px;margin-right:-5px;margin-left:8px}.filter-grayscale[_ngcontent-%COMP%]{filter:grayscale(100%)}.strikethrough[_ngcontent-%COMP%]{text-decoration:line-through}"]}),t})();function Mc(t,n){1&t&&f._UZ(0,"app-departures-item",2),2&t&&f.Q6J("departure",n.$implicit)}function wc(t,n){if(1&t&&(f.TgZ(0,"ion-list"),f.YNc(1,Mc,1,1,"app-departures-item",1),f.qZA()),2&t){const e=f.oxw();f.xp6(1),f.Q6J("ngForOf",e.departures)}}let Jo=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-departures-list"]],inputs:{departures:"departures"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"departure",4,"ngFor","ngForOf"],[3,"departure"]],template:function(e,i){1&e&&f.YNc(0,wc,2,1,"ion-list",0),2&e&&f.Q6J("ngIf",i.departures)},directives:[J.O5,E.q_,J.sg,yc],styles:[""]}),t})();function bc(t,n){1&t&&(f.TgZ(0,"ion-item"),f.TgZ(1,"ion-avatar",1),f._UZ(2,"ion-skeleton-text",2),f.qZA(),f.TgZ(3,"ion-label"),f.TgZ(4,"h2"),f._UZ(5,"ion-skeleton-text",2),f.qZA(),f.TgZ(6,"h3"),f._UZ(7,"ion-skeleton-text",2),f.qZA(),f.qZA(),f.qZA())}let $o=(()=>{class t{constructor(){}ngOnInit(){}get skeletons(){return Array(this.departureCount)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-departures-item-skeleton"]],inputs:{departureCount:"departureCount"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["slot","start"],["animated",""]],template:function(e,i){1&e&&(f.TgZ(0,"ion-list"),f.YNc(1,bc,8,0,"ion-item",0),f.qZA()),2&e&&(f.xp6(1),f.Q6J("ngForOf",i.skeletons))},directives:[E.q_,J.sg,E.Ie,E.BJ,E.CK,E.Q$],styles:["ion-avatar[_ngcontent-%COMP%]{--border-radius: 0px;margin-left:unset;margin-inline-start:-16px}"]}),t})();function Sc(t,n){if(1&t){const e=f.EpF();f.TgZ(0,"ion-card"),f.TgZ(1,"ion-item",1),f.TgZ(2,"ion-label"),f.TgZ(3,"ion-card-title",2),f._uU(4),f.ALo(5,"translate"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(6,"ion-card-content"),f.TgZ(7,"app-station-picker",3),f.NdJ("stationSelected",function(o){return f.CHM(e),f.oxw().onStationSelected(o)}),f.qZA(),f.TgZ(8,"ion-item"),f.TgZ(9,"ion-label",4),f._uU(10),f.ALo(11,"translate"),f.qZA(),f._UZ(12,"ion-datetime",5),f.ALo(13,"translate"),f.ALo(14,"translate"),f.qZA(),f._UZ(15,"ion-row",6),f.TgZ(16,"ion-button",7),f.NdJ("click",function(){return f.CHM(e),f.oxw().enterStationSelectedMode()}),f._UZ(17,"ion-icon",8),f._uU(18),f.ALo(19,"translate"),f.qZA(),f.qZA(),f.qZA()}if(2&t){const e=f.oxw();f.xp6(4),f.Oqu(f.lcZ(5,9,"departures.quick-search-title")),f.xp6(6),f.Oqu(f.lcZ(11,11,"shared.times.departure-time")),f.xp6(2),f.s9C("min",e.currentDate),f.s9C("max",e.maxDate),f.s9C("cancelText",f.lcZ(13,13,"shared.inputs.cancel")),f.s9C("doneText",f.lcZ(14,15,"shared.inputs.done")),f.Q6J("formControl",e.departureTime),f.xp6(4),f.Q6J("disabled",!e.selectedStation),f.xp6(2),f.hij(" ",f.lcZ(19,17,"shared.inputs.search")," ")}}function xc(t,n){if(1&t){const e=f.EpF();f.TgZ(0,"ion-button",17),f.NdJ("click",function(){return f.CHM(e),f.oxw(2).addStationToFavorites()}),f._UZ(1,"ion-icon",18),f.qZA()}}function Cc(t,n){if(1&t){const e=f.EpF();f.TgZ(0,"ion-button",17),f.NdJ("click",function(){return f.CHM(e),f.oxw(2).removeStationFromFavorites()}),f._UZ(1,"ion-icon",19),f.qZA()}}function Ac(t,n){if(1&t&&f._UZ(0,"app-departures-list",20),2&t){const e=f.oxw(2);f.Q6J("departures",e.departures)}}function Oc(t,n){1&t&&(f.TgZ(0,"h2",21),f._uU(1),f.ALo(2,"translate"),f.qZA()),2&t&&(f.xp6(1),f.Oqu(f.lcZ(2,1,"departures.none-found")))}function Tc(t,n){if(1&t&&f._UZ(0,"app-departures-item-skeleton",22),2&t){const e=f.oxw(2);f.Q6J("departureCount",e.selectedStation.departureCount)}}const Ec=function(t){return{time:t}};function Pc(t,n){if(1&t){const e=f.EpF();f.TgZ(0,"ion-card"),f.TgZ(1,"ion-item",1),f.TgZ(2,"ion-label"),f.TgZ(3,"ion-card-subtitle",2),f._uU(4),f.qZA(),f.TgZ(5,"ion-card-title",2),f._uU(6),f.qZA(),f.qZA(),f.TgZ(7,"app-timer",9),f.NdJ("click",function(){f.CHM(e);const o=f.oxw();return o.secondsElapsed>35&&!o.isUpdating&&o.updateDepartures()}),f.qZA(),f.YNc(8,xc,2,0,"ion-button",10),f.YNc(9,Cc,2,0,"ion-button",10),f.TgZ(10,"ion-button",11),f.NdJ("click",function(){return f.CHM(e),f.oxw().leaveStationSelectedMode()}),f._UZ(11,"ion-icon",12),f.qZA(),f.qZA(),f.TgZ(12,"ion-card-content"),f.TgZ(13,"ion-text",13),f._uU(14),f.ALo(15,"translate"),f.qZA(),f.YNc(16,Ac,1,1,"app-departures-list",14),f.YNc(17,Oc,3,3,"h2",15),f.YNc(18,Tc,1,1,"app-departures-item-skeleton",16),f.qZA(),f.qZA()}if(2&t){const e=f.oxw();f.xp6(4),f.Oqu(e.selectedStation.city),f.xp6(2),f.Oqu(e.selectedStation.name),f.xp6(1),f.Q6J("start",e.lastUpdate)("update",e.inStationSelectedMode)("clickable",e.secondsElapsed>35&&!e.isUpdating)("updating",e.isUpdating),f.xp6(1),f.Q6J("ngIf",!e.isStationInFavorites),f.xp6(1),f.Q6J("ngIf",e.isStationInFavorites),f.xp6(5),f.hij(" ",f.xi3(15,12,"shared.times.departing-at",f.VKq(15,Ec,e.formattedDepartureTime))," "),f.xp6(2),f.Q6J("ngIf",e.departures.length>0),f.xp6(1),f.Q6J("ngIf",0===e.departures.length&&!e.isUpdating),f.xp6(1),f.Q6J("ngIf",0===e.departures.length&&e.isUpdating)}}let Dc=(()=>{class t{constructor(e,i,o){this.dateTimeService=e,this.apiService=i,this.stationService=o,this.departures=[],this.inStationSelectedMode=!1,this.isUpdating=!0,this.isStationInFavorites=!1}ngOnInit(){this.updateCurrentDate(),this.updateDateTimeInterval=setInterval(()=>{this.updateCurrentDate()},500),this.departureTime=new P.NI(this.currentDate,P.kI.required)}get formattedDepartureTime(){return To(new Date(this.departureTime.value),"dd.MM.yyyy, HH:mm")}get secondsElapsed(){return this.lastUpdate?this.dateTimeService.getSecondsElapsed(this.lastUpdate):0}updateCurrentDate(){const e=new Date;this.currentDate=To(e,"yyyy-MM-dd'T'HH:mm"),this.maxDate=To(function(t,n){if(lt(2,arguments),!n||"object"!=typeof n)return new Date(NaN);var e=n.years?ge(n.years):0,i=n.months?ge(n.months):0,o=n.weeks?ge(n.weeks):0,u=n.days?ge(n.days):0,d=n.hours?ge(n.hours):0,M=n.minutes?ge(n.minutes):0,A=n.seconds?ge(n.seconds):0,k=mt(t),$=i||e?Ku(k,i+12*e):k,_=u||o?Hu($,u+7*o):$,O=1e3*(A+60*(M+60*d));return new Date(_.getTime()+O)}(e,{months:1}),"yyyy-MM-dd'T'HH:mm"),this.departureTime&&this.dateTimeService.getMinutesFromNow(new Date(this.departureTime.value))<0&&this.departureTime.setValue(this.currentDate)}updateDepartures(){return K(this,void 0,void 0,function*(){this.isUpdating=!0;let e=this.dateTimeService.getMinutesFromNow(new Date(this.departureTime.value));e<0&&(e=0);const i=yield this.apiService.getDepartures(this.selectedStation,e);0===i.length&&this.departures.length>0?this.isUpdating=!1:(this.departures=i,this.isUpdating=!1,this.lastUpdate=new Date)})}enterStationSelectedMode(){return K(this,void 0,void 0,function*(){const e=yield this.stationService.getStation(this.selectedStation._id);e&&(this.selectedStation=e,this.isStationInFavorites=!0),this.lastUpdate=null,this.inStationSelectedMode=!0,this.updateDepartures(),this.updateDeparturesInterval=setInterval(()=>{this.updateDepartures()},3e4)})}leaveStationSelectedMode(){clearInterval(this.updateDeparturesInterval),this.inStationSelectedMode=!1,this.isStationInFavorites=!1,this.selectedStation=null,this.departures=[]}addStationToFavorites(){return K(this,void 0,void 0,function*(){yield this.stationService.createStation(this.selectedStation),this.leaveStationSelectedMode()})}removeStationFromFavorites(){return K(this,void 0,void 0,function*(){yield this.stationService.deleteStation(this.selectedStation),this.leaveStationSelectedMode()})}onStationSelected(e){this.selectedStation=e}}return t.\u0275fac=function(e){return new(e||t)(f.Y36(Eo),f.Y36(Po),f.Y36(st))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-departures-card-quick-search"]],decls:2,vars:2,consts:[[4,"ngIf"],["lines","none"],[1,"ion-text-nowrap"],[3,"stationSelected"],["position","floating"],["displayFormat","DD.MM.YYYY, HH:mm",3,"formControl","min","max","cancelText","doneText"],[2,"height","1em"],[3,"disabled","click"],["slot","start","name","search-outline"],[1,"timer-item",3,"start","update","clickable","updating","click"],["class","card-button-item","fill","clear","size","small",3,"click",4,"ngIf"],["fill","clear","size","small",3,"click"],["slot","icon-only","name","close-outline","color","dark"],["color","dark"],[3,"departures",4,"ngIf"],["class","no-departures",4,"ngIf"],[3,"departureCount",4,"ngIf"],["fill","clear","size","small",1,"card-button-item",3,"click"],["slot","icon-only","name","star-outline","color","dark"],["slot","icon-only","name","star","color","primary"],[3,"departures"],[1,"no-departures"],[3,"departureCount"]],template:function(e,i){1&e&&(f.YNc(0,Sc,20,19,"ion-card",0),f.YNc(1,Pc,19,17,"ion-card",0)),2&e&&(f.Q6J("ngIf",!i.inStationSelectedMode),f.xp6(1),f.Q6J("ngIf",i.inStationSelectedMode))},directives:[J.O5,E.PM,E.Ie,E.Q$,E.gZ,E.FN,fc,E.x4,E.QI,P.JJ,P.oH,E.Nd,E.YG,E.gu,E.tO,Yo,E.yW,Jo,$o],pipes:[ft.X$],styles:["ion-card-title.ion-text-nowrap[_ngcontent-%COMP%], ion-card-subtitle.ion-text-nowrap[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}ion-card-content[_ngcontent-%COMP%]{padding-top:0}.card-button-item[_ngcontent-%COMP%]{margin-left:0!important}.timer-item[_ngcontent-%COMP%]{margin-left:0}.no-departures[_ngcontent-%COMP%]{margin-top:10px}"]}),t})();const Ic=function(){return{lower:"1",upper:"10"}};function Nc(t,n){1&t&&(f.TgZ(0,"ion-text",8),f._uU(1),f.ALo(2,"translate"),f.qZA()),2&t&&(f.xp6(1),f.hij(" ",f.xi3(2,1,"shared.inputs.restraints.range",f.DdM(4,Ic)),""))}let qc=(()=>{class t{constructor(e){this.stationService=e,this.submitted=new f.vpe}ngOnInit(){this.departureCount=new P.NI(this.station.departureCount,[P.kI.required,P.kI.min(1),P.kI.max(10)])}submit(){return K(this,void 0,void 0,function*(){this.station.departureCount=this.departureCount.value,yield this.stationService.updateStation(this.station),this.submitted.emit()})}removeStationFromFavorites(){return K(this,void 0,void 0,function*(){yield this.stationService.deleteStation(this.station)})}}return t.\u0275fac=function(e){return new(e||t)(f.Y36(st))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-departures-station-editor"]],inputs:{station:"station"},outputs:{submitted:"submitted"},decls:15,vars:12,consts:[["position","floating"],["type","number","min","1","max","10",3,"formControl"],["color","danger",4,"ngIf"],[2,"height","1em"],[3,"disabled","click"],["slot","start","name","save-outline"],["fill","clear","color","danger",1,"ion-float-right",3,"click"],["slot","start","name","trash-outline"],["color","danger"]],template:function(e,i){1&e&&(f.TgZ(0,"ion-item"),f.TgZ(1,"ion-label",0),f._uU(2),f.ALo(3,"translate"),f.qZA(),f._UZ(4,"ion-input",1),f.qZA(),f.YNc(5,Nc,3,5,"ion-text",2),f._UZ(6,"ion-row",3),f.TgZ(7,"ion-button",4),f.NdJ("click",function(){return i.submit()}),f._UZ(8,"ion-icon",5),f._uU(9),f.ALo(10,"translate"),f.qZA(),f.TgZ(11,"ion-button",6),f.NdJ("click",function(){return i.removeStationFromFavorites()}),f._UZ(12,"ion-icon",7),f._uU(13),f.ALo(14,"translate"),f.qZA()),2&e&&(f.xp6(2),f.Oqu(f.lcZ(3,6,"departures.departure-count")),f.xp6(2),f.Q6J("formControl",i.departureCount),f.xp6(1),f.Q6J("ngIf",i.departureCount.invalid&&(i.departureCount.dirty||i.departureCount.touched)),f.xp6(2),f.Q6J("disabled",i.departureCount.invalid),f.xp6(2),f.hij(" ",f.lcZ(10,8,"shared.inputs.save"),"\n"),f.xp6(4),f.hij(" ",f.lcZ(14,10,"shared.inputs.delete"),"\n"))},directives:[E.Ie,E.Q$,E.pK,E.as,P.JJ,P.oH,J.O5,E.Nd,E.YG,E.gu,E.yW],pipes:[ft.X$],styles:[""]}),t})();function Rc(t,n){if(1&t){const e=f.EpF();f.TgZ(0,"app-timer",5),f.NdJ("click",function(){f.CHM(e);const o=f.oxw();return o.secondsElapsed>35&&!o.isUpdating&&o.updateDepartures()}),f.qZA()}if(2&t){const e=f.oxw();f.Q6J("start",e.lastUpdate)("update",!e.inEditMode)("clickable",e.secondsElapsed>35&&!e.isUpdating)("updating",e.isUpdating)}}function kc(t,n){if(1&t){const e=f.EpF();f.TgZ(0,"ion-button",6),f.NdJ("click",function(){return f.CHM(e),f.oxw().enterEditMode()}),f._UZ(1,"ion-icon",7),f.qZA()}}function Lc(t,n){if(1&t&&f._UZ(0,"app-departures-list",10),2&t){const e=f.oxw(2);f.Q6J("departures",e.departures)}}function Uc(t,n){if(1&t&&f._UZ(0,"app-departures-item-skeleton",11),2&t){const e=f.oxw(2);f.Q6J("departureCount",e.station.departureCount)}}function Bc(t,n){1&t&&(f.TgZ(0,"h2"),f._uU(1),f.ALo(2,"translate"),f.qZA()),2&t&&(f.xp6(1),f.Oqu(f.lcZ(2,1,"departures.none-found")))}function Fc(t,n){if(1&t&&(f.TgZ(0,"ion-card-content"),f.YNc(1,Lc,1,1,"app-departures-list",8),f.YNc(2,Uc,1,1,"app-departures-item-skeleton",9),f.YNc(3,Bc,3,3,"h2",4),f.qZA()),2&t){const e=f.oxw();f.xp6(1),f.Q6J("ngIf",e.departures&&e.departures.length>0),f.xp6(1),f.Q6J("ngIf",!e.departures||0===e.departures.length&&e.isUpdating),f.xp6(1),f.Q6J("ngIf",e.departures&&0===e.departures.length&&!e.isUpdating)}}function jc(t,n){if(1&t){const e=f.EpF();f.TgZ(0,"ion-card-content"),f.TgZ(1,"app-departures-station-editor",12),f.NdJ("submitted",function(){return f.CHM(e),f.oxw().onEditorSubmitted()}),f.qZA(),f.qZA()}if(2&t){const e=f.oxw();f.xp6(1),f.Q6J("station",e.station)}}let Gc=(()=>{class t{constructor(e,i,o){this.dateTimeService=e,this.apiService=i,this.stationService=o,this.departures=[],this.inEditMode=!1,this.isUpdating=!0}ngOnInit(){return K(this,void 0,void 0,function*(){this.stationService.getStationUpdated().subscribe(e=>this.onStationUpdated(e)),yield this.updateDepartures(),this.setUpdateInterval()})}get secondsElapsed(){return this.lastUpdate?this.dateTimeService.getSecondsElapsed(this.lastUpdate):0}setUpdateInterval(){this.updateInterval=setInterval(()=>{this.updateDepartures()},3e4)}updateDepartures(){return K(this,void 0,void 0,function*(){this.isUpdating=!0;const e=yield this.apiService.getDepartures(this.station);0===e.length&&this.departures.length>0?this.isUpdating=!1:(this.departures=e,this.isUpdating=!1,this.lastUpdate=new Date)})}enterEditMode(){clearInterval(this.updateInterval),this.inEditMode=!0}onStationUpdated(e){return K(this,void 0,void 0,function*(){e._id===this.station._id&&(this.station=e)})}onEditorSubmitted(){return K(this,void 0,void 0,function*(){this.departures=[],this.lastUpdate=null,this.inEditMode=!1,yield this.updateDepartures(),this.setUpdateInterval()})}}return t.\u0275fac=function(e){return new(e||t)(f.Y36(Eo),f.Y36(Po),f.Y36(st))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-departures-card-favorite"]],inputs:{station:"station"},decls:11,vars:6,consts:[["lines","none"],[1,"ion-text-nowrap"],["class","timer-item",3,"start","update","clickable","updating","click",4,"ngIf"],["class","settings-item","slot","end","fill","clear","size","small",3,"click",4,"ngIf"],[4,"ngIf"],[1,"timer-item",3,"start","update","clickable","updating","click"],["slot","end","fill","clear","size","small",1,"settings-item",3,"click"],["slot","icon-only","name","settings-outline","color","dark"],[3,"departures",4,"ngIf"],[3,"departureCount",4,"ngIf"],[3,"departures"],[3,"departureCount"],[3,"station","submitted"]],template:function(e,i){1&e&&(f.TgZ(0,"ion-card"),f.TgZ(1,"ion-item",0),f.TgZ(2,"ion-label"),f.TgZ(3,"ion-card-subtitle",1),f._uU(4),f.qZA(),f.TgZ(5,"ion-card-title",1),f._uU(6),f.qZA(),f.qZA(),f.YNc(7,Rc,1,4,"app-timer",2),f.YNc(8,kc,2,0,"ion-button",3),f.qZA(),f.YNc(9,Fc,4,3,"ion-card-content",4),f.YNc(10,jc,2,1,"ion-card-content",4),f.qZA()),2&e&&(f.xp6(4),f.Oqu(i.station.city),f.xp6(2),f.Oqu(i.station.name),f.xp6(1),f.Q6J("ngIf",!i.inEditMode),f.xp6(1),f.Q6J("ngIf",!i.inEditMode),f.xp6(1),f.Q6J("ngIf",!i.inEditMode),f.xp6(1),f.Q6J("ngIf",i.inEditMode))},directives:[E.PM,E.Ie,E.Q$,E.tO,E.gZ,J.O5,Yo,E.YG,E.gu,E.FN,Jo,$o,qc],pipes:[ft.X$],styles:["ion-card-title.ion-text-nowrap[_ngcontent-%COMP%], ion-card-subtitle.ion-text-nowrap[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}ion-card-content[_ngcontent-%COMP%]{padding-top:0}.settings-item[_ngcontent-%COMP%]{margin-left:0!important}.timer-item[_ngcontent-%COMP%]{margin-left:0}"]}),t})();function Zc(t,n){if(1&t&&(f.TgZ(0,"ion-col",4),f._UZ(1,"app-departures-card-favorite",6),f.qZA()),2&t){const e=n.$implicit;f.xp6(1),f.Q6J("station",e)}}const Wc=[{path:"",component:(()=>{class t{constructor(e,i,o){this.stationService=e,this.toastController=i,this.translateService=o,this.stations=[]}ngOnInit(){return K(this,void 0,void 0,function*(){this.stationService.getStationCreated().subscribe(e=>this.onStationCreated(e)),this.stationService.getStationDeleted().subscribe(e=>this.onStationDeleted(e)),this.stations=yield this.stationService.getStations(),this.stations.sort((e,i)=>this.compare(e,i))})}getCombinedStationName(e){return e.name+", "+e.city}compare(e,i){return e.city===i.city?e.name.localeCompare(i.name):e.city.localeCompare(i.city)}onStationCreated(e){return K(this,void 0,void 0,function*(){this.stations.push(e),this.stations.sort((o,u)=>this.compare(o,u)),(yield this.toastController.create({message:this.translateService.instant("shared.favorite.added",{name:this.getCombinedStationName(e)}),duration:3e3})).present()})}onStationDeleted(e){return K(this,void 0,void 0,function*(){const i=this.stations.findIndex(u=>u._id===e._id);this.stations.splice(i,1),(yield this.toastController.create({message:this.translateService.instant("shared.favorite.removed",{name:this.getCombinedStationName(e)}),duration:3e3})).present()})}}return t.\u0275fac=function(e){return new(e||t)(f.Y36(st),f.Y36(E.yF),f.Y36(ft.sK))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-departures"]],decls:15,vars:9,consts:[[3,"translucent"],[1,"ion-float-start"],[1,"ion-float-end"],[3,"fullscreen"],["size-xs","12","size-sm","12","size-md","6","size-lg","6","size-xl","4"],["size-xs","12","size-sm","12","size-md","6","size-lg","6","size-xl","4",4,"ngFor","ngForOf"],[3,"station"]],template:function(e,i){1&e&&(f.TgZ(0,"title"),f._uU(1),f.ALo(2,"translate"),f.qZA(),f.TgZ(3,"ion-header",0),f.TgZ(4,"ion-toolbar"),f.TgZ(5,"ion-title",1),f._uU(6),f.ALo(7,"translate"),f.qZA(),f._UZ(8,"app-title",2),f.qZA(),f.qZA(),f.TgZ(9,"ion-content",3),f.TgZ(10,"ion-grid"),f.TgZ(11,"ion-row"),f.TgZ(12,"ion-col",4),f._UZ(13,"app-departures-card-quick-search"),f.qZA(),f.YNc(14,Zc,2,1,"ion-col",5),f.qZA(),f.qZA(),f.qZA()),2&e&&(f.xp6(1),f.hij("",f.lcZ(2,5,"departures.title")," \u2013 DVBetter"),f.xp6(2),f.Q6J("translucent",!0),f.xp6(3),f.hij(" ",f.lcZ(7,7,"departures.title")," "),f.xp6(3),f.Q6J("fullscreen",!0),f.xp6(5),f.Q6J("ngForOf",i.stations))},directives:[E.Gu,E.sr,E.wd,dt.z,E.W2,E.jY,E.Nd,E.wI,Dc,J.sg,Gc],pipes:[ft.X$],styles:[""]}),t})()}];let Qc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.oAB({type:t}),t.\u0275inj=f.cJS({imports:[[L.Bz.forChild(Wc)],L.Bz]}),t})();var zc=I(933);let Yc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.oAB({type:t}),t.\u0275inj=f.cJS({imports:[[E.Pc,J.ez,P.u5,P.UX,Qc,ft.aw,zc.q]]}),t})()},1325:gt=>{function R(E,J,P,L,W,U,H){try{var B=E[U](H),N=B.value}catch(F){return void P(F)}B.done?J(N):Promise.resolve(N).then(L,W)}gt.exports=function(E){return function(){var J=this,P=arguments;return new Promise(function(L,W){var U=E.apply(J,P);function H(N){R(U,L,W,H,B,"next",N)}function B(N){R(U,L,W,H,B,"throw",N)}H(void 0)})}},gt.exports.default=gt.exports,gt.exports.__esModule=!0},5525:()=>{}}]);